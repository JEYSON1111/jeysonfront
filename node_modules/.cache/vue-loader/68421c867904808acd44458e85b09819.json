{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\asesor\\seguimiento\\components\\visitasAdmin.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\asesor\\seguimiento\\components\\visitasAdmin.vue","mtime":1712682815533},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nexport default {\r\n    data() {\r\n       return{\r\n           counterDanger: false,\r\n           visitas:[],\r\n           institucion:'',\r\n           institucion_id:'',\r\n           periodo:'',\r\n           periodo_id:'',\r\n           usuario:[],\r\n           popupAgregarSeguimiento:false,\r\n           popupEditarSeguimiento:false,\r\n            Fgenerar: null,\r\n            Fvisita: null,\r\n            configdateTimePicker: {\r\n                enableTime: true,\r\n                dateFormat: 'Y-m-d'\r\n            },\r\n            seguimiento:{\r\n                observacion:''\r\n            },\r\n            id:0,\r\n            update:false,\r\n            title:'',\r\n            titleFechaGenera:'',\r\n            titleFechaVisita:'',\r\n            isAdmin:'',\r\n            asesorDesdeAdmin:'',\r\n            institucionesProlipa:[],\r\n            institucionesTemporales:[],\r\n            asesor_id:'',\r\n               opciones:{\r\n                presentacion:false,\r\n                entrega_muestras:false,\r\n                reunion:false,\r\n                seguimiento:false,\r\n                cierre:false,\r\n                cobranza:false,\r\n                post_venta:false,\r\n                retiro_cartas:false,\r\n                retiro_muestras:false,\r\n                sinSello: true,\r\n                editorial: '',\r\n                otraEditorial: false,\r\n            },\r\n            nombreInstitucion:'',\r\n            estado_institucion_temporal:'0',\r\n            institucion_id_temporal:'',\r\n        \r\n            popupFiltroInstitucion:false,\r\n            error: false,\r\n            messageError: \"\",\r\n            ciudadSelect: '',\r\n            popupAddNuevaInstitucion: false,\r\n            seleccionadoInsitucion: false,\r\n            nombreInstitucion: '',\r\n            busquedaInstitucion: \"\",\r\n            instituciones: [],\r\n            popupaddInstitucion: false,\r\n            arregloCiudad: [],\r\n            temporalInstitucion: {\r\n                ciudad: '',\r\n                nombreInstitucion: '',\r\n                region: '2',\r\n            },\r\n          \r\n\r\n       } \r\n    },\r\n    props:{\r\n        tipo:{\r\n            type:String,\r\n            default:1\r\n        },\r\n        valor:{\r\n            type:String,\r\n            default:\"Visita\"\r\n        }\r\n    },\r\n      components:{\r\n        flatPickr,\r\n    },\r\n    created(){\r\n        let me = this;\r\n         me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n        me.institucion = localStorage.getItem(\"institucion_seguimiento_nombre\")\r\n        me.institucion_id = localStorage.getItem(\"institucion_seguimiento_id\")\r\n        me.periodo = localStorage.getItem(\"institucion_seguimiento_periodo\")\r\n        me.periodo_id = localStorage.getItem(\"institucion_seguimiento_periodo_id\")\r\n        me.isAdmin = localStorage.getItem(\"adminSeguimiento\")\r\n        me.asesor_id = localStorage.getItem(\"institucion_seguimiento_asesor_id\")\r\n        \r\n        me.getVisitas()\r\n        me.title = \"Genera\"+\" \" +me.valor\r\n        me.titleFechaGenera = \"Fecha generar\"+ \" \" +me.valor\r\n        me.titleFechaVisita = \"Fecha visita\" + \" \" +me.valor\r\n        me.getRegistrosPendientes()\r\n    }, \r\n    methods:{\r\n        agregarInstitucionTemporal() {\r\n\r\n            let me = this;\r\n            if (me.temporalInstitucion.nombre_institucion == \"\" || me.temporalInstitucion.nombre_institucion == null || me.temporalInstitucion.nombre_institucion == undefined) {\r\n                me.$vs.notify({\r\n                    color: 'primary',\r\n                    title: 'Mensaje',\r\n                    text: 'Debe escribir una institución por favor'\r\n                })\r\n                return false;\r\n            }\r\n\r\n            let formData = new FormData();\r\n            formData.append('nombre_institucion', me.temporalInstitucion.nombre_institucion);\r\n            formData.append('ciudad', me.temporalInstitucion.ciudad.nombre);\r\n            formData.append('region', me.temporalInstitucion.region);\r\n            formData.append('asesor_id', me.usuario.idusuario);\r\n\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'GuardarInstitucionTemporal', formData)\r\n                .then(res => {\r\n\r\n                    me.$vs.loading.close()\r\n                    me.popupAddNuevaInstitucion = false;\r\n                    me.activePromptAddEvent = true\r\n                    me.seleccionadoInsitucion = false;\r\n                    me.nombreInstitucion = me.temporalInstitucion.nombre_institucion\r\n                    me.institucion_id_temporal = res.data.institucion_temporal_id\r\n                    me.instituciones = []\r\n                    me.periodo_id_temporal = res.data.periodo_id\r\n                    me.estado_institucion_temporal = 1;\r\n\r\n                    me.$vs.notify({\r\n                        text: \"Se guardo correctamente\",\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                })\r\n        },\r\n        //lista de ciudades para usar en el select\r\n        listaCiudades() {\r\n            let me = this\r\n            this.$http.get(this.$server_url + `ciudad`).then(res => {\r\n                    me.arregloCiudad = res.data;\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        regresar() {\r\n            let me = this;\r\n            me.seleccionadoInsitucion = false;\r\n            me.instituciones = []\r\n            me.error = false\r\n        },\r\n        limpiar(){\r\n            let me = this;\r\n            me.nombreInstitucion = \"\";\r\n            me.opciones.presentacion     = \"\" \r\n            me.opciones.entrega_muestras = \"\" \r\n            me.opciones.reunion          = \"\" \r\n            me.opciones.seguimiento      = \"\" \r\n            me.opciones.cierre           = \"\" \r\n            me.opciones.cobranza         = \"\" \r\n            me.opciones.post_venta       = \"\" \r\n            me.opciones.retiro_cartas    = \"\" \r\n            me.opciones.retiro_muestras  = \"\"\r\n            me.Fgenerar                  = \"\" \r\n            me.seguimiento.observacion   = \"\" \r\n            me.opciones.sinSello         = false;\r\n            me.opciones.otraEditorial    = false;\r\n            me.opciones.editorial        = \"\"\r\n\r\n        },\r\n        asginarInstitucion(tr) {\r\n            let me = this;\r\n            me.institucion_id = tr.idInstitucion\r\n            me.nombreInstitucion = tr.nombreInstitucion\r\n            me.estado_institucion_temporal = 0;\r\n            me.seleccionadoInsitucion = false;\r\n            me.instituciones = []\r\n\r\n        },\r\n\r\n        getInstitucion() {\r\n            let me = this;\r\n            me.instituciones = [];\r\n            if (me.busquedaInstitucion.length < 5) {\r\n                me.$vs.notify({\r\n                    text: 'Minimo 5 caracteres de busqueda',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })\r\n\r\n                return false;\r\n\r\n            }\r\n\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'listaInsitucionAsesor?busqueda=' + me.busquedaInstitucion + '&cedula=' + me.usuario.cedula)\r\n                .then(function (res) {\r\n                    // me.tmpInstituciones = res.data;\r\n                    me.instituciones = res.data;\r\n                    // me.filtroRegion();\r\n                    me.$vs.loading.close()\r\n                    if (res.data.message) {\r\n                        me.$vs.notify({\r\n                            text: res.data.message,\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-user',\r\n                            time: 8000\r\n                        })\r\n                    }\r\n\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n        },\r\n         ModalPendientes(tr,tipo){\r\n            let me = this\r\n\r\n            if(tipo == 1){\r\n                localStorage.setItem('institucion_seguimiento_id',tr.institucion_id_temporal)\r\n                localStorage.setItem('institucion_seguimiento_nombre',tr.nombre_institucion_temporal) \r\n                me.estado_institucion_temporal = 1\r\n                me.institucion_id_temporal = tr.institucion_id_temporal        \r\n            }else{\r\n                localStorage.setItem('institucion_seguimiento_id',tr.institucion_id)\r\n                localStorage.setItem('institucion_seguimiento_nombre',tr.nombreInstitucion)   \r\n                me.estado_institucion_temporal = 0   \r\n                     \r\n            }\r\n            localStorage.setItem('institucion_seguimiento_periodo_id',tr.periodo_id)\r\n            localStorage.setItem('institucion_seguimiento_periodo',tr.periodo)\r\n            me.nombreInstitucion = localStorage.getItem(\"institucion_seguimiento_nombre\")\r\n            me.institucion = localStorage.getItem(\"institucion_seguimiento_nombre\")\r\n            me.institucion_id = localStorage.getItem(\"institucion_seguimiento_id\")\r\n            me.periodo = localStorage.getItem(\"institucion_seguimiento_periodo\")\r\n            me.periodo_id = localStorage.getItem(\"institucion_seguimiento_periodo_id\")\r\n            //abrir modal \r\n            me.popupAgregarSeguimiento = true;\r\n            //variable si la data viene del asesor\r\n            me.desdeAsesor = true\r\n            me.update = false;\r\n            //agregar las opciones al modal\r\n            me.opciones.presentacion     = tr.opciones.presentacion\r\n            me.opciones.entrega_muestras = tr.opciones.entrega_muestras\r\n            me.opciones.reunion          = tr.opciones.reunion\r\n            me.opciones.seguimiento      = tr.opciones.seguimiento\r\n            me.opciones.cierre           = tr.opciones.cierre\r\n            me.opciones.cobranza         = tr.opciones.cobranza\r\n            me.opciones.post_venta       = tr.opciones.post_venta\r\n            me.opciones.retiro_cartas    = tr.opciones.retiro_cartas\r\n            me.opciones.retiro_muestras  = tr.opciones.retiro_muestras\r\n            me.Fgenerar                  = tr.startDate\r\n            me.seguimiento.observacion   = tr.url\r\n         \r\n\r\n        },\r\n        confirmarRegistroPendiente(tr) {\r\n            let me = this;\r\n            me.id = tr.id\r\n            this.$vs.dialog({\r\n                type: 'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: 'Esta seguro de registrar esta Planificación.',\r\n                accept: this.registrarPendiente\r\n            })\r\n        },\r\n        //prar registras las agendas pendientes\r\n        registrarPendiente() {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            formData.append('id', me.id);\r\n            me.$vs.loading();\r\n            this.$http.post(this.$server_url + 'seguimiento-registrar', formData)\r\n                .then(res => {\r\n\r\n                    me.getRegistrosPendientes();\r\n\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: 'Se registro con exito',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                    location.reload()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n\r\n        },\r\n\r\n         //para obtener el listado de los asesores\r\n        getRegistrosPendientes() {\r\n            let me = this;\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + 'seguimiento?asesor_id=' + me.asesor_id + '&pendientes=yes')\r\n                .then(function (res) {\r\n                    let datosProlipa = res.data.institucionesProlipa\r\n\r\n                    for (let i = 0; i < datosProlipa.length; i++) {\r\n\r\n                        me.institucionesProlipa.push({\r\n                            \"id\": datosProlipa[i].id,\r\n                            \"id_usuario\": datosProlipa[i].id_usuario,\r\n                            \"title\": datosProlipa[i].title,\r\n                            \"label\": datosProlipa[i].label,\r\n                            \"classes\": datosProlipa[i].classes,\r\n                            \"startDate\": datosProlipa[i].startDate,\r\n                            \"endDate\": datosProlipa[i].endDate,\r\n                            \"hora_inicio\": datosProlipa[i].hora_inicio,\r\n                            \"hora_fin\": datosProlipa[i].hora_fin,\r\n                            \"url\": datosProlipa[i].url,\r\n                            \"institucion_id\": datosProlipa[i].institucion_id,\r\n                            \"institucion_id_temporal\": datosProlipa[i].institucion_id_temporal,\r\n                            \"nombre_institucion_temporal\": datosProlipa[i].nombre_institucion_temporal,\r\n                            \"estado_institucion_temporal\": datosProlipa[i].estado_institucion_temporal,\r\n                            \"opciones\": JSON.parse(datosProlipa[i].opciones),\r\n                            \"periodo_id\": datosProlipa[i].periodo_id,\r\n                            \"estado\": datosProlipa[i].estado,\r\n                            \"idperiodoescolar\": datosProlipa[i].idperiodoescolar,\r\n                            \"periodo\": datosProlipa[i].periodo,\r\n                            \"nombreInstitucion\": datosProlipa[i].nombreInstitucion,\r\n                            \"vendedor\": datosProlipa[i].vendedor\r\n                        })\r\n                    }\r\n\r\n                    //para las instituciones temporales\r\n                    let datosTemporales = res.data.institucionesTemporales\r\n                   \r\n                    for (let i = 0; i < datosTemporales.length; i++) {\r\n\r\n                        me.institucionesTemporales.push({\r\n                            \"id\": datosTemporales[i].id,\r\n                            \"id_usuario\": datosTemporales[i].id_usuario,\r\n                            \"title\": datosTemporales[i].title,\r\n                            \"label\": datosTemporales[i].label,\r\n                            \"classes\": datosTemporales[i].classes,\r\n                            \"startDate\": datosTemporales[i].startDate,\r\n                            \"endDate\": datosTemporales[i].endDate,\r\n                            \"hora_inicio\": datosTemporales[i].hora_inicio,\r\n                            \"hora_fin\": datosTemporales[i].hora_fin,\r\n                            \"url\": datosTemporales[i].url,\r\n                            \"institucion_id\": datosTemporales[i].institucion_id,\r\n                            \"institucion_id_temporal\": datosTemporales[i].institucion_id_temporal,\r\n                            \"nombre_institucion_temporal\": datosTemporales[i].nombre_institucion_temporal,\r\n                            \"estado_institucion_temporal\": datosTemporales[i].estado_institucion_temporal,\r\n                            \"opciones\": JSON.parse(datosTemporales[i].opciones),\r\n                            \"periodo_id\": datosTemporales[i].periodo_id,\r\n                            \"estado\": datosTemporales[i].estado,\r\n                            \"idperiodoescolar\": datosTemporales[i].idperiodoescolar,\r\n                            \"periodo\": datosTemporales[i].periodo,\r\n                            \"nombreInstitucion\": datosTemporales[i].nombreInstitucion,\r\n                            \"vendedor\": datosTemporales[i].vendedor\r\n                        })\r\n                    }\r\n\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n        },\r\n        //cantidad de escuelas del asesor\r\n        async getVisitas() {\r\n            let me = this;\r\n            if (me.isAdmin == \"yes\") {\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\")\r\n            } else {\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n\r\n            this.$http.get(this.$server_url + 'asesor/seguimiento?institucion_id=' + localStorage.institucion_seguimiento_id +'&nombreInstitucion='+localStorage.institucion_seguimiento_nombre+ '&periodo_id=' + me.periodo_id + '&asesor_id=' + me.asesorDesdeAdmin)\r\n                .then(function (response) {\r\n                    let datos = response.data;\r\n                    let datosConvertir = datos.filter(p => p.tipo_seguimiento == me.tipo)\r\n                    for (let i = 0; i < datosConvertir.length; i++) {\r\n                            me.visitas.push({\r\n                            \"id\": datosConvertir[i].id,\r\n                            \"num_visita\": datosConvertir[i].num_visita,\r\n                            \"institucion_id\": datosConvertir[i].institucion_id,\r\n                            \"asesor_id\": datosConvertir[i].asesor_id,\r\n                            \"usuario_editor\": datosConvertir[i].usuario_editor,\r\n                            \"tipo_seguimiento\": datosConvertir[i].tipo_seguimiento,\r\n                            \"fecha_genera_visita\": datosConvertir[i].fecha_genera_visita,\r\n                            \"fecha_que_visita\": datosConvertir[i].fecha_que_visita,\r\n                            \"opciones\": JSON.parse(datosConvertir[i].opciones),\r\n                            \"observacion\":datosConvertir[i].observacion,\r\n                            \"periodo_id\": datosConvertir[i].periodo_id,\r\n                            \"estado\": datosConvertir[i].estado,\r\n                            \"nombreInstitucion\":datosConvertir[i].nombreInstitucion,\r\n                            \"institucion_id_temporal\": datosConvertir[i].institucion_id_temporal,\r\n                            \"nombre_institucion_temporal\": datosConvertir[i].nombre_institucion_temporal,\r\n                            \"estado_institucion_temporal\":datosConvertir[i].estado_institucion_temporal,\r\n                            \r\n                         \r\n                        })\r\n                    }\r\n                })\r\n                .catch(function (error) {\r\n\r\n                })\r\n        },\r\n        openConfirm(tr){\r\n            let me = this;\r\n            me.id = tr.id\r\n            this.$vs.dialog({\r\n                type:'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: 'Estas seguro de Eliminar',\r\n                accept:this.eliminar,\r\n                acceptText:\"Aceptar\",\r\n                cancelText:\"Cancelar\"\r\n            })\r\n        },        \r\n     //para eliminar la area\r\n         eliminar() {\r\n              let me = this;\r\n              let formData = new FormData();\r\n              formData.append('id',me.id);\r\n              this.$http.post(this.$server_url+'seguimiento-eliminar', formData)\r\n              .then(res => {\r\n\r\n                  me.id = 0\r\n                   this.$vs.notify({\r\n                        text:'Se elimno correctamente',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n            \r\n            if(me.isAdmin == \"yes\"){\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\") \r\n            }else{\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n            \r\n            this.$http.get(this.$server_url+'asesor/seguimiento?institucion_id='+me.institucion_id+'&periodo_id='+me.periodo_id+'&asesor_id='+me.asesorDesdeAdmin)\r\n                .then(function (response) {\r\n                    let datos = response.data;\r\n                    if(response.data.status == \"0\"){\r\n                        me.visitas = []\r\n                    }else{\r\n                         me.visitas = datos.filter(p => p.tipo_seguimiento == me.tipo) \r\n                    }\r\n                   \r\n                })\r\n                .catch(function (error) {\r\n                    \r\n                })\r\n                 \r\n              })\r\n                .catch(function (error) {\r\n                   \r\n                })\r\n        },\r\n\r\n            openModalEdit(tr) {\r\n            let me = this;\r\n           \r\n            me.id = tr.id\r\n            me.Fgenerar = tr.fecha_genera_visita\r\n            me.Fvisita = tr.fecha_que_visita\r\n            me.seguimiento.observacion = tr.observacion\r\n            me.popupEditarSeguimiento = true;\r\n            //agregar las opciones al modal\r\n            me.opciones.presentacion     = tr.opciones.presentacion\r\n            me.opciones.entrega_muestras = tr.opciones.entrega_muestras\r\n            me.opciones.reunion          = tr.opciones.reunion\r\n            me.opciones.seguimiento      = tr.opciones.seguimiento\r\n            me.opciones.cierre           = tr.opciones.cierre\r\n            me.opciones.cobranza         = tr.opciones.cobranza\r\n            me.opciones.post_venta       = tr.opciones.post_venta\r\n            me.opciones.retiro_cartas    = tr.opciones.retiro_cartas\r\n            me.opciones.retiro_muestras  = tr.opciones.retiro_muestras\r\n            if(tr.estado_institucion_temporal == 0){\r\n                me.nombreInstitucion = tr.nombreInstitucion\r\n            }else{\r\n                me.nombreInstitucion = tr.nombre_institucion_temporal\r\n            }\r\n            me.estado_institucion_temporal = tr.estado_institucion_temporal\r\n            me.institucion_id_temporal = tr.institucion_id_temporal\r\n            me.institucion_id = tr.institucion_id\r\n        },\r\n      generarSeguimiento() {\r\n            let me = this;\r\n        \r\n            if (me.Fgenerar == null) {\r\n                me.$vs.notify({\r\n                    text: 'Debe escoger una fecha generar visita',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })\r\n                return false;\r\n            }\r\n            //validacion al editar\r\n            if (me.update == true) {\r\n\r\n                if (me.Fgenerar > me.Fvisita) {\r\n                    me.$vs.notify({\r\n                        text: 'La fecha de generar visita  no puede mayor  que la fecha de visita',\r\n                        color: 'warning',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                    return false;\r\n                }\r\n            }\r\n            me.visitas=[]\r\n\r\n            let formData = new FormData();\r\n            if (me.update = true) {\r\n                formData.append('id', me.id);\r\n                formData.append('fecha_que_visita', me.Fvisita);\r\n                //solo si coloca la fecha de visita el estado cambiara a finalizdo\r\n                if (me.Fvisita == null) {} else {\r\n                    formData.append('finalizar', \"yes\")\r\n                }\r\n            }\r\n            \r\n            formData.append('estado_institucion_temporal', me.estado_institucion_temporal);\r\n            formData.append('nombreInstitucion', localStorage.institucion_seguimiento_nombre);\r\n            formData.append('fecha_genera_visita', me.Fgenerar);\r\n            formData.append('observacion', me.seguimiento.observacion);\r\n            if(me.estado_institucion_temporal == 1){\r\n                formData.append('institucion_id', me.institucion_id_temporal);\r\n            }else{\r\n                formData.append('institucion_id', me.institucion_id);\r\n            }\r\n            if (me.isAdmin == \"yes\") {\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\")\r\n                formData.append('usuario_editor', me.usuario.idusuario);\r\n                formData.append('admin', \"yes\");\r\n            } else {\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n\r\n            formData.append('asesor_id', me.asesorDesdeAdmin);\r\n            formData.append('tipo_seguimiento', me.tipo);\r\n            formData.append('periodo_id', me.periodo_id);\r\n            formData.append('opciones', JSON.stringify(me.opciones));\r\n        \r\n            me.$vs.loading();\r\n            this.$http.post(this.$server_url + 'guardarSeguimiento',formData)\r\n                .then(function (res) {\r\n\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'primary',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    me.popupAgregarSeguimiento = false;\r\n                    me.popupEditarSeguimiento = false;\r\n                    me.getVisitas();\r\n                    me.limpiar()\r\n                    // location.reload()   \r\n                \r\n\r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.loading.close()\r\n                });\r\n        },\r\n        limpiar() {\r\n            let me = this;\r\n            me.seguimiento.observacion = \"\"\r\n            me.Fgenerar = null\r\n            me.opciones.presentacion     = \"\" \r\n            me.opciones.entrega_muestras = \"\" \r\n            me.opciones.reunion          = \"\" \r\n            me.opciones.seguimiento      = \"\" \r\n            me.opciones.cierre           = \"\" \r\n            me.opciones.cobranza         = \"\" \r\n            me.opciones.post_venta       = \"\" \r\n            me.opciones.retiro_cartas    = \"\" \r\n            me.opciones.retiro_muestras  = \"\" \r\n            me.estado_institucion_temporal = \"\" \r\n            me.nombreInstitucion = \"\"\r\n            \r\n\r\n        }\r\n    }\r\n}\r\n",{"version":3,"sources":["visitasAdmin.vue"],"names":[],"mappings":";AAqnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA","file":"visitasAdmin.vue","sourceRoot":"src/views/asesor/seguimiento/components","sourcesContent":["<template>\r\n    <div>\r\n     <vs-row>\r\n    \r\n        <p @click=\"popupAgregarSeguimiento = true;update = false;\" style=\"cursor:pointer\" v-if=\"usuario.id_group == 1\">\r\n            <vs-chip color=\"primary\" style=\"cursor:pointer\"  class=\"mt-2\">\r\n                <vs-avatar icon=\"edit\"  @click=\"popupAgregarSeguimiento = true;limpiar()\"/>\r\n                Agregar {{valor}}\r\n            </vs-chip>\r\n        </p>    \r\n      \r\n        <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n             <vs-table stripe :data=\"visitas\" search pagination max-items=\"10\" style=\"width: 100%;\">\r\n                <template slot=\"header\">\r\n                    \r\n                    <vs-list>\r\n                        <vs-list-header title=\"Información\"></vs-list-header>\r\n                        <vs-list-item title=\"Institución\" :subtitle=\"institucion\"></vs-list-item>\r\n                        <vs-list-item title=\"Período\" :subtitle=\"periodo\"></vs-list-item>\r\n                        <vs-list-item :title=\"valor +' ' + 'cantidad'\" :subtitle=\"visitas.length\"></vs-list-item>\r\n                    </vs-list>\r\n\r\n                </template>\r\n                \r\n                <template slot=\"thead\">\r\n                    <vs-th>\r\n                       \r\n                    {{valor}}\r\n                    </vs-th>\r\n                    <vs-th>\r\n                        \r\n                    Fecha Genera {{valor}}\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Fecha {{valor}}\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Observación\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Estado\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Acciones\r\n                    </vs-th>\r\n\r\n                </template>\r\n            \r\n                <template slot-scope=\"{data}\">\r\n                    <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\" >\r\n                        <vs-td :data=\"data[indextr].num_visita\" width=\"20%\">\r\n                            <vs-chip color=\"primary\">\r\n                            {{valor}} Nº {{data[indextr].num_visita}}\r\n                            </vs-chip>\r\n                        </vs-td>\r\n                        <vs-td :data=\"data[indextr].fecha_genera_visita\" width=\"20%\">\r\n                            {{data[indextr].fecha_genera_visita}}\r\n                        </vs-td>\r\n\r\n                        <vs-td :data=\"data[indextr].fecha_que_visita\" width=\"20%\">\r\n                            {{data[indextr].fecha_que_visita}}\r\n                        </vs-td>\r\n\r\n                        <vs-td height=\"30%\" width=\"50%\">\r\n                            <div class=\"overflow-y-auto h-24\">\r\n                                {{tr.observacion}}\r\n                               \r\n                            </div>\r\n                        </vs-td>\r\n                        <vs-td>\r\n                            <vs-chip :color=\"tr.estado == '0'?'success':'warning'\">\r\n                                {{ tr.estado == '0' ? 'Generada' :'Finalizada' }}\r\n                            </vs-chip>\r\n                        </vs-td>\r\n                        <vs-td>\r\n                            <div style=\"display:flex;\">\r\n                                <vx-tooltip style=\"display: inline-block;\" text=\"Editar\" position=\"top\" color=\"primary\">\r\n                                    <vs-button radius color=\"success\" @click=\"openModalEdit(tr);update = true\" type=\"line\" icon=\"edit\"></vs-button>\r\n                                </vx-tooltip> &nbsp;  \r\n                                <vx-tooltip style=\"display: inline-block;\" :text=\"'Eliminar '+valor\" position=\"top\" color=\"danger\">\r\n                                    <vs-button radius color=\"danger\" @click=\"openConfirm(tr)\" type=\"line\" icon=\"delete\"></vs-button>\r\n                                </vx-tooltip> &nbsp;  \r\n                            </div>\r\n                         \r\n             \r\n                        </vs-td>\r\n                    </vs-tr>\r\n                </template>\r\n            </vs-table>\r\n        </vs-col>\r\n    </vs-row>\r\n\r\n    <vs-card>\r\n         <vs-collapse accordion>\r\n        <vs-collapse-item>\r\n            <div slot=\"header\">\r\n                Registros Pendientes con Instituciones de Prolipa\r\n            </div>\r\n            <div>\r\n                <vs-table max-items=\"10\" stripe search pagination :data=\"institucionesProlipa\" class=\"mt-2\">\r\n                    <template slot=\"thead\">\r\n                        <vs-th>Datos Planificación</vs-th>\r\n                        <vs-th>Opciones</vs-th>\r\n                        <vs-th>Prioridad</vs-th>\r\n                        <vs-th>Observación</vs-th>\r\n                        <vs-th>Acciones</vs-th>\r\n                    </template>\r\n                    <template slot-scope=\"{data}\">\r\n                        <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n\r\n                            <vs-td>\r\n                                Titulo:\r\n                                <br>\r\n                                <span style=\"font-weight:600;\">\r\n                                   \r\n                                    {{ tr.title }}<br>\r\n                                </span>\r\n\r\n                                Fecha inicio:\r\n                                <br>\r\n                                <span style=\" font-weight:600; \">\r\n                                    {{ tr.startDate }}<br>\r\n                                </span>\r\n\r\n                                Fecha Fin:\r\n                                <br>\r\n                                <span style=\"font-weight:600;  \">\r\n                                    {{ tr.endDate }}<br>\r\n                                </span>\r\n                                Institución:\r\n                                <br>\r\n                                <span style=\"font-weight:600;  \">\r\n                                    {{ tr.nombreInstitucion }}<br>\r\n                                </span>\r\n                            </vs-td>\r\n                            <vs-td height=\"30%\" width=\"50%\">\r\n                                <div class=\"overflow-y-auto h-24\">\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.presentacion\">\r\n                                        Presentación\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.entrega_muestras\">\r\n                                        Entrega muestras\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.reunion\">\r\n                                        Reunión\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.seguimiento\">\r\n                                        Seguimiento\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.cierre\">\r\n                                        Cierre\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.cobranza\">\r\n                                        Cobranza\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.post_venta\">\r\n                                        Post venta\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.retiro_cartas\">\r\n                                        Retiro cartas\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.retiro_muestras\">\r\n                                        Retiro muestras\r\n                                    </vs-chip>\r\n                                </div>\r\n                            </vs-td>\r\n                            <vs-td>\r\n                                <vs-chip color=\"success\">\r\n                                    {{tr.label}}\r\n                                </vs-chip>\r\n                            </vs-td>\r\n                            <vs-td>\r\n                                {{tr.url}}\r\n                            </vs-td>\r\n                            <vs-td>\r\n                                <div style=\"display: flex;\">\r\n                                     <vx-tooltip style=\"display: inline-block;\" text=\"Registrar Planificación\" position=\"top\" color=\"warning\">\r\n                                        <vs-button class=\"modal-default-button\"  @click=\"ModalPendientes(tr,0)\" radius size=\"small\" color=\"primary\" type=\"line\" icon-pack=\"feather\" icon=\"icon-bookmark\">\r\n                                        </vs-button>\r\n                                    </vx-tooltip> &nbsp;\r\n                                    <vx-tooltip style=\"display: inline-block;\" text=\"Marcar como registrado\" position=\"top\" color=\"primary\">\r\n                                        <vs-button class=\"modal-default-button\" radius @click=\"confirmarRegistroPendiente(tr)\" size=\"small\" color=\"success\" type=\"line\" icon-pack=\"feather\" icon=\"icon-check-circle\">\r\n                                        </vs-button>\r\n                                    </vx-tooltip> &nbsp;\r\n                                </div>\r\n                            </vs-td>\r\n\r\n                        </vs-tr>\r\n                    </template>\r\n                </vs-table>\r\n            </div>\r\n        </vs-collapse-item>\r\n        <vs-collapse-item>\r\n            <div slot=\"header\">\r\n                Registros Pendientes con Instituciones Nuevas\r\n            </div>\r\n            <div>\r\n         \r\n                <vs-table max-items=\"10\" stripe search pagination :data=\"institucionesTemporales\" class=\"mt-2\">\r\n                    <template slot=\"thead\">\r\n                        <vs-th>Datos Planificación</vs-th>\r\n                        <vs-th>Opciones</vs-th>\r\n                        <vs-th>Prioridad</vs-th>\r\n                        <vs-th>Observación</vs-th>\r\n                        <vs-th>Acciones</vs-th>\r\n                    </template>\r\n                    <template slot-scope=\"{data}\">\r\n                        <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n\r\n                            <vs-td>\r\n                               \r\n                                Titulo:\r\n                                <br>\r\n                                <span style=\"font-weight:600;  \">\r\n                                    {{ tr.title }}<br>\r\n                                </span>\r\n\r\n                                Fecha inicio:\r\n                                <br>\r\n                                <span style=\" font-weight:600; \">\r\n                                    {{ tr.startDate }}<br>\r\n                                </span>\r\n\r\n                                Fecha Fin:\r\n                                <br>\r\n                                <span style=\"font-weight:600;  \">\r\n                                    {{ tr.endDate }}<br>\r\n                                </span>\r\n                                Institución:\r\n                                <br>\r\n                                <span style=\"font-weight:600;  \">\r\n                                    {{ tr.nombre_institucion_temporal }}<br>\r\n                                </span>\r\n                            </vs-td>\r\n                             <vs-td height=\"30%\" width=\"50%\">\r\n                                <div class=\"overflow-y-auto h-24\">\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.presentacion\">\r\n                                        Presentación\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.entrega_muestras\">\r\n                                        Entrega muestras\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.reunion\">\r\n                                        Reunión\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.seguimiento\">\r\n                                        Seguimiento\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.cierre\">\r\n                                        Cierre\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.cobranza\">\r\n                                        Cobranza\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.post_venta\">\r\n                                        Post venta\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.retiro_cartas\">\r\n                                        Retiro cartas\r\n                                    </vs-chip>\r\n                                    <vs-chip color=\"primary\" v-if=\"tr.opciones.retiro_muestras\">\r\n                                        Retiro muestras\r\n                                    </vs-chip>\r\n                                </div>\r\n                            </vs-td>\r\n                            <vs-td>\r\n                                <vs-chip color=\"success\">\r\n                                    {{tr.label}}\r\n                                </vs-chip>\r\n                            </vs-td>\r\n                            <vs-td>\r\n                                {{tr.url}}\r\n                            </vs-td>\r\n                            <vs-td>\r\n                                <div style=\"display: flex;\">\r\n                                     <vx-tooltip style=\"display: inline-block;\" text=\"Registrar Planificación\" position=\"top\" color=\"warning\">\r\n                                        <vs-button class=\"modal-default-button\"  @click=\"ModalPendientes(tr,1)\" radius size=\"small\" color=\"primary\" type=\"line\" icon-pack=\"feather\" icon=\"icon-bookmark\">\r\n                                        </vs-button>\r\n                                    </vx-tooltip> &nbsp;\r\n                                    <vx-tooltip style=\"display: inline-block;\" text=\"Marcar como registrado\" position=\"top\" color=\"primary\">\r\n                                        <vs-button class=\"modal-default-button\" radius @click=\"confirmarRegistroPendiente(tr)\" size=\"small\" color=\"success\" type=\"line\" icon-pack=\"feather\" icon=\"icon-check-circle\">\r\n                                        </vs-button>\r\n                                    </vx-tooltip> &nbsp;\r\n                                </div>\r\n                            </vs-td>\r\n\r\n                        </vs-tr>\r\n                    </template>\r\n                </vs-table>\r\n            </div>\r\n\r\n        </vs-collapse-item>\r\n\r\n    </vs-collapse>\r\n    </vs-card>\r\n\r\n    \r\n    <!--MODALES-->\r\n    <!--MODAL PARA AGREGAR SEGUIMIENTO-->\r\n    <!-- <vs-popup\r\n        :title=\"title\" :active.sync=\"popupAgregarSeguimiento\">\r\n\r\n            <vs-row>\r\n                <p class=\"ml-2\">Fecha generar {{valor}}</p>\r\n                <vs-col  class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                   <flat-pickr :config=\"configdateTimePicker\" v-model=\"Fgenerar\"  :placeholder=\"titleFechaGenera\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row class=\"mt-2\">    \r\n                <p class=\"ml-2\">Observación</p>\r\n                <vs-col  class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n            \r\n                <vs-textarea counter=\"500\" style=\"width:100%;\" label=\"Mensaje\" :counter-danger.sync=\"counterDanger\" v-model=\"seguimiento.observacion\" />\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row>\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <vs-button @click=\"generarSeguimiento()\" type=\"gradient\">Generar {{valor}}</vs-button>\r\n                </vs-col>\r\n            </vs-row>\r\n        \r\n    </vs-popup> -->\r\n\r\n    <!--MODAL PARA Editar SEGUIMIENTO-->\r\n    <!-- <vs-popup\r\n         :title=\"title\" :active.sync=\"popupEditarSeguimiento\">\r\n\r\n            <vs-row>\r\n                <p class=\"ml-2\">Fecha generar {{valor}}</p>\r\n                <vs-col  class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                   <flat-pickr :config=\"configdateTimePicker\" v-model=\"Fgenerar\"  :placeholder=\"titleFechaGenera\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n                </vs-col>\r\n            </vs-row>\r\n             <vs-row>\r\n                <p class=\"ml-2\">Fecha de la {{valor}}</p>\r\n                <vs-col  class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                   <flat-pickr :config=\"configdateTimePicker\" v-model=\"Fvisita\"  :placeholder=\"titleFechaVisita\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row class=\"mt-2\">    \r\n                <p class=\"ml-2\">Observación</p>\r\n                <vs-col  class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                <vs-textarea counter=\"500\" style=\"width:100%;\" label=\"Mensaje\" :counter-danger.sync=\"counterDanger\" v-model=\"seguimiento.observacion\" />\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row>\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <vs-button @click=\"generarSeguimiento()\" type=\"gradient\">Generar {{valor}}</vs-button>\r\n                </vs-col>\r\n            </vs-row>\r\n        \r\n    </vs-popup> -->\r\n         <!--MODALES-->\r\n    <!--MODAL PARA AGREGAR SEGUIMIENTO-->\r\n    <vs-popup :title=\"title\" :active.sync=\"popupAgregarSeguimiento\">\r\n\r\n            <vs-row v-if=\"seleccionadoInsitucion ==  false\" class=\"mt-2\">\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <p style=\"color:red;\" v-if=\"nombreInstitucion == '' || nombreInstitucion == null \">\r\n                        Sin Institución\r\n                    </p>\r\n                    <vs-chip color=\"success\" v-else>\r\n                        Institución {{ nombreInstitucion}}\r\n                    </vs-chip>\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row v-if=\"seleccionadoInsitucion ==  true\" class=\"mt-2\">\r\n                <vs-col vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"6\">\r\n                    <vs-button size=\"small\" color=\"success\" radius=\"\" @click=\"regresar()\" icon=\"reply\" type=\"gradient\"></vs-button>\r\n                    <vs-button size=\"small\" class=\"ml-3\" @click=\"popupAddNuevaInstitucion = true;activePromptAddEvent = false;\" type=\"relief\">Añadir nueva institución</vs-button>\r\n                </vs-col>\r\n\r\n            </vs-row>\r\n\r\n            <vs-button color=\"warning\" class=\"mt-2\" v-if=\"seleccionadoInsitucion == false\" size=\"small\" style=\"margin:0 auto;\" @click=\"seleccionadoInsitucion = true;\" type=\"relief\">Asignar Institución</vs-button>\r\n            <div style=\"width:100%;display:flex;\" v-if=\"seleccionadoInsitucion ==  true\" class=\"mt-5\">\r\n                <div style=\"width:80%;\">\r\n                    <vs-input icon=\"search\" style=\"width:100%;\" placeholder=\"Search\" @keyup.enter=\"getInstitucion()\" v-model=\"busquedaInstitucion\" />\r\n                </div>\r\n\r\n                <div style=\"width:20%;margin-left:15px;\">\r\n                    <vs-button radius color=\"warning\" @click=\"getInstitucion()\" type=\"filled\" icon=\"search\"></vs-button>\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <div v-if=\"instituciones.length >0\">\r\n                <vs-table stripe max-items=\"5\" search pagination :data=\"instituciones\">\r\n                    <template slot=\"header\">\r\n                        <div class=\"vx-row\">\r\n                            <div class=\"vx-col w-full m-3\">\r\n                                Cantidad: {{instituciones.length}}\r\n                            </div>\r\n\r\n                        </div>\r\n                    </template>\r\n                    <template slot=\"thead\">\r\n                        <vs-th sort-key=\"nombreInstitucion\">Institución</vs-th>\r\n                        <vs-th sort-key=\"nombre\">Localidad</vs-th>\r\n                        <vs-th>Acciones</vs-th>\r\n                    </template>\r\n                    <template slot-scope=\"{data}\">\r\n                        <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n\r\n                            <vs-td :data=\"data[indextr].nombreInstitucion\">\r\n                                {{data[indextr].nombreInstitucion}}<br>\r\n\r\n                            </vs-td>\r\n                            <vs-td :data=\"data[indextr].nombreregion\">\r\n                                {{data[indextr].nombreregion}} <br>\r\n                                <small>{{data[indextr].ciudad}}</small>\r\n                            </vs-td>\r\n                            <vs-td>\r\n                                <div class=\"flex\">\r\n                                    <vs-button size=\"small\" type=\"relief\" style=\"border-radius: 5px;\" icon-pack=\"feather\" icon=\"icon-bookmark\" class=\"mr-2\" color=\"primary\" @click=\"asginarInstitucion(tr);error=false\">\r\n                                        Asignar\r\n                                    </vs-button>\r\n                                </div>\r\n                            </vs-td>\r\n                        </vs-tr>\r\n                    </template>\r\n                </vs-table>\r\n            </div>\r\n            <vs-row v-if=\"error ==  true\" class=\"mt-3\">\r\n                    <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                        <vs-alert active=\"true\" color=\"danger\">\r\n                            {{messageError}}\r\n                        </vs-alert>\r\n                    </vs-col>\r\n            </vs-row>\r\n\r\n        <div v-if=\"seleccionadoInsitucion == false\">\r\n             <vs-row class=\"mt-4\">\r\n                <p class=\"ml-2\">Fecha generar {{valor}}</p>\r\n                <vs-col class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <flat-pickr :config=\"configdateTimePicker\" v-model=\"Fgenerar\" :placeholder=\"titleFechaGenera\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row class=\"mt-2\">\r\n                <p class=\"ml-2\">Observación</p>\r\n                <vs-col class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n\r\n                    <vs-textarea counter=\"500\" style=\"width:100%;\" label=\"Mensaje\" :counter-danger.sync=\"counterDanger\" v-model=\"seguimiento.observacion\" />\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-divider color=\"success\">Opciones</vs-divider>\r\n        \r\n\r\n            <vs-row class=\"mt-5\">\r\n                <ul style=\"display:flex;flex-wrap: wrap;width: 100%;\">\r\n                <li style=\"width: 50%;\">\r\n                    <vs-checkbox  color=\"success\" v-model=\"opciones.presentacion\">Presentación</vs-checkbox>\r\n                </li>\r\n                <li style=\"width: 50%;\">\r\n                    <vs-checkbox color=\"success\" v-model=\"opciones.entrega_muestras\">Entregas de muestras</vs-checkbox>\r\n                </li>\r\n                <li style=\"width: 50%;margin-top: 5px;\">\r\n                    <vs-checkbox color=\"success\" v-model=\"opciones.reunion\">Reunión</vs-checkbox>\r\n                </li>\r\n                <li style=\"width: 50%;margin-top: 10px;\">\r\n                    <vs-checkbox color=\"success\" v-model=\"opciones.seguimiento\">Seguimiento</vs-checkbox>\r\n                </li>\r\n                <li style=\"width: 50%;margin-top: 10px;\">\r\n                    <vs-checkbox color=\"success\" v-model=\"opciones.cierre\">Cierre</vs-checkbox>\r\n                </li>\r\n                <li style=\"width: 50%;margin-top: 10px;\">\r\n                    <vs-checkbox color=\"success\" v-model=\"opciones.cobranza\">Cobranza</vs-checkbox>\r\n                </li>\r\n                <li style=\"width: 50%;margin-top: 10px;\">\r\n                    <vs-checkbox color=\"success\" v-model=\"opciones.post_venta\">Post Venta</vs-checkbox>\r\n                </li>\r\n                <li style=\"width: 50%;margin-top: 10px;\">\r\n                    <vs-checkbox color=\"success\" v-model=\"opciones.retiro_cartas\">Retiro de cartas</vs-checkbox>\r\n                </li>\r\n                <li style=\"width: 50%;margin-top: 10px;\">\r\n                    <vs-checkbox color=\"success\" v-model=\"opciones.retiro_muestras\">Retiro de muestra</vs-checkbox>\r\n                </li>\r\n\r\n                <li style=\"width: 30%;margin-top: 10px;\">\r\n                    <vs-switch color=\"danger\" v-model=\"opciones.sinSello\" style=\"width: 60%;\">\r\n                            <span slot=\"on\">Sin sello</span>\r\n                            <span slot=\"off\">Con Sello</span>\r\n                    </vs-switch>\r\n                </li>\r\n                <li style=\"width: 50%;margin-top: 10px;\">\r\n                    <vs-checkbox color=\"success\" v-model=\"opciones.otraEditorial\">Otra Editorial</vs-checkbox>\r\n                </li>\r\n                <li  v-if=\"opciones.otraEditorial == true\" style=\"width: 50%;margin-top: 10px;\">\r\n                    <vs-input class=\"inputx\" style=\"width: 90%;\" placeholder=\"Escriba el nombre de la editorial\" v-model=\"opciones.editorial\" />\r\n\r\n                </li>\r\n                </ul> \r\n            </vs-row>\r\n\r\n            <vs-row class=\"mt-5\">\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <vs-button @click=\"generarSeguimiento()\" type=\"gradient\">Generar {{valor}}</vs-button>\r\n                </vs-col>\r\n            </vs-row>\r\n        </div>\r\n\r\n           \r\n\r\n    </vs-popup>\r\n\r\n    <!--MODAL PARA Editar SEGUIMIENTO-->\r\n    <vs-popup :title=\"title\" :active.sync=\"popupEditarSeguimiento\">\r\n\r\n        \r\n     \r\n\r\n        <vs-row>\r\n            <p class=\"ml-2\">Fecha generar {{valor}}</p>\r\n            <vs-col class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                <flat-pickr :config=\"configdateTimePicker\" v-model=\"Fgenerar\" :placeholder=\"titleFechaGenera\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n            </vs-col>\r\n        </vs-row>\r\n        <vs-row>\r\n            <p class=\"ml-2\">Fecha de la {{valor}}</p>\r\n            <vs-col class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                <flat-pickr :config=\"configdateTimePicker\" v-model=\"Fvisita\" :placeholder=\"titleFechaVisita\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n            </vs-col>\r\n        </vs-row>\r\n        <vs-row class=\"mt-2\">\r\n            <p class=\"ml-2\">Observación</p>\r\n            <vs-col class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                <vs-textarea counter=\"500\" style=\"width:100%;\" label=\"Mensaje\" :counter-danger.sync=\"counterDanger\" v-model=\"seguimiento.observacion\" />\r\n            </vs-col>\r\n        </vs-row>\r\n        <vs-divider color=\"success\">Opciones</vs-divider>\r\n\r\n        <vs-row class=\"mt-5\">\r\n            <ul style=\"display:flex;flex-wrap: wrap;width: 100%;\">\r\n              <li style=\"width: 50%;\">\r\n                <vs-checkbox  color=\"success\" v-model=\"opciones.presentacion\">Presentación</vs-checkbox>\r\n              </li>\r\n              <li style=\"width: 50%;\">\r\n                <vs-checkbox color=\"success\" v-model=\"opciones.entrega_muestras\">Entregas de muestras</vs-checkbox>\r\n              </li>\r\n              <li style=\"width: 50%;margin-top: 5px;\">\r\n                <vs-checkbox color=\"success\" v-model=\"opciones.reunion\">Reunión</vs-checkbox>\r\n              </li>\r\n              <li style=\"width: 50%;margin-top: 10px;\">\r\n                <vs-checkbox color=\"success\" v-model=\"opciones.seguimiento\">Seguimiento</vs-checkbox>\r\n              </li>\r\n              <li style=\"width: 50%;margin-top: 10px;\">\r\n                <vs-checkbox color=\"success\" v-model=\"opciones.cierre\">Cierre</vs-checkbox>\r\n              </li>\r\n              <li style=\"width: 50%;margin-top: 10px;\">\r\n                <vs-checkbox color=\"success\" v-model=\"opciones.cobranza\">Cobranza</vs-checkbox>\r\n              </li>\r\n              <li style=\"width: 50%;margin-top: 10px;\">\r\n                <vs-checkbox color=\"success\" v-model=\"opciones.post_venta\">Post Venta</vs-checkbox>\r\n              </li>\r\n              <li style=\"width: 50%;margin-top: 10px;\">\r\n                <vs-checkbox color=\"success\" v-model=\"opciones.retiro_cartas\">Retiro de cartas</vs-checkbox>\r\n              </li>\r\n              <li style=\"width: 50%;margin-top: 10px;\">\r\n                <vs-checkbox color=\"success\" v-model=\"opciones.retiro_muestras\">Retiro de muestra</vs-checkbox>\r\n              </li>\r\n\r\n             <li style=\"width: 30%;margin-top: 10px;\">\r\n                <vs-switch color=\"danger\" v-model=\"opciones.sinSello\" style=\"width: 60%;\">\r\n                        <span slot=\"on\">Sin sello</span>\r\n                        <span slot=\"off\">Con Sello</span>\r\n                  </vs-switch>\r\n              </li>\r\n              <li style=\"width: 50%;margin-top: 10px;\">\r\n                <vs-checkbox color=\"success\" v-model=\"opciones.otraEditorial\">Otra Editorial</vs-checkbox>\r\n              </li>\r\n               <li  v-if=\"opciones.otraEditorial == true\" style=\"width: 50%;margin-top: 10px;\">\r\n                  <vs-input class=\"inputx\" style=\"width: 90%;\" placeholder=\"Escriba el nombre de la editorial\" v-model=\"opciones.editorial\" />\r\n\r\n               </li>\r\n\r\n            </ul> \r\n        </vs-row>\r\n        <vs-row>\r\n            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                <vs-button @click=\"generarSeguimiento()\" type=\"gradient\">Generar {{valor}}</vs-button>\r\n            </vs-col>\r\n        </vs-row>\r\n\r\n    </vs-popup>\r\n\r\n       <!--MODAL PARA AGREGAR NUEVA INSTITUCION-->\r\n\r\n        <vs-popup background-color=\"rgba(255,255,255,.6)\" title=\"Agregar Nueva Institución\" :active.sync=\"popupAddNuevaInstitucion\">\r\n            <vs-button size=\"small\" color=\"success\" radius=\"\" @click=\"popupAddNuevaInstitucion=false;activePromptAddEvent=true;\" icon=\"reply\" type=\"gradient\"></vs-button>\r\n            <vs-row>\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <div class=\"vx-col w-full mt-5\">\r\n\r\n                        Seleccione una ciudad:\r\n                        <v-select :options=\"arregloCiudad\" :reduce=\"arregloCiudad => arregloCiudad\" label=\"nombre\" class=\"w-full\" v-model=\"temporalInstitucion.ciudad\" />\r\n                    </div>\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row class=\"mt-2\">\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <vs-input label=\"Escriba un nombre para la institución\" class=\"w-full\" v-model=\"temporalInstitucion.nombre_institucion\" placeholder=\"Institución\" />\r\n                </vs-col>\r\n            </vs-row>\r\n\r\n            <vs-row class=\"mt-2\">\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <ul class=\"leftx\" style=\"display:flex;flex-direction: row;\">\r\n\r\n                        <li class=\"ml-2\">\r\n                            <vs-radio v-model=\"temporalInstitucion.region\" vs-name=\"radios1\" vs-value=\"1\">Sierra</vs-radio>\r\n                        </li>\r\n                        <li class=\"ml-2\">\r\n                            <vs-radio v-model=\"temporalInstitucion.region\" vs-name=\"radios1\" vs-value=\"2\">Costa</vs-radio>\r\n                        </li>\r\n\r\n                    </ul>\r\n                </vs-col>\r\n            </vs-row>\r\n\r\n            <vs-row class=\"mt-5\">\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <vs-button @click=\"agregarInstitucionTemporal();error = false\" type=\"gradient\">Agregar Institución</vs-button>\r\n                </vs-col>\r\n            </vs-row>\r\n        </vs-popup>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nexport default {\r\n    data() {\r\n       return{\r\n           counterDanger: false,\r\n           visitas:[],\r\n           institucion:'',\r\n           institucion_id:'',\r\n           periodo:'',\r\n           periodo_id:'',\r\n           usuario:[],\r\n           popupAgregarSeguimiento:false,\r\n           popupEditarSeguimiento:false,\r\n            Fgenerar: null,\r\n            Fvisita: null,\r\n            configdateTimePicker: {\r\n                enableTime: true,\r\n                dateFormat: 'Y-m-d'\r\n            },\r\n            seguimiento:{\r\n                observacion:''\r\n            },\r\n            id:0,\r\n            update:false,\r\n            title:'',\r\n            titleFechaGenera:'',\r\n            titleFechaVisita:'',\r\n            isAdmin:'',\r\n            asesorDesdeAdmin:'',\r\n            institucionesProlipa:[],\r\n            institucionesTemporales:[],\r\n            asesor_id:'',\r\n               opciones:{\r\n                presentacion:false,\r\n                entrega_muestras:false,\r\n                reunion:false,\r\n                seguimiento:false,\r\n                cierre:false,\r\n                cobranza:false,\r\n                post_venta:false,\r\n                retiro_cartas:false,\r\n                retiro_muestras:false,\r\n                sinSello: true,\r\n                editorial: '',\r\n                otraEditorial: false,\r\n            },\r\n            nombreInstitucion:'',\r\n            estado_institucion_temporal:'0',\r\n            institucion_id_temporal:'',\r\n        \r\n            popupFiltroInstitucion:false,\r\n            error: false,\r\n            messageError: \"\",\r\n            ciudadSelect: '',\r\n            popupAddNuevaInstitucion: false,\r\n            seleccionadoInsitucion: false,\r\n            nombreInstitucion: '',\r\n            busquedaInstitucion: \"\",\r\n            instituciones: [],\r\n            popupaddInstitucion: false,\r\n            arregloCiudad: [],\r\n            temporalInstitucion: {\r\n                ciudad: '',\r\n                nombreInstitucion: '',\r\n                region: '2',\r\n            },\r\n          \r\n\r\n       } \r\n    },\r\n    props:{\r\n        tipo:{\r\n            type:String,\r\n            default:1\r\n        },\r\n        valor:{\r\n            type:String,\r\n            default:\"Visita\"\r\n        }\r\n    },\r\n      components:{\r\n        flatPickr,\r\n    },\r\n    created(){\r\n        let me = this;\r\n         me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n        me.institucion = localStorage.getItem(\"institucion_seguimiento_nombre\")\r\n        me.institucion_id = localStorage.getItem(\"institucion_seguimiento_id\")\r\n        me.periodo = localStorage.getItem(\"institucion_seguimiento_periodo\")\r\n        me.periodo_id = localStorage.getItem(\"institucion_seguimiento_periodo_id\")\r\n        me.isAdmin = localStorage.getItem(\"adminSeguimiento\")\r\n        me.asesor_id = localStorage.getItem(\"institucion_seguimiento_asesor_id\")\r\n        \r\n        me.getVisitas()\r\n        me.title = \"Genera\"+\" \" +me.valor\r\n        me.titleFechaGenera = \"Fecha generar\"+ \" \" +me.valor\r\n        me.titleFechaVisita = \"Fecha visita\" + \" \" +me.valor\r\n        me.getRegistrosPendientes()\r\n    }, \r\n    methods:{\r\n        agregarInstitucionTemporal() {\r\n\r\n            let me = this;\r\n            if (me.temporalInstitucion.nombre_institucion == \"\" || me.temporalInstitucion.nombre_institucion == null || me.temporalInstitucion.nombre_institucion == undefined) {\r\n                me.$vs.notify({\r\n                    color: 'primary',\r\n                    title: 'Mensaje',\r\n                    text: 'Debe escribir una institución por favor'\r\n                })\r\n                return false;\r\n            }\r\n\r\n            let formData = new FormData();\r\n            formData.append('nombre_institucion', me.temporalInstitucion.nombre_institucion);\r\n            formData.append('ciudad', me.temporalInstitucion.ciudad.nombre);\r\n            formData.append('region', me.temporalInstitucion.region);\r\n            formData.append('asesor_id', me.usuario.idusuario);\r\n\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'GuardarInstitucionTemporal', formData)\r\n                .then(res => {\r\n\r\n                    me.$vs.loading.close()\r\n                    me.popupAddNuevaInstitucion = false;\r\n                    me.activePromptAddEvent = true\r\n                    me.seleccionadoInsitucion = false;\r\n                    me.nombreInstitucion = me.temporalInstitucion.nombre_institucion\r\n                    me.institucion_id_temporal = res.data.institucion_temporal_id\r\n                    me.instituciones = []\r\n                    me.periodo_id_temporal = res.data.periodo_id\r\n                    me.estado_institucion_temporal = 1;\r\n\r\n                    me.$vs.notify({\r\n                        text: \"Se guardo correctamente\",\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                })\r\n        },\r\n        //lista de ciudades para usar en el select\r\n        listaCiudades() {\r\n            let me = this\r\n            this.$http.get(this.$server_url + `ciudad`).then(res => {\r\n                    me.arregloCiudad = res.data;\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        regresar() {\r\n            let me = this;\r\n            me.seleccionadoInsitucion = false;\r\n            me.instituciones = []\r\n            me.error = false\r\n        },\r\n        limpiar(){\r\n            let me = this;\r\n            me.nombreInstitucion = \"\";\r\n            me.opciones.presentacion     = \"\" \r\n            me.opciones.entrega_muestras = \"\" \r\n            me.opciones.reunion          = \"\" \r\n            me.opciones.seguimiento      = \"\" \r\n            me.opciones.cierre           = \"\" \r\n            me.opciones.cobranza         = \"\" \r\n            me.opciones.post_venta       = \"\" \r\n            me.opciones.retiro_cartas    = \"\" \r\n            me.opciones.retiro_muestras  = \"\"\r\n            me.Fgenerar                  = \"\" \r\n            me.seguimiento.observacion   = \"\" \r\n            me.opciones.sinSello         = false;\r\n            me.opciones.otraEditorial    = false;\r\n            me.opciones.editorial        = \"\"\r\n\r\n        },\r\n        asginarInstitucion(tr) {\r\n            let me = this;\r\n            me.institucion_id = tr.idInstitucion\r\n            me.nombreInstitucion = tr.nombreInstitucion\r\n            me.estado_institucion_temporal = 0;\r\n            me.seleccionadoInsitucion = false;\r\n            me.instituciones = []\r\n\r\n        },\r\n\r\n        getInstitucion() {\r\n            let me = this;\r\n            me.instituciones = [];\r\n            if (me.busquedaInstitucion.length < 5) {\r\n                me.$vs.notify({\r\n                    text: 'Minimo 5 caracteres de busqueda',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })\r\n\r\n                return false;\r\n\r\n            }\r\n\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'listaInsitucionAsesor?busqueda=' + me.busquedaInstitucion + '&cedula=' + me.usuario.cedula)\r\n                .then(function (res) {\r\n                    // me.tmpInstituciones = res.data;\r\n                    me.instituciones = res.data;\r\n                    // me.filtroRegion();\r\n                    me.$vs.loading.close()\r\n                    if (res.data.message) {\r\n                        me.$vs.notify({\r\n                            text: res.data.message,\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-user',\r\n                            time: 8000\r\n                        })\r\n                    }\r\n\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n        },\r\n         ModalPendientes(tr,tipo){\r\n            let me = this\r\n\r\n            if(tipo == 1){\r\n                localStorage.setItem('institucion_seguimiento_id',tr.institucion_id_temporal)\r\n                localStorage.setItem('institucion_seguimiento_nombre',tr.nombre_institucion_temporal) \r\n                me.estado_institucion_temporal = 1\r\n                me.institucion_id_temporal = tr.institucion_id_temporal        \r\n            }else{\r\n                localStorage.setItem('institucion_seguimiento_id',tr.institucion_id)\r\n                localStorage.setItem('institucion_seguimiento_nombre',tr.nombreInstitucion)   \r\n                me.estado_institucion_temporal = 0   \r\n                     \r\n            }\r\n            localStorage.setItem('institucion_seguimiento_periodo_id',tr.periodo_id)\r\n            localStorage.setItem('institucion_seguimiento_periodo',tr.periodo)\r\n            me.nombreInstitucion = localStorage.getItem(\"institucion_seguimiento_nombre\")\r\n            me.institucion = localStorage.getItem(\"institucion_seguimiento_nombre\")\r\n            me.institucion_id = localStorage.getItem(\"institucion_seguimiento_id\")\r\n            me.periodo = localStorage.getItem(\"institucion_seguimiento_periodo\")\r\n            me.periodo_id = localStorage.getItem(\"institucion_seguimiento_periodo_id\")\r\n            //abrir modal \r\n            me.popupAgregarSeguimiento = true;\r\n            //variable si la data viene del asesor\r\n            me.desdeAsesor = true\r\n            me.update = false;\r\n            //agregar las opciones al modal\r\n            me.opciones.presentacion     = tr.opciones.presentacion\r\n            me.opciones.entrega_muestras = tr.opciones.entrega_muestras\r\n            me.opciones.reunion          = tr.opciones.reunion\r\n            me.opciones.seguimiento      = tr.opciones.seguimiento\r\n            me.opciones.cierre           = tr.opciones.cierre\r\n            me.opciones.cobranza         = tr.opciones.cobranza\r\n            me.opciones.post_venta       = tr.opciones.post_venta\r\n            me.opciones.retiro_cartas    = tr.opciones.retiro_cartas\r\n            me.opciones.retiro_muestras  = tr.opciones.retiro_muestras\r\n            me.Fgenerar                  = tr.startDate\r\n            me.seguimiento.observacion   = tr.url\r\n         \r\n\r\n        },\r\n        confirmarRegistroPendiente(tr) {\r\n            let me = this;\r\n            me.id = tr.id\r\n            this.$vs.dialog({\r\n                type: 'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: 'Esta seguro de registrar esta Planificación.',\r\n                accept: this.registrarPendiente\r\n            })\r\n        },\r\n        //prar registras las agendas pendientes\r\n        registrarPendiente() {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            formData.append('id', me.id);\r\n            me.$vs.loading();\r\n            this.$http.post(this.$server_url + 'seguimiento-registrar', formData)\r\n                .then(res => {\r\n\r\n                    me.getRegistrosPendientes();\r\n\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: 'Se registro con exito',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                    location.reload()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n\r\n        },\r\n\r\n         //para obtener el listado de los asesores\r\n        getRegistrosPendientes() {\r\n            let me = this;\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + 'seguimiento?asesor_id=' + me.asesor_id + '&pendientes=yes')\r\n                .then(function (res) {\r\n                    let datosProlipa = res.data.institucionesProlipa\r\n\r\n                    for (let i = 0; i < datosProlipa.length; i++) {\r\n\r\n                        me.institucionesProlipa.push({\r\n                            \"id\": datosProlipa[i].id,\r\n                            \"id_usuario\": datosProlipa[i].id_usuario,\r\n                            \"title\": datosProlipa[i].title,\r\n                            \"label\": datosProlipa[i].label,\r\n                            \"classes\": datosProlipa[i].classes,\r\n                            \"startDate\": datosProlipa[i].startDate,\r\n                            \"endDate\": datosProlipa[i].endDate,\r\n                            \"hora_inicio\": datosProlipa[i].hora_inicio,\r\n                            \"hora_fin\": datosProlipa[i].hora_fin,\r\n                            \"url\": datosProlipa[i].url,\r\n                            \"institucion_id\": datosProlipa[i].institucion_id,\r\n                            \"institucion_id_temporal\": datosProlipa[i].institucion_id_temporal,\r\n                            \"nombre_institucion_temporal\": datosProlipa[i].nombre_institucion_temporal,\r\n                            \"estado_institucion_temporal\": datosProlipa[i].estado_institucion_temporal,\r\n                            \"opciones\": JSON.parse(datosProlipa[i].opciones),\r\n                            \"periodo_id\": datosProlipa[i].periodo_id,\r\n                            \"estado\": datosProlipa[i].estado,\r\n                            \"idperiodoescolar\": datosProlipa[i].idperiodoescolar,\r\n                            \"periodo\": datosProlipa[i].periodo,\r\n                            \"nombreInstitucion\": datosProlipa[i].nombreInstitucion,\r\n                            \"vendedor\": datosProlipa[i].vendedor\r\n                        })\r\n                    }\r\n\r\n                    //para las instituciones temporales\r\n                    let datosTemporales = res.data.institucionesTemporales\r\n                   \r\n                    for (let i = 0; i < datosTemporales.length; i++) {\r\n\r\n                        me.institucionesTemporales.push({\r\n                            \"id\": datosTemporales[i].id,\r\n                            \"id_usuario\": datosTemporales[i].id_usuario,\r\n                            \"title\": datosTemporales[i].title,\r\n                            \"label\": datosTemporales[i].label,\r\n                            \"classes\": datosTemporales[i].classes,\r\n                            \"startDate\": datosTemporales[i].startDate,\r\n                            \"endDate\": datosTemporales[i].endDate,\r\n                            \"hora_inicio\": datosTemporales[i].hora_inicio,\r\n                            \"hora_fin\": datosTemporales[i].hora_fin,\r\n                            \"url\": datosTemporales[i].url,\r\n                            \"institucion_id\": datosTemporales[i].institucion_id,\r\n                            \"institucion_id_temporal\": datosTemporales[i].institucion_id_temporal,\r\n                            \"nombre_institucion_temporal\": datosTemporales[i].nombre_institucion_temporal,\r\n                            \"estado_institucion_temporal\": datosTemporales[i].estado_institucion_temporal,\r\n                            \"opciones\": JSON.parse(datosTemporales[i].opciones),\r\n                            \"periodo_id\": datosTemporales[i].periodo_id,\r\n                            \"estado\": datosTemporales[i].estado,\r\n                            \"idperiodoescolar\": datosTemporales[i].idperiodoescolar,\r\n                            \"periodo\": datosTemporales[i].periodo,\r\n                            \"nombreInstitucion\": datosTemporales[i].nombreInstitucion,\r\n                            \"vendedor\": datosTemporales[i].vendedor\r\n                        })\r\n                    }\r\n\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n        },\r\n        //cantidad de escuelas del asesor\r\n        async getVisitas() {\r\n            let me = this;\r\n            if (me.isAdmin == \"yes\") {\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\")\r\n            } else {\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n\r\n            this.$http.get(this.$server_url + 'asesor/seguimiento?institucion_id=' + localStorage.institucion_seguimiento_id +'&nombreInstitucion='+localStorage.institucion_seguimiento_nombre+ '&periodo_id=' + me.periodo_id + '&asesor_id=' + me.asesorDesdeAdmin)\r\n                .then(function (response) {\r\n                    let datos = response.data;\r\n                    let datosConvertir = datos.filter(p => p.tipo_seguimiento == me.tipo)\r\n                    for (let i = 0; i < datosConvertir.length; i++) {\r\n                            me.visitas.push({\r\n                            \"id\": datosConvertir[i].id,\r\n                            \"num_visita\": datosConvertir[i].num_visita,\r\n                            \"institucion_id\": datosConvertir[i].institucion_id,\r\n                            \"asesor_id\": datosConvertir[i].asesor_id,\r\n                            \"usuario_editor\": datosConvertir[i].usuario_editor,\r\n                            \"tipo_seguimiento\": datosConvertir[i].tipo_seguimiento,\r\n                            \"fecha_genera_visita\": datosConvertir[i].fecha_genera_visita,\r\n                            \"fecha_que_visita\": datosConvertir[i].fecha_que_visita,\r\n                            \"opciones\": JSON.parse(datosConvertir[i].opciones),\r\n                            \"observacion\":datosConvertir[i].observacion,\r\n                            \"periodo_id\": datosConvertir[i].periodo_id,\r\n                            \"estado\": datosConvertir[i].estado,\r\n                            \"nombreInstitucion\":datosConvertir[i].nombreInstitucion,\r\n                            \"institucion_id_temporal\": datosConvertir[i].institucion_id_temporal,\r\n                            \"nombre_institucion_temporal\": datosConvertir[i].nombre_institucion_temporal,\r\n                            \"estado_institucion_temporal\":datosConvertir[i].estado_institucion_temporal,\r\n                            \r\n                         \r\n                        })\r\n                    }\r\n                })\r\n                .catch(function (error) {\r\n\r\n                })\r\n        },\r\n        openConfirm(tr){\r\n            let me = this;\r\n            me.id = tr.id\r\n            this.$vs.dialog({\r\n                type:'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: 'Estas seguro de Eliminar',\r\n                accept:this.eliminar,\r\n                acceptText:\"Aceptar\",\r\n                cancelText:\"Cancelar\"\r\n            })\r\n        },        \r\n     //para eliminar la area\r\n         eliminar() {\r\n              let me = this;\r\n              let formData = new FormData();\r\n              formData.append('id',me.id);\r\n              this.$http.post(this.$server_url+'seguimiento-eliminar', formData)\r\n              .then(res => {\r\n\r\n                  me.id = 0\r\n                   this.$vs.notify({\r\n                        text:'Se elimno correctamente',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n            \r\n            if(me.isAdmin == \"yes\"){\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\") \r\n            }else{\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n            \r\n            this.$http.get(this.$server_url+'asesor/seguimiento?institucion_id='+me.institucion_id+'&periodo_id='+me.periodo_id+'&asesor_id='+me.asesorDesdeAdmin)\r\n                .then(function (response) {\r\n                    let datos = response.data;\r\n                    if(response.data.status == \"0\"){\r\n                        me.visitas = []\r\n                    }else{\r\n                         me.visitas = datos.filter(p => p.tipo_seguimiento == me.tipo) \r\n                    }\r\n                   \r\n                })\r\n                .catch(function (error) {\r\n                    \r\n                })\r\n                 \r\n              })\r\n                .catch(function (error) {\r\n                   \r\n                })\r\n        },\r\n\r\n            openModalEdit(tr) {\r\n            let me = this;\r\n           \r\n            me.id = tr.id\r\n            me.Fgenerar = tr.fecha_genera_visita\r\n            me.Fvisita = tr.fecha_que_visita\r\n            me.seguimiento.observacion = tr.observacion\r\n            me.popupEditarSeguimiento = true;\r\n            //agregar las opciones al modal\r\n            me.opciones.presentacion     = tr.opciones.presentacion\r\n            me.opciones.entrega_muestras = tr.opciones.entrega_muestras\r\n            me.opciones.reunion          = tr.opciones.reunion\r\n            me.opciones.seguimiento      = tr.opciones.seguimiento\r\n            me.opciones.cierre           = tr.opciones.cierre\r\n            me.opciones.cobranza         = tr.opciones.cobranza\r\n            me.opciones.post_venta       = tr.opciones.post_venta\r\n            me.opciones.retiro_cartas    = tr.opciones.retiro_cartas\r\n            me.opciones.retiro_muestras  = tr.opciones.retiro_muestras\r\n            if(tr.estado_institucion_temporal == 0){\r\n                me.nombreInstitucion = tr.nombreInstitucion\r\n            }else{\r\n                me.nombreInstitucion = tr.nombre_institucion_temporal\r\n            }\r\n            me.estado_institucion_temporal = tr.estado_institucion_temporal\r\n            me.institucion_id_temporal = tr.institucion_id_temporal\r\n            me.institucion_id = tr.institucion_id\r\n        },\r\n      generarSeguimiento() {\r\n            let me = this;\r\n        \r\n            if (me.Fgenerar == null) {\r\n                me.$vs.notify({\r\n                    text: 'Debe escoger una fecha generar visita',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })\r\n                return false;\r\n            }\r\n            //validacion al editar\r\n            if (me.update == true) {\r\n\r\n                if (me.Fgenerar > me.Fvisita) {\r\n                    me.$vs.notify({\r\n                        text: 'La fecha de generar visita  no puede mayor  que la fecha de visita',\r\n                        color: 'warning',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                    return false;\r\n                }\r\n            }\r\n            me.visitas=[]\r\n\r\n            let formData = new FormData();\r\n            if (me.update = true) {\r\n                formData.append('id', me.id);\r\n                formData.append('fecha_que_visita', me.Fvisita);\r\n                //solo si coloca la fecha de visita el estado cambiara a finalizdo\r\n                if (me.Fvisita == null) {} else {\r\n                    formData.append('finalizar', \"yes\")\r\n                }\r\n            }\r\n            \r\n            formData.append('estado_institucion_temporal', me.estado_institucion_temporal);\r\n            formData.append('nombreInstitucion', localStorage.institucion_seguimiento_nombre);\r\n            formData.append('fecha_genera_visita', me.Fgenerar);\r\n            formData.append('observacion', me.seguimiento.observacion);\r\n            if(me.estado_institucion_temporal == 1){\r\n                formData.append('institucion_id', me.institucion_id_temporal);\r\n            }else{\r\n                formData.append('institucion_id', me.institucion_id);\r\n            }\r\n            if (me.isAdmin == \"yes\") {\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\")\r\n                formData.append('usuario_editor', me.usuario.idusuario);\r\n                formData.append('admin', \"yes\");\r\n            } else {\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n\r\n            formData.append('asesor_id', me.asesorDesdeAdmin);\r\n            formData.append('tipo_seguimiento', me.tipo);\r\n            formData.append('periodo_id', me.periodo_id);\r\n            formData.append('opciones', JSON.stringify(me.opciones));\r\n        \r\n            me.$vs.loading();\r\n            this.$http.post(this.$server_url + 'guardarSeguimiento',formData)\r\n                .then(function (res) {\r\n\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'primary',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    me.popupAgregarSeguimiento = false;\r\n                    me.popupEditarSeguimiento = false;\r\n                    me.getVisitas();\r\n                    me.limpiar()\r\n                    // location.reload()   \r\n                \r\n\r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.loading.close()\r\n                });\r\n        },\r\n        limpiar() {\r\n            let me = this;\r\n            me.seguimiento.observacion = \"\"\r\n            me.Fgenerar = null\r\n            me.opciones.presentacion     = \"\" \r\n            me.opciones.entrega_muestras = \"\" \r\n            me.opciones.reunion          = \"\" \r\n            me.opciones.seguimiento      = \"\" \r\n            me.opciones.cierre           = \"\" \r\n            me.opciones.cobranza         = \"\" \r\n            me.opciones.post_venta       = \"\" \r\n            me.opciones.retiro_cartas    = \"\" \r\n            me.opciones.retiro_muestras  = \"\" \r\n            me.estado_institucion_temporal = \"\" \r\n            me.nombreInstitucion = \"\"\r\n            \r\n\r\n        }\r\n    }\r\n}\r\n</script>"]}]}