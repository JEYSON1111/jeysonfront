{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\asesor\\seguimiento\\components\\visitas.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\asesor\\seguimiento\\components\\visitas.vue","mtime":1712682815531},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nexport default {\r\n    data() {\r\n       return{\r\n           counterDanger: false,\r\n           visitas:[],\r\n           institucion:'',\r\n           institucion_id:'',\r\n           periodo:'',\r\n           periodo_id:'',\r\n           usuario:[],\r\n           popupAgregarSeguimiento:false,\r\n           popupEditarSeguimiento:false,\r\n            Fgenerar: null,\r\n            Fvisita: null,\r\n            configdateTimePicker: {\r\n                enableTime: true,\r\n                dateFormat: 'Y-m-d'\r\n            },\r\n            seguimiento:{\r\n                observacion:''\r\n            },\r\n            id:0,\r\n            update:false,\r\n            title:'',\r\n            titleFechaGenera:'',\r\n            titleFechaVisita:'',\r\n            isAdmin:'',\r\n            asesorDesdeAdmin:'',\r\n          \r\n\r\n       } \r\n    },\r\n    props:{\r\n        tipo:{\r\n            type:String,\r\n            default:1\r\n        },\r\n        valor:{\r\n            type:String,\r\n            default:\"Visita\"\r\n        }\r\n    },\r\n      components:{\r\n        flatPickr,\r\n    },\r\n    created(){\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n        me.institucion = localStorage.getItem(\"institucion_seguimiento_nombre\")\r\n        me.institucion_id = localStorage.getItem(\"institucion_seguimiento_id\")\r\n        me.periodo = localStorage.getItem(\"institucion_seguimiento_periodo\")\r\n        me.periodo_id = localStorage.getItem(\"institucion_seguimiento_periodo_id\")\r\n        me.isAdmin = localStorage.getItem(\"adminSeguimiento\")\r\n        \r\n        me.getVisitas()\r\n        me.title = \"Genera\"+\" \" +me.valor\r\n        me.titleFechaGenera = \"Fecha generar\"+ \" \" +me.valor\r\n        me.titleFechaVisita = \"Fecha visita\" + \" \" +me.valor\r\n    }, \r\n    methods:{\r\n        //cantidad de escuelas del asesor\r\n        async getVisitas() {\r\n            let me = this;\r\n            if(me.isAdmin == \"yes\"){\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\") \r\n            }else{\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n            \r\n            this.$http.get(this.$server_url+'asesor/seguimiento?institucion_id='+me.institucion_id+'&periodo_id='+me.periodo_id+'&asesor_id='+me.asesorDesdeAdmin)\r\n                .then(function (response) {\r\n                    let datos = response.data;\r\n                    me.visitas = datos.filter(p => p.tipo_seguimiento == me.tipo) \r\n                })\r\n                .catch(function (error) {\r\n                    \r\n                })\r\n        },\r\n        openConfirm(tr){\r\n            let me = this;\r\n            me.id = tr.id\r\n            this.$vs.dialog({\r\n                type:'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: 'Estas seguro de Eliminar',\r\n                accept:this.eliminar,\r\n                acceptText:\"Aceptar\",\r\n                cancelText:\"Cancelar\"\r\n            })\r\n        },        \r\n     //para eliminar la area\r\n         eliminar() {\r\n              let me = this;\r\n              let formData = new FormData();\r\n              formData.append('id',me.id);\r\n              this.$http.post(this.$server_url+'seguimiento-eliminar', formData)\r\n              .then(res => {\r\n\r\n                  me.id = 0\r\n                   this.$vs.notify({\r\n                        text:'Se elimno correctamente',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n            \r\n            if(me.isAdmin == \"yes\"){\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\") \r\n            }else{\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n            \r\n            this.$http.get(this.$server_url+'asesor/seguimiento?institucion_id='+me.institucion_id+'&periodo_id='+me.periodo_id+'&asesor_id='+me.asesorDesdeAdmin)\r\n                .then(function (response) {\r\n                    let datos = response.data;\r\n                    if(response.data.status == \"0\"){\r\n                        me.visitas = []\r\n                    }else{\r\n                         me.visitas = datos.filter(p => p.tipo_seguimiento == me.tipo) \r\n                    }    \r\n                })\r\n                .catch(function (error) {\r\n                    \r\n                })\r\n                 \r\n              })\r\n                .catch(function (error) {\r\n                   \r\n                })\r\n        },\r\n\r\n        openModalEdit(tr){\r\n            let me = this;\r\n            me.id = tr.id\r\n            me.Fgenerar = tr.fecha_genera_visita\r\n            me.Fvisita = tr.fecha_que_visita\r\n            me.seguimiento.observacion = tr.observacion\r\n            me.popupEditarSeguimiento  = true;\r\n        },\r\n        generarSeguimiento(){\r\n            let me = this;\r\n            if(me.seguimiento.observacion.length >= 500){\r\n                me.$vs.notify({\r\n                    color: 'primary',\r\n                    title: 'Mensaje',\r\n                    text: 'El observación debe tener un maximo de 500 caracteres'\r\n                    })\r\n                return false;\r\n            }\r\n            \r\n            if(me.Fgenerar == null){\r\n                me.$vs.notify({\r\n                text: 'Debe escoger una fecha generar visita',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n            return false;\r\n            }\r\n            //validacion al editar\r\n            if(me.update == true){\r\n         \r\n                if(me.Fgenerar > me.Fvisita){\r\n                    me.$vs.notify({\r\n                        text: 'La fecha de generar visita  no puede mayor  que la fecha de visita',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                       return false;\r\n                }\r\n            }\r\n\r\n            \r\n           let formData = new FormData();\r\n            if(me.update = true){\r\n              formData.append('id',    me.id);       \r\n              formData.append('fecha_que_visita',    me.Fvisita);\r\n              //solo si coloca la fecha de visita el estado cambiara a finalizdo\r\n                 if(me.Fvisita == null){\r\n                 }else{\r\n                    formData.append('finalizar',    \"yes\")\r\n                 }\r\n            }\r\n            formData.append('fecha_genera_visita',    me.Fgenerar);\r\n            formData.append('observacion',            me.seguimiento.observacion);\r\n            formData.append('institucion_id',         me.institucion_id);\r\n            if(me.isAdmin == \"yes\"){\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\") \r\n                formData.append('usuario_editor',    me.usuario.idusuario);\r\n                formData.append('admin',    \"yes\");\r\n            }else{\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n            \r\n            formData.append('asesor_id',              me.asesorDesdeAdmin);\r\n            formData.append('tipo_seguimiento',       me.tipo);\r\n            formData.append('periodo_id',             me.periodo_id);\r\n            \r\n            me.$vs.loading();\r\n            this.$http.post(this.$server_url+'guardarSeguimiento', formData)\r\n                .then(function (res) {\r\n                    \r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'primary',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                   me.popupAgregarSeguimiento = false;\r\n                   me.popupEditarSeguimiento = false;\r\n                   me.getVisitas();\r\n                   me.limpiar()\r\n                    \r\n                  \r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.loading.close()\r\n                });\r\n        },\r\n        limpiar(){\r\n            let  me = this;\r\n            me.seguimiento.observacion = \"\"\r\n            me.Fgenerar = null\r\n\r\n        }\r\n    }\r\n}\r\n",{"version":3,"sources":["visitas.vue"],"names":[],"mappings":";AAyJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"visitas.vue","sourceRoot":"src/views/asesor/seguimiento/components","sourcesContent":["<template>\r\n    <div>\r\n     <vs-row>\r\n    \r\n        <p @click=\"popupAgregarSeguimiento = true;update = false;\" style=\"cursor:pointer\" v-if=\"usuario.id_group == 1\">\r\n            <vs-chip color=\"primary\" style=\"cursor:pointer\"  class=\"mt-2\">\r\n                <vs-avatar icon=\"edit\"  @click=\"popupAgregarSeguimiento = true;\"/>\r\n                Agregar {{valor}}\r\n            </vs-chip>\r\n        </p> \r\n       \r\n\r\n        <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n             <vs-table stripe :data=\"visitas\" search pagination max-items=\"10\" style=\"width: 100%;\">\r\n                <template slot=\"header\">\r\n                    \r\n                    <vs-list>\r\n                        <vs-list-header title=\"Información\"></vs-list-header>\r\n                        <vs-list-item title=\"Institución\" :subtitle=\"institucion\"></vs-list-item>\r\n                        <vs-list-item title=\"Período\" :subtitle=\"periodo\"></vs-list-item>\r\n                        <vs-list-item :title=\"valor +' ' + 'cantidad'\" :subtitle=\"visitas.length\"></vs-list-item>\r\n                    </vs-list>\r\n\r\n                </template>\r\n                \r\n                <template slot=\"thead\">\r\n                    <vs-th>\r\n                    {{valor}}\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Fecha Genera {{valor}}\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Fecha {{valor}}\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Observación\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Estado\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Acciones\r\n                    </vs-th>\r\n\r\n                </template>\r\n            \r\n                <template slot-scope=\"{data}\">\r\n                    <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\" >\r\n                        <vs-td :data=\"data[indextr].num_visita\" width=\"20%\">\r\n                           \r\n                            <vs-chip color=\"primary\">\r\n                            {{valor}} Nº {{data[indextr].num_visita}}\r\n                            </vs-chip>\r\n                        </vs-td>\r\n                        <vs-td :data=\"data[indextr].fecha_genera_visita\" width=\"20%\">\r\n                            {{data[indextr].fecha_genera_visita}}\r\n                        </vs-td>\r\n\r\n                        <vs-td :data=\"data[indextr].fecha_que_visita\" width=\"20%\">\r\n                            {{data[indextr].fecha_que_visita}}\r\n                        </vs-td>\r\n\r\n                        <vs-td height=\"30%\" width=\"50%\">\r\n                            <div class=\"overflow-y-auto h-24\">\r\n                                {{tr.observacion}}\r\n                               \r\n                            </div>\r\n                        </vs-td>\r\n                        <vs-td>\r\n                            <vs-chip :color=\"tr.estado == '0'?'success':'warning'\">\r\n                                {{ tr.estado == '0' ? 'Generada' :'Finalizada' }}\r\n                            </vs-chip>\r\n                        </vs-td>\r\n                        <vs-td>\r\n                            <div style=\"display:flex;\">\r\n                                <vx-tooltip style=\"display: inline-block;\" text=\"Editar\" position=\"top\" color=\"primary\">\r\n                                    <vs-button radius color=\"success\" @click=\"openModalEdit(tr);update = true\" type=\"line\" icon=\"edit\"></vs-button>\r\n                                </vx-tooltip> &nbsp;  \r\n                                <vx-tooltip style=\"display: inline-block;\" :text=\"'Eliminar '+valor\" position=\"top\" color=\"danger\">\r\n                                    <vs-button radius color=\"danger\" @click=\"openConfirm(tr)\" type=\"line\" icon=\"delete\"></vs-button>\r\n                                </vx-tooltip> &nbsp;  \r\n                            </div>\r\n                         \r\n             \r\n                        </vs-td>\r\n                    </vs-tr>\r\n                </template>\r\n            </vs-table>\r\n        </vs-col>\r\n    </vs-row>\r\n\r\n    \r\n    <!--MODALES-->\r\n    <!--MODAL PARA AGREGAR SEGUIMIENTO-->\r\n    <vs-popup\r\n        :title=\"title\" :active.sync=\"popupAgregarSeguimiento\">\r\n\r\n            <vs-row>\r\n                <p class=\"ml-2\">Fecha generar {{valor}}</p>\r\n                <vs-col  class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                   <flat-pickr :config=\"configdateTimePicker\" v-model=\"Fgenerar\"  :placeholder=\"titleFechaGenera\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row class=\"mt-2\">    \r\n                <p class=\"ml-2\">Observación</p>\r\n                <vs-col  class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n            \r\n                <vs-textarea counter=\"500\" style=\"width:100%;\" label=\"Mensaje\" :counter-danger.sync=\"counterDanger\" v-model=\"seguimiento.observacion\" />\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row>\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <vs-button @click=\"generarSeguimiento()\" type=\"gradient\">Generar {{valor}}</vs-button>\r\n                </vs-col>\r\n            </vs-row>\r\n        \r\n    </vs-popup>\r\n\r\n    <!--MODAL PARA Editar SEGUIMIENTO-->\r\n    <vs-popup\r\n         :title=\"title\" :active.sync=\"popupEditarSeguimiento\">\r\n\r\n            <vs-row>\r\n                <p class=\"ml-2\">Fecha generar {{valor}}</p>\r\n                <vs-col  class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                   <flat-pickr :config=\"configdateTimePicker\" v-model=\"Fgenerar\"  :placeholder=\"titleFechaGenera\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n                </vs-col>\r\n            </vs-row>\r\n             <vs-row>\r\n                <p class=\"ml-2\">Fecha de la {{valor}}</p>\r\n                <vs-col  class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                   <flat-pickr :config=\"configdateTimePicker\" v-model=\"Fvisita\"  :placeholder=\"titleFechaVisita\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row class=\"mt-2\">    \r\n                <p class=\"ml-2\">Observación</p>\r\n                <vs-col  class=\"mt-1\" vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                <vs-textarea counter=\"500\" style=\"width:100%;\" label=\"Mensaje\" :counter-danger.sync=\"counterDanger\" v-model=\"seguimiento.observacion\" />\r\n                </vs-col>\r\n            </vs-row>\r\n            <vs-row>\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                    <vs-button @click=\"generarSeguimiento()\" type=\"gradient\">Generar {{valor}}</vs-button>\r\n                </vs-col>\r\n            </vs-row>\r\n        \r\n    </vs-popup>\r\n       \r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nexport default {\r\n    data() {\r\n       return{\r\n           counterDanger: false,\r\n           visitas:[],\r\n           institucion:'',\r\n           institucion_id:'',\r\n           periodo:'',\r\n           periodo_id:'',\r\n           usuario:[],\r\n           popupAgregarSeguimiento:false,\r\n           popupEditarSeguimiento:false,\r\n            Fgenerar: null,\r\n            Fvisita: null,\r\n            configdateTimePicker: {\r\n                enableTime: true,\r\n                dateFormat: 'Y-m-d'\r\n            },\r\n            seguimiento:{\r\n                observacion:''\r\n            },\r\n            id:0,\r\n            update:false,\r\n            title:'',\r\n            titleFechaGenera:'',\r\n            titleFechaVisita:'',\r\n            isAdmin:'',\r\n            asesorDesdeAdmin:'',\r\n          \r\n\r\n       } \r\n    },\r\n    props:{\r\n        tipo:{\r\n            type:String,\r\n            default:1\r\n        },\r\n        valor:{\r\n            type:String,\r\n            default:\"Visita\"\r\n        }\r\n    },\r\n      components:{\r\n        flatPickr,\r\n    },\r\n    created(){\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n        me.institucion = localStorage.getItem(\"institucion_seguimiento_nombre\")\r\n        me.institucion_id = localStorage.getItem(\"institucion_seguimiento_id\")\r\n        me.periodo = localStorage.getItem(\"institucion_seguimiento_periodo\")\r\n        me.periodo_id = localStorage.getItem(\"institucion_seguimiento_periodo_id\")\r\n        me.isAdmin = localStorage.getItem(\"adminSeguimiento\")\r\n        \r\n        me.getVisitas()\r\n        me.title = \"Genera\"+\" \" +me.valor\r\n        me.titleFechaGenera = \"Fecha generar\"+ \" \" +me.valor\r\n        me.titleFechaVisita = \"Fecha visita\" + \" \" +me.valor\r\n    }, \r\n    methods:{\r\n        //cantidad de escuelas del asesor\r\n        async getVisitas() {\r\n            let me = this;\r\n            if(me.isAdmin == \"yes\"){\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\") \r\n            }else{\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n            \r\n            this.$http.get(this.$server_url+'asesor/seguimiento?institucion_id='+me.institucion_id+'&periodo_id='+me.periodo_id+'&asesor_id='+me.asesorDesdeAdmin)\r\n                .then(function (response) {\r\n                    let datos = response.data;\r\n                    me.visitas = datos.filter(p => p.tipo_seguimiento == me.tipo) \r\n                })\r\n                .catch(function (error) {\r\n                    \r\n                })\r\n        },\r\n        openConfirm(tr){\r\n            let me = this;\r\n            me.id = tr.id\r\n            this.$vs.dialog({\r\n                type:'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: 'Estas seguro de Eliminar',\r\n                accept:this.eliminar,\r\n                acceptText:\"Aceptar\",\r\n                cancelText:\"Cancelar\"\r\n            })\r\n        },        \r\n     //para eliminar la area\r\n         eliminar() {\r\n              let me = this;\r\n              let formData = new FormData();\r\n              formData.append('id',me.id);\r\n              this.$http.post(this.$server_url+'seguimiento-eliminar', formData)\r\n              .then(res => {\r\n\r\n                  me.id = 0\r\n                   this.$vs.notify({\r\n                        text:'Se elimno correctamente',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n            \r\n            if(me.isAdmin == \"yes\"){\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\") \r\n            }else{\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n            \r\n            this.$http.get(this.$server_url+'asesor/seguimiento?institucion_id='+me.institucion_id+'&periodo_id='+me.periodo_id+'&asesor_id='+me.asesorDesdeAdmin)\r\n                .then(function (response) {\r\n                    let datos = response.data;\r\n                    if(response.data.status == \"0\"){\r\n                        me.visitas = []\r\n                    }else{\r\n                         me.visitas = datos.filter(p => p.tipo_seguimiento == me.tipo) \r\n                    }    \r\n                })\r\n                .catch(function (error) {\r\n                    \r\n                })\r\n                 \r\n              })\r\n                .catch(function (error) {\r\n                   \r\n                })\r\n        },\r\n\r\n        openModalEdit(tr){\r\n            let me = this;\r\n            me.id = tr.id\r\n            me.Fgenerar = tr.fecha_genera_visita\r\n            me.Fvisita = tr.fecha_que_visita\r\n            me.seguimiento.observacion = tr.observacion\r\n            me.popupEditarSeguimiento  = true;\r\n        },\r\n        generarSeguimiento(){\r\n            let me = this;\r\n            if(me.seguimiento.observacion.length >= 500){\r\n                me.$vs.notify({\r\n                    color: 'primary',\r\n                    title: 'Mensaje',\r\n                    text: 'El observación debe tener un maximo de 500 caracteres'\r\n                    })\r\n                return false;\r\n            }\r\n            \r\n            if(me.Fgenerar == null){\r\n                me.$vs.notify({\r\n                text: 'Debe escoger una fecha generar visita',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n            return false;\r\n            }\r\n            //validacion al editar\r\n            if(me.update == true){\r\n         \r\n                if(me.Fgenerar > me.Fvisita){\r\n                    me.$vs.notify({\r\n                        text: 'La fecha de generar visita  no puede mayor  que la fecha de visita',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                       return false;\r\n                }\r\n            }\r\n\r\n            \r\n           let formData = new FormData();\r\n            if(me.update = true){\r\n              formData.append('id',    me.id);       \r\n              formData.append('fecha_que_visita',    me.Fvisita);\r\n              //solo si coloca la fecha de visita el estado cambiara a finalizdo\r\n                 if(me.Fvisita == null){\r\n                 }else{\r\n                    formData.append('finalizar',    \"yes\")\r\n                 }\r\n            }\r\n            formData.append('fecha_genera_visita',    me.Fgenerar);\r\n            formData.append('observacion',            me.seguimiento.observacion);\r\n            formData.append('institucion_id',         me.institucion_id);\r\n            if(me.isAdmin == \"yes\"){\r\n                me.asesorDesdeAdmin = localStorage.getItem(\"institucion_seguimiento_asesor_id\") \r\n                formData.append('usuario_editor',    me.usuario.idusuario);\r\n                formData.append('admin',    \"yes\");\r\n            }else{\r\n                me.asesorDesdeAdmin = me.usuario.idusuario\r\n            }\r\n            \r\n            formData.append('asesor_id',              me.asesorDesdeAdmin);\r\n            formData.append('tipo_seguimiento',       me.tipo);\r\n            formData.append('periodo_id',             me.periodo_id);\r\n            \r\n            me.$vs.loading();\r\n            this.$http.post(this.$server_url+'guardarSeguimiento', formData)\r\n                .then(function (res) {\r\n                    \r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'primary',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                   me.popupAgregarSeguimiento = false;\r\n                   me.popupEditarSeguimiento = false;\r\n                   me.getVisitas();\r\n                   me.limpiar()\r\n                    \r\n                  \r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.loading.close()\r\n                });\r\n        },\r\n        limpiar(){\r\n            let  me = this;\r\n            me.seguimiento.observacion = \"\"\r\n            me.Fgenerar = null\r\n\r\n        }\r\n    }\r\n}\r\n</script>"]}]}