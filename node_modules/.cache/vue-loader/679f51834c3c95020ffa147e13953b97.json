{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\codigos\\components\\ResetearCampos.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\codigos\\components\\ResetearCampos.vue","mtime":1712682815628},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport vSelect from 'vue-select'\r\nimport TableSelectInstitucion from '../../usuarios/GestionEstudiantes/components/TableSelectInstitucion.vue';\r\nimport gestionCodigosLista from './utils/gestionCodigosLista.vue';\r\nexport default {\r\n    data() {\r\n       return{\r\n            usuario:[],\r\n            codigo:{\r\n                libro:'',\r\n                idusuario:0,\r\n                contrato:'',\r\n                id_periodo:'',\r\n                estado_liquidacion:1,\r\n                bc_estado:1,\r\n                codigos_barras:1,\r\n                bc_institucion:0,\r\n                bc_periodo:0,\r\n                venta_estado:0,\r\n                venta_lista_institucion:0,\r\n                contador:1,\r\n                estado:0,\r\n                verif1:'',\r\n                verif2:'',\r\n                verif3:'',\r\n                verif4:'',\r\n                verif5:'',\r\n                verif6:'',\r\n                verif7:'',\r\n                verif8:'',\r\n                verif9:'',\r\n                verif10:'',\r\n                bc_fecha_ingreso: null,\r\n            },\r\n            nombreInstitucion:'',\r\n            institucion_id:0,\r\n            error:false,\r\n            statusPeriodo:0,\r\n            periodo_id:0,\r\n            //variables para la consulta\r\n            chkIdusuario:false,\r\n            chkContrato:false,\r\n            chkId_periodo:false,\r\n            chkEstado_liquidacion:false,\r\n            chkBc_estado:false,\r\n            chkBc_Codigos_barras:false,\r\n            chkBc_Bc_institucion:false,\r\n            chkBc_Bc_periodo:false,\r\n            chkBc_Venta_lista_institucion:false,\r\n            chkBc_Venta_estado:false,\r\n            chkBc_Verif1:false,\r\n            chkBc_Verif2:false,\r\n            chkBc_Verif3:false,\r\n            chkBc_Verif4:false,\r\n            chkBc_Verif5:false,\r\n            chkBc_Verif6:false,\r\n            chkBc_Verif7:false,\r\n            chkBc_Verif8:false,\r\n            chkBc_Verif9:false,\r\n            chkBc_Verif10:false,\r\n            chkBc_Estado:false,\r\n            //fin variables para la consulta\r\n            informacion:[],\r\n            tmpinformacion:[],\r\n            arregloChangeCodigos:[],\r\n            arregloCodigosEnviar:[],\r\n            codigosPerdidos:false,\r\n            popupConfirmar:false,\r\n            popupLimit:false,\r\n            porcentaje:0,\r\n            codigoTipo:100,\r\n            tipo:'',\r\n       }\r\n    },\r\n    created(){\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem(\"usuario\"));\r\n    },\r\n    mounted(){\r\n        let me = this;\r\n    },\r\n    components: {\r\n        'v-select': vSelect,\r\n        flatPickr,\r\n        TableSelectInstitucion,\r\n        gestionCodigosLista\r\n    },\r\n    computed:{\r\n        sumaTotal(){\r\n            let me = this;\r\n            let total = me.informacion.length\r\n            return total\r\n        },\r\n        sumaCodigosRegalados(){\r\n            let me = this;\r\n            let primerFiltro = me.informacion.filter(p => p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null);\r\n            let datos        = primerFiltro.filter(p => p.estado_liquidacion =='2')\r\n            let resultado    = datos.length\r\n            return resultado\r\n        },\r\n        sumarCodigosLiquidados(){\r\n            let me = this;\r\n            let primerFiltro = me.informacion.filter(p => p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null);\r\n            let datos        = primerFiltro.filter(p => p.estado_liquidacion =='0')\r\n            let resultado    = datos.length\r\n            return resultado\r\n        },\r\n        SumaCodigosDevolucion(){\r\n            let me = this;\r\n            let datos       = me.informacion.filter(p => p.estado_liquidacion == '3');\r\n            let resultado   = datos.length\r\n            return resultado\r\n        },\r\n        sumarCodigosLeidos(){\r\n            let me = this;\r\n            let primerFiltro = me.informacion.filter(p => (p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null) && (p.estado_liquidacion == 1));\r\n            let datos        = primerFiltro.filter(p => p.bc_estado =='2')\r\n            let resultado    = datos.length\r\n            return resultado\r\n        },\r\n        sumarCodigosNoleidos(){\r\n            let me = this;\r\n            let primerFiltro = me.informacion.filter(p => (p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null) && (p.estado_liquidacion == 1));\r\n            let datos        = primerFiltro.filter(p => p.bc_estado =='1')\r\n            let resultado    = datos.length\r\n            return resultado\r\n        }\r\n    },\r\n    watch:{\r\n        institucion_id(results){\r\n            let me = this\r\n            if(results > 0){\r\n                me.informacion = []\r\n                me.tmpinformacion = []\r\n                me.arregloChangeCodigos = []\r\n                me.getTipoVenta()\r\n            }else{\r\n                me.informacion = []\r\n                me.tmpinformacion = []\r\n                me.arregloChangeCodigos = []\r\n            }\r\n        }\r\n    },\r\n    methods:{\r\n        changeHandle(e){\r\n            let me = this\r\n            let valor = e.change\r\n            if(valor == 'institucion')       me.institucion_id   = e.value\r\n            if(valor == 'noPeriodo')         me.error            = e.value\r\n            if(valor == 'periodo')           me.statusPeriodo    = e.value\r\n            if(valor == 'periodo_id')        me.periodo_id           = e.value\r\n            if(valor == 'nombreInstitucion') me.nombreInstitucion = e.value\r\n            me.codigosPerdidos = false\r\n            me.porcentaje      = 0\r\n        },\r\n        openConfirmar(){\r\n            let me = this;\r\n              //VALIDACION\r\n            if(me.arregloChangeCodigos.length == 0){\r\n                me.$vs.notify({\r\n                text:'No hay códigos para cambiar',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false;\r\n            }\r\n            if(me.codigoTipo == 100){\r\n                me.$vs.notify({\r\n                text:'Seleccione la cantidad de códigos que se va cambiar',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false;\r\n            }\r\n            if(me.error){\r\n                me.$vs.notify({\r\n                text:'La institución no tiene período',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false;\r\n            }\r\n            if(me.institucion_id <= 0){\r\n                me.$vs.notify({\r\n                text:'Seleccione una institución por favor',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false\r\n            }\r\n            if(me.statusPeriodo == 0){\r\n                me.$vs.notify({\r\n                text:'La institución tiene período inactivo, consulte con el administrador por favor',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false\r\n            }\r\n            //FIN VALIDACION\r\n            me.popupConfirmar = true\r\n        },\r\n        guardarCodigo(){\r\n            let me = this;\r\n            let formData = new FormData();\r\n            me.$vs.loading();\r\n            formData.append('data_codigos',           JSON.stringify(me.arregloCodigosEnviar))\r\n            formData.append('idusuario',              me.codigo.idusuario)\r\n            formData.append('estado',                 me.codigo.estado)\r\n            formData.append('contrato',               me.codigo.contrato)\r\n            formData.append('id_periodo',             me.codigo.id_periodo)\r\n            formData.append('verif1',                 me.codigo.verif1 == 'null' ? '': me.codigo.verif1 )\r\n            formData.append('verif2',                 me.codigo.verif2 == 'null' ? '': me.codigo.verif2 )\r\n            formData.append('verif3',                 me.codigo.verif3 == 'null' ? '': me.codigo.verif3 )\r\n            formData.append('verif4',                 me.codigo.verif4 == 'null' ? '': me.codigo.verif4 )\r\n            formData.append('verif5',                 me.codigo.verif5 == 'null' ? '': me.codigo.verif5 )\r\n            formData.append('verif6',                 me.codigo.verif6 == 'null' ? '': me.codigo.verif6 )\r\n            formData.append('verif7',                 me.codigo.verif7 == 'null' ? '': me.codigo.verif7 )\r\n            formData.append('verif8',                 me.codigo.verif8 == 'null' ? '': me.codigo.verif8 )\r\n            formData.append('verif9',                 me.codigo.verif9 == 'null' ? '': me.codigo.verif9 )\r\n            formData.append('verif10',                me.codigo.verif10 == 'null' ? '': me.codigo.verif10 )\r\n            formData.append('estado_liquidacion',     me.codigo.estado_liquidacion)\r\n            formData.append('bc_estado',              me.codigo.bc_estado)\r\n            formData.append('codigos_barras',         me.codigo.codigos_barras)\r\n            formData.append('bc_institucion',         me.codigo.bc_institucion)\r\n            formData.append('bc_periodo',             me.codigo.bc_periodo)\r\n            //auditoria\r\n            formData.append('institucion_id',         me.institucion_id)\r\n            formData.append('periodo_id',             me.periodo_id)\r\n            formData.append('user_created',           me.usuario.idusuario)\r\n            //formData.append('old_values',           JSON.stringify(me.codigosEdit))\r\n            formData.append('venta_estado',           me.codigo.venta_estado)\r\n            formData.append('venta_estado',           me.codigo.venta_estado)\r\n            formData.append('venta_lista_institucion',me.codigo.venta_lista_institucion)\r\n            //parametros reset\r\n            formData.append('chkIdusuario',                 me.chkIdusuario                     ? '1' : '0')\r\n            formData.append('chkContrato',                  me.chkContrato                      ? '1' : '0')\r\n            formData.append('chkId_periodo',                me.chkId_periodo                    ? '1' : '0')\r\n            formData.append('chkEstado_liquidacion',        me.chkEstado_liquidacion            ? '1' : '0')\r\n            formData.append('chkBc_estado',                 me.chkBc_estado                     ? '1' : '0')\r\n            formData.append('chkBc_Codigos_barras',         me.chkBc_Codigos_barras             ? '1' : '0')\r\n            formData.append('chkBc_Bc_institucion',         me.chkBc_Bc_institucion             ? '1' : '0')\r\n            formData.append('chkBc_Bc_periodo',             me.chkBc_Bc_periodo                 ? '1' : '0')\r\n            formData.append('chkBc_Venta_lista_institucion',me.chkBc_Venta_lista_institucion    ? '1' : '0')\r\n            formData.append('chkBc_Venta_estado',           me.chkBc_Venta_estado               ? '1' : '0')\r\n            formData.append('chkBc_Verif1',                 me.chkBc_Verif1                     ? '1' : '0')\r\n            formData.append('chkBc_Verif2',                 me.chkBc_Verif2                     ? '1' : '0')\r\n            formData.append('chkBc_Verif3',                 me.chkBc_Verif3                     ? '1' : '0')\r\n            formData.append('chkBc_Verif4',                 me.chkBc_Verif4                     ? '1' : '0')\r\n            formData.append('chkBc_Verif5',                 me.chkBc_Verif5                     ? '1' : '0')\r\n            formData.append('chkBc_Verif6',                 me.chkBc_Verif6                     ? '1' : '0')\r\n            formData.append('chkBc_Verif7',                 me.chkBc_Verif7                     ? '1' : '0')\r\n            formData.append('chkBc_Verif8',                 me.chkBc_Verif8                     ? '1' : '0')\r\n            formData.append('chkBc_Verif9',                 me.chkBc_Verif9                     ? '1' : '0')\r\n            formData.append('chkBc_Verif10',                me.chkBc_Verif10                    ? '1' : '0')\r\n            //fin variables parametros\r\n            this.$http.post(this.$server_url+'guardarCodigoParametros', formData)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    if(res.data.status == '3'){\r\n                        me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                        })\r\n                        return\r\n                    }\r\n                    me.codigosPerdidos    = true\r\n                    me.porcentaje         = res.data.contador\r\n                    me.$vs.notify({\r\n                        text: \"Se proceso correctamente\",\r\n                        color: 'primary',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    me.codigoTipo = 100\r\n                    me.getTipoVenta()\r\n              })\r\n              .catch(function (error) {me.$vs.loading.close()})\r\n        },\r\n        filtroTipo(){\r\n            let me = this;\r\n            let datos = me.informacion\r\n            me.arregloChangeCodigos = []\r\n            //para ver los codigos regalados\r\n            if(me.codigoTipo == 4){\r\n                me.tipo = 'regalado';\r\n                let primerFiltro = datos.filter(p => p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null);\r\n                me.tmpinformacion = primerFiltro.filter(p => p.estado_liquidacion =='2')\r\n                me.setArray()\r\n                return\r\n            }\r\n            //para ver los codigos liquidados\r\n            if(me.codigoTipo == 5){\r\n                me.tipo = 'liquidados';\r\n                let primerFiltro = datos.filter(p => p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null);\r\n                me.tmpinformacion = primerFiltro.filter(p => p.estado_liquidacion =='0')\r\n                me.setArray()\r\n                return\r\n            }\r\n            //para ver los codigos devueltos\r\n            if(me.codigoTipo == 7){\r\n                me.tipo = 'devueltos';\r\n                let primerFiltro = datos.filter(p => p.estado_liquidacion == '3');\r\n                me.tmpinformacion = primerFiltro\r\n                me.setArray()\r\n                return\r\n            }\r\n            //para ver los codigos leidos\r\n            if(me.codigoTipo == 8){\r\n                me.tipo = 'leidos';\r\n                let primerFiltro = datos.filter(p => (p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null) && (p.estado_liquidacion == 1));\r\n                me.tmpinformacion = primerFiltro.filter(p => p.bc_estado =='2')\r\n                me.setArray()\r\n                return\r\n            }\r\n             //para ver los codigos no leidos\r\n            if(me.codigoTipo == 9){\r\n                me.tipo = 'no_leidos';\r\n                let primerFiltro = datos.filter(p => (p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null) && (p.estado_liquidacion == 1));\r\n                me.tmpinformacion = primerFiltro.filter(p => p.bc_estado =='1')\r\n                me.setArray()\r\n                return\r\n            }\r\n            //para ver todos los codigos\r\n            else{\r\n                me.tipo = 'todos';\r\n                me.tmpinformacion = datos\r\n                me.setArray()\r\n            }\r\n        },\r\n        getTipoVenta(tr) {\r\n        let me = this;\r\n        me.informacion = []\r\n        me.tmpinformacion = []\r\n        me.arregloChangeCodigos = []\r\n        me.$vs.loading();\r\n        this.$http.get(this.$server_url+'getTipoVenta?institucion_id='+me.institucion_id+'&periodo_id='+me.periodo_id)\r\n            .then(function (res) {\r\n            me.$vs.loading.close()\r\n            me.informacion = res.data\r\n            me.tmpinformacion = res.data\r\n            })\r\n            .catch(function (error) {\r\n            console.log(error + ' error');\r\n            me.$vs.loading.close()\r\n            })\r\n        },\r\n        setArray(){\r\n            let me = this\r\n            me.arregloChangeCodigos = []\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url+'traerCodigosParametros?institucion_id='+me.institucion_id+'&periodo_id='+me.periodo_id+'&tipo='+me.tipo)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    me.arregloChangeCodigos = res.data\r\n                    if(me.tmpinformacion.length > 1999){\r\n                        me.popupLimit = true\r\n                        me.$vs.notify({\r\n                        text:'Va a cambiar '+me.tmpinformacion.length+' códigos '+'Se procedera a cambiar '+me.arregloChangeCodigos.length+' códigos primeramente',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check',\r\n                        time:8000\r\n                        })\r\n                    }else{\r\n                        me.$vs.notify({\r\n                        text:'Va a cambiar '+me.arregloChangeCodigos.length+' códigos ',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check',\r\n                        time:8000\r\n                        })\r\n                    }\r\n                    me.SimplicarArray()\r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.loading.close()\r\n                    console.log(error + ' error');\r\n                })\r\n        },\r\n        SimplicarArray(){\r\n            let me = this;\r\n            me.arregloCodigosEnviar = []\r\n            let p = new Promise(function(resolve,reject){\r\n                if(me.arregloChangeCodigos.length){\r\n                    resolve(me.arregloChangeCodigos)\r\n                }else{\r\n                    reject('No hay codigos en esa institucion')\r\n                }\r\n            });\r\n            p.then((res) => {\r\n                let datos = res\r\n                datos.forEach(element => {\r\n                    var cal = new Object();\r\n                    cal.codigo = element.codigo\r\n                    me.arregloCodigosEnviar.push(cal)\r\n                    console.log(\"cantidad\",me.arregloCodigosEnviar.length)\r\n                });\r\n            }).catch((e) => {\r\n                console.log(e)\r\n            })\r\n        },\r\n        limpiar(){\r\n            let me = this\r\n            me.codigo.idusuario=0\r\n            me.codigo.contrato=''\r\n            me.codigo.id_periodo=''\r\n            me.codigo.estado_liquidacion=1\r\n            me.codigo.bc_estado=1\r\n            me.codigo.codigos_barras=1\r\n            me.codigo.bc_institucion=0\r\n            me.codigo.bc_periodo=0\r\n            me.codigo.venta_estado=0\r\n            me.codigo.venta_lista_institucion=0\r\n            me.codigo.estado=0\r\n            me.codigo.verif1=''\r\n            me.codigo.verif2=''\r\n            me.codigo.verif3=''\r\n            me.codigo.verif4=''\r\n            me.codigo.verif5=''\r\n            me.codigo.verif6=''\r\n            me.codigo.verif7=''\r\n            me.codigo.verif8=''\r\n            me.codigo.verif9=''\r\n            me.codigo.verif10=''\r\n            //variables para la consulta\r\n            me.chkIdusuario                  = false\r\n            me.chkContrato                   = false\r\n            me.chkId_periodo                 = false\r\n            me.chkEstado_liquidacion         = false\r\n            me.chkBc_estado                  = false\r\n            me.chkBc_Codigos_barras          = false\r\n            me.chkBc_Bc_institucion          = false\r\n            me.chkBc_Bc_periodo              = false\r\n            me.chkBc_Venta_lista_institucion = false\r\n            me.chkBc_Venta_estado            = false\r\n            me.chkBc_Verif1                  = false\r\n            me.chkBc_Verif2                  = false\r\n            me.chkBc_Verif3                  = false\r\n            me.chkBc_Verif4                  = false\r\n            me.chkBc_Verif5                  = false\r\n            me.chkBc_Verif6                  = false\r\n            me.chkBc_Verif7                  = false\r\n            me.chkBc_Verif8                  = false\r\n            me.chkBc_Verif9                  = false\r\n            me.chkBc_Verif10                 = false\r\n            me.chkBc_Estado                  = false\r\n            me.codigoTipo                    = 100\r\n            //fin variables para la consulta\r\n        },\r\n    },\r\n}\r\n",{"version":3,"sources":["ResetearCampos.vue"],"names":[],"mappings":";AAgPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ResetearCampos.vue","sourceRoot":"src/views/codigos/components","sourcesContent":["<template>\r\n    <vx-card\r\n    title = \"Cambiar valores por parámetros de los códigos\"\r\n    title-color =\"primary\"\r\n    subtitle = \"Seleccione una institución y realize el cambios de los códigos (Máximo 2000)\"\r\n    >\r\n    <vs-alert color=\"warning\" style=\"height: 80px;\">\r\n        <p class=\"font-bold\">*Seleccione una institución y seleccione un radio button</p>\r\n        <p class=\"font-bold\">*Los checkbox que han sido seleccionados modificarán a todos los codigos seleccionados del radio button escogido</p>\r\n    </vs-alert>\r\n    <!-- <pre>{{ arregloChangeCodigos }}</pre> -->\r\n        <vs-divider color=\"primary\">Institucion seleccionada: {{ nombreInstitucion }}</vs-divider>\r\n        <vs-row v-if=\"codigosPerdidos == true\">\r\n          <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n            <vs-alert active=\"true\">\r\n                Se realizo el cambio de  {{ porcentaje }} códigos\r\n            </vs-alert>\r\n          </vs-col>\r\n        </vs-row>\r\n        <div>\r\n            <TableSelectInstitucion @change=\"changeHandle\"/>\r\n        </div>\r\n        <div v-if=\"nombreInstitucion.length > 1\">\r\n            <vs-collapse style=\"margin-left: -20px;margin-top: -60px;\">\r\n                <vs-collapse-item>\r\n                    <div slot=\"header\">\r\n                        <vs-list-header icon=\"supervisor_account\" :title=\"'Resultado '+ tmpinformacion.length+' códigos'\"></vs-list-header>\r\n                    </div>\r\n                    <div class=\"mt-5\">\r\n                        <ul style=\"display:flex;flex-wrap: wrap;\">\r\n                            <li>\r\n                                <vs-radio v-model=\"codigoTipo\" vs-name=\"radios1codigoTipo\" @input=\"filtroTipo();\" vs-value=\"0\"><span class=\"font-bold\">{{sumaTotal}}</span> Todos</vs-radio>\r\n                            </li>\r\n                            <li class=\"ml-2\">\r\n                                <vs-radio v-model=\"codigoTipo\" vs-name=\"radios1codigoTipo\"  @input=\"filtroTipo();\" vs-value=\"4\"><span style=\"font-weight:bold;\">{{sumaCodigosRegalados}}</span> Códigos Regalados </vs-radio>\r\n                            </li>\r\n                            <li class=\"ml-2\">\r\n                                <vs-radio v-model=\"codigoTipo\" vs-name=\"radios1codigoTipo\"  @input=\"filtroTipo();\" vs-value=\"5\"><span style=\"font-weight:bold;\">{{sumarCodigosLiquidados}}</span> Códigos Liquidados </vs-radio>\r\n                            </li>\r\n                            <li class=\"ml-2\">\r\n                                <vs-radio v-model=\"codigoTipo\" vs-name=\"radios1codigoTipo\"  @input=\"filtroTipo();\" vs-value=\"7\"><span style=\"font-weight:bold;\">{{SumaCodigosDevolucion}}</span> Códigos devueltos</vs-radio>\r\n                            </li>\r\n                            <li class=\"ml-2\">\r\n                                <vs-radio v-model=\"codigoTipo\" vs-name=\"radios1codigoTipo\" @input=\"filtroTipo();\" vs-value=\"8\"><span style=\"font-weight:bold;\">{{sumarCodigosLeidos}}</span> Códigos leidos (No liquidados) </vs-radio>\r\n                            </li>\r\n                            <li class=\"ml-2\">\r\n                                <vs-radio v-model=\"codigoTipo\" vs-name=\"radios1codigoTipo\" @input=\"filtroTipo();\" vs-value=\"9\"><span style=\"font-weight:bold;\">{{sumarCodigosNoleidos}}</span> Códigos sin leer </vs-radio>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                    <gestionCodigosLista :arregloCodigos=\"tmpinformacion\" style=\"width: 100%!important;\"/>\r\n                </vs-collapse-item>\r\n            </vs-collapse>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-2 flex\">\r\n                <vs-input class=\"w-full\" icon=\"person\" label=\"Id usuario\" v-model=\"codigo.idusuario\" />\r\n                <vs-checkbox style=\"margin-top: 25px;\" v-model=\"chkIdusuario\"></vs-checkbox>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-2 flex\">\r\n                <vs-input class=\"w-full\" icon=\"bookmark\" label=\"Contrato\" v-model=\"codigo.contrato\" />\r\n                <vs-checkbox style=\"margin-top: 25px;\" v-model=\"chkContrato\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row mt-4\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-2 flex\">\r\n                <vs-input class=\"w-full\" icon=\"swap_horiz\" label=\"Id Periodo\" v-model=\"codigo.id_periodo\" />\r\n                <vs-checkbox style=\"margin-top: 20px;\" v-model=\"chkId_periodo\"></vs-checkbox>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full flex\" style=\"justify-content: space-between;\">\r\n                <div class=\"mt-5\">\r\n                    <p class=\"ml-2\">Estado liquidacion</p>\r\n                    <ul class=\"flex mt-2 ml-2\">\r\n                    <li>\r\n                        <vs-radio v-model=\"codigo.estado_liquidacion\" vs-name=\"radiosestado_liquidacion\" vs-value=\"0\">Liquidado</vs-radio>\r\n                    </li>\r\n                    <li>\r\n                        <vs-radio v-model=\"codigo.estado_liquidacion\" class=\"ml-3\" vs-name=\"radiosestado_liquidacion\" vs-value=\"1\">Sin liquidar</vs-radio>\r\n                    </li>\r\n                    <li>\r\n                        <vs-radio class=\"ml-3\" v-model=\"codigo.estado_liquidacion\" vs-name=\"radiosestado_liquidacion\" vs-value=\"2\">Regalado</vs-radio>\r\n                    </li>\r\n                    <li>\r\n                        <vs-radio class=\"ml-3\" v-model=\"codigo.estado_liquidacion\" vs-name=\"radiosestado_liquidacion\" vs-value=\"3\">Devuelto</vs-radio>\r\n                    </li>\r\n                    </ul>\r\n                </div>\r\n                <vs-checkbox style=\"margin-top: 20px;\"  v-model=\"chkEstado_liquidacion\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row mt-5\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-2 flex\" style=\"justify-content: space-between;\">\r\n                <div>\r\n                    <p class=\"ml-2\">Bc_estado</p>\r\n                    <ul class=\"flex mt-2 ml-2\">\r\n                    <li>\r\n                        <vs-radio v-model=\"codigo.bc_estado\" vs-name=\"radiosEstado2bc_estado\" vs-value=\"1\">Sin leer</vs-radio>\r\n                    </li>\r\n                    <li>\r\n                        <vs-radio class=\"ml-3\" v-model=\"codigo.bc_estado\" vs-name=\"radiosEstado2bc_estado\" vs-value=\"2\">Leido</vs-radio>\r\n                    </li>\r\n                    </ul>\r\n                </div>\r\n                <vs-checkbox style=\"margin-top: 5px;\"  v-model=\"chkBc_estado\"></vs-checkbox>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-6 flex\" style=\"justify-content: space-between;\">\r\n                <div>\r\n                    <p class=\"ml-2\">Codigos de barras</p>\r\n                    <ul class=\"flex mt-2 ml-2\">\r\n                        <li>\r\n                            <vs-radio v-model=\"codigo.codigos_barras\" vs-name=\"radioscodigos_barras\" vs-value=\"1\">Si</vs-radio>\r\n                        </li>\r\n                        <li>\r\n                            <vs-radio class=\"ml-3\" v-model=\"codigo.codigos_barras\" vs-name=\"radioscodigos_barras\" vs-value=\"0\">No</vs-radio>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <vs-checkbox style=\"margin-top: 5px;\"  v-model=\"chkBc_Codigos_barras\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-2 flex\">\r\n                <vs-input class=\"w-full\" icon=\"swap_vert\" label=\"Bc_Institucion\" v-model=\"codigo.bc_institucion\" />\r\n                <vs-checkbox style=\"margin-top: 5px;\"  v-model=\"chkBc_Bc_institucion\"></vs-checkbox>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-6 flex\">\r\n                <vs-input class=\"w-full\" icon=\"swap_vert\" label=\"Bc_periodo\" v-model=\"codigo.bc_periodo\" />\r\n                <vs-checkbox style=\"margin-top: 15px;\"  v-model=\"chkBc_Bc_periodo\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-2 flex\">\r\n                <vs-input class=\"w-full\" icon=\"swap_vert\" label=\"venta_lista_institucion\" v-model=\"codigo.venta_lista_institucion\" />\r\n                <vs-checkbox style=\"margin-top: 5px;\"  v-model=\"chkBc_Venta_lista_institucion\"></vs-checkbox>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-6 flex\" style=\"justify-content: space-between;\">\r\n                <div>\r\n                    <p class=\"ml-2\">Venta estado</p>\r\n                    <ul class=\"flex mt-2 ml-2\">\r\n                        <li>\r\n                            <vs-radio v-model=\"codigo.venta_estado\" vs-name=\"radiosventa_estado\" vs-value=\"0\">Nada</vs-radio>\r\n                        </li>\r\n                        <li>\r\n                            <vs-radio class=\"ml-3\" v-model=\"codigo.venta_estado\" vs-name=\"radiosventa_estado\" vs-value=\"1\">Venta directa</vs-radio>\r\n                        </li>\r\n                        <li>\r\n                            <vs-radio class=\"ml-3\" v-model=\"codigo.venta_estado\" vs-name=\"radiosventa_estado\" vs-value=\"2\">Venta lista</vs-radio>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <vs-checkbox style=\"margin-top: 5px;\"  v-model=\"chkBc_Venta_estado\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-2 flex\">\r\n                <vs-input class=\"w-full\" icon=\"filter\" label=\"verif1\" v-model=\"codigo.verif1\" />\r\n                <vs-checkbox style=\"margin-top: 5px;\"  v-model=\"chkBc_Verif1\"></vs-checkbox>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-6 flex\">\r\n                <vs-input type=\"number\" class=\"w-full\" icon=\"filter\" label=\"verif2\" v-model=\"codigo.verif2\" />\r\n                <vs-checkbox style=\"margin-top: 20px;\"  v-model=\"chkBc_Verif2\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-2 flex\">\r\n                <vs-input class=\"w-full\" icon=\"filter\" label=\"verif3\" v-model=\"codigo.verif3\" />\r\n                <vs-checkbox style=\"margin-top: 15px;\"  v-model=\"chkBc_Verif3\"></vs-checkbox>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-0 flex\">\r\n                <vs-input type=\"number\" class=\"w-full\" icon=\"filter\" label=\"verif4\" v-model=\"codigo.verif4\" />\r\n                <vs-checkbox style=\"margin-top: 15px;\"  v-model=\"chkBc_Verif4\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-0 flex\">\r\n                <vs-input class=\"w-full\" icon=\"filter\" label=\"verif5\" v-model=\"codigo.verif5\" />\r\n                <vs-checkbox style=\"margin-top: 15px;\"  v-model=\"chkBc_Verif5\"></vs-checkbox>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-0 flex\">\r\n                <vs-input type=\"number\" class=\"w-full\" icon=\"filter\" label=\"verif6\" v-model=\"codigo.verif6\" />\r\n                <vs-checkbox style=\"margin-top: 15px;\"  v-model=\"chkBc_Verif6\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-2 flex\">\r\n                <vs-input class=\"w-full\" icon=\"filter\" label=\"verif7\" v-model=\"codigo.verif7\" />\r\n                <vs-checkbox style=\"margin-top: 5px;\"  v-model=\"chkBc_Verif7\"></vs-checkbox>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-6 flex\">\r\n                <vs-input type=\"number\" class=\"w-full\" icon=\"filter\" label=\"verif8\" v-model=\"codigo.verif8\" />\r\n                <vs-checkbox style=\"margin-top: 15px;\"  v-model=\"chkBc_Verif8\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-0 flex\">\r\n                <vs-input class=\"w-full\" icon=\"filter\" label=\"verif9\" v-model=\"codigo.verif9\" />\r\n                <vs-checkbox style=\"margin-top: 20px;\"  v-model=\"chkBc_Verif9\"></vs-checkbox>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-0 flex\">\r\n                <vs-input type=\"number\" class=\"w-full\" icon=\"filter\" label=\"verif10\" v-model=\"codigo.verif10\" />\r\n                <vs-checkbox style=\"margin-top: 15px;\"  v-model=\"chkBc_Verif10\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row mt-5\">\r\n            <div class=\"vx-col w-full mb-6 flex\">\r\n                <div>\r\n                    <ul class=\"flex\">\r\n                        <li>\r\n                            <vs-radio v-model=\"codigo.estado\" vs-name=\"radiosEstado2\" vs-value=\"0\">Activo</vs-radio>\r\n                        </li>\r\n                        <li>\r\n                            <vs-radio class=\"ml-3\" v-model=\"codigo.estado\" vs-name=\"radiosEstado2\" vs-value=\"2\">Bloqueado</vs-radio>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <vs-checkbox class=\"ml-5\" v-model=\"chkBc_Estado\"></vs-checkbox>\r\n            </div>\r\n        </div>\r\n        <div class=\"vx-row\">\r\n            <div class=\"vx-col w-full flex\">\r\n                <vs-button class=\"mr-3 mb-2\" icon=\"save\" @click=\"openConfirmar()\">Realizar cambios</vs-button>\r\n                <vs-button color=\"danger\" class=\"mb-2\" @click=\"limpiar()\" type=\"border\">Resetear</vs-button>\r\n            </div>\r\n        </div>\r\n        <!--MODAL PARA CONFIRMAR-->\r\n        <vs-popup class=\"holamundo\"  title=\"Confirmar\" :active.sync=\"popupConfirmar\">\r\n        <p class=\"text-center\">\r\n            Estas seguro de querer cambiar <b>{{ arregloChangeCodigos.length }}</b> códigos?\r\n        </p>\r\n        <div class=\"flex mt-5 justify-center\">\r\n            <vs-button type=\"gradient\" @click=\"popupConfirmar = false;guardarCodigo();\">Si, deseo cambiar</vs-button>\r\n            <vs-button color=\"danger\"  @click=\"popupConfirmar = false;\" class=\"ml-2\" type=\"border\">Cancelar</vs-button>\r\n        </div>\r\n        </vs-popup>\r\n        <vs-popup fullscreen title=\"Estos 2000 códigos se van a cambiar\" :active.sync=\"popupLimit\">\r\n            <gestionCodigosLista :arregloCodigos=\"arregloChangeCodigos\" style=\"width: 100%!important;\"/>\r\n        </vs-popup>\r\n    </vx-card>\r\n</template>\r\n<script>\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport vSelect from 'vue-select'\r\nimport TableSelectInstitucion from '../../usuarios/GestionEstudiantes/components/TableSelectInstitucion.vue';\r\nimport gestionCodigosLista from './utils/gestionCodigosLista.vue';\r\nexport default {\r\n    data() {\r\n       return{\r\n            usuario:[],\r\n            codigo:{\r\n                libro:'',\r\n                idusuario:0,\r\n                contrato:'',\r\n                id_periodo:'',\r\n                estado_liquidacion:1,\r\n                bc_estado:1,\r\n                codigos_barras:1,\r\n                bc_institucion:0,\r\n                bc_periodo:0,\r\n                venta_estado:0,\r\n                venta_lista_institucion:0,\r\n                contador:1,\r\n                estado:0,\r\n                verif1:'',\r\n                verif2:'',\r\n                verif3:'',\r\n                verif4:'',\r\n                verif5:'',\r\n                verif6:'',\r\n                verif7:'',\r\n                verif8:'',\r\n                verif9:'',\r\n                verif10:'',\r\n                bc_fecha_ingreso: null,\r\n            },\r\n            nombreInstitucion:'',\r\n            institucion_id:0,\r\n            error:false,\r\n            statusPeriodo:0,\r\n            periodo_id:0,\r\n            //variables para la consulta\r\n            chkIdusuario:false,\r\n            chkContrato:false,\r\n            chkId_periodo:false,\r\n            chkEstado_liquidacion:false,\r\n            chkBc_estado:false,\r\n            chkBc_Codigos_barras:false,\r\n            chkBc_Bc_institucion:false,\r\n            chkBc_Bc_periodo:false,\r\n            chkBc_Venta_lista_institucion:false,\r\n            chkBc_Venta_estado:false,\r\n            chkBc_Verif1:false,\r\n            chkBc_Verif2:false,\r\n            chkBc_Verif3:false,\r\n            chkBc_Verif4:false,\r\n            chkBc_Verif5:false,\r\n            chkBc_Verif6:false,\r\n            chkBc_Verif7:false,\r\n            chkBc_Verif8:false,\r\n            chkBc_Verif9:false,\r\n            chkBc_Verif10:false,\r\n            chkBc_Estado:false,\r\n            //fin variables para la consulta\r\n            informacion:[],\r\n            tmpinformacion:[],\r\n            arregloChangeCodigos:[],\r\n            arregloCodigosEnviar:[],\r\n            codigosPerdidos:false,\r\n            popupConfirmar:false,\r\n            popupLimit:false,\r\n            porcentaje:0,\r\n            codigoTipo:100,\r\n            tipo:'',\r\n       }\r\n    },\r\n    created(){\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem(\"usuario\"));\r\n    },\r\n    mounted(){\r\n        let me = this;\r\n    },\r\n    components: {\r\n        'v-select': vSelect,\r\n        flatPickr,\r\n        TableSelectInstitucion,\r\n        gestionCodigosLista\r\n    },\r\n    computed:{\r\n        sumaTotal(){\r\n            let me = this;\r\n            let total = me.informacion.length\r\n            return total\r\n        },\r\n        sumaCodigosRegalados(){\r\n            let me = this;\r\n            let primerFiltro = me.informacion.filter(p => p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null);\r\n            let datos        = primerFiltro.filter(p => p.estado_liquidacion =='2')\r\n            let resultado    = datos.length\r\n            return resultado\r\n        },\r\n        sumarCodigosLiquidados(){\r\n            let me = this;\r\n            let primerFiltro = me.informacion.filter(p => p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null);\r\n            let datos        = primerFiltro.filter(p => p.estado_liquidacion =='0')\r\n            let resultado    = datos.length\r\n            return resultado\r\n        },\r\n        SumaCodigosDevolucion(){\r\n            let me = this;\r\n            let datos       = me.informacion.filter(p => p.estado_liquidacion == '3');\r\n            let resultado   = datos.length\r\n            return resultado\r\n        },\r\n        sumarCodigosLeidos(){\r\n            let me = this;\r\n            let primerFiltro = me.informacion.filter(p => (p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null) && (p.estado_liquidacion == 1));\r\n            let datos        = primerFiltro.filter(p => p.bc_estado =='2')\r\n            let resultado    = datos.length\r\n            return resultado\r\n        },\r\n        sumarCodigosNoleidos(){\r\n            let me = this;\r\n            let primerFiltro = me.informacion.filter(p => (p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null) && (p.estado_liquidacion == 1));\r\n            let datos        = primerFiltro.filter(p => p.bc_estado =='1')\r\n            let resultado    = datos.length\r\n            return resultado\r\n        }\r\n    },\r\n    watch:{\r\n        institucion_id(results){\r\n            let me = this\r\n            if(results > 0){\r\n                me.informacion = []\r\n                me.tmpinformacion = []\r\n                me.arregloChangeCodigos = []\r\n                me.getTipoVenta()\r\n            }else{\r\n                me.informacion = []\r\n                me.tmpinformacion = []\r\n                me.arregloChangeCodigos = []\r\n            }\r\n        }\r\n    },\r\n    methods:{\r\n        changeHandle(e){\r\n            let me = this\r\n            let valor = e.change\r\n            if(valor == 'institucion')       me.institucion_id   = e.value\r\n            if(valor == 'noPeriodo')         me.error            = e.value\r\n            if(valor == 'periodo')           me.statusPeriodo    = e.value\r\n            if(valor == 'periodo_id')        me.periodo_id           = e.value\r\n            if(valor == 'nombreInstitucion') me.nombreInstitucion = e.value\r\n            me.codigosPerdidos = false\r\n            me.porcentaje      = 0\r\n        },\r\n        openConfirmar(){\r\n            let me = this;\r\n              //VALIDACION\r\n            if(me.arregloChangeCodigos.length == 0){\r\n                me.$vs.notify({\r\n                text:'No hay códigos para cambiar',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false;\r\n            }\r\n            if(me.codigoTipo == 100){\r\n                me.$vs.notify({\r\n                text:'Seleccione la cantidad de códigos que se va cambiar',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false;\r\n            }\r\n            if(me.error){\r\n                me.$vs.notify({\r\n                text:'La institución no tiene período',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false;\r\n            }\r\n            if(me.institucion_id <= 0){\r\n                me.$vs.notify({\r\n                text:'Seleccione una institución por favor',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false\r\n            }\r\n            if(me.statusPeriodo == 0){\r\n                me.$vs.notify({\r\n                text:'La institución tiene período inactivo, consulte con el administrador por favor',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false\r\n            }\r\n            //FIN VALIDACION\r\n            me.popupConfirmar = true\r\n        },\r\n        guardarCodigo(){\r\n            let me = this;\r\n            let formData = new FormData();\r\n            me.$vs.loading();\r\n            formData.append('data_codigos',           JSON.stringify(me.arregloCodigosEnviar))\r\n            formData.append('idusuario',              me.codigo.idusuario)\r\n            formData.append('estado',                 me.codigo.estado)\r\n            formData.append('contrato',               me.codigo.contrato)\r\n            formData.append('id_periodo',             me.codigo.id_periodo)\r\n            formData.append('verif1',                 me.codigo.verif1 == 'null' ? '': me.codigo.verif1 )\r\n            formData.append('verif2',                 me.codigo.verif2 == 'null' ? '': me.codigo.verif2 )\r\n            formData.append('verif3',                 me.codigo.verif3 == 'null' ? '': me.codigo.verif3 )\r\n            formData.append('verif4',                 me.codigo.verif4 == 'null' ? '': me.codigo.verif4 )\r\n            formData.append('verif5',                 me.codigo.verif5 == 'null' ? '': me.codigo.verif5 )\r\n            formData.append('verif6',                 me.codigo.verif6 == 'null' ? '': me.codigo.verif6 )\r\n            formData.append('verif7',                 me.codigo.verif7 == 'null' ? '': me.codigo.verif7 )\r\n            formData.append('verif8',                 me.codigo.verif8 == 'null' ? '': me.codigo.verif8 )\r\n            formData.append('verif9',                 me.codigo.verif9 == 'null' ? '': me.codigo.verif9 )\r\n            formData.append('verif10',                me.codigo.verif10 == 'null' ? '': me.codigo.verif10 )\r\n            formData.append('estado_liquidacion',     me.codigo.estado_liquidacion)\r\n            formData.append('bc_estado',              me.codigo.bc_estado)\r\n            formData.append('codigos_barras',         me.codigo.codigos_barras)\r\n            formData.append('bc_institucion',         me.codigo.bc_institucion)\r\n            formData.append('bc_periodo',             me.codigo.bc_periodo)\r\n            //auditoria\r\n            formData.append('institucion_id',         me.institucion_id)\r\n            formData.append('periodo_id',             me.periodo_id)\r\n            formData.append('user_created',           me.usuario.idusuario)\r\n            //formData.append('old_values',           JSON.stringify(me.codigosEdit))\r\n            formData.append('venta_estado',           me.codigo.venta_estado)\r\n            formData.append('venta_estado',           me.codigo.venta_estado)\r\n            formData.append('venta_lista_institucion',me.codigo.venta_lista_institucion)\r\n            //parametros reset\r\n            formData.append('chkIdusuario',                 me.chkIdusuario                     ? '1' : '0')\r\n            formData.append('chkContrato',                  me.chkContrato                      ? '1' : '0')\r\n            formData.append('chkId_periodo',                me.chkId_periodo                    ? '1' : '0')\r\n            formData.append('chkEstado_liquidacion',        me.chkEstado_liquidacion            ? '1' : '0')\r\n            formData.append('chkBc_estado',                 me.chkBc_estado                     ? '1' : '0')\r\n            formData.append('chkBc_Codigos_barras',         me.chkBc_Codigos_barras             ? '1' : '0')\r\n            formData.append('chkBc_Bc_institucion',         me.chkBc_Bc_institucion             ? '1' : '0')\r\n            formData.append('chkBc_Bc_periodo',             me.chkBc_Bc_periodo                 ? '1' : '0')\r\n            formData.append('chkBc_Venta_lista_institucion',me.chkBc_Venta_lista_institucion    ? '1' : '0')\r\n            formData.append('chkBc_Venta_estado',           me.chkBc_Venta_estado               ? '1' : '0')\r\n            formData.append('chkBc_Verif1',                 me.chkBc_Verif1                     ? '1' : '0')\r\n            formData.append('chkBc_Verif2',                 me.chkBc_Verif2                     ? '1' : '0')\r\n            formData.append('chkBc_Verif3',                 me.chkBc_Verif3                     ? '1' : '0')\r\n            formData.append('chkBc_Verif4',                 me.chkBc_Verif4                     ? '1' : '0')\r\n            formData.append('chkBc_Verif5',                 me.chkBc_Verif5                     ? '1' : '0')\r\n            formData.append('chkBc_Verif6',                 me.chkBc_Verif6                     ? '1' : '0')\r\n            formData.append('chkBc_Verif7',                 me.chkBc_Verif7                     ? '1' : '0')\r\n            formData.append('chkBc_Verif8',                 me.chkBc_Verif8                     ? '1' : '0')\r\n            formData.append('chkBc_Verif9',                 me.chkBc_Verif9                     ? '1' : '0')\r\n            formData.append('chkBc_Verif10',                me.chkBc_Verif10                    ? '1' : '0')\r\n            //fin variables parametros\r\n            this.$http.post(this.$server_url+'guardarCodigoParametros', formData)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    if(res.data.status == '3'){\r\n                        me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                        })\r\n                        return\r\n                    }\r\n                    me.codigosPerdidos    = true\r\n                    me.porcentaje         = res.data.contador\r\n                    me.$vs.notify({\r\n                        text: \"Se proceso correctamente\",\r\n                        color: 'primary',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    me.codigoTipo = 100\r\n                    me.getTipoVenta()\r\n              })\r\n              .catch(function (error) {me.$vs.loading.close()})\r\n        },\r\n        filtroTipo(){\r\n            let me = this;\r\n            let datos = me.informacion\r\n            me.arregloChangeCodigos = []\r\n            //para ver los codigos regalados\r\n            if(me.codigoTipo == 4){\r\n                me.tipo = 'regalado';\r\n                let primerFiltro = datos.filter(p => p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null);\r\n                me.tmpinformacion = primerFiltro.filter(p => p.estado_liquidacion =='2')\r\n                me.setArray()\r\n                return\r\n            }\r\n            //para ver los codigos liquidados\r\n            if(me.codigoTipo == 5){\r\n                me.tipo = 'liquidados';\r\n                let primerFiltro = datos.filter(p => p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null);\r\n                me.tmpinformacion = primerFiltro.filter(p => p.estado_liquidacion =='0')\r\n                me.setArray()\r\n                return\r\n            }\r\n            //para ver los codigos devueltos\r\n            if(me.codigoTipo == 7){\r\n                me.tipo = 'devueltos';\r\n                let primerFiltro = datos.filter(p => p.estado_liquidacion == '3');\r\n                me.tmpinformacion = primerFiltro\r\n                me.setArray()\r\n                return\r\n            }\r\n            //para ver los codigos leidos\r\n            if(me.codigoTipo == 8){\r\n                me.tipo = 'leidos';\r\n                let primerFiltro = datos.filter(p => (p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null) && (p.estado_liquidacion == 1));\r\n                me.tmpinformacion = primerFiltro.filter(p => p.bc_estado =='2')\r\n                me.setArray()\r\n                return\r\n            }\r\n             //para ver los codigos no leidos\r\n            if(me.codigoTipo == 9){\r\n                me.tipo = 'no_leidos';\r\n                let primerFiltro = datos.filter(p => (p.estado == '1' ||  p.estado == '0' ||  p.estado == '' || p.estado == null) && (p.estado_liquidacion == 1));\r\n                me.tmpinformacion = primerFiltro.filter(p => p.bc_estado =='1')\r\n                me.setArray()\r\n                return\r\n            }\r\n            //para ver todos los codigos\r\n            else{\r\n                me.tipo = 'todos';\r\n                me.tmpinformacion = datos\r\n                me.setArray()\r\n            }\r\n        },\r\n        getTipoVenta(tr) {\r\n        let me = this;\r\n        me.informacion = []\r\n        me.tmpinformacion = []\r\n        me.arregloChangeCodigos = []\r\n        me.$vs.loading();\r\n        this.$http.get(this.$server_url+'getTipoVenta?institucion_id='+me.institucion_id+'&periodo_id='+me.periodo_id)\r\n            .then(function (res) {\r\n            me.$vs.loading.close()\r\n            me.informacion = res.data\r\n            me.tmpinformacion = res.data\r\n            })\r\n            .catch(function (error) {\r\n            console.log(error + ' error');\r\n            me.$vs.loading.close()\r\n            })\r\n        },\r\n        setArray(){\r\n            let me = this\r\n            me.arregloChangeCodigos = []\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url+'traerCodigosParametros?institucion_id='+me.institucion_id+'&periodo_id='+me.periodo_id+'&tipo='+me.tipo)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    me.arregloChangeCodigos = res.data\r\n                    if(me.tmpinformacion.length > 1999){\r\n                        me.popupLimit = true\r\n                        me.$vs.notify({\r\n                        text:'Va a cambiar '+me.tmpinformacion.length+' códigos '+'Se procedera a cambiar '+me.arregloChangeCodigos.length+' códigos primeramente',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check',\r\n                        time:8000\r\n                        })\r\n                    }else{\r\n                        me.$vs.notify({\r\n                        text:'Va a cambiar '+me.arregloChangeCodigos.length+' códigos ',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check',\r\n                        time:8000\r\n                        })\r\n                    }\r\n                    me.SimplicarArray()\r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.loading.close()\r\n                    console.log(error + ' error');\r\n                })\r\n        },\r\n        SimplicarArray(){\r\n            let me = this;\r\n            me.arregloCodigosEnviar = []\r\n            let p = new Promise(function(resolve,reject){\r\n                if(me.arregloChangeCodigos.length){\r\n                    resolve(me.arregloChangeCodigos)\r\n                }else{\r\n                    reject('No hay codigos en esa institucion')\r\n                }\r\n            });\r\n            p.then((res) => {\r\n                let datos = res\r\n                datos.forEach(element => {\r\n                    var cal = new Object();\r\n                    cal.codigo = element.codigo\r\n                    me.arregloCodigosEnviar.push(cal)\r\n                    console.log(\"cantidad\",me.arregloCodigosEnviar.length)\r\n                });\r\n            }).catch((e) => {\r\n                console.log(e)\r\n            })\r\n        },\r\n        limpiar(){\r\n            let me = this\r\n            me.codigo.idusuario=0\r\n            me.codigo.contrato=''\r\n            me.codigo.id_periodo=''\r\n            me.codigo.estado_liquidacion=1\r\n            me.codigo.bc_estado=1\r\n            me.codigo.codigos_barras=1\r\n            me.codigo.bc_institucion=0\r\n            me.codigo.bc_periodo=0\r\n            me.codigo.venta_estado=0\r\n            me.codigo.venta_lista_institucion=0\r\n            me.codigo.estado=0\r\n            me.codigo.verif1=''\r\n            me.codigo.verif2=''\r\n            me.codigo.verif3=''\r\n            me.codigo.verif4=''\r\n            me.codigo.verif5=''\r\n            me.codigo.verif6=''\r\n            me.codigo.verif7=''\r\n            me.codigo.verif8=''\r\n            me.codigo.verif9=''\r\n            me.codigo.verif10=''\r\n            //variables para la consulta\r\n            me.chkIdusuario                  = false\r\n            me.chkContrato                   = false\r\n            me.chkId_periodo                 = false\r\n            me.chkEstado_liquidacion         = false\r\n            me.chkBc_estado                  = false\r\n            me.chkBc_Codigos_barras          = false\r\n            me.chkBc_Bc_institucion          = false\r\n            me.chkBc_Bc_periodo              = false\r\n            me.chkBc_Venta_lista_institucion = false\r\n            me.chkBc_Venta_estado            = false\r\n            me.chkBc_Verif1                  = false\r\n            me.chkBc_Verif2                  = false\r\n            me.chkBc_Verif3                  = false\r\n            me.chkBc_Verif4                  = false\r\n            me.chkBc_Verif5                  = false\r\n            me.chkBc_Verif6                  = false\r\n            me.chkBc_Verif7                  = false\r\n            me.chkBc_Verif8                  = false\r\n            me.chkBc_Verif9                  = false\r\n            me.chkBc_Verif10                 = false\r\n            me.chkBc_Estado                  = false\r\n            me.codigoTipo                    = 100\r\n            //fin variables para la consulta\r\n        },\r\n    },\r\n}\r\n</script>\r\n"]}]}