{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\departamentos\\archivos.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\departamentos\\archivos.vue","mtime":1712682815719},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\n\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nVue.use(axios)\r\nimport vSelect from \"vue-select\";\r\nimport flatPickr from 'vue-flatpickr-component'\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport Datepicker from 'vuejs-datepicker';\r\nexport default {\r\ndata(){\r\n    return {\r\n      active:false,\r\n      activePrompt: false,\r\n      descripcion: '',\r\n      value1: '',\r\n      value2: '',\r\n      departamento: {},\r\n      departamentos: [],\r\n      nombre_file: '',\r\n      size_file: '',\r\n      subir_disabled: false,\r\n      nombre_valido: true,\r\n      archivo_seleccionado: [],\r\n      popupArchivo: false,\r\n      archivos_departamento: [],\r\n      departamento_selected: '',\r\n      usuario: [],\r\n      fecha_archivo: '',\r\n      configdateTimePicker: {\r\n          enableTime: true,\r\n          dateFormat: 'Y-m'\r\n      },\r\n      tipo_selected: '',\r\n      tipos_archivos: [\r\n        {id: '0', label: 'Todos'},\r\n        {id: '1', label: 'Excel'},\r\n        {id: '2', label: 'Word'},\r\n        {id: '3', label: 'Imágenes'},\r\n        {id: '4', label: 'Comprimidos'},\r\n        {id: '5', label: 'Videos'},\r\n        {id: '6', label: 'PDF'},\r\n        {id: '7', label: 'Otros'},\r\n      ],\r\n      archivo_eliminar: [],\r\n    }\r\n  },\r\n  components: {\r\n    'v-select': vSelect,\r\n    flatPickr,\r\n    Datepicker\r\n  },\r\n  mounted() {\r\n    this.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n    this.getDepartamentos()\r\n  },\r\n  methods:{\r\n    getDepartamentos(){\r\n      let me = this\r\n      this.$http.get(me.$server_url+'files_departamentos')\r\n      .then(res => {\r\n          me.departamentos = res.data\r\n          me.verArchivos(res.data[0].id_categoria)\r\n      })\r\n      .catch(function (error) {\r\n          console.log(error);\r\n      })\r\n    },\r\n    mostrarImg(file, img){\r\n        let me = this;\r\n        var archivo = document.getElementById(\"file1\").files[0];\r\n        me.archivo_seleccionado = archivo\r\n        me.nombre_file = archivo.name\r\n        me.size_file = (archivo.size / 1000000).toFixed(2)\r\n        if( me.size_file > 15 ){\r\n          me.subir_disabled = true\r\n        }\r\n        if ( !/^[a-zA-Z]*$/g.test(me.nombre_file) ) {\r\n            me.nombre_valido = true\r\n        }else{\r\n          me.nombre_valido = false\r\n          me.subir_disabled = true\r\n        }\r\n    },\r\n    guardarArchivo(){\r\n      let me = this\r\n\r\n      if( me.departamento ){\r\n        if( me.departamento.id_categoria){\r\n\r\n          me.$vs.loading()\r\n          // var fileArchivo = document.getElementById(\"file1\").files[0];\r\n\r\n          const formData = new FormData();\r\n          formData.append('id_departamento', me.departamento.id_categoria);\r\n          formData.append('nombre_archivo', me.archivo_seleccionado);\r\n          formData.append('id_usuario', me.usuario.idusuario);\r\n          axios.post(this.$data_url+'api/files_departamentos_save', formData)\r\n          .then(res => {\r\n              me.$vs.loading.close()\r\n              me.verArchivos(me.departamento_selected)\r\n              me.$vs.notify({\r\n              text:'Archivo subido exitosamente.',\r\n              color:'success',\r\n              iconPack: 'feather',\r\n              icon:'icon-check'})\r\n          })\r\n          .catch(function (error) {\r\n              me.$vs.loading.close()\r\n              console.log(error + ': error al crear archivo_seleccionado');\r\n          })\r\n\r\n        }else{\r\n          this.$vs.notify({\r\n              color: 'warning',\r\n              title: 'Seleccione un departamento antes de subir su archivo.',\r\n          })\r\n        }\r\n      }else{\r\n        this.$vs.notify({\r\n            color: 'warning',\r\n            title: 'Seleccione un departamento antes de subir su archivo.',\r\n        })\r\n      }\r\n\r\n    },\r\n    verArchivos(id_categoria){\r\n      let me = this\r\n      me.nombre_file = ''\r\n      me.departamento_selected = id_categoria\r\n      me.$vs.loading()\r\n      this.$http.get(me.$server_url+'ver_archivos_departamento/'+id_categoria)\r\n      .then(res => {\r\n          me.archivos_departamento = res.data\r\n          me.$vs.loading.close()\r\n          me.popupArchivo = false\r\n      })\r\n      .catch(function (error) {\r\n          me.$vs.loading.close()\r\n          console.log(error);\r\n      })\r\n    },\r\n    archivos_filtro(){\r\n      let me = this\r\n      me.$vs.loading()\r\n\r\n      let mes = ''\r\n      let mes_filtro  = ''\r\n      if( me.fecha_archivo ){\r\n        mes = (me.fecha_archivo.getMonth()+1).toString()\r\n        if( mes.length == 1 ){ mes = ('0' + mes) }\r\n        mes_filtro = me.fecha_archivo.getFullYear()  + \"-\" + mes\r\n      }\r\n\r\n\r\n\r\n      var fecha = 'null'\r\n      var tipo = 'null'\r\n      if( mes_filtro ){fecha = mes_filtro}\r\n      if( me.tipo_selected ){if( me.tipo_selected.id ){tipo = me.tipo_selected.id}}\r\n\r\n      this.$http.get(me.$server_url+'archivos_departamento_filtro/'+me.departamento_selected+'/'+fecha+'/'+tipo)\r\n      .then(res => {\r\n          me.archivos_departamento = res.data\r\n          me.$vs.loading.close()\r\n          me.popupArchivo = false\r\n      })\r\n      .catch(function (error) {\r\n          me.$vs.loading.close()\r\n          console.log(error);\r\n      })\r\n    },\r\n    confirm_eliminar_archivo(){\r\n      this.$vs.dialog({\r\n        type: 'confirm',\r\n        color: 'danger',\r\n        title: `Confirmar`,\r\n        text: '¿Está seguro de eliminar este archivo?',\r\n        accept: this.eliminar_archivo\r\n      })\r\n    },\r\n    eliminar_archivo(){\r\n      let me = this\r\n\r\n      const formData = new FormData();\r\n      formData.append('id_usuario', me.usuario.idusuario);\r\n      formData.append('nombre_archivo', me.archivo_eliminar.nombre_archivo);\r\n      formData.append('id_archivo', me.archivo_eliminar.id_archivo);\r\n\r\n      this.$http.post(me.$server_url+'remover_archivo', formData)\r\n      .then(res => {\r\n          me.verArchivos(me.departamento_selected)\r\n          me.$vs.loading.close()\r\n      })\r\n      .catch(function (error) {\r\n          me.$vs.loading.close()\r\n          console.log(error);\r\n      })\r\n    },\r\n    visualizar_archivo(item){\r\n      let me = this\r\n\r\n      if (item.nombre_archivo.substr(-3) == \"pdf\" || item.nombre_archivo.substr(-3) == \"png\" || item.nombre_archivo.substr(-3) == \"jpg\") {\r\n          window.open(this.$data_url+'archivos/departamentos/' + item.nombre_archivo, '_blank');\r\n      } else if ( item.nombre_archivo.substr(-3) == \"doc\" || item.nombre_archivo.substr(-3) == \"ocx\" || item.nombre_archivo.substr(-3) == \"xls\" || item.nombre_archivo.substr(-3) == \"lsx\" ) {\r\n          window.open('https://view.officeapps.live.com/op/embed.aspx?src='+this.$data_url+'archivos/departamentos/' + item.nombre_archivo, '_blank');\r\n      }\r\n\r\n    },\r\n    descargar_archivo(item){\r\n      let me = this\r\n\r\n      window.open(this.$data_url+'archivos/departamentos/' + item.nombre_archivo, '_blank');\r\n\r\n    },\r\n  }\r\n}\r\n",{"version":3,"sources":["archivos.vue"],"names":[],"mappings":";;AA4HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA","file":"archivos.vue","sourceRoot":"src/views/departamentos","sourcesContent":["<template>\r\n<div>\r\n\r\n  <vs-popup title=\"Agregar un archivo\" :active.sync=\"popupArchivo\">\r\n\r\n    <span style=\"top: -10px; position: relative; margin-right: 10px;\">Elija un departamento:</span>\r\n    <v-select style=\"display: inline-block; width: 300px;\" class=\"mb-4\" :options=\"departamentos\" :reduce=\"departamentos => departamentos\" label=\"nombre_categoria\" v-model=\"departamento\"></v-select>\r\n\r\n    <div class=\"vx-row mb-6\">\r\n\r\n      <div class=\"vx-col w-full\">\r\n        <div class=\"content_archivos content_subir\" align=\"center\">\r\n\r\n            <div v-if=\"nombre_file\" class=\"w-full mb-4\">\r\n\r\n              <vs-button radius color=\"danger\" size=\"large\" type=\"filled\" icon-pack=\"feather\" icon=\"icon-trash\" class=\"m-3 float-right\" style=\"margin-bottom: -100px;\" @click=\"nombre_file = ''\"></vs-button>\r\n\r\n              <vs-button radius color=\"success\" :disabled=\"subir_disabled\" size=\"large\" type=\"filled\" icon-pack=\"feather\" icon=\"icon-upload\" class=\"m-3 float-right\" style=\"margin-bottom: -100px;\" @click=\"guardarArchivo\"></vs-button>\r\n\r\n              <img v-if=\"nombre_file.split('.')[1] == 'xls' || nombre_file.split('.')[1] == 'xlsx'\" src=\"../../assets/images/departamentos/excel_ico.png\" class=\"img_selected\">\r\n              <img v-else-if=\"nombre_file.split('.')[1] == 'pdf'\" src=\"../../assets/images/departamentos/pdf_ico.png\" class=\"img_selected\">\r\n              <img v-else-if=\"nombre_file.split('.')[1] == 'png' || nombre_file.split('.')[1] == 'jpg'\" src=\"../../assets/images/departamentos/img_ico.png\" class=\"img_selected\">\r\n              <img v-else-if=\"nombre_file.split('.')[1] == 'mp4' || nombre_file.split('.')[1] == 'mpeg' || nombre_file.split('.')[1] == 'mov' || nombre_file.split('.')[1] == 'wmv'\" src=\"../../assets/images/departamentos/img_ico.png\" class=\"video_selected\">\r\n              <img v-else-if=\"nombre_file.split('.')[1] == 'rar' || nombre_file.split('.')[1] == 'zip'\" src=\"../../assets/images/departamentos/zip_ico.png\" class=\"img_selected\">\r\n              <img v-else src=\"../../assets/images/departamentos/file_ico.png\" class=\"img_selected\">\r\n\r\n              <b>Nombre archivo:</b> {{nombre_file}} <br>\r\n              <b>Tamaño:</b> <span v-if=\"size_file>0\">{{size_file}}</span><span v-else>0.01</span> <span v-if=\"size_file < 1\">KB</span><span v-else>MB</span> <br>\r\n\r\n              <div style=\"color: red; padding-top: 10px;\"><b v-if=\"size_file > 25\">No puede subir archivos que excedan los 25 MB</b></div>\r\n              <div style=\"color: red; padding-top: 10px;\"><b v-if=\"nombre_valido === false \">El nombre del archivo no es válido, solo se aceptan letras, números y/o guiónes. Renombre el archivo y vuelva a subirlo</b></div>\r\n\r\n            </div>\r\n\r\n            <div v-else class=\"w-full text-center\">\r\n              <input type=\"file\" name=\"file1\" id=\"file1\" class=\"inputfile\" style=\"display: none;\" v-on:change=\"mostrarImg(1,1)\">\r\n              <label for=\"file1\" style=\"cursor: pointer; color: gray; font-size: 12px;\">\r\n                Click aquí para subir archivo\r\n              </label>\r\n            </div>\r\n\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </vs-popup>\r\n\r\n\r\n  <div class=\"vx-row mb-6\">\r\n\r\n    <div class=\"vx-col sm:w-1/4 w-full\">\r\n      <vx-card>\r\n\r\n        <vs-list>\r\n          <vs-list-header title=\"Departamentos\" color=\"primary\"></vs-list-header>\r\n\r\n          <vs-list-item :key=\"index\" v-for=\"(item, index) in departamentos\"  style=\"cursor: pointer;\">\r\n            <template slot=\"avatar\">\r\n              <img src=\"../../assets/images/departamentos/folder_ico.png\" style=\"width: 30px; transition: 0.3s;\" class=\"m-4 folder_list\" @click=\"departamento = item; verArchivos(item.id_categoria); fecha_archivo = ''; tipo_selected = '';\">\r\n              <p @click=\"departamento = item; verArchivos(item.id_categoria); fecha_archivo = ''; tipo_selected = '';\">\r\n                {{ item.nombre_categoria }}\r\n              </p>\r\n            </template>\r\n          </vs-list-item>\r\n        </vs-list>\r\n\r\n      </vx-card>\r\n    </div>\r\n\r\n    <div class=\"vx-col sm:w-3/4 w-full\">\r\n      <vx-card>\r\n\r\n        <vs-table stripe pagination max-items=\"10\" search :data=\"archivos_departamento\">\r\n        <template slot=\"header\">\r\n\r\n            <vs-button style=\"font-size: 14px;\" icon-pack=\"feather\" icon=\"icon-plus\" icon-after color=\"dark\" class=\"mr-3\" type=\"border\" @click=\"popupArchivo = true;  fecha_archivo = ''; tipo_selected = '';\">Agregar</vs-button>\r\n\r\n            <datepicker style=\"width: 120px;\" class=\"mr-3\" :minimumView=\"'month'\" :maximumView=\"'year'\"  v-model=\"fecha_archivo\" placeholder=\"Filtro por fecha\" @input=\"archivos_filtro\"></datepicker>\r\n\r\n            <!-- <flat-pickr style=\"width: 120px;\" class=\"mr-3\" :config=\"configdateTimePicker\" v-model=\"fecha_archivo\" placeholder=\"Filtro por fecha\" @input=\"archivos_filtro\"/> -->\r\n\r\n            <v-select style=\"width: 170px;\" placeholder=\"Tipo de archivo\" v-model=\"tipo_selected\" :options=\"tipos_archivos\" :dir=\"$vs.rtl ? 'rtl' : 'ltr'\" @input=\"archivos_filtro\"></v-select>\r\n        </template>\r\n\r\n        <template slot=\"thead\">\r\n            <vs-th colspan=\"2\">Archivo</vs-th>\r\n            <vs-th>Autor</vs-th>\r\n            <!-- <vs-th colspan=\"2\">Fecha</vs-th> -->\r\n        </template>\r\n\r\n        <template slot-scope=\"{data}\">\r\n        <vs-tr :data=\"tr\" :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n          <vs-td>\r\n              <img v-if=\"tr.nombre_archivo.split('.')[1] == 'xls' || tr.nombre_archivo.split('.')[1] == 'xlsx'\" src=\"../../assets/images/departamentos/excel_ico.png\" class=\"img_list\">\r\n              <img v-else-if=\"tr.nombre_archivo.split('.')[1] == 'pdf'\" src=\"../../assets/images/departamentos/pdf_ico.png\" class=\"img_list\">\r\n              <img v-else-if=\"tr.nombre_archivo.split('.')[1] == 'png' || tr.nombre_archivo.split('.')[1] == 'jpg'\" :src=\"$data_url+'archivos/departamentos/'+tr.nombre_archivo\" class=\"img_list\">\r\n              <img v-else-if=\"tr.nombre_archivo.split('.')[1] == 'mp4' || tr.nombre_archivo.split('.')[1] == 'mpeg' || tr.nombre_archivo.split('.')[1] == 'mov' || tr.nombre_archivo.split('.')[1] == 'wmv'\" src=\"../../assets/images/departamentos/img_ico.png\" class=\"video_selected\">\r\n              <img v-else-if=\"tr.nombre_archivo.split('.')[1] == 'rar' || tr.nombre_archivo.split('.')[1] == 'zip'\" src=\"../../assets/images/departamentos/zip_ico.png\" class=\"img_list\">\r\n              <img v-else src=\"../../assets/images/departamentos/file_ico.png\" class=\"img_list\">\r\n          </vs-td>\r\n          <vs-td>{{tr.nombre_archivo.slice(13,100)}}</vs-td>\r\n          <vs-td>{{tr.nombres +' '+tr.apellidos}}</vs-td>\r\n          <!-- <vs-td>{{tr.created_at}}</vs-td> -->\r\n          <vs-td>\r\n            <vs-button size=\"small\" radius color=\"primary\" type=\"filled\" icon-pack=\"feather\" icon=\"icon-eye\" class=\"m-1\" @click=\"visualizar_archivo(tr);\"></vs-button>\r\n\r\n            <vs-button size=\"small\" radius color=\"dark\" type=\"filled\" icon-pack=\"feather\" icon=\"icon-download\" class=\"m-1\" @click=\"descargar_archivo(tr);\"></vs-button>\r\n            <vs-button v-if=\"usuario.idusuario == tr.idusuario || usuario.idusuario == 1\" size=\"small\" radius color=\"danger\" type=\"filled\" icon-pack=\"feather\" icon=\"icon-trash\" class=\"m-1\" @click=\"confirm_eliminar_archivo(); archivo_eliminar = tr\"></vs-button>\r\n          </vs-td>\r\n        </vs-tr>\r\n        </template>\r\n        </vs-table>\r\n\r\n      </vx-card>\r\n    </div>\r\n  </div>\r\n\r\n\r\n\r\n</div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nVue.use(axios)\r\nimport vSelect from \"vue-select\";\r\nimport flatPickr from 'vue-flatpickr-component'\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport Datepicker from 'vuejs-datepicker';\r\nexport default {\r\ndata(){\r\n    return {\r\n      active:false,\r\n      activePrompt: false,\r\n      descripcion: '',\r\n      value1: '',\r\n      value2: '',\r\n      departamento: {},\r\n      departamentos: [],\r\n      nombre_file: '',\r\n      size_file: '',\r\n      subir_disabled: false,\r\n      nombre_valido: true,\r\n      archivo_seleccionado: [],\r\n      popupArchivo: false,\r\n      archivos_departamento: [],\r\n      departamento_selected: '',\r\n      usuario: [],\r\n      fecha_archivo: '',\r\n      configdateTimePicker: {\r\n          enableTime: true,\r\n          dateFormat: 'Y-m'\r\n      },\r\n      tipo_selected: '',\r\n      tipos_archivos: [\r\n        {id: '0', label: 'Todos'},\r\n        {id: '1', label: 'Excel'},\r\n        {id: '2', label: 'Word'},\r\n        {id: '3', label: 'Imágenes'},\r\n        {id: '4', label: 'Comprimidos'},\r\n        {id: '5', label: 'Videos'},\r\n        {id: '6', label: 'PDF'},\r\n        {id: '7', label: 'Otros'},\r\n      ],\r\n      archivo_eliminar: [],\r\n    }\r\n  },\r\n  components: {\r\n    'v-select': vSelect,\r\n    flatPickr,\r\n    Datepicker\r\n  },\r\n  mounted() {\r\n    this.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n    this.getDepartamentos()\r\n  },\r\n  methods:{\r\n    getDepartamentos(){\r\n      let me = this\r\n      this.$http.get(me.$server_url+'files_departamentos')\r\n      .then(res => {\r\n          me.departamentos = res.data\r\n          me.verArchivos(res.data[0].id_categoria)\r\n      })\r\n      .catch(function (error) {\r\n          console.log(error);\r\n      })\r\n    },\r\n    mostrarImg(file, img){\r\n        let me = this;\r\n        var archivo = document.getElementById(\"file1\").files[0];\r\n        me.archivo_seleccionado = archivo\r\n        me.nombre_file = archivo.name\r\n        me.size_file = (archivo.size / 1000000).toFixed(2)\r\n        if( me.size_file > 15 ){\r\n          me.subir_disabled = true\r\n        }\r\n        if ( !/^[a-zA-Z]*$/g.test(me.nombre_file) ) {\r\n            me.nombre_valido = true\r\n        }else{\r\n          me.nombre_valido = false\r\n          me.subir_disabled = true\r\n        }\r\n    },\r\n    guardarArchivo(){\r\n      let me = this\r\n\r\n      if( me.departamento ){\r\n        if( me.departamento.id_categoria){\r\n\r\n          me.$vs.loading()\r\n          // var fileArchivo = document.getElementById(\"file1\").files[0];\r\n\r\n          const formData = new FormData();\r\n          formData.append('id_departamento', me.departamento.id_categoria);\r\n          formData.append('nombre_archivo', me.archivo_seleccionado);\r\n          formData.append('id_usuario', me.usuario.idusuario);\r\n          axios.post(this.$data_url+'api/files_departamentos_save', formData)\r\n          .then(res => {\r\n              me.$vs.loading.close()\r\n              me.verArchivos(me.departamento_selected)\r\n              me.$vs.notify({\r\n              text:'Archivo subido exitosamente.',\r\n              color:'success',\r\n              iconPack: 'feather',\r\n              icon:'icon-check'})\r\n          })\r\n          .catch(function (error) {\r\n              me.$vs.loading.close()\r\n              console.log(error + ': error al crear archivo_seleccionado');\r\n          })\r\n\r\n        }else{\r\n          this.$vs.notify({\r\n              color: 'warning',\r\n              title: 'Seleccione un departamento antes de subir su archivo.',\r\n          })\r\n        }\r\n      }else{\r\n        this.$vs.notify({\r\n            color: 'warning',\r\n            title: 'Seleccione un departamento antes de subir su archivo.',\r\n        })\r\n      }\r\n\r\n    },\r\n    verArchivos(id_categoria){\r\n      let me = this\r\n      me.nombre_file = ''\r\n      me.departamento_selected = id_categoria\r\n      me.$vs.loading()\r\n      this.$http.get(me.$server_url+'ver_archivos_departamento/'+id_categoria)\r\n      .then(res => {\r\n          me.archivos_departamento = res.data\r\n          me.$vs.loading.close()\r\n          me.popupArchivo = false\r\n      })\r\n      .catch(function (error) {\r\n          me.$vs.loading.close()\r\n          console.log(error);\r\n      })\r\n    },\r\n    archivos_filtro(){\r\n      let me = this\r\n      me.$vs.loading()\r\n\r\n      let mes = ''\r\n      let mes_filtro  = ''\r\n      if( me.fecha_archivo ){\r\n        mes = (me.fecha_archivo.getMonth()+1).toString()\r\n        if( mes.length == 1 ){ mes = ('0' + mes) }\r\n        mes_filtro = me.fecha_archivo.getFullYear()  + \"-\" + mes\r\n      }\r\n\r\n\r\n\r\n      var fecha = 'null'\r\n      var tipo = 'null'\r\n      if( mes_filtro ){fecha = mes_filtro}\r\n      if( me.tipo_selected ){if( me.tipo_selected.id ){tipo = me.tipo_selected.id}}\r\n\r\n      this.$http.get(me.$server_url+'archivos_departamento_filtro/'+me.departamento_selected+'/'+fecha+'/'+tipo)\r\n      .then(res => {\r\n          me.archivos_departamento = res.data\r\n          me.$vs.loading.close()\r\n          me.popupArchivo = false\r\n      })\r\n      .catch(function (error) {\r\n          me.$vs.loading.close()\r\n          console.log(error);\r\n      })\r\n    },\r\n    confirm_eliminar_archivo(){\r\n      this.$vs.dialog({\r\n        type: 'confirm',\r\n        color: 'danger',\r\n        title: `Confirmar`,\r\n        text: '¿Está seguro de eliminar este archivo?',\r\n        accept: this.eliminar_archivo\r\n      })\r\n    },\r\n    eliminar_archivo(){\r\n      let me = this\r\n\r\n      const formData = new FormData();\r\n      formData.append('id_usuario', me.usuario.idusuario);\r\n      formData.append('nombre_archivo', me.archivo_eliminar.nombre_archivo);\r\n      formData.append('id_archivo', me.archivo_eliminar.id_archivo);\r\n\r\n      this.$http.post(me.$server_url+'remover_archivo', formData)\r\n      .then(res => {\r\n          me.verArchivos(me.departamento_selected)\r\n          me.$vs.loading.close()\r\n      })\r\n      .catch(function (error) {\r\n          me.$vs.loading.close()\r\n          console.log(error);\r\n      })\r\n    },\r\n    visualizar_archivo(item){\r\n      let me = this\r\n\r\n      if (item.nombre_archivo.substr(-3) == \"pdf\" || item.nombre_archivo.substr(-3) == \"png\" || item.nombre_archivo.substr(-3) == \"jpg\") {\r\n          window.open(this.$data_url+'archivos/departamentos/' + item.nombre_archivo, '_blank');\r\n      } else if ( item.nombre_archivo.substr(-3) == \"doc\" || item.nombre_archivo.substr(-3) == \"ocx\" || item.nombre_archivo.substr(-3) == \"xls\" || item.nombre_archivo.substr(-3) == \"lsx\" ) {\r\n          window.open('https://view.officeapps.live.com/op/embed.aspx?src='+this.$data_url+'archivos/departamentos/' + item.nombre_archivo, '_blank');\r\n      }\r\n\r\n    },\r\n    descargar_archivo(item){\r\n      let me = this\r\n\r\n      window.open(this.$data_url+'archivos/departamentos/' + item.nombre_archivo, '_blank');\r\n\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n<style>\r\n.content_archivos{\r\n  -webkit-box-shadow: 0px 0px 7px 0px rgba(212,212,212,1);\r\n  -moz-box-shadow: 0px 0px 7px 0px rgba(212,212,212,1);\r\n  box-shadow: 0px 0px 7px 0px rgba(212,212,212,1);\r\n  border-radius: 5px;\r\n  min-height: 100px;\r\n}\r\n\r\n.content_subir{\r\n  display: -ms-flexbox;\r\n  display: -webkit-flex;\r\n  display: flex;\r\n  -ms-flex-align: center;\r\n  -webkit-align-items: center;\r\n  -webkit-box-align: center;\r\n  align-items: center;\r\n}\r\n.img_selected{\r\n  width: 170px; border-radius: 5px;\r\n}\r\n.img_list{\r\n  width: 70px; border-radius: 5px;\r\n}\r\n.folder_list:hover{\r\n  width: 40px !important;\r\n  opacity: 0.5;\r\n}\r\n</style>\r\n"]}]}