{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\admin\\capacitaciones_agenda.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\admin\\capacitaciones_agenda.vue","mtime":1712682815443},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport vSelect from 'vue-select'\r\nexport default {\r\n    components: {\r\n        'v-select': vSelect,\r\n        flatPickr\r\n    },\r\n    data() {\r\n        return {\r\n            agenda_capacitaciones: '',\r\n            tmp_agenda_capacitaciones: '',\r\n            region: '',\r\n            radios1: '',\r\n            periodos: '',\r\n            sel_region: '',\r\n            tmp_sel_region: '',\r\n            modalAdd: false,\r\n            agenda_editar: {\r\n                'id': '',\r\n                'estado': '',\r\n                'observacion': '',\r\n                'personas': '',\r\n                'startDate':'',\r\n                'endDate':'',\r\n            },\r\n            counterDanger: false,\r\n            counter_long: 300,\r\n            filtro_fecha_ini: '',\r\n            filtro_fecha_fin: '',\r\n            lista_asesores: '',\r\n            m_asesores: '',\r\n            configdateTimePicker: {\r\n                enableTime: true,\r\n                dateFormat: 'Y-m-d'\r\n            },\r\n            //para exportar\r\n            codigoSelected:[],\r\n            formats: ['xls', 'xlsx', 'csv', 'txt'],\r\n            fileName:null,\r\n            selectedFormat: 'xls',\r\n            cellAutoWidth: true,\r\n            activePrompt: false,\r\n        }\r\n    },\r\n    mounted() {\r\n        let me = this;\r\n        me.tmp_sel_region = localStorage.getItem('sel_region');\r\n        if (me.tmp_sel_region != null) {\r\n            // console.log(me.tmp_sel_region)\r\n            me.f_periodo(me.tmp_sel_region)\r\n            me.region = me.tmp_sel_region;\r\n        }\r\n        me.f_lista_Asesores();\r\n    },\r\n    methods: {\r\n        f_periodo(item) {\r\n            let me = this;\r\n            localStorage.setItem('sel_region', item);\r\n            let tmp_item = item;\r\n            // console.log(tmp_item)\r\n            // return\r\n            let formData = new FormData();\r\n            formData.append('region', tmp_item);\r\n            this.$http.post(this.$server_url + 'periodoActivoReg', formData)\r\n                .then(function (res) {\r\n                    // console.log(res.data)\r\n                    me.periodos = res.data;\r\n                    me.getAgendaCapacitacion();\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n        },\r\n        getAgendaCapacitacion() {\r\n            let me = this;\r\n            me.$vs.loading()\r\n            me.modalAdd = false;\r\n            this.$http.get(this.$server_url + 'agenda_capacitacion/' + me.periodos[0].idperiodoescolar)\r\n                .then(function (res) {\r\n                    me.agenda_capacitaciones = res.data\r\n                    me.f_array_filtro_contenido();\r\n                    // console.log(res.data)\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        f_array_filtro_contenido() {\r\n            let me = this;\r\n            me.tmp_agenda_capacitaciones = [];\r\n            if (me.filtro_fecha_ini != \"\") { //filtro con fecha inicio\r\n                if (me.filtro_fecha_fin != \"\") { //filtro con fecha inicio y fin\r\n                    if (me.m_asesores != \"\") { //filtro fecha inicio, fecha fin y asesor\r\n                        // console.log('f ini f_fin y asesor')\r\n                        for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                            if (me.agenda_capacitaciones[index].fechaCapacitacion.substr(0, 10) >= me.filtro_fecha_ini &&\r\n                                me.agenda_capacitaciones[index].fechaFinCapacitacion.substr(0, 10) <= me.filtro_fecha_fin &&\r\n                                me.agenda_capacitaciones[index].cedula == me.m_asesores.cedula) {\r\n                                me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                            }\r\n                        }\r\n                    } else { //filtro fecha inicio, fecha fin sin asesor\r\n                        // console.log('f ini f_fin')\r\n                        for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                            if (me.agenda_capacitaciones[index].fechaCapacitacion.substr(0, 10) >= me.filtro_fecha_ini &&\r\n                                me.agenda_capacitaciones[index].fechaFinCapacitacion.substr(0, 10) <= me.filtro_fecha_fin) {\r\n                                me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (me.m_asesores != \"\") { //filtro con fecha inicio y asesor\r\n                    // console.log('f_inic y asesor')\r\n                    for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                        if (me.agenda_capacitaciones[index].fechaCapacitacion.substr(0, 10) >= me.filtro_fecha_ini &&\r\n                            me.agenda_capacitaciones[index].cedula == me.m_asesores.cedula) {\r\n                            me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                        }\r\n                    }\r\n                } else { //filtro con fecha inicio y asesor\r\n                    // console.log('solo f_inic')\r\n                    for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                        if (me.agenda_capacitaciones[index].fechaCapacitacion.substr(0, 10) >= me.filtro_fecha_ini) {\r\n                            me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                        }\r\n                    }\r\n                }\r\n                return\r\n            }\r\n            if (me.filtro_fecha_fin != \"\") { //filtro con fecha fin\r\n                if (me.m_asesores != \"\") {\r\n                    // console.log('f_fin y asesor')\r\n                    for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                        if (me.agenda_capacitaciones[index].fechaFinCapacitacion.substr(0, 10) <= me.filtro_fecha_fin &&\r\n                            me.agenda_capacitaciones[index].cedula == me.m_asesores.cedula) {\r\n                            me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                        }\r\n                    }\r\n                } else {\r\n                    // console.log('solo_f_fin')\r\n                    for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                        if (me.agenda_capacitaciones[index].fechaFinCapacitacion.substr(0, 10) <= me.filtro_fecha_fin) {\r\n                            me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                        }\r\n                    }\r\n                }\r\n                return\r\n            }\r\n            if (me.m_asesores != \"\") { //filtro con asesor\r\n                // console.log('solo_asesor')\r\n                for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                    if (me.agenda_capacitaciones[index].cedula == me.m_asesores.cedula) {\r\n                        me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                    }\r\n                }\r\n                return\r\n            }\r\n            // console.log('sin fechas, sin asesor')\r\n            me.tmp_agenda_capacitaciones = me.agenda_capacitaciones;\r\n        },\r\n        f_lista_Asesores(item) {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'listaAsesores')\r\n                .then(function (res) {\r\n                    me.lista_asesores = res.data\r\n                    // console.log(res.data)\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        f_cambio_estado(item) {\r\n            let me = this;\r\n            me.agenda_editar.id = item.id;\r\n            me.agenda_editar.titulo = item.tema;\r\n            me.agenda_editar.personas = item.personas;\r\n            me.agenda_editar.estado = item.estado;\r\n            me.agenda_editar.observacion = item.observacion;\r\n            me.agenda_editar.startDate = item.fechaCapacitacion;\r\n            me.agenda_editar.endDate = item.fechaFinCapacitacion\r\n            console.log(item)\r\n            me.modalAdd = true;\r\n        },\r\n\r\n        f_aceptar_modal() {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            formData.append('id', me.agenda_editar.id);\r\n            formData.append('personas', me.agenda_editar.personas);\r\n            formData.append('estado', me.agenda_editar.estado);\r\n            formData.append('observacion', me.agenda_editar.observacion);\r\n            formData.append('endDate', me.agenda_editar.endDate);\r\n            me.$vs.loading()\r\n            console.log(me.agenda_editar)\r\n            this.$http.post(this.$server_url + 'editar_agenda_adm', formData)\r\n                .then(function (res) {\r\n                    me.agenda_capacitaciones = res.data\r\n                    // console.log(res.data)\r\n                    me.getAgendaCapacitacion();\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        f_filtro_fechas(item) {\r\n            let me = this;\r\n            if (item == 0) {\r\n                me.filtro_fecha_ini = \"\";\r\n                me.filtro_fecha_fin = \"\";\r\n                me.m_asesores = \"\"\r\n            }\r\n            me.f_array_filtro_contenido();\r\n        },\r\n        //para importar a excel\r\n        exportToExcel() {\r\n            let headerTitle = [ 'Tema','Area', 'Capacitador', 'Asesor', 'Institucion', 'Fecha capacitación','Hora inicio','Hora fin','fecha create','estado'];\r\n            let headerVal = [ 'tema','nombrearea', 'capacitador','asesor', 'institucionFinal','fechaFinCapacitacion','hora_inicio','hora_fin','created_at','estadoCapacitacion'];\r\n            import('@/vendor/Export2Excel').then(excel => {\r\n                const data = this.formatJson(headerVal, this.codigoSelected)\r\n                excel.export_json_to_excel({\r\n                    header: headerTitle,\r\n                    data,\r\n                    filename: this.fileName,\r\n                    autoWidth: this.cellAutoWidth,\r\n                    bookType: this.selectedFormat\r\n                })\r\n                this.clearFields()\r\n                this.guardarActivo = '';\r\n                this.generarActivo = ' ';\r\n                this.textAlertCant = '';\r\n                this.cantidad = '';\r\n                this.codigoSelected = [];\r\n            })\r\n        },\r\n\r\n        formatJson(filterVal, jsonData) {\r\n            return jsonData.map(v => filterVal.map(j => {\r\n                return v[j]\r\n            }))\r\n        },\r\n            //limpiar campos para exportar de nuevo\r\n        clearFields() {\r\n            this.fileName = ''\r\n            this.cellAutoWidth = true\r\n            this.selectedFormat = 'xls'\r\n        },\r\n    },\r\n}\r\n",{"version":3,"sources":["capacitaciones_agenda.vue"],"names":[],"mappings":";AAwHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"capacitaciones_agenda.vue","sourceRoot":"src/views/admin","sourcesContent":["<template>\r\n<div class=\"w-full mb-base\">\r\n    <vs-popup title=\"Detalles capacitación\" :active.sync=\"modalAdd\">\r\n        <h3 class=\"mb-4\">{{agenda_editar.titulo}} </h3>\r\n        <div>Marcar la capacitacion actual como:</div>\r\n        <vs-radio class=\"m-3\" color=\"warning\" v-model=\"agenda_editar.estado\" vs-name=\"radios2\" vs-value=\"1\">Pendiente</vs-radio>\r\n        <vs-radio class=\"m-3\" color=\"success\" v-model=\"agenda_editar.estado\" vs-name=\"radios2\" vs-value=\"2\">Realizada</vs-radio>\r\n        <vs-radio class=\"m-3\" color=\"danger\" v-model=\"agenda_editar.estado\" vs-name=\"radios2\" vs-value=\"0\">Cancelada</vs-radio>\r\n\r\n        <div class=\"mt-3\">\r\n            <p>Fecha capacitación</p>\r\n            <flat-pickr :config=\"configdateTimePicker\" v-model=\"agenda_editar.endDate\"  placeholder=\"Fecha capacitación\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n        </div>\r\n\r\n        <!-- <div class=\"mt-3\">\r\n              <p>Fecha  fin capacitación</p>\r\n            <flat-pickr :config=\"configdateTimePicker\" v-model=\"agenda_editar.endDate\"  placeholder=\"Fecha Fin\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n        </div> -->\r\n        <div class=\"mt-3\">\r\n\r\n            <vs-input type=\"number\" v-model=\"agenda_editar.personas\" label=\"Cantidad de asistentes\"></vs-input>\r\n        </div>\r\n        <div class=\"mt-3\">\r\n            <vs-textarea v-model=\"agenda_editar.observacion\" :counter=\"counter_long\" label=\"observación\" height=\"130px\" :counter-danger.sync=\"counterDanger\"></vs-textarea>\r\n        </div>\r\n        <div>\r\n            <vs-button class=\"mt-5\" color=\"primary\" @click=\"f_aceptar_modal()\" type=\"filled\">Aceptar</vs-button>\r\n        </div>\r\n    </vs-popup>\r\n    <!-- <vx-card> -->\r\n    <div class=\"m-3\">\r\n        <vs-radio class=\"m-3\" v-model=\"region\" vs-name=\"radios1\" vs-value=\"SIERRA\" @change=\"f_periodo(region)\">SIERRA</vs-radio>\r\n        <vs-radio class=\"m-3\" v-model=\"region\" vs-name=\"radios1\" vs-value=\"COSTA\" @change=\"f_periodo(region)\">COSTA</vs-radio>\r\n        <div class=\"m-3\">\r\n            <vs-input style=\"display:inline-block\" type=\"date\" v-model=\"filtro_fecha_ini\" class=\"mb-4 mr-4 col-3 sm:col-12\" label=\"Fecha inicio\"></vs-input>\r\n            <vs-input style=\"display:inline-block\" type=\"date\" v-model=\"filtro_fecha_fin\" class=\"mb-4 mr-4 col-3 sm:col-12\" label=\"Fecha fin\"></vs-input>\r\n            <vs-select style=\"display:inline-block; min-width:250px\" class=\"mr-2\" autocomplete label=\"Asesores\" v-model=\"m_asesores\">\r\n                <vs-select-item :key=\"index\" :value=\"item\" :text=\"item.nombres\" v-for=\"(item,index) in lista_asesores\" />\r\n            </vs-select>\r\n            <vs-button style=\"display:inline-block\" @click=\"f_filtro_fechas();\" radius icon-pack=\"feather\" icon=\"icon-filter\" color=\"primary\" type=\"filled\"></vs-button>\r\n            <vs-button style=\"display:inline-block\" class=\"ml-3\" @click=\"f_filtro_fechas(0);\" radius icon-pack=\"feather\" icon=\"icon-x\" color=\"warning\" type=\"filled\"></vs-button>\r\n        </div>\r\n    </div>\r\n    <vs-table multiple v-model=\"codigoSelected\" pagination max-items=\"10\" search :data=\"tmp_agenda_capacitaciones\">\r\n\r\n        <template slot=\"header\" style=\"display:flex;\">\r\n            <div>\r\n                  Cantidad:<b> {{tmp_agenda_capacitaciones.length}}</b>\r\n            </div>\r\n            <div class=\"ml-5\">\r\n                <vs-button color=\"warning\" size=\"small\" class=\"mr-5\" style=\"font-size: 14px;\" @click=\"activePrompt=true;\">Exportar</vs-button>\r\n            </div>\r\n        </template>\r\n\r\n        <template slot=\"thead\">\r\n            <vs-th sort-key=\"tema\" width=\"25%\">Tema</vs-th>\r\n            <vs-th sort-key=\"institucion\" width=\"25%\">Institución</vs-th>\r\n            <vs-th sort-key=\"fechaCapacitacion\" width=\"25%\">Fecha</vs-th>\r\n            <vs-th sort-key=\"\" width=\"20%\"></vs-th>\r\n        </template>\r\n\r\n        <template slot-scope=\"{data}\">\r\n            <vs-tr :data=\"tr\" :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n\r\n                <vs-td :data=\"data[indextr].tema\">\r\n                    {{data[indextr].tema}}<br>\r\n                    <small>Area: {{data[indextr].nombrearea}}</small><br>\r\n                    <small>Capacitador: {{data[indextr].capacitador}}</small>\r\n                    <span v-if=\"data[indextr].estado == 0\"><br>\r\n                        <vs-chip color=\"danger\">Cancelada</vs-chip>\r\n                    </span>\r\n                    <span v-if=\"data[indextr].estado == 1\"><br>\r\n                        <vs-chip color=\"warning\">Pendiente</vs-chip>\r\n                    </span>\r\n                    <span v-if=\"data[indextr].estado == 2\"><br>\r\n                        <vs-chip color=\"success\">Realizada</vs-chip>\r\n                    </span>\r\n                     <vs-chip :color=\"data[indextr].classes.substring(6)\">{{data[indextr].label}}</vs-chip>\r\n                     <vs-chip color=\"primary\">{{tr.tipo =='0'?'Presencial':'Virtual'}}</vs-chip>\r\n                </vs-td>\r\n\r\n                <vs-td :data=\"data[indextr].nombreInstitucion\">\r\n                    <span v-if=\"data[indextr].institucion_id != null\">{{data[indextr].nombreInstitucion}}</span>\r\n                    <span v-if=\"data[indextr].idInstitucionTemporal != null\">{{data[indextr].institucionTemporal}}</span>\r\n                    <small><br>Asesor: {{data[indextr].asesorNombre}} {{data[indextr].asesorApellido}} </small>\r\n                    <small><br>cedula: {{data[indextr].cedula}}</small>\r\n                </vs-td>\r\n\r\n                <vs-td :data=\"data[indextr].fechaFinCapacitacion\">\r\n                    <!-- <small>Inicio:</small> {{data[indextr].fechaCapacitacion.substr(0,10)}}<br> -->\r\n                    <small>Fecha capacitación:</small>{{data[indextr].fechaFinCapacitacion}}<br>\r\n                    <small>Hora Inicio:</small> {{data[indextr].hora_inicio}}<br>\r\n                    <small>Hora fin:</small> {{data[indextr].hora_fin}}<br>\r\n                    <small>Fecha create:</small> {{data[indextr].created_at}}<br>\r\n                    <small>Fecha actualización:</small> {{data[indextr].updated_at}}<br>\r\n                </vs-td>\r\n                <vs-td :data=\"data[indextr].estado\">\r\n                    <vs-button style=\"display:inline-block\" @click=\"f_cambio_estado(tr);\" radius icon-pack=\"feather\" icon=\"icon-more-vertical\" color=\"primary\" type=\"border\"></vs-button>\r\n                </vs-td>\r\n            </vs-tr>\r\n        </template>\r\n    </vs-table>\r\n    <!-- </vx-card> -->\r\n       <!--modal exportar-->\r\n        <vs-prompt title=\"Exportar a Excel\" class=\"export-options\" @cancle=\"clearFields\" @accept=\"exportToExcel\" accept-text=\"Exportar\" @close=\"clearFields\" :active.sync=\"activePrompt\">\r\n\r\n            <vs-alert class=\"mb-3\" color=\"danger\" icon-pack=\"feather\" icon=\"icon-info\">\r\n                <span>Recuerde <b>seleccionar</b> los registros que desea exportar.</span>\r\n            </vs-alert>\r\n            <vs-input v-model=\"fileName\" placeholder=\"Ingrese el nombre del archivo\" class=\"w-full\" />\r\n            <v-select v-model=\"selectedFormat\" :options=\"formats\" class=\"my-4\" />\r\n            <div class=\"flex\">\r\n                <!--<span class=\"mr-4\">Cell Auto Width:</span>\r\n                <vs-switch v-model=\"cellAutoWidth\">Cell Auto Width</vs-switch>-->\r\n            </div>\r\n        </vs-prompt>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport vSelect from 'vue-select'\r\nexport default {\r\n    components: {\r\n        'v-select': vSelect,\r\n        flatPickr\r\n    },\r\n    data() {\r\n        return {\r\n            agenda_capacitaciones: '',\r\n            tmp_agenda_capacitaciones: '',\r\n            region: '',\r\n            radios1: '',\r\n            periodos: '',\r\n            sel_region: '',\r\n            tmp_sel_region: '',\r\n            modalAdd: false,\r\n            agenda_editar: {\r\n                'id': '',\r\n                'estado': '',\r\n                'observacion': '',\r\n                'personas': '',\r\n                'startDate':'',\r\n                'endDate':'',\r\n            },\r\n            counterDanger: false,\r\n            counter_long: 300,\r\n            filtro_fecha_ini: '',\r\n            filtro_fecha_fin: '',\r\n            lista_asesores: '',\r\n            m_asesores: '',\r\n            configdateTimePicker: {\r\n                enableTime: true,\r\n                dateFormat: 'Y-m-d'\r\n            },\r\n            //para exportar\r\n            codigoSelected:[],\r\n            formats: ['xls', 'xlsx', 'csv', 'txt'],\r\n            fileName:null,\r\n            selectedFormat: 'xls',\r\n            cellAutoWidth: true,\r\n            activePrompt: false,\r\n        }\r\n    },\r\n    mounted() {\r\n        let me = this;\r\n        me.tmp_sel_region = localStorage.getItem('sel_region');\r\n        if (me.tmp_sel_region != null) {\r\n            // console.log(me.tmp_sel_region)\r\n            me.f_periodo(me.tmp_sel_region)\r\n            me.region = me.tmp_sel_region;\r\n        }\r\n        me.f_lista_Asesores();\r\n    },\r\n    methods: {\r\n        f_periodo(item) {\r\n            let me = this;\r\n            localStorage.setItem('sel_region', item);\r\n            let tmp_item = item;\r\n            // console.log(tmp_item)\r\n            // return\r\n            let formData = new FormData();\r\n            formData.append('region', tmp_item);\r\n            this.$http.post(this.$server_url + 'periodoActivoReg', formData)\r\n                .then(function (res) {\r\n                    // console.log(res.data)\r\n                    me.periodos = res.data;\r\n                    me.getAgendaCapacitacion();\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n        },\r\n        getAgendaCapacitacion() {\r\n            let me = this;\r\n            me.$vs.loading()\r\n            me.modalAdd = false;\r\n            this.$http.get(this.$server_url + 'agenda_capacitacion/' + me.periodos[0].idperiodoescolar)\r\n                .then(function (res) {\r\n                    me.agenda_capacitaciones = res.data\r\n                    me.f_array_filtro_contenido();\r\n                    // console.log(res.data)\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        f_array_filtro_contenido() {\r\n            let me = this;\r\n            me.tmp_agenda_capacitaciones = [];\r\n            if (me.filtro_fecha_ini != \"\") { //filtro con fecha inicio\r\n                if (me.filtro_fecha_fin != \"\") { //filtro con fecha inicio y fin\r\n                    if (me.m_asesores != \"\") { //filtro fecha inicio, fecha fin y asesor\r\n                        // console.log('f ini f_fin y asesor')\r\n                        for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                            if (me.agenda_capacitaciones[index].fechaCapacitacion.substr(0, 10) >= me.filtro_fecha_ini &&\r\n                                me.agenda_capacitaciones[index].fechaFinCapacitacion.substr(0, 10) <= me.filtro_fecha_fin &&\r\n                                me.agenda_capacitaciones[index].cedula == me.m_asesores.cedula) {\r\n                                me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                            }\r\n                        }\r\n                    } else { //filtro fecha inicio, fecha fin sin asesor\r\n                        // console.log('f ini f_fin')\r\n                        for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                            if (me.agenda_capacitaciones[index].fechaCapacitacion.substr(0, 10) >= me.filtro_fecha_ini &&\r\n                                me.agenda_capacitaciones[index].fechaFinCapacitacion.substr(0, 10) <= me.filtro_fecha_fin) {\r\n                                me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (me.m_asesores != \"\") { //filtro con fecha inicio y asesor\r\n                    // console.log('f_inic y asesor')\r\n                    for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                        if (me.agenda_capacitaciones[index].fechaCapacitacion.substr(0, 10) >= me.filtro_fecha_ini &&\r\n                            me.agenda_capacitaciones[index].cedula == me.m_asesores.cedula) {\r\n                            me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                        }\r\n                    }\r\n                } else { //filtro con fecha inicio y asesor\r\n                    // console.log('solo f_inic')\r\n                    for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                        if (me.agenda_capacitaciones[index].fechaCapacitacion.substr(0, 10) >= me.filtro_fecha_ini) {\r\n                            me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                        }\r\n                    }\r\n                }\r\n                return\r\n            }\r\n            if (me.filtro_fecha_fin != \"\") { //filtro con fecha fin\r\n                if (me.m_asesores != \"\") {\r\n                    // console.log('f_fin y asesor')\r\n                    for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                        if (me.agenda_capacitaciones[index].fechaFinCapacitacion.substr(0, 10) <= me.filtro_fecha_fin &&\r\n                            me.agenda_capacitaciones[index].cedula == me.m_asesores.cedula) {\r\n                            me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                        }\r\n                    }\r\n                } else {\r\n                    // console.log('solo_f_fin')\r\n                    for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                        if (me.agenda_capacitaciones[index].fechaFinCapacitacion.substr(0, 10) <= me.filtro_fecha_fin) {\r\n                            me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                        }\r\n                    }\r\n                }\r\n                return\r\n            }\r\n            if (me.m_asesores != \"\") { //filtro con asesor\r\n                // console.log('solo_asesor')\r\n                for (let index = 0; index < me.agenda_capacitaciones.length; index++) {\r\n                    if (me.agenda_capacitaciones[index].cedula == me.m_asesores.cedula) {\r\n                        me.tmp_agenda_capacitaciones.push(me.agenda_capacitaciones[index])\r\n                    }\r\n                }\r\n                return\r\n            }\r\n            // console.log('sin fechas, sin asesor')\r\n            me.tmp_agenda_capacitaciones = me.agenda_capacitaciones;\r\n        },\r\n        f_lista_Asesores(item) {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'listaAsesores')\r\n                .then(function (res) {\r\n                    me.lista_asesores = res.data\r\n                    // console.log(res.data)\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        f_cambio_estado(item) {\r\n            let me = this;\r\n            me.agenda_editar.id = item.id;\r\n            me.agenda_editar.titulo = item.tema;\r\n            me.agenda_editar.personas = item.personas;\r\n            me.agenda_editar.estado = item.estado;\r\n            me.agenda_editar.observacion = item.observacion;\r\n            me.agenda_editar.startDate = item.fechaCapacitacion;\r\n            me.agenda_editar.endDate = item.fechaFinCapacitacion\r\n            console.log(item)\r\n            me.modalAdd = true;\r\n        },\r\n\r\n        f_aceptar_modal() {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            formData.append('id', me.agenda_editar.id);\r\n            formData.append('personas', me.agenda_editar.personas);\r\n            formData.append('estado', me.agenda_editar.estado);\r\n            formData.append('observacion', me.agenda_editar.observacion);\r\n            formData.append('endDate', me.agenda_editar.endDate);\r\n            me.$vs.loading()\r\n            console.log(me.agenda_editar)\r\n            this.$http.post(this.$server_url + 'editar_agenda_adm', formData)\r\n                .then(function (res) {\r\n                    me.agenda_capacitaciones = res.data\r\n                    // console.log(res.data)\r\n                    me.getAgendaCapacitacion();\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        f_filtro_fechas(item) {\r\n            let me = this;\r\n            if (item == 0) {\r\n                me.filtro_fecha_ini = \"\";\r\n                me.filtro_fecha_fin = \"\";\r\n                me.m_asesores = \"\"\r\n            }\r\n            me.f_array_filtro_contenido();\r\n        },\r\n        //para importar a excel\r\n        exportToExcel() {\r\n            let headerTitle = [ 'Tema','Area', 'Capacitador', 'Asesor', 'Institucion', 'Fecha capacitación','Hora inicio','Hora fin','fecha create','estado'];\r\n            let headerVal = [ 'tema','nombrearea', 'capacitador','asesor', 'institucionFinal','fechaFinCapacitacion','hora_inicio','hora_fin','created_at','estadoCapacitacion'];\r\n            import('@/vendor/Export2Excel').then(excel => {\r\n                const data = this.formatJson(headerVal, this.codigoSelected)\r\n                excel.export_json_to_excel({\r\n                    header: headerTitle,\r\n                    data,\r\n                    filename: this.fileName,\r\n                    autoWidth: this.cellAutoWidth,\r\n                    bookType: this.selectedFormat\r\n                })\r\n                this.clearFields()\r\n                this.guardarActivo = '';\r\n                this.generarActivo = ' ';\r\n                this.textAlertCant = '';\r\n                this.cantidad = '';\r\n                this.codigoSelected = [];\r\n            })\r\n        },\r\n\r\n        formatJson(filterVal, jsonData) {\r\n            return jsonData.map(v => filterVal.map(j => {\r\n                return v[j]\r\n            }))\r\n        },\r\n            //limpiar campos para exportar de nuevo\r\n        clearFields() {\r\n            this.fileName = ''\r\n            this.cellAutoWidth = true\r\n            this.selectedFormat = 'xls'\r\n        },\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"css\">\r\n.select-asesores {\r\n    text-transform: uppercase\r\n}\r\n</style>\r\n"]}]}