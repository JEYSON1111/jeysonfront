{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\evaluaciones\\ExportarPreguntas.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\evaluaciones\\ExportarPreguntas.vue","mtime":1712682815860},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\n\r\nimport vSelect from 'vue-select'\r\nexport default{\r\n    data(){\r\n        return{\r\n            usuario:[],\r\n            asignaturas:[],\r\n            unidades:[],\r\n            temas:[],\r\n            datoEnviar:[],\r\n            asignaturaSelected:'',\r\n            unidadSelected:'',\r\n            tema_ambito:'',\r\n            preguntas: [],\r\n            unidades: [\r\n                { id: \"1\", label: \"Unidad 1\", }, { id: \"2\", label: \"Unidad 2\", }, { id: \"3\", label: \"Unidad 3\", }, { id: \"4\", label: \"Unidad 4\", }, { id: \"5\", label: \"Unidad 5\", }, { id: \"6\", label: \"Unidad 6\", }, { id: \"7\", label: \"Unidad 7\", }, { id: \"8\", label: \"Unidad 8\", }\r\n            ],\r\n            bancoSelected: {id:'3',label:'Ambas'},\r\n            bancos: [\r\n                {id:'1',label:'Preguntas de Prolipa'},\r\n                // {id:'2',label:'Solo mis preguntas'},\r\n                {id:'3',label:'Todo'},\r\n            ],\r\n        }\r\n    },\r\n    components:{\r\n        vSelect,\r\n    },\r\n    mounted(){\r\n        let me = this;\r\n        me.getAsignaturas()\r\n        me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n    },\r\n    methods:{\r\n        ExportToDoc(){\r\n            let me = this;\r\n            if(me.asignaturaSelected == \"\" || me.asignaturaSelected == undefined || me.asignaturaSelected == null){\r\n                me.$vs.notify({\r\n                text:'Seleccione una asignatura y una unidad',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return \r\n            }\r\n            if(me.unidadSelected == \"\" || me.unidadSelected == undefined || me.unidadSelected == null){\r\n                me.$vs.notify({\r\n                text:'Seleccione una asignatura y una unidad',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return \r\n            }\r\n            let filename = \"\"\r\n            filename = me.asignaturaSelected.label + \" - \" +me.unidadSelected.label\r\n            var HtmlHead = \"<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>\";\r\n            var EndHtml = \"</body></html>\";\r\n            //complete html\r\n            var html = HtmlHead +document.getElementById(\"MainHTML\").innerHTML+EndHtml;\r\n            //specify the type\r\n            var blob = new Blob(['\\ufeff', html], {\r\n                type: 'application/msword'\r\n            });\r\n            // Specify link url\r\n            var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);\r\n            // Specify file name\r\n            filename = filename?filename+'.doc':'document.doc';\r\n            // Create download link element\r\n            var downloadLink = document.createElement(\"a\");\r\n            document.body.appendChild(downloadLink);\r\n            if(navigator.msSaveOrOpenBlob ){\r\n                navigator.msSaveOrOpenBlob(blob, filename);\r\n            }else{\r\n                // Create a link to the file\r\n                downloadLink.href = url;\r\n                // Setting the file name\r\n                downloadLink.download = filename;\r\n                //triggering the function\r\n                downloadLink.click();\r\n            }\r\n            document.body.removeChild(downloadLink);\r\n        },\r\n        getAsignaturas(){\r\n            let me = this;\r\n            this.$http.get(this.$server_url+'asignaturasDoc/0').then(res => {\r\n                me.asignaturas = res.data;\r\n                me.$vs.loading.close()\r\n            })\r\n        },  \r\n        filtrarPreguntas(){\r\n            let me = this;\r\n            me.preguntas.id = ''\r\n            me.datoEnviar   = []\r\n            me.preguntas    = []\r\n            if( me.asignaturaSelected.id === undefined ){\r\n                me.$vs.notify({\r\n                    text:'Seleccione una asignatura antes de filtrar por Unidades',\r\n                    color:'warning',\r\n                    iconPack: 'feather',\r\n                    icon:'icon-check'})\r\n                return;\r\n            }\r\n            if( me.asignaturaSelected.id===113 || me.asignaturaSelected.id===114 || me.asignaturaSelected.id===115 ){\r\n                me.tema_ambito = 'Ámbito'\r\n            }else{\r\n                me.tema_ambito = 'Tema'\r\n            }\r\n            if( me.unidadSelected.id === undefined ){\r\n                return;\r\n            }\r\n            me.temas      = []\r\n            me.datoEnviar = []\r\n            me.preguntas  = []\r\n            //me.pregunta.tema.id = ''\r\n            this.$http.get(this.$server_url+'temasignunidadExport?asignatura='+me.asignaturaSelected.id+'&unidad='+me.unidadSelected.id)\r\n            .then(res => {\r\n                me.temas = res.data;\r\n                me.getPreguntas()\r\n            })\r\n            .catch(function (error) {\r\n                console.log(error);\r\n            })\r\n        },\r\n        getPreguntas(){\r\n            let me = this;\r\n            me.preguntas = []\r\n            me.datoEnviar = []\r\n            if(me.bancoSelected == \"\" || me.bancoSelected == undefined || me.bancoSelected == null){\r\n                me.$vs.notify({\r\n                    text: \"Seleccione los tipos de preguntas a mostrar\",\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            //enviar solo los ids\r\n            me.temas.forEach(element => {\r\n                var cal         = new Object();\r\n                cal.id          = element.id\r\n                cal.nombre_tema = element.nombre_tema\r\n                me.datoEnviar.push(cal)\r\n            });\r\n            let formData = new FormData();\r\n            me.$vs.loading()\r\n            formData.append('temas',JSON.stringify(me.datoEnviar));\r\n            this.$http.post(this.$server_url+'preguntasxUnidadytema',formData)\r\n            .then(res => {\r\n                me.$vs.loading.close()\r\n                if(res.data.length == 0){\r\n                    me.$vs.notify({\r\n                        text: \"No hay datos que mostrar\",\r\n                        color: 'warning',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    return\r\n                }\r\n                //FILTRAR(PROLIPA - TODO)\r\n                let filtro = me.bancoSelected.id\r\n                let datos = res.data\r\n                //PROLIPA\r\n                if(filtro == 1){\r\n                    me.preguntas = datos.filter(p => p.idusuario != me.usuario)\r\n                }else{\r\n                    me.preguntas = datos;\r\n                }\r\n            })\r\n            .catch((error) =>{\r\n                me.$vs.loading.close()\r\n            })\r\n        },\r\n    }\r\n}\r\n",{"version":3,"sources":["ExportarPreguntas.vue"],"names":[],"mappings":";;AA8DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ExportarPreguntas.vue","sourceRoot":"src/views/evaluaciones","sourcesContent":["<template>\r\n    <vx-card\r\n    title=\"Exportar preguntas del banco de preguntas\"\r\n    title-color=\"primary\"\r\n    subtitle=\"Seleccione un libro y una unidad para filtrar\"\r\n    style=\"min-height: 100vh;\"\r\n    >\r\n    <small v-if=\"usuario.id_group == 1\" align=\"left\">Ruta: /a_exportarPreguntas</small>\r\n        <div class=\"vx-row w-full mb-5 mt-2\">\r\n            <div class=\"vx-col sm:w-1/2 w-full\">\r\n                Asignatura\r\n                <v-select class=\"mb-2\" v-model=\"asignaturaSelected\" :options=\"asignaturas\" @input=\"filtrarPreguntas()\" :dir=\"$vs.rtl ? 'rtl' : 'ltr'\" />\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full\">\r\n                Unidad\r\n                <v-select class=\"mb-2\" v-model=\"unidadSelected\" :options=\"unidades\" @input=\"filtrarPreguntas()\" :dir=\"$vs.rtl ? 'rtl' : 'ltr'\" />\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full\">\r\n                Banco\r\n                <v-select v-model=\"bancoSelected\" class=\"w-full\" :options=\"bancos\" @input=\"getPreguntas()\" :dir=\"$vs.rtl ? 'rtl' : 'ltr'\" />\r\n            </div>\r\n        </div>\r\n        <div v-if=\"preguntas.length > 0\" class=\"flex mt-3\">\r\n            <vs-button @click=\"ExportToDoc()\"  color=\"#3dd495\"  gradient-color-secondary=\"rgb(130, 207, 23)\" type=\"gradient\"><i class=\"fa-solid fa-download\"></i><span class=\"ml-2\">Exportar</span></vs-button>\r\n            <vs-chip class=\"ml-2 mt-2\" color=\"primary\">Total temas: {{ preguntas.length }}</vs-chip>\r\n        </div>\r\n        <div id=\"MainHTML\" class=\"mt-3\" v-if=\"preguntas.length > 0\">\r\n            <div v-for=\"(tr,index) in preguntas\" :key=\"index\">\r\n                <h2 class=\"p-2\">TEMA: {{ tr.nombre_tema.toUpperCase() }}</h2>\r\n                    <vs-table stripe :data=\"tr.items.items\" no-data-text=\"No hay preguntas de este tema\">\r\n                        <template slot=\"thead\">\r\n                            <vs-th sort-key=\"pregunta\">Pregunta</vs-th>\r\n                            <vs-th sort-key=\"id_tipo_pregunta\">Tipo</vs-th>\r\n                        </template>\r\n                        <template slot-scope=\"{data}\">\r\n                        <vs-tr :data=\"tr\" :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                            <vs-td :data=\"data[indextr].descripcion\">\r\n                                <b>{{indextr+1}}. {{ data[indextr].descripcion }}</b><br>\r\n                                <img v-if=\"data[indextr].img_pregunta!='' && data[indextr].img_pregunta!='null' && data[indextr].img_pregunta!=null\" v-bind:src=\"$data_url+'archivos/img/img_preguntas/'+data[indextr].img_pregunta\" class=\"img-responsive\" width=\"50\" height=\"50\" style=\"border-radius: 5px;\">\r\n                                <div slot=\"header\">\r\n                                    Opciones\r\n                                </div>\r\n                                <div class=\"mb-5\" :key=\"indexitem\" v-for=\"(item, indexitem) in data[indextr].opciones\">\r\n                                <div style=\"width: 100%; font-size: 12px; color: #0DCD88;\" v-if=\"item.tipo===1\">Respuesta correcta<br></div>\r\n                                <div style=\"width: 100%; font-size: 12px; color: #FD5858;\" v-else>Respuesta incorrecta<br></div>\r\n                                <div style=\"width: 100%\"> {{ item.opcion }}<br></div>\r\n                                <div style=\"width: 100%\" ><img v-if=\"item.img_opcion!='' && item.img_opcion!='null' && item.img_opcion!=null\" v-bind:src=\"$data_url+'archivos/img/img_preguntas/'+item.img_opcion\" class=\"img-responsive\" style=\"border-radius: 5px;\" width=\"50\" height=\"50\"></div>\r\n                                </div>\r\n                            </vs-td>\r\n                            <vs-td :data=\"data[indextr].nombre_tipo\">\r\n                                {{data[indextr].nombre_tipo}}\r\n                            </vs-td>\r\n                        </vs-tr>\r\n                        </template>\r\n                    </vs-table>\r\n             \r\n            </div>\r\n        </div>\r\n    </vx-card>\r\n</template>\r\n<script>\r\n\r\nimport vSelect from 'vue-select'\r\nexport default{\r\n    data(){\r\n        return{\r\n            usuario:[],\r\n            asignaturas:[],\r\n            unidades:[],\r\n            temas:[],\r\n            datoEnviar:[],\r\n            asignaturaSelected:'',\r\n            unidadSelected:'',\r\n            tema_ambito:'',\r\n            preguntas: [],\r\n            unidades: [\r\n                { id: \"1\", label: \"Unidad 1\", }, { id: \"2\", label: \"Unidad 2\", }, { id: \"3\", label: \"Unidad 3\", }, { id: \"4\", label: \"Unidad 4\", }, { id: \"5\", label: \"Unidad 5\", }, { id: \"6\", label: \"Unidad 6\", }, { id: \"7\", label: \"Unidad 7\", }, { id: \"8\", label: \"Unidad 8\", }\r\n            ],\r\n            bancoSelected: {id:'3',label:'Ambas'},\r\n            bancos: [\r\n                {id:'1',label:'Preguntas de Prolipa'},\r\n                // {id:'2',label:'Solo mis preguntas'},\r\n                {id:'3',label:'Todo'},\r\n            ],\r\n        }\r\n    },\r\n    components:{\r\n        vSelect,\r\n    },\r\n    mounted(){\r\n        let me = this;\r\n        me.getAsignaturas()\r\n        me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n    },\r\n    methods:{\r\n        ExportToDoc(){\r\n            let me = this;\r\n            if(me.asignaturaSelected == \"\" || me.asignaturaSelected == undefined || me.asignaturaSelected == null){\r\n                me.$vs.notify({\r\n                text:'Seleccione una asignatura y una unidad',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return \r\n            }\r\n            if(me.unidadSelected == \"\" || me.unidadSelected == undefined || me.unidadSelected == null){\r\n                me.$vs.notify({\r\n                text:'Seleccione una asignatura y una unidad',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return \r\n            }\r\n            let filename = \"\"\r\n            filename = me.asignaturaSelected.label + \" - \" +me.unidadSelected.label\r\n            var HtmlHead = \"<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>\";\r\n            var EndHtml = \"</body></html>\";\r\n            //complete html\r\n            var html = HtmlHead +document.getElementById(\"MainHTML\").innerHTML+EndHtml;\r\n            //specify the type\r\n            var blob = new Blob(['\\ufeff', html], {\r\n                type: 'application/msword'\r\n            });\r\n            // Specify link url\r\n            var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);\r\n            // Specify file name\r\n            filename = filename?filename+'.doc':'document.doc';\r\n            // Create download link element\r\n            var downloadLink = document.createElement(\"a\");\r\n            document.body.appendChild(downloadLink);\r\n            if(navigator.msSaveOrOpenBlob ){\r\n                navigator.msSaveOrOpenBlob(blob, filename);\r\n            }else{\r\n                // Create a link to the file\r\n                downloadLink.href = url;\r\n                // Setting the file name\r\n                downloadLink.download = filename;\r\n                //triggering the function\r\n                downloadLink.click();\r\n            }\r\n            document.body.removeChild(downloadLink);\r\n        },\r\n        getAsignaturas(){\r\n            let me = this;\r\n            this.$http.get(this.$server_url+'asignaturasDoc/0').then(res => {\r\n                me.asignaturas = res.data;\r\n                me.$vs.loading.close()\r\n            })\r\n        },  \r\n        filtrarPreguntas(){\r\n            let me = this;\r\n            me.preguntas.id = ''\r\n            me.datoEnviar   = []\r\n            me.preguntas    = []\r\n            if( me.asignaturaSelected.id === undefined ){\r\n                me.$vs.notify({\r\n                    text:'Seleccione una asignatura antes de filtrar por Unidades',\r\n                    color:'warning',\r\n                    iconPack: 'feather',\r\n                    icon:'icon-check'})\r\n                return;\r\n            }\r\n            if( me.asignaturaSelected.id===113 || me.asignaturaSelected.id===114 || me.asignaturaSelected.id===115 ){\r\n                me.tema_ambito = 'Ámbito'\r\n            }else{\r\n                me.tema_ambito = 'Tema'\r\n            }\r\n            if( me.unidadSelected.id === undefined ){\r\n                return;\r\n            }\r\n            me.temas      = []\r\n            me.datoEnviar = []\r\n            me.preguntas  = []\r\n            //me.pregunta.tema.id = ''\r\n            this.$http.get(this.$server_url+'temasignunidadExport?asignatura='+me.asignaturaSelected.id+'&unidad='+me.unidadSelected.id)\r\n            .then(res => {\r\n                me.temas = res.data;\r\n                me.getPreguntas()\r\n            })\r\n            .catch(function (error) {\r\n                console.log(error);\r\n            })\r\n        },\r\n        getPreguntas(){\r\n            let me = this;\r\n            me.preguntas = []\r\n            me.datoEnviar = []\r\n            if(me.bancoSelected == \"\" || me.bancoSelected == undefined || me.bancoSelected == null){\r\n                me.$vs.notify({\r\n                    text: \"Seleccione los tipos de preguntas a mostrar\",\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            //enviar solo los ids\r\n            me.temas.forEach(element => {\r\n                var cal         = new Object();\r\n                cal.id          = element.id\r\n                cal.nombre_tema = element.nombre_tema\r\n                me.datoEnviar.push(cal)\r\n            });\r\n            let formData = new FormData();\r\n            me.$vs.loading()\r\n            formData.append('temas',JSON.stringify(me.datoEnviar));\r\n            this.$http.post(this.$server_url+'preguntasxUnidadytema',formData)\r\n            .then(res => {\r\n                me.$vs.loading.close()\r\n                if(res.data.length == 0){\r\n                    me.$vs.notify({\r\n                        text: \"No hay datos que mostrar\",\r\n                        color: 'warning',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    return\r\n                }\r\n                //FILTRAR(PROLIPA - TODO)\r\n                let filtro = me.bancoSelected.id\r\n                let datos = res.data\r\n                //PROLIPA\r\n                if(filtro == 1){\r\n                    me.preguntas = datos.filter(p => p.idusuario != me.usuario)\r\n                }else{\r\n                    me.preguntas = datos;\r\n                }\r\n            })\r\n            .catch((error) =>{\r\n                me.$vs.loading.close()\r\n            })\r\n        },\r\n    }\r\n}\r\n</script>"]}]}