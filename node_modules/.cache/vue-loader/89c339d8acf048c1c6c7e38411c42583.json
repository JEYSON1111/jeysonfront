{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\materialapoyo\\components\\crearmaterial.vue?vue&type=style&index=0&id=c1f755a2&scoped=true&lang=css","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\materialapoyo\\components\\crearmaterial.vue","mtime":1712682816144},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\n.principal{\r\n    /* background:red; */\r\n    display: flex;\r\n    \r\n    flex-wrap: wrap;\r\n}\r\n.principal2{\r\n    /* background:red; */\r\n    display: flex;\r\n    width:100%;\r\n    flex-wrap: wrap;\r\n}\r\n.grupo{\r\n    /* background: green; */\r\n    width: 45%;\r\n    margin:5px 20px;\r\n}\r\n",{"version":3,"sources":["crearmaterial.vue"],"names":[],"mappings":";AA8bA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"crearmaterial.vue","sourceRoot":"src/views/materialapoyo/components","sourcesContent":["<template>\r\n    <div>\r\n        <vs-row vs-justify=\"center\">\r\n            <vs-col type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                <vs-card>\r\n                <div slot=\"header\">\r\n                    <h3>\r\n                    Subir Material<span style=\"font-size:10px;color:#f2f2f2;\">Al selecionar el  numero de material debe llenarlo</span>\r\n\r\n                    </h3>\r\n                    <br>\r\n                    <div class=\"\">\r\n                       \r\n                        <div>\r\n                            <div class=\"principal\">\r\n\r\n                                    <div class=\"grupo\" v-if=\"docente =='yes'\">\r\n                                      \r\n                                    </div>\r\n                                     <div class=\"grupo\" v-else>\r\n                                        <div class=\"vx-col w-full mt-5\">\r\n                                          \r\n                                            Libro:\r\n                                            <v-select @input=\"filtrarUnidades()\"  :options=\"arregloLibros\" :reduce=\"arregloLibros => arregloLibros\" label=\"nombrelibro\" class=\"w-full\" v-model=\"libro.libro\" />\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                  \r\n                                     \r\n                            </div>  \r\n                            <!-- {{inputs2}} -->\r\n                            <!--Unidades y temas-->\r\n                            <div class=\"principal2\" v-for=\"(input,k) in inputs2\" :key=\"k\">\r\n\r\n                            \r\n                                <div class=\"grupo\">\r\n                                    <div class=\"vx-col w-full mt-5\">\r\n\r\n                                        (Unidad)Filtrar Temas:\r\n                                        <v-select @input=\"filtrarTemas(k)\" :options=\"arregloTraeUnidades2\" :reduce=\"arregloTraeUnidades2 => arregloTraeUnidades2\" label=\"unidad\" class=\"w-full\" v-model=\"input.unidad\" />\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <div class=\"grupo\">\r\n                                    <div class=\"vx-col w-full mt-5\">\r\n                                    \r\n                                    Seleccione  Temas:\r\n                                        <v-select multiple :options=\"arregloTraerTemas\" id=\"temas\" :reduce=\"arregloTraerTemas => arregloTraerTemas\" label=\"nombre_tema\" class=\"w-full\" v-model=\"input.temas\" />\r\n                                    </div>\r\n\r\n                                </div>\r\n                                <div class=\"grupo\">\r\n                                    <vs-button color=\"danger\"  style=\"margin:10px;\" size=\"small\" type=\"filled\" @click=\"remove2(k)\" v-show=\"k || ( !k && inputs2.length > 1)\">-</vs-button>\r\n                                    <vs-button color=\"primary\"   size=\"small\" type=\"filled\" @click=\"add2(k)\" v-show=\"k == inputs2.length-1\">+</vs-button>\r\n                                \r\n                                </div>  \r\n                                <br>                   \r\n                        \r\n                            </div>\r\n                                    \r\n                                <vs-divider color=\"warning\">Archivos</vs-divider>\r\n\r\n                                \r\n                                <br>\r\n                                    <vs-button  @click=\"borrartodo()\" style=\"margin-left: 10px;\" size=\"small\" color=\"danger\" type=\"filled\">\r\n                                        x todo\r\n                                </vs-button>\r\n                                <br>\r\n                                <br>\r\n                                <ul>\r\n                                    <li>Los archivos que se subiran</li>\r\n                                    <li v-for=\"(item,k) in attachments\" :key=\"k\">{{item.name}}</li>\r\n                                </ul>  \r\n\r\n                          <!---INPUTS DE ARCHIVOS-->        \r\n                            <div class=\"principal\" v-for=\"(input,k) in inputs\" :key=\"k\">\r\n                                \r\n                                <div class=\"grupo\">\r\n                                    <div class=\"vx-col w-full mt-5\">\r\n\r\n                                        Nombre archivo:\r\n                                        <vs-input label-placeholder=\"Nombre archivo\" v-model=\"input.name\" />\r\n                                     </div>\r\n                                </div>\r\n\r\n                                <div class=\"grupo\">\r\n                                        <div class=\"vx-col w-full mt-5\">\r\n\r\n                                            Archivo:\r\n                                        \r\n                                            <input type=\"file\" class=\"upload-file\" style=\"margin-top:20px;\"  @change=\"fieldChange\" />\r\n                                        </div>\r\n                                \r\n                                </div>\r\n                                <div class=\"grupo\">\r\n                                    <vs-button color=\"danger\"  style=\"margin:10px;\" size=\"small\" type=\"filled\" v-if=\"k>0\" @click=\"remove(k)\"  v-show=\"k == inputs.length-1\">-</vs-button>\r\n                                    <vs-button color=\"primary\"   size=\"small\" type=\"filled\" @click=\"add(k)\" v-show=\"k == inputs.length-1\">+</vs-button>\r\n                                \r\n                                    \r\n                                \r\n                                </div>  \r\n                                <br>                   \r\n                            </div>    \r\n\r\n                            <br>\r\n                            <br>\r\n                                <vs-button @click=\"uploadFile();\" id=\"save1\" color=\"primary\" type=\"filled\">Guardar Cambios</vs-button>\r\n\r\n                        </div>   \r\n                      \r\n                    \r\n                    </div>\r\n                </div>\r\n                </vs-card>\r\n            </vs-col>\r\n      </vs-row>\r\n      <br>\r\n  \r\n      \r\n    </div>   \r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport vSelect from 'vue-select'\r\nexport default {\r\n    data(){\r\n        return{\r\n            //para ver si es docente\r\n            docente:'',\r\n            //para usar en los demas materiales\r\n            librousable:'',\r\n          \r\n            // para el select de libros\r\n            arregloLibros:[],\r\n            //para el select de unidades\r\n            arregloTraeUnidades:[],\r\n            arregloTraeUnidades2:[],\r\n            //para el select de temas\r\n            arregloTraerTemas:[], \r\n            \r\n            libro:{\r\n                libro:'',\r\n                unidad:[],\r\n                tema:'',\r\n        \r\n            \r\n            }, \r\n             libro2:{\r\n                libro:'',\r\n                unidad:[],\r\n                tema:'',\r\n        \r\n            \r\n            },   \r\n            \r\n            //para los inputs\r\n            inputs: [{\r\n                name: '',\r\n            \r\n            }],\r\n            //para los inputs unidades-temas\r\n            inputs2:[{\r\n                unidad:'',\r\n                temas:'',\r\n            }],\r\n            error:\"\",\r\n           \r\n       \r\n                //para subir archivos,\r\n            attachments:[],\r\n            dataarchivos:[],\r\n            form: new FormData,\r\n            form2: new FormData,\r\n\r\n           \r\n        }\r\n    },\r\n    components: {\r\n    'v-select': vSelect,\r\n            \r\n    },\r\n    methods:{\r\n         add () {\r\n        this.inputs.push({\r\n            name: '',\r\n           \r\n        })\r\n        },\r\n       \r\n\r\n        remove (index) {\r\n        this.attachments.splice(index,1)\r\n        this.inputs.splice(index, 1)\r\n        },\r\n\r\n          add2 () {\r\n            this.inputs2.push({\r\n                unidad: '',\r\n                temas: ''\r\n            })\r\n            console.log(this.inputs)\r\n            },\r\n\r\n            remove2 (index) {\r\n            \r\n            this.inputs2.splice(index, 1)\r\n            },\r\n    \r\n          //para subir archivos\r\n        fieldChange(e){\r\n              //  let archivo = this.archivo1;\r\n              // this.dataarchivos.push(archivo);\r\n                console.log(e.target.files);\r\n                let selectedFiles=e.target.files;\r\n                if(!selectedFiles.length){\r\n                    return false;\r\n                }\r\n                for(let i=0;i<selectedFiles.length;i++){\r\n                    this.attachments.push(selectedFiles[i]);\r\n                }\r\n                \r\n                console.log(this.attachments);\r\n        },\r\n\r\n        borrartodo(){\r\n            this.attachments.splice(0,20)\r\n            this.inputs = [{name:\"\"}];\r\n            \r\n        },\r\n           \r\n    \r\n         //para guardar\r\n        uploadFile(){\r\n              let me  = this;\r\n           \r\n\r\n                for(let i=0; i<this.inputs2.length;i++){\r\n                    \r\n                    this.form.append('unidadestemas[]',JSON.stringify(this.inputs2[i]));\r\n                    // this.form.append('temas[]',JSON.stringify(this.inputs2[i].temas));\r\n                    // for(let j=0; j<this.inputs2[i].temas.length;j++){\r\n                    //      this.form.append('temas[]',this.inputs2[i].temas[j].id);\r\n                    // }\r\n                    \r\n\r\n                     \r\n                }\r\n             //}  \r\n\r\n                for(let i=0; i<this.attachments.length;i++){\r\n                    this.form.append('archivo[]',this.attachments[i]);\r\n                 \r\n                    if(this.docente == \"yes\"){\r\n                        this.form.append('id_libro',localStorage.getItem(\"idlibro\"));\r\n                        this.form.append('id_asignatura',localStorage.getItem(\"idasignatura\"));\r\n                    }else{\r\n                        this.form.append('id_asignatura',me.libro.libro.asignatura_idasignatura);\r\n                        this.form.append('id_libro',me.libro.libro.idlibro);\r\n                    }\r\n                    \r\n                    this.form.append('nombre_archivo[]',me.inputs[i].name);\r\n\r\n\r\n                }\r\n               \r\n              \r\n            //    console.log(\"hola\",this.form2);\r\n                const config = { headers: { 'Content-Type': 'multipart/form-data' } };\r\n                document.querySelectorAll('.upload-file').value=[];\r\n                me.$vs.loading()\r\n                axios.post(this.$data_url+'api/cargarmaterial',this.form, config).then(response=>{\r\n                    \r\n                \r\n                   // me.$vs.loading.close()\r\n                  \r\n                    console.log(response.data);\r\n                    \r\n                  if(response.data.status ==\"0\"){\r\n                      me.$vs.notify({\r\n                      text: 'No se pudo ingresar la informacion',\r\n                      color: 'danger',\r\n                      iconPack: 'feather',\r\n                      icon: 'icon-check'\r\n                    })\r\n                    me.$vs.loading.close()\r\n                    this.form = \"\";\r\n                    me.libro.libro = \"\";\r\n                    me.borrartodo()\r\n                    me.inputs2 = []\r\n                    // window.location.reload();\r\n\r\n                  }\r\n\r\n                   if(response.data.status ==\"1\"){\r\n                      me.$vs.notify({\r\n                      text: 'Se guardo correctamente',\r\n                      color: 'success',\r\n                      iconPack: 'feather',\r\n                      icon: 'icon-check'\r\n                    })\r\n                    me.$vs.loading.close()\r\n                    this.$router.go(-1);\r\n\r\n                  }\r\n                })\r\n                    .catch(response=>{\r\n                        //error\r\n                    });\r\n\r\n        },\r\n\r\n      \r\n      \r\n\r\n        \r\n          //lista de libros para usar en el select\r\n        listalibros(){\r\n            let me = this\r\n        this.$http.get(this.$server_url+`libroserie`).then(res => {\r\n                    me.arregloLibros = res.data.libroslista;\r\n                    // console.log(me.arregloLibros);\r\n                                    \r\n                    })\r\n                    .catch(function (error) {\r\n                    console.log(error)\r\n                    })\r\n\r\n        \r\n        },\r\n        //filtro para filtrar unidad por libro\r\n        filtrarUnidades(){\r\n            \r\n               let me = this;\r\n            \r\n              \r\n                const formData = new FormData();\r\n                \r\n                if(me.docente == \"yes\"){\r\n                     formData.append('idlibro', localStorage.getItem('idlibro'));\r\n                }else{\r\n                    this.inputs2 = [{unidad:\"\",temas:\"\"}];\r\n            \r\n                     if( me.libro.libro.idlibro === undefined ){\r\n                        me.$vs.notify({\r\n                            text:'Seleccione una libro antes de filtrar por unidades',\r\n                            color:'warning',\r\n                            iconPack: 'feather',\r\n                            icon:'icon-check'})\r\n                        return;\r\n                    }\r\n\r\n                \r\n                \r\n                    me.arregloTraeUnidades2 = [];\r\n                    \r\n                    me.$vs.loading()\r\n\r\n                    formData.append('idlibro', me.libro.libro.idlibro);\r\n                }\r\n                \r\n                   \r\n\r\n                this.$http.post(this.$server_url+'traerunidades', formData).then(res => {\r\n                   \r\n                    me.arregloTraeUnidades2 = res.data;\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error);\r\n                })  \r\n          },\r\n\r\n          //para filtrar los temas por unidad y que se muestre en el select\r\n          filtrarTemas(index){\r\n            let me = this;\r\n                \r\n            this.inputs2[index].temas=\"\";\r\n            // console.log(this.inputs2);\r\n            console.log(this.inputs2[index].unidad.id_unidad_libro);\r\n            let repeticion = this.inputs2[index].unidad.id_unidad_libro;\r\n            let contador =1;\r\n            if(this.inputs2.length >= 2){\r\n               for(let i =0; i<this.inputs2.length; i++){\r\n                   console.log(\"hola mundo\")\r\n                   if(this.inputs2[i].unidad.id_unidad_libro === repeticion){\r\n                       contador++;\r\n                       if(contador>2){\r\n                           alert(\"ya se eligio esa unidad seleccione otra\");\r\n                           this.inputs2[index].unidad=\"\";\r\n                           return false;\r\n                       }\r\n                   }\r\n\r\n                 \r\n                   \r\n               }\r\n            }\r\n            \r\n         \r\n\r\n\r\n                if( me.inputs2[index].unidad.id_unidad_libro === undefined ){\r\n                    me.$vs.notify({\r\n                        text:'Seleccione una libro antes de filtrar por unidades',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                    return;\r\n                }\r\n                me.arregloTraerTemas = []\r\n                \r\n                me.$vs.loading()\r\n                const formData = new FormData();\r\n                formData.append('id_unidad_libro', me.inputs2[index].unidad.id_unidad_libro);\r\n                   \r\n\r\n                this.$http.post(this.$server_url+'traertemas', formData).then(res => {\r\n                    me.arregloTraerTemas = res.data;\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error);\r\n                })  \r\n          },\r\n\r\n      \r\n    },\r\n    created(){\r\n        this.docente = localStorage.getItem(\"docente\");\r\n        this.listalibros();\r\n      \r\n      \r\n \r\n  \r\n  },\r\n  mounted(){\r\n      if(this.docente ==\"yes\"){\r\n            this.filtrarUnidades();\r\n      }\r\n \r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.principal{\r\n    /* background:red; */\r\n    display: flex;\r\n    \r\n    flex-wrap: wrap;\r\n}\r\n.principal2{\r\n    /* background:red; */\r\n    display: flex;\r\n    width:100%;\r\n    flex-wrap: wrap;\r\n}\r\n.grupo{\r\n    /* background: green; */\r\n    width: 45%;\r\n    margin:5px 20px;\r\n}\r\n</style>\r\n"]}]}