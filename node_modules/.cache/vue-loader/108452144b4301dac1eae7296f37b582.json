{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\temporadas\\components\\UploadVerificacion.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\temporadas\\components\\UploadVerificacion.vue","mtime":1712682816597},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport axios from 'axios'\r\n\texport default{\r\n        data(){\r\n            return{\r\n                attachmentArray:[],\r\n                tipoFile:'',\r\n                ifSaveImagen:false,\r\n            }\r\n        },\r\n        props:{\r\n            pedido:{\r\n                type:Object,\r\n                default:{},\r\n            },\r\n            titlebtn:{\r\n                type:String,\r\n                default:'',\r\n            },\r\n            campo_fecha:{\r\n                type:String,\r\n                default:'fecha_subir_cheque',\r\n            },\r\n            tipoDocumento:{\r\n                type:String,\r\n                default:'',\r\n            },\r\n            campo_file:{\r\n                type:String,\r\n                default:'fecha_subir_evidencia',\r\n            },\r\n            imgOld:{\r\n                type:String,\r\n                default:'',\r\n            },\r\n        },\r\n        watch:{\r\n            imgOld(results){\r\n                let me = this\r\n                me.attachmentArray = []\r\n                setTimeout(function() {\r\n                    if(me.imgOld){\r\n                        me.ifSaveImagen = true\r\n                    }\r\n                }, 1000);\r\n            }\r\n        },\r\n        mounted(){\r\n            let me = this;\r\n            me.attachmentArray = []\r\n        },\r\n        methods:{\r\n            removeItemFromArr (arr, item) {\r\n                let me = this;\r\n                const i = arr.indexOf(item)\r\n                arr.splice(i, 1)\r\n                document.getElementById(\"fileAutoriza\").value = ''\r\n            },\r\n            uploadFiles(e){\r\n                let me = this;\r\n                me.attachmentArray = []\r\n                // var archivo = document.getElementById(\"fileAutoriza\").files[0];\r\n                me.tipoFile  = \"\"\r\n                var archivo = e.target.files[0];\r\n                if(archivo.type == \"image/png\" || archivo.type == \"image/gif\" || archivo.type == \"image/jpeg\" || archivo.type == \"image/jpg\"){\r\n                    me.tipoFile = \"img\"\r\n                }\r\n                else{\r\n                    me.tipoFile = \"other\"\r\n                }\r\n                var reader = new FileReader();\r\n                if (me) {\r\n                    reader.readAsDataURL(archivo );\r\n                    reader.onloadend = function () {\r\n                        var cal = new Object();\r\n                        cal.file = archivo\r\n                        cal.img  = reader.result\r\n                        cal.tipo = me.tipoFile\r\n                        cal.name = archivo.name\r\n                        me.attachmentArray.push(cal)\r\n                    }\r\n                }\r\n            },\r\n            subirDocumento(){\r\n                let me = this;\r\n                if(me.ifSaveImagen == false){\r\n                    if(me.attachmentArray.length == 0){\r\n                        me.$vs.notify({\r\n                            text: \"Suba un una imagen de \"+me.tipoDocumento +\" por favor\",\r\n                            color: 'warning',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-alert-triangle'\r\n                        })\r\n                        return\r\n                    }\r\n                }\r\n                // if(me.tipoFile == 'other'){\r\n                //     me.$vs.notify({\r\n                //         text: \"Solo puede subir imagenes png, jpg o pdf por favor\",\r\n                //         color: 'warning',\r\n                //         iconPack: 'feather',\r\n                //         icon: 'icon-alert-triangle'\r\n                //     })\r\n                //     return\r\n                // }\r\n                //files\r\n                let imgsEnviar = []\r\n                let formData = new FormData();\r\n                if(me.ifSaveImagen){\r\n                    formData.append('NoCambios','yes')\r\n                }else{\r\n                    me.attachmentArray.forEach(element => {\r\n                    imgsEnviar.push(element.file)\r\n                    });\r\n                    for(let i=0; i<this.attachmentArray.length;i++){\r\n                        formData.append('archivos[]',              imgsEnviar[i]);\r\n                    }\r\n                }\r\n                formData.append('campo_fecha',      me.campo_fecha)\r\n                formData.append('campo_file',       me.campo_file)\r\n                formData.append('verificacion_id',  me.pedido.id)\r\n                formData.append('contrato',         me.pedido.contrato)\r\n                formData.append('tipoDocumento',    me.tipoDocumento)\r\n                formData.append('imgOld',           me.imgOld)\r\n                const config = { headers: { 'Content-Type': 'multipart/form-data' } };\r\n                me.$vs.loading()\r\n                axios.post(this.$data_url + 'api/saveFileVerificacion', formData, config)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                    text:\"Se guardo correctamente\",\r\n                    color:'success',\r\n                    iconPack: 'feather',\r\n                    icon:'icon-check'})\r\n                    me.$emit('recharge',true)\r\n                    document.getElementById(\"fileAutoriza\").value = '';\r\n                    me.attachmentArray                     = []\r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.loading.close()\r\n                })\r\n            },\r\n        }\r\n    }\r\n\r\n\r\n",{"version":3,"sources":["UploadVerificacion.vue"],"names":[],"mappings":";AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UploadVerificacion.vue","sourceRoot":"src/views/temporadas/components","sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"box-input\" v-if=\"attachmentArray.length == 0 && ifSaveImagen == false\">\r\n            <div class=\" box upload-container\">\r\n                <input type=\"file\" name=\"file7\" id=\"file7\" class=\"file7\" v-on:change=\"uploadFiles\" />\r\n            </div>\r\n            <br>\r\n        </div>\r\n        <div class=\"box-input\" v-if=\"attachmentArray.length == 0 && ifSaveImagen == true\">\r\n            <div class=\"flex\" style=\"justify-content: center;\">\r\n                <div class=\"flex\" style=\"flex-direction: column;\">\r\n                    <img v-if=\"imgOld.substr(-3) == 'pdf'\" style=\"width: 200px;\"  src=\"@/assets/images/file-icons/doc.png\"/>\r\n                    <img v-else id=\"img1\" width=\"200\" class=\"img-responsive mb-2 ml-1\" :src=\"$data_url+'archivos/verificaciones/'+tipoDocumento+'/'+imgOld\" style=\"border-radius: 5px;margin: 0 auto;\">\r\n                    <small class=\"mt-1 ml-2\">{{ imgOld }}</small>\r\n                </div>\r\n                <vs-button radius type=\"line\" @click=\"ifSaveImagen = false;\"  class=\"ml-2 mt-4\" color=\"danger\" icon=\"delete\"></vs-button>\r\n            </div>\r\n            <br>\r\n        </div>\r\n        <div class=\"flex\" style=\"margin-top: -10px;\">\r\n            <div class=\"flex\" v-for=\"(tr,key) in attachmentArray\" :key=\"key\" style=\"margin: 0 auto;\">\r\n                <div class=\"flex\" style=\"flex-direction: column;\">\r\n                    <img id=\"img1\" v-if=\"tr.tipo == 'img'\" width=\"200\" class=\"img-responsive mb-2 ml-1\" v-bind:src=\"tr.img\" style=\"border-radius: 5px;margin: 0 auto;\">\r\n                    <img v-else style=\"width: 200px;\"  src=\"@/assets/images/file-icons/doc.png\"/>\r\n                    <small class=\"mt-1 ml-2\">{{ tr.name }}</small>\r\n                </div>\r\n                <vs-button radius type=\"line\"  @click=\"removeItemFromArr(attachmentArray,tr)\" class=\"ml-2 mt-4\" color=\"danger\" icon=\"delete\"></vs-button>\r\n            </div>\r\n        </div>\r\n        <div class=\"flex\" style=\"justify-content: center;\">\r\n            <vs-button color=\"success\" @click=\"subirDocumento()\" class=\"mt-2\" type=\"gradient\">{{ titlebtn }}</vs-button>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport axios from 'axios'\r\n\texport default{\r\n        data(){\r\n            return{\r\n                attachmentArray:[],\r\n                tipoFile:'',\r\n                ifSaveImagen:false,\r\n            }\r\n        },\r\n        props:{\r\n            pedido:{\r\n                type:Object,\r\n                default:{},\r\n            },\r\n            titlebtn:{\r\n                type:String,\r\n                default:'',\r\n            },\r\n            campo_fecha:{\r\n                type:String,\r\n                default:'fecha_subir_cheque',\r\n            },\r\n            tipoDocumento:{\r\n                type:String,\r\n                default:'',\r\n            },\r\n            campo_file:{\r\n                type:String,\r\n                default:'fecha_subir_evidencia',\r\n            },\r\n            imgOld:{\r\n                type:String,\r\n                default:'',\r\n            },\r\n        },\r\n        watch:{\r\n            imgOld(results){\r\n                let me = this\r\n                me.attachmentArray = []\r\n                setTimeout(function() {\r\n                    if(me.imgOld){\r\n                        me.ifSaveImagen = true\r\n                    }\r\n                }, 1000);\r\n            }\r\n        },\r\n        mounted(){\r\n            let me = this;\r\n            me.attachmentArray = []\r\n        },\r\n        methods:{\r\n            removeItemFromArr (arr, item) {\r\n                let me = this;\r\n                const i = arr.indexOf(item)\r\n                arr.splice(i, 1)\r\n                document.getElementById(\"fileAutoriza\").value = ''\r\n            },\r\n            uploadFiles(e){\r\n                let me = this;\r\n                me.attachmentArray = []\r\n                // var archivo = document.getElementById(\"fileAutoriza\").files[0];\r\n                me.tipoFile  = \"\"\r\n                var archivo = e.target.files[0];\r\n                if(archivo.type == \"image/png\" || archivo.type == \"image/gif\" || archivo.type == \"image/jpeg\" || archivo.type == \"image/jpg\"){\r\n                    me.tipoFile = \"img\"\r\n                }\r\n                else{\r\n                    me.tipoFile = \"other\"\r\n                }\r\n                var reader = new FileReader();\r\n                if (me) {\r\n                    reader.readAsDataURL(archivo );\r\n                    reader.onloadend = function () {\r\n                        var cal = new Object();\r\n                        cal.file = archivo\r\n                        cal.img  = reader.result\r\n                        cal.tipo = me.tipoFile\r\n                        cal.name = archivo.name\r\n                        me.attachmentArray.push(cal)\r\n                    }\r\n                }\r\n            },\r\n            subirDocumento(){\r\n                let me = this;\r\n                if(me.ifSaveImagen == false){\r\n                    if(me.attachmentArray.length == 0){\r\n                        me.$vs.notify({\r\n                            text: \"Suba un una imagen de \"+me.tipoDocumento +\" por favor\",\r\n                            color: 'warning',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-alert-triangle'\r\n                        })\r\n                        return\r\n                    }\r\n                }\r\n                // if(me.tipoFile == 'other'){\r\n                //     me.$vs.notify({\r\n                //         text: \"Solo puede subir imagenes png, jpg o pdf por favor\",\r\n                //         color: 'warning',\r\n                //         iconPack: 'feather',\r\n                //         icon: 'icon-alert-triangle'\r\n                //     })\r\n                //     return\r\n                // }\r\n                //files\r\n                let imgsEnviar = []\r\n                let formData = new FormData();\r\n                if(me.ifSaveImagen){\r\n                    formData.append('NoCambios','yes')\r\n                }else{\r\n                    me.attachmentArray.forEach(element => {\r\n                    imgsEnviar.push(element.file)\r\n                    });\r\n                    for(let i=0; i<this.attachmentArray.length;i++){\r\n                        formData.append('archivos[]',              imgsEnviar[i]);\r\n                    }\r\n                }\r\n                formData.append('campo_fecha',      me.campo_fecha)\r\n                formData.append('campo_file',       me.campo_file)\r\n                formData.append('verificacion_id',  me.pedido.id)\r\n                formData.append('contrato',         me.pedido.contrato)\r\n                formData.append('tipoDocumento',    me.tipoDocumento)\r\n                formData.append('imgOld',           me.imgOld)\r\n                const config = { headers: { 'Content-Type': 'multipart/form-data' } };\r\n                me.$vs.loading()\r\n                axios.post(this.$data_url + 'api/saveFileVerificacion', formData, config)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                    text:\"Se guardo correctamente\",\r\n                    color:'success',\r\n                    iconPack: 'feather',\r\n                    icon:'icon-check'})\r\n                    me.$emit('recharge',true)\r\n                    document.getElementById(\"fileAutoriza\").value = '';\r\n                    me.attachmentArray                     = []\r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.loading.close()\r\n                })\r\n            },\r\n        }\r\n    }\r\n\r\n\r\n</script>\r\n<style scoped>\r\n   .box-input{\r\n   }\r\n    .upload-container{\r\n      position:relative}\r\n      .upload-container input{\r\n        border:1px solid #92b0b3;\r\n        background:#217bc5;\r\n        outline:2px dashed #92b0b3;\r\n        outline-offset:-10px;\r\n        padding:100px 0px 100px 130px;\r\n        width:100%;\r\n        color:white;\r\n    }\r\n      .upload-container input:hover{\r\n        background:#2c78cf}\r\n      .upload-container:before{\r\n        position:absolute;\r\n        bottom:50px;\r\n        left:23%;\r\n        content:\" Seleccione un archivo o arrastre aqui \";\r\n        color:#f1f9fa;\r\n        font-weight:900\r\n    }\r\n      .upload-btn{\r\n        margin-left:300px;\r\n        padding:7px 20px}\r\n</style>\r\n"]}]}