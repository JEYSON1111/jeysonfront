{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\libros\\libros.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\libros\\libros.vue","mtime":1712682816124},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\n    import Vue from 'vue'\r\n    import axios from 'axios'\r\n    import vSelect from 'vue-select'\r\n    import flatPickr from 'vue-flatpickr-component';\r\n    import 'flatpickr/dist/flatpickr.css';\r\n    export default {\r\n        data() {\r\n            return {\r\n                Asignaturas: [],\r\n                libroserieArreglo:[],\r\n                activeConfirm: false,\r\n                popupVerSerie:false,\r\n                id: 0,\r\n                idlibro: 0,\r\n                title:'',\r\n                popupGuardarLibro:false,\r\n                popupGuardar:false,\r\n                unidadesLibro:[],\r\n                arregloSeries:[],\r\n                options1: [\r\n                    { text: '--Seleccione--', value: null },\r\n                    { text: 'Si', value: true },\r\n                    { text: 'No', value: false },\r\n                ],\r\n                Grupos: [],\r\n                gru_pro_codigo: 1,\r\n                series:[],\r\n                tabProducto: {\r\n                    pro_codigo: '',\r\n                    gru_pro_codigo: '',\r\n                    pro_nombre: '',\r\n                    pro_descripcion: '',\r\n                    pro_iva: '',\r\n                    pro_valor: '',\r\n                    pro_descuento: '',\r\n                    pro_stock: '',\r\n                    pro_costo: '',\r\n                    pro_peso: '',\r\n                    pro_estado: '',                                \r\n                    id_serie:'',\r\n                    idlibro:'',\r\n                    year:''\r\n                },\r\n                libro: {\r\n                    nombrelibro: \"\",\r\n                    nombre_imprimir:\"\",\r\n                    descripcionlibro: \"\",\r\n                    serie: '0',\r\n                    weblibro: \"\",\r\n                    pdfsinguia: \"\",\r\n                    pdfconguia: \"\",\r\n                    guiadidactica: \"\",\r\n                    asignatura_idasignatura: \"\",\r\n                    demo:'',\r\n                    portada:\"portada.png\",\r\n                    //SIERRA LIBROS\r\n                    s_weblibro: \"\",\r\n                    s_pdfsinguia: \"\",\r\n                    s_pdfconguia: \"\",\r\n                    s_guiadidactica: \"\",\r\n                    s_portada:\"portada.png\",\r\n                    //COSTA LIBROS\r\n                    c_weblibro: \"\",\r\n                    c_pdfsinguia: \"\",\r\n                    c_pdfconguia: \"\",\r\n                    c_guiadidactica: \"\",\r\n                    c_portada:\"portada.png\",\r\n                },\r\n                serie:{\r\n                    nombrelibro:'',\r\n                    nombre_serie:'',\r\n                    iniciales:'',\r\n                    codigo_liquidacion:'',\r\n                    nombre:'',\r\n                    year:'',\r\n                    version2:''\r\n                },\r\n                //para mostrar lo de libro serie\r\n                lsnombre:\"\",\r\n                lscodigo_liquidacion:\"\",\r\n                lsyear:\"\",\r\n                lsversion:\"\",\r\n                lsiniciales:\"\",\r\n                lsnombre_serie:\"\",\r\n                popupLinkLibro: false,\r\n                link:{\r\n                  pag_ini: '',\r\n                  pag_fin: '',\r\n                  fecha_inicio: '',\r\n                  fecha_caducidad: '',\r\n                },\r\n                configdateTimePicker: {\r\n                  enableTime: true,\r\n                  dateFormat: 'Y-m-d H:i:s'\r\n                },\r\n                links: [],\r\n                permisoRoot:false,\r\n                usuario:[],\r\n                modoEdicion: false,\r\n                numeros: 0\r\n            }\r\n        },\r\n        components: {\r\n            'v-select': vSelect,\r\n            flatPickr\r\n        },\r\n        props:{\r\n            arreglosLibros:{\r\n              type:Array,\r\n              default:[],\r\n            },\r\n            //0 => no tendra botones; 1 => si\r\n            doActions:{\r\n              type:Number,\r\n              default:1\r\n            }\r\n        },\r\n        methods: {\r\n            validarStock() {\r\n                let stock = this.tabProducto.proStock;\r\n                if (!/^\\d+$/.test(stock) || isNaN(stock)) {\r\n                    this.tabProducto.proStock = '';\r\n                }\r\n            },\r\n            validarCosto() {\r\n                const costo = this.tabProducto.proCosto;\r\n                if (/^\\d/.test(costo)) { // si comienza con un dígito\r\n                 if (!/^\\d{0,18}(\\.\\d{1,5})?$/.test(costo)) {\r\n                    this.tabProducto.proCosto = '';\r\n                    }\r\n                } else if (/^[,.e]/.test(costo)) { // si comienza con una coma o un punto\r\n                    if (!/^([,.]\\d{1,5})?$/.test(costo)) {\r\n                    this.tabProducto.proCosto = '';\r\n                    }\r\n                } else { // si comienza con cualquier otro caracter\r\n                    this.tabProducto.proCosto = '';\r\n                }\r\n            },\r\n            validarPeso() {\r\n                const peso = this.tabProducto.proPeso;\r\n                if (/^\\d/.test(peso)) { // si comienza con un dígito\r\n                 if (!/^\\d{0,15}(\\.\\d{1,5})?$/.test(peso)) {\r\n                    this.tabProducto.proPeso = '';\r\n                    }\r\n                } else if (/^[,.e]/.test(peso)) { // si comienza con una coma o un punto\r\n                    if (!/^([,.]\\d{1,5})?$/.test(peso)) {\r\n                    this.tabProducto.proPeso = '';\r\n                    }\r\n                } else { // si comienza con cualquier otro caracter\r\n                    this.tabProducto.proPeso = '';\r\n                }\r\n            },\r\n            handleRadioInput(opcion) {\r\n                // Vacía el array Productos cuando se selecciona la opción 'nombres'\r\n                if (opcion === 'nombres') {\r\n                    this.Productos = [];\r\n                }\r\n                else if(opcion === 'codigopro'){\r\n                    this.Productos = [];\r\n                }\r\n            },\r\n            validarDescuento() {\r\n                let descuento = this.tabProducto.pro_descuento;\r\n                // Reemplazar comas por puntos solo si hay comas en la cadena\r\n                if (descuento.includes(',')) {\r\n                    descuento = descuento.replace(',', '.');\r\n                    this.tabProducto.pro_descuento = descuento;\r\n                }\r\n                // Validar el formato del número\r\n                if (!/^\\d{0,14}(\\.\\d{0,2})?$/.test(descuento)) {\r\n                    this.tabProducto.pro_descuento = '';\r\n                    console.log(\"reset\");\r\n                }\r\n            },\r\n            validarValor() {\r\n                const valor = this.tabProducto.proValor;\r\n                if (/^\\d/.test(valor)) { // si comienza con un dígito\r\n                 if (!/^\\d{0,18}(\\.\\d{1,5})?$/.test(valor)) {\r\n                    this.tabProducto.proValor = '';\r\n                    }\r\n                } else if (/^[,.e]/.test(valor)) { // si comienza con una coma o un punto\r\n                    if (!/^([,.]\\d{1,5})?$/.test(valor)) {\r\n                    this.tabProducto.proValor = '';\r\n                    }\r\n                } else { // si comienza con cualquier otro caracter\r\n                    this.tabProducto.proValor = '';\r\n                }\r\n            },\r\n            getGrupoProducto() {\r\n                let me = this;\r\n                this.$http.get(this.$server_url+'GetGrupoProducto_todo')\r\n                //axios.get(this.$apifacturacion_url + 'f_Producto')\r\n                .then(res => {\r\n                //let resultado = res.data.productos.filter(p => p.proCodigo !== 0);\r\n                //this.Productos = resultado;\r\n                this.Grupos = res.data;\r\n                // console.log(this.Productos);\r\n                // console.log(this.Grupos);\r\n                })\r\n                .catch(err => {\r\n                console.log(err)\r\n                })\r\n            },\r\n            convertirAMayusculas() {            \r\n                const numerosString = this.tabProducto.pro_codigo.replace(/\\D/g, '');\r\n                this.numeros = numerosString ? parseInt(numerosString) : 0; // Asignar el valor a tabProducto.pro_codigo             \r\n                // Extraer los números y almacenarlos en la variable 'numeros'\r\n            },\r\n            guardarnuevo() {\r\n                let me = this;\r\n                me.modoEdicion = true;\r\n                const usuariorespo = localStorage.getItem(\"usuario\");\r\n                const usuarioObjeto = JSON.parse(usuariorespo);\r\n                //VALIDACION DE CAMPOS NULOS Y VACIOS\r\n                if (me.tabProducto.pro_codigo === '' || me.tabProducto.pro_codigo === null) {\r\n                    this.$vs.notify({\r\n                        text: 'Escriba el código del Producto antes de guardar',\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    });\r\n                    return;\r\n                }\r\n                if (me.tabProducto.gru_pro_codigo === '' || me.tabProducto.gru_pro_codigo === null) {\r\n                    this.$vs.notify({\r\n                        text: 'Seleccione el grupo del producto antes de guardar',\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    });\r\n                    return;\r\n                }\r\n                let datos  = {\r\n                    \"pro_codigo\": me.tabProducto.pro_codigo,\r\n                    \"gru_pro_codigo\": me.tabProducto.gru_pro_codigo,\r\n                    \"pro_nombre\": me.tabProducto.pro_nombre,\r\n                    \"pro_descripcion\": me.tabProducto.pro_descripcion,\r\n                    \"pro_iva\": me.tabProducto.pro_iva,\r\n                    \"pro_valor\": parseFloat(me.tabProducto.pro_valor),\r\n                    \"pro_descuento\": parseFloat(me.tabProducto.pro_descuento),\r\n                    \"pro_stock\": parseFloat(me.tabProducto.pro_stock),\r\n                    \"pro_costo\": parseFloat(me.tabProducto.pro_costo),\r\n                    \"pro_peso\": parseFloat(me.tabProducto.pro_peso),\r\n                    \"nombrelibro\": me.tabProducto.pro_nombre,\r\n                    \"nombre_imprimir\": me.tabProducto.pro_nombre,\r\n                    \"descripcionlibro\": me.tabProducto.pro_descripcion,\r\n                    \"serie\": 0,\r\n                    \"weblibro\": null,\r\n                    \"pdfsinguia\":null ,\r\n                    \"pdfconguia\": null,\r\n                    \"guiadidactica\": null,\r\n                    \"asignatura_idasignatura\": null,\r\n                    \"portada\": \"portada.png\",\r\n                    \"demo\": null,\r\n                    \"id_serie\": me.tabProducto.id_serie,\r\n                    \"codigo_liquidacion\": me.tabProducto.pro_codigo,\r\n                    \"year\": parseInt(me.numeros),\r\n                    \"version2\": null,\r\n                    \"s_weblibro\": null,\r\n                    \"s_pdfsinguia\": null,\r\n                    \"s_pdfconguia\": null,\r\n                    \"s_guiadidactica\": null,\r\n                    \"s_portada\": \"portada.png\",\r\n                    \"c_weblibro\": null,\r\n                    \"c_pdfsinguia\": null,\r\n                    \"c_pdfconguia\": null,\r\n                    \"c_guiadidactica\": null,\r\n                    \"c_portada\": \"portada.png\",\r\n                    \"user_created\": usuarioObjeto.idusuario,                \r\n                }\r\n                me.$vs.loading()\r\n                //axios.post(this.$apifacturacion_url + 'f_Vendedor', datos)\r\n                this.$http.post(this.$server_url+'Registrar_modificar_producto', datos)\r\n                // this.$http.post(this.$server_url+'guardarLibro', datos2)\r\n                .then(res => {\r\n                    me.$vs.loading.close()\r\n                    me.popupGuardar = false\r\n                    if(res.data.message){\r\n                        me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-user'\r\n                        })\r\n                    }else{\r\n                        me.$vs.notify({\r\n                            text: 'Guardado con éxito',\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-check'\r\n                        });\r\n                    }\r\n                    limpiar()\r\n                })\r\n                .catch(function () {\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: 'Producto no se pudo guardar',\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-x'\r\n                    })\r\n                })\r\n            },\r\n            //para obtener el listado de los usuarios root\r\n            getUserRoot() {\r\n                let me = this;\r\n                this.$http.get(this.$server_url+'permisos?permiso=yes&usuario_id='+me.usuario.idusuario)\r\n                    .then(function (res) {\r\n                        if(res.data.status == '1'){\r\n                            me.permisoRoot = true\r\n                        }else{\r\n                            me.permisoRoot = false\r\n                        }\r\n                    })\r\n                    .catch(function (error) {\r\n                        console.log(error + ' error');\r\n                    })\r\n            },\r\n            //para obtener el listado de asignaturas\r\n            getAsignaturas() {\r\n                let me = this;\r\n                me.$vs.loading();\r\n                this.$http.get(this.$server_url + 'listaLibro')\r\n                    .then(function (res) {\r\n                        me.Asignaturas = res.data.asignatura\r\n                        me.$vs.loading.close()\r\n                    })\r\n                    .catch(function (error) {\r\n                        console.log(error + ' error');\r\n                        me.$vs.loading.close()\r\n                    })\r\n            },\r\n            //lista de series para usar en el select\r\n            listaSeries(){\r\n                let me = this\r\n            this.$http.get(this.$server_url+`libroserie`).then(res => {\r\n                me.arregloSeries = res.data.serieslista;\r\n                })\r\n                .catch(function (error) {\r\n                console.log(error)\r\n                })\r\n            },\r\n            //para ver el libro digital\r\n            datolibro(data,url) {\r\n                let me = this;\r\n                let region  = localStorage.region\r\n                 this.$http.get(this.$server_url+'menu_unidades_libros/' + data.idlibro+'/'+region)\r\n                .then(function (response) {\r\n                    me.unidadesLibro = response.data\r\n                })\r\n                .catch(function (error) {})\r\n                localStorage.url = url;\r\n                for (let index = 0; index < me.unidadesLibro.length; index++) {\r\n                    if (index == 0) {\r\n                        localStorage.pag_inicio = me.unidadesLibro[index].pag_inicio\r\n                    }\r\n                    localStorage.pag_fin = me.unidadesLibro[index].pag_fin\r\n                }\r\n                localStorage.vistalibro = 'por_unidad'\r\n                 let route = this.$router.resolve({path: '/admin/libro/desgloselibro'});\r\n                // let route = this.$router.resolve('/link/to/page'); // This also works.\r\n                window.open(route.href, '_blank');\r\n            },\r\n            //para ver el libro sin guia en el admin\r\n            datopdfsinguia(url) {\r\n                let me = this\r\n                if (url === null || url === 'null') {\r\n                    me.$vs.notify({\r\n                        text: 'El PDF sin guía aun no está disponible',\r\n                        color: 'warning',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    return\r\n                }\r\n                localStorage.pdfsinguia = url;\r\n                let route = this.$router.resolve({path: '/admin/libro/pdfsinguia'});\r\n                window.open(route.href, '_blank');\r\n            },\r\n            //para ver el libro con guia en el admin\r\n            datopdfconguia(url) {\r\n                let me = this\r\n                if (url === null || url === 'null') {\r\n                    me.$vs.notify({\r\n                        text: 'El PDF con guía aun no está disponible',\r\n                        color: 'warning',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    return\r\n                }\r\n                localStorage.url_guia = url;\r\n                let route = this.$router.resolve({path: '/docente/libro/pdfconguia'});\r\n                window.open(route.href, '_blank');\r\n            },\r\n            datopdfguiadidactica(url) {\r\n                let me = this\r\n                if (url === null || url === 'null') {\r\n                    me.$vs.notify({\r\n                        text: 'La guía didáctica aun no está disponible',\r\n                        color: 'warning',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    return\r\n                }\r\n                localStorage.url_guiadid = url;\r\n                let route = this.$router.resolve({path: '/docente/libro/pdfguiadidactica'});\r\n                window.open(route.href, '_blank');\r\n            },\r\n            //para eliminar el libro\r\n            eliminarLibro() {\r\n                let me = this;\r\n                let formData = new FormData();\r\n                formData.append('idlibro', me.idlibro);\r\n                me.$vs.loading()\r\n                this.$http.post(this.$server_url + 'eliminarLibro', formData)\r\n                    .then(res => {\r\n                        me.$vs.loading.close()\r\n                        me.$vs.notify({\r\n                            text: 'Libro desactivado con exito',\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-check'\r\n                        })\r\n                        me.$emit('recharge',true)\r\n                    })\r\n            },\r\n            //para activar el libro\r\n            activarLibro(){\r\n                let me = this;\r\n                let formData = new FormData();\r\n                formData.append('idlibro', me.idlibro);\r\n                me.$vs.loading()\r\n                this.$http.post(this.$server_url + 'activarLibro', formData)\r\n                    .then(res => {\r\n                        me.$vs.loading.close()\r\n                        me.$vs.notify({\r\n                            text: 'Libro Activado con exito',\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-check'\r\n                        })\r\n                        me.$emit('recharge',true)\r\n                    })\r\n            },\r\n            //para abrir el popup de confimacion para eliminar\r\n            openConfirm(idlibro) {\r\n                this.idlibro = idlibro;\r\n                this.$vs.dialog({\r\n                    type: 'confirm',\r\n                    color: 'danger',\r\n                    title: `Confirmación`,\r\n                    text: 'Está seguro de desactivar este libro?',\r\n                    acceptText:'Aceptar',\r\n                    cancelText:'Cancelar',\r\n                    accept: this.eliminarLibro\r\n                })\r\n            },\r\n            openConfirmActivar(idlibro){\r\n                 this.idlibro = idlibro;\r\n                this.$vs.dialog({\r\n                    type: 'confirm',\r\n                    color: 'danger',\r\n                    title: `Confirmación`,\r\n                    text: 'Está seguro de activar este libro?',\r\n                    acceptText:'Aceptar',\r\n                    cancelText:'Cancelar',\r\n                    accept: this.activarLibro\r\n                })\r\n            },\r\n            //para guardar las areas\r\n            guardarLibro() {\r\n                let me = this;\r\n                if (me.libro.nombrelibro === '' || me.libro.serie == '' || me.serie.year == '' ) {\r\n                  this.$vs.notify({\r\n                    text: 'Debe completar todos los campos antes de guardar',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                  })\r\n                  return;\r\n                }\r\n                if(me.libro.nombre_imprimir == \"\"){\r\n                  this.$vs.notify({\r\n                    text: 'Debe ingresar el nombre del libro para imprimir',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                  })\r\n                  return;\r\n                }\r\n                let formData = new FormData();\r\n                formData.append('idlibro',                  me.id);\r\n                formData.append('nombrelibro',              me.libro.nombrelibro);\r\n                formData.append('nombre_imprimir',          me.libro.nombre_imprimir)\r\n                formData.append('descripcionlibro',         me.libro.descripcionlibro);\r\n                formData.append('serie',                    me.libro.serie);\r\n                formData.append('weblibro',                 me.libro.weblibro);\r\n                formData.append('pdfsinguia',               me.libro.pdfsinguia);\r\n                formData.append('pdfconguia',               me.libro.pdfconguia);\r\n                formData.append('guiadidactica',            me.libro.guiadidactica);\r\n                formData.append('asignatura_idasignatura',  me.libro.asignatura_idasignatura.idasignatura);\r\n                formData.append('portada',                  me.libro.portada);\r\n                formData.append('demo',                     me.libro.demo)\r\n                //para guardar la serie\r\n                formData.append('id_serie',                 me.serie.nombre_serie.id_serie);\r\n                formData.append('codigo_liquidacion',       me.serie.codigo_liquidacion);\r\n                formData.append('year',                     me.serie.year);\r\n                formData.append('version2',                 me.serie.version2);\r\n                //SIERRA\r\n                formData.append('s_weblibro',               me.libro.s_weblibro);\r\n                formData.append('s_pdfsinguia',             me.libro.s_pdfsinguia);\r\n                formData.append('s_pdfconguia',             me.libro.s_pdfconguia);\r\n                formData.append('s_guiadidactica',          me.libro.s_guiadidactica);\r\n                formData.append('s_portada',                me.libro.s_portada);\r\n                //COSTA\r\n                formData.append('c_weblibro',               me.libro.c_weblibro);\r\n                formData.append('c_pdfsinguia',             me.libro.c_pdfsinguia);\r\n                formData.append('c_pdfconguia',             me.libro.c_pdfconguia);\r\n                formData.append('c_guiadidactica',          me.libro.c_guiadidactica);\r\n                formData.append('c_portada',                me.libro.c_portada);\r\n                me.$vs.loading()\r\n                this.$http.post(this.$server_url + 'guardarLibro', formData)\r\n                    .then(function (res) {\r\n                        me.$vs.notify({\r\n                            text: res.data.message,\r\n                            color: 'primary',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-alert-triangle'\r\n                        })\r\n                        me.$vs.loading.close()\r\n                        me.popupGuardarLibro = false\r\n                        if(me.id == 0){\r\n                            me.$emit('nuevoLibro',me.libro.nombrelibro)\r\n                        }else{\r\n                            console.log(\"mundo\")\r\n                            me.$emit('recharge',true)\r\n                        }\r\n                        limpiar()\r\n                    })\r\n                    .catch(function (error) {})\r\n    \r\n            },\r\n            //para editar los campos\r\n            openModalEditar(data = {}) {\r\n                let me = this;\r\n                //llenar la data en los campos\r\n                me.id = data.idlibro;\r\n                me.libro.nombrelibro            = data.nombrelibro;\r\n                me.libro.nombre_imprimir        = data.nombre_imprimir\r\n                me.libro.descripcionlibro       = data.descripcionlibro;\r\n                me.libro.serie                  = data.serie;\r\n                me.libro.weblibro               = data.weblibro;\r\n                me.libro.pdfsinguia             = data.pdfsinguia;\r\n                me.libro.pdfconguia             = data.pdfconguia;\r\n                me.libro.portada                = data.portada;\r\n                if(data.guiadidactica == null ||  data.guiadidactica == \"null\" ||   data.guiadidactica == \"0\")\r\n                {\r\n                    me.libro.guiadidactica = \"\";\r\n                }else{\r\n                    me.libro.guiadidactica = data.guiadidactica;\r\n                }\r\n                if(data.year == null ||  data.year == \"null\" ||   data.year == \"0\")\r\n                {\r\n                    me.serie.year = \"\";\r\n                }else{\r\n                    me.serie.year = data.year;\r\n                }\r\n                if(data.version == null ||  data.version == \"null\" ||   data.version == \"0\")\r\n                {\r\n                    me.serie.version2 = \"\";\r\n                }else{\r\n                    me.serie.version2 = data.version;\r\n                }\r\n                me.libro.asignatura_idasignatura = { idasignatura: data.asignatura_idasignatura, nombreasignatura: data.asignatura };\r\n                //para  editar la tabla serie\r\n                me.serie.nombre_serie = { id_serie: data.id_serie, nombre_serie: data.nombre_serie };\r\n                // me.serie.iniciales = data.iniciales;\r\n                me.serie.codigo_liquidacion = data.codigo_liquidacion;\r\n                //DATOS LIBRO SIERRA\r\n                me.libro.s_weblibro            = data.s_weblibro\r\n                me.libro.s_pdfsinguia          = data.s_pdfsinguia\r\n                me.libro.s_pdfconguia          = data.s_pdfconguia\r\n                me.libro.s_guiadidactica       = data.s_guiadidactica\r\n                me.libro.s_portada             = data.s_portada\r\n                me.libro.demo                  = data.demo\r\n                //DATOS LIBRO COSTA\r\n                me.libro.c_weblibro            = data.c_weblibro\r\n                me.libro.c_pdfsinguia          = data.c_pdfsinguia\r\n                me.libro.c_pdfconguia          = data.c_pdfconguia\r\n                me.libro.c_guiadidactica       = data.c_guiadidactica\r\n                me.libro.c_portada             = data.c_portada\r\n                me.popupGuardarLibro           = true;\r\n                me.modoEdicion                 = true;\r\n            },\r\n            //para ver el libro serie especifico\r\n            verLibroSerie(data={}){\r\n                let me =this;\r\n                me.popupVerSerie = true\r\n                 me.$vs.loading();\r\n                    this.$http.get(this.$server_url+'verLibroSerie?idlibro='+data.idlibro)\r\n                    .then(res => {\r\n                        me.lsiniciales = res.data[0].iniciales;\r\n                        me.lsnombre= res.data[0].nombre\r\n                        me.lscodigo_liquidacion= res.data[0].codigo_liquidacion\r\n                        me.lsyear= res.data[0].year\r\n                        me.lsversion= res.data[0].version\r\n                        me.lsnombre_serie= res.data[0].nombre_serie\r\n                        me.$vs.loading.close();\r\n                    })\r\n                    .catch(function (error) {\r\n                      console.log(error)\r\n                          me.$vs.loading.close();\r\n                    })\r\n            },\r\n            //para limpiar los campos\r\n            limpiar() {\r\n                let me                              = this;\r\n                me.id                               = 0\r\n                me.libro.nombrelibro                = \"\";\r\n                me.libro.nombre_imprimir            = \"\";\r\n                me.libro.descripcionlibro           = \"\";\r\n                me.libro.weblibro                   = \"\";\r\n                me.libro.pdfsinguia                 = \"\";\r\n                me.libro.pdfconguia                 = \"\";\r\n                me.libro.guiadidactica              = \"\";\r\n                me.libro.serie                      = \"0\";\r\n                me.libro.asignatura_idasignatura    = \"\";\r\n                me.libro.portada                    = \"portada.png\"\r\n                me.libro.demo                       = \"\"\r\n                //para limpiar la tabla serie\r\n                me.serie.nombre_serie               = \"\";\r\n                me.serie.iniciales                  = \"\";\r\n                me.serie.codigo_liquidacion         = \"\";\r\n                me.serie.year                       = \"\";\r\n                me.serie.version2                   = \"\";\r\n                //DATOS LIBRO SIERRA\r\n                me.libro.s_weblibro                 = \"\"\r\n                me.libro.s_pdfsinguia               = \"\"\r\n                me.libro.s_pdfconguia               = \"\"\r\n                me.libro.s_guiadidactica            = \"\"\r\n                me.libro.s_portada                  = \"portada.png\"\r\n                //DATOS LIBRO COSTA\r\n                me.libro.c_weblibro                 = \"\"\r\n                me.libro.c_pdfsinguia               = \"\"\r\n                me.libro.c_pdfconguia               = \"\"\r\n                me.libro.c_guiadidactica            = \"\"\r\n                me.libro.c_portada                  = \"portada.png\"\r\n                me.tabProducto.pro_codigo           = \"\"\r\n                me.tabProducto.gru_pro_codigo       = 1\r\n                me.tabProducto.pro_costo            = null\r\n                me.tabProducto.pro_descripcion      = \"\"\r\n                me.tabProducto.pro_descuento        = \"\"\r\n                me.tabProducto.pro_iva              = null\r\n                me.tabProducto.pro_nombre           = \"\"\r\n                me.tabProducto.pro_peso             = \"\"\r\n                me.tabProducto.pro_stock            = \"\"\r\n                me.tabProducto.pro_valor            = \"\"\r\n                me.tabProducto.id_serie             = \"\"\r\n            },\r\n            getLinksLibros(){\r\n              let me = this\r\n              me.$vs.loading();\r\n              me.$http.get(this.$server_url + 'get_links_libro/' + me.idlibro)\r\n              .then(res => {\r\n                  me.links = res.data\r\n                  me.$vs.loading.close()\r\n              })\r\n              .catch(function (error) { me.$vs.loading.close() })\r\n            },\r\n            guardarLink(){\r\n              let me = this\r\n              me.$vs.loading();\r\n              let formData = new FormData();\r\n              formData.append('id_libro', me.idlibro);\r\n              formData.append('pag_ini', me.link.pag_ini);\r\n              formData.append('pag_fin', me.link.pag_fin);\r\n              formData.append('fecha_ini', me.link.fecha_inicio);\r\n              formData.append('fecha_fin', me.link.fecha_caducidad);\r\n              me.$http.post(this.$server_url + 'guardar_link_libro', formData)\r\n              .then(res => {\r\n                  me.getLinksLibros();\r\n                  me.$vs.loading.close()\r\n                  me.$vs.notify({ text: 'Link guardado con éxito', color: 'success', iconPack: 'feather', icon: 'icon-check' })\r\n              })\r\n              .catch(function (error) { me.$vs.loading.close() })\r\n            },\r\n            copiarLink(item){\r\n              let me = this\r\n                let host = location.protocol + '//' + location.hostname +':'+ location.port\r\n                let ruta = host +'/libro_free/'+ item.pag_ini+'4.3'+item.pag_fin+'4.3'+item.fecha_ini+'4.3'+item.fecha_fin+'4.3'+item.weblibro\r\n                var aux = document.createElement(\"input\");\r\n                console.log('ruta',ruta)\r\n                aux.setAttribute(\"value\", ruta);\r\n                document.body.appendChild(aux);\r\n                aux.select();\r\n                try {\r\n                    var status = document.execCommand('copy');\r\n                    if (!status) {\r\n                        me.$vs.notify({ text: 'Error al copiar el link', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n                    } else {\r\n                        me.$vs.notify({ text: 'Link copiado', color: 'success', iconPack: 'feather', icon: 'icon-check' })\r\n                    }\r\n                } catch (err) {\r\n                    console.log('No se pudo copiar');\r\n                }\r\n                document.body.removeChild(aux);\r\n            }\r\n        },\r\n        created() {\r\n            this.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n            this.getAsignaturas();\r\n            this.listaSeries();\r\n            localStorage.vistalibro = 'todo'\r\n            this.getUserRoot()\r\n        }\r\n    }\r\n    ",{"version":3,"sources":["libros.vue"],"names":[],"mappings":";AAwaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"libros.vue","sourceRoot":"src/views/libros","sourcesContent":["<template>\r\n    <vx-card>\r\n      <vs-popup fullscreen title=\"Generar link\" :active.sync=\"popupLinkLibro\">\r\n          <div class=\"vx-row mb-base p-3\">\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-3\">\r\n              <vs-input type=\"number\" class=\"w-full\" label=\"Página inicio\" v-model=\"link.pag_ini\" />\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-3\">\r\n              <vs-input type=\"number\" class=\"w-full\" label=\"Página fin\" v-model=\"link.pag_fin\" />\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-3\">\r\n              <div style=\"color: gray; font-size: 12px;\">Fecha inicio</div>\r\n              <flat-pickr class=\"w-full\" :config=\"configdateTimePicker\" v-model=\"link.fecha_inicio\" />\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 w-full mb-3\">\r\n              <div style=\"color: gray; font-size: 12px;\">Fecha caducidad</div>\r\n              <flat-pickr class=\"w-full\" :config=\"configdateTimePicker\" v-model=\"link.fecha_caducidad\" />\r\n            </div>\r\n            <div class=\"vx-col w-full\">\r\n              <vs-button @click=\"guardarLink()\">Guardar link</vs-button>\r\n            </div>\r\n          </div>\r\n          <vs-divider></vs-divider>\r\n          <vs-table max-items=\"10\" stripe search pagination :data=\"links\" class=\"mb-3\">\r\n            <template slot=\"thead\">\r\n                <vs-th>#</vs-th>\r\n                <vs-th>Pág inicio</vs-th>\r\n                <vs-th>Pág fin</vs-th>\r\n                <vs-th>Fecha inicio</vs-th>\r\n                <vs-th>Fecha fin</vs-th>\r\n                <vs-th>Recurso externo</vs-th>\r\n                <vs-th>Acciones</vs-th>\r\n            </template>\r\n            <template slot-scope=\"{data}\">\r\n                <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                    <vs-td> {{indextr+1}} </vs-td>\r\n                    <vs-td> {{data[indextr].pag_ini}} </vs-td>\r\n                    <vs-td> {{data[indextr].pag_fin}} </vs-td>\r\n                    <vs-td> {{data[indextr].fecha_ini}} </vs-td>\r\n                    <vs-td> {{data[indextr].fecha_fin}} </vs-td>\r\n                    <vs-td>\r\n                        <div v-if=\"tr.recurso_externo == '0'\">\r\n                            <vs-chip color=\"warning\">No</vs-chip>\r\n                        </div>\r\n                        <div v-else>\r\n                            <vs-chip color=\"warning\">Si</vs-chip><br><br>\r\n                            <small>Asignado a {{ tr.nombreInstitucion }}</small>\r\n                        </div>\r\n                    </vs-td>\r\n                    <vs-td align=\"center\">\r\n                        <vx-tooltip style=\"display: inline-block;\" text=\"Copiar link\" position=\"top\" color=\"success\">\r\n                            <vs-button size=\"small\" class=\"modal-default-button\" color=\"success\" @click=\"copiarLink(data[indextr])\" type=\"line\" icon-pack=\"feather\" icon=\"icon-copy\"> </vs-button>\r\n                        </vx-tooltip>\r\n                    </vs-td>\r\n                </vs-tr>\r\n            </template>\r\n        </vs-table>\r\n      </vs-popup>\r\n      <div class=\"con-tab-ejemplo\">\r\n        <div>\r\n            <!-- <vs-button color=\"dark\" icon=\"add\"  v-if=\"permisoRoot && doActions == 1\" @click=\"limpiar();popupGuardarLibro=true;title='Guardar'\" type=\"line\">Añadir Libro </vs-button> -->\r\n            <vs-button color=\"dark\" icon=\"add\" @click=\"limpiar();popupGuardar=true;title='Guardar';getGrupoProducto();listaSeries();\" type=\"line\">Añadir producto </vs-button>\r\n            <vs-table max-items=\"20\" stripe search pagination :data=\"arreglosLibros\">\r\n                <template slot=\"header\">\r\n                    <vs-chip  color=\"primary\">Cantidad: <b> {{ arreglosLibros.length }}</b></vs-chip>\r\n                </template>\r\n                <template slot=\"thead\">\r\n                    <vs-th width=\"35%\">Nombre</vs-th>\r\n                    <vs-th v-if=\"doActions == 1\">Pdfs</vs-th>\r\n                    <vs-th v-if=\"doActions == 1\">Portada</vs-th>\r\n                    <vs-th v-if=\"doActions\">Detalles</vs-th>\r\n                    <vs-th>Estado</vs-th>\r\n                    <vs-th>Acciones</vs-th>\r\n                </template>\r\n                <template slot-scope=\"{data}\">\r\n                    <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                        <vs-td>\r\n                            <p><b>Libro:</b> {{data[indextr].nombrelibro}}</p>\r\n                            <p><b>Nombre Imprimir:</b> {{data[indextr].nombre_imprimir}}</p>\r\n                            <p class=\"mt-1\"><b>Descripción:</b> {{data[indextr].descripcionlibro}}</p>\r\n                            <p class=\"mt-1\"><b>Serie:</b> {{ tr.nombre_serie }}</p>\r\n                            <p class=\"mt-1\"><b>Código:</b> {{ tr.codigo_liquidacion }}</p>\r\n                            <vs-chip v-if=\"data[indextr].serie === '0'\">Sin plus</vs-chip>\r\n                            <vs-chip v-else color=\"success\">Plus</vs-chip>\r\n                        </vs-td>\r\n                        <vs-td v-if=\"doActions == 1\">\r\n                            <span class=\"enlace\" @click=\"datolibro(tr,tr.weblibro)\" >\r\n                                <b>Weblibro :</b><span v-if=\"tr.weblibro\"> {{ tr.weblibro}}</span><span class=\"text-danger\" v-else> No disponible</span><br>\r\n                            </span>\r\n                            <span class=\"enlace\" @click=\"datopdfsinguia(tr.pdfsinguia)\" >\r\n                                <b>SG :</b><span v-if=\"tr.pdfsinguia\"> {{ tr.pdfsinguia }}</span><span class=\"text-danger\" v-else> No disponible</span><br>\r\n                            </span>\r\n                            <span class=\"enlace\" @click=\"datopdfconguia(tr.pdfconguia)\" >\r\n                                <b>G :</b><span v-if=\"tr.pdfconguia\"> {{ tr.pdfconguia }}</span><span class=\"text-danger\" v-else> No disponible</span><br>\r\n                            </span>\r\n                            <span class=\"enlace\" @click=\"datopdfguiadidactica(tr.guiadidactica)\">\r\n                                <b>G Didactica:</b><span v-if=\"tr.guiadidactica\"> {{ tr.guiadidactica }}</span><span class=\"text-danger\" v-else> No disponible</span><br>\r\n                            </span>\r\n                            <!--LIBRO SIERRA-->\r\n                            <vs-divider color=\"primary\">Libro sierra</vs-divider>\r\n                            <span class=\"enlace\" v-if=\"tr.s_weblibro\" @click=\"datolibro(tr,tr.s_weblibro)\" >\r\n                                <b>Weblibro :</b><span > {{ tr.s_weblibro}}</span><br>\r\n                            </span>\r\n                            <span class=\"enlace\" v-if=\"tr.s_pdfsinguia\" @click=\"datopdfsinguia(tr.s_pdfsinguia)\" >\r\n                                <b>SG :</b><span> {{ tr.s_pdfsinguia}}</span><br>\r\n                            </span>\r\n                            <span class=\"enlace\" v-if=\"tr.s_pdfconguia\" @click=\"datopdfconguia(tr.s_pdfconguia)\" >\r\n                                <b>G:</b><span> {{ tr.s_pdfconguia}}</span><br>\r\n                            </span>\r\n                            <span class=\"enlace\" v-if=\"tr.s_guiadidactica\" @click=\"datopdfguiadidactica(tr.s_guiadidactica)\">\r\n                                <b>G Didactica:</b><span> {{ tr.s_guiadidactica}}</span><br>\r\n                            </span>\r\n                              <!--LIBRO COSTA-->\r\n                              <vs-divider color=\"success\">Libro costa</vs-divider>\r\n                              <span class=\"enlace\" v-if=\"tr.c_weblibro\" @click=\"datolibro(tr,tr.c_weblibro)\" >\r\n                                <b>Weblibro :</b><span > {{ tr.c_weblibro}}</span><br>\r\n                            </span>\r\n                            <span class=\"enlace\" v-if=\"tr.c_pdfsinguia\" @click=\"datopdfsinguia(tr.c_pdfsinguia)\" >\r\n                                <b>SG :</b><span> {{ tr.c_pdfsinguia}}</span><br>\r\n                            </span>\r\n                            <span class=\"enlace\" v-if=\"tr.c_pdfconguia\" @click=\"datopdfconguia(tr.c_pdfconguia)\" >\r\n                                <b>G:</b><span> {{ tr.c_pdfconguia}}</span><br>\r\n                            </span>\r\n                            <span class=\"enlace\" v-if=\"tr.c_guiadidactica\" @click=\"datopdfguiadidactica(tr.c_guiadidactica)\">\r\n                                <b>G Didactica:</b><span> {{ tr.c_guiadidactica}}</span><br>\r\n                            </span>\r\n                        </vs-td>\r\n                        <vs-td v-if=\"doActions == 1\">\r\n                            <a @click=\"datolibro(tr,tr.weblibro)\" style=\"cursor:pointer;\" >\r\n                                <img v-if=\"data[indextr].weblibro != null \"  width=\"50\" class=\"card-img-top\" v-bind:src=\"$data_url+'archivos/upload/libro/'+data[indextr].weblibro+'/'+tr.portada\" alt=\"Card image cap\">\r\n                                <img v-else class=\"card-img-top\" width=\"50\" v-bind:src=\"$data_url+'archivos/archivos/img/'+data[indextr].portada\" alt=\"Card image cap\">\r\n                            </a>\r\n                        </vs-td>\r\n                        <vs-td v-if=\"doActions == 1\">\r\n                            <vx-tooltip style=\"display: inline-block;\" text=\"Ver Detalles\" position=\"top\" color=\"warning\">\r\n                                <vs-button size=\"small\" class=\"modal-default-button\" color=\"primary\" @click=\"verLibroSerie(tr)\" type=\"filled\" icon-pack=\"feather\" icon=\"icon-bookmark\"> </vs-button>\r\n                            </vx-tooltip> &nbsp;\r\n                        </vs-td>\r\n                        <vs-td>\r\n                            <template v-if=\"data[indextr].Estado_idEstado == '1'\">\r\n                                <p>Activado</p>\r\n                            </template>\r\n                            <template v-else>\r\n                                <p>Desactivado</p>\r\n                            </template>\r\n                          </vs-td>\r\n                        <vs-td>\r\n                          <div v-if=\"doActions == 1\">\r\n                            <vx-tooltip style=\"display: inline-block;\" text=\"Editar libro\" position=\"top\" color=\"success\">\r\n                                <vs-button size=\"small\" class=\"modal-default-button\" color=\"success\" @click=\"title='Editar';openModalEditar(data[indextr])\" type=\"filled\" icon-pack=\"feather\" icon=\"icon-edit\"> </vs-button>\r\n                            </vx-tooltip> &nbsp;\r\n                              <template v-if=\"data[indextr].Estado_idEstado == '1'\">\r\n                                <vx-tooltip style=\"display: inline-block;\" text=\"Desactivar libro\" position=\"top\" color=\"danger\">\r\n                                    <vs-button size=\"small\" class=\"modal-default-button\" color=\"danger\" @click=\"openConfirm(data[indextr].idlibro)\" type=\"filled\" icon-pack=\"feather\" icon=\"icon-x-square\"> </vs-button>\r\n                                  </vx-tooltip> &nbsp;\r\n                              </template>\r\n                              <template v-else>\r\n                                  <vx-tooltip style=\"display: inline-block;\" text=\"Activar libro\" position=\"top\" color=\"warning\">\r\n                                    <vs-button size=\"small\" class=\"modal-default-button\" color=\"primary\" @click=\"openConfirmActivar(data[indextr].idlibro)\" type=\"filled\" icon-pack=\"feather\" icon=\"icon-arrow-up-right\"> </vs-button>\r\n                                  </vx-tooltip> &nbsp;\r\n                              </template>\r\n                              <vx-tooltip style=\"display: inline-block;\" text=\"Generar link de libro\" position=\"top\" color=\"dark\">\r\n                                  <vs-button size=\"small\" style=\"display: inline-block;\" class=\"p-2\" icon-pack=\"feather\" icon=\"icon-link\" color=\"dark\" @click=\"idlibro = data[indextr].idlibro; getLinksLibros(); popupLinkLibro=true;\"></vs-button>\r\n                              </vx-tooltip>\r\n                          </div>\r\n                          <div v-else>\r\n                            <vx-tooltip style=\"display: inline-block;\" text=\"Seleccionar libro\" position=\"top\" color=\"primary\">\r\n                                <vs-button class=\"modal-default-button\" size=\"small\" @click=\"$emit('changeLibroSelect',tr)\" color=\"primary\" type=\"filled\" icon-pack=\"feather\" icon=\"icon-star\"> Seleccionar </vs-button>\r\n                            </vx-tooltip> &nbsp;\r\n                          </div>\r\n                        </vs-td>\r\n                    </vs-tr>\r\n                </template>\r\n            </vs-table>\r\n        </div>\r\n      </div>\r\n      <!-- SECCION REGISTRO -->\r\n      <vs-popup class=\"crear\" title=\"Registro nuevo producto\" :active.sync=\"popupGuardar\">\r\n                <vs-row>\r\n                    <vs-col vs-align=\"center\" vs-lg=\"12\" vs-sm=\"12\" vs-xs=\"12\" style=\"text-align: center;\"><b>Información Producto</b></vs-col>\r\n    \r\n                    <vs-col vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <!-- {{tabusuario.pv_tipo_usuario}}  //Para ver que propiedad quiero guardar -->\r\n                                <vs-input label=\"Código del producto \" maxlength=\"6\" placeholder=\"Nombre\" class=\"w-full\" icon=\"mode_edit\" v-model=\"tabProducto.pro_codigo\" @input=\"convertirAMayusculas()\" />\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                    <vs-col vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <!-- {{tabusuario.pv_tipo_usuario}}  //Para ver que propiedad quiero guardar -->\r\n                                <font style=\"font-size: 11.5px\">&nbsp;Grupo</font><br>\r\n                                <v-select :options=\"Grupos\" :reduce=\"Grupos => Grupos.gru_pro_codigo\" label=\"gru_pro_nombre\" class=\"w-full h-100\" placeholder=\"--Seleccione--\" v-model=\"tabProducto.gru_pro_codigo\" disabled />\r\n                                <!-- <vs-input label=\"Grupo\" maxlength=\"6\" placeholder=\"Grupo\" class=\"w-full\" icon=\"mode_edit\"  v-model=\"tabProducto.gru_pro_codigo\" :readonly=\"modoEdicion\"/> -->\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                    <vs-col v-if=\"tabProducto.gru_pro_codigo === 1\" vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <font style=\"font-size: 11.5px\">&nbsp;Serie</font><br>\r\n                                <v-select :options=\"arregloSeries\" :reduce=\"arregloSeries => arregloSeries.id_serie\" label=\"nombre_serie\" placeholder=\"--Seleccione--\" class=\"w-full\" v-model=\"tabProducto.id_serie\" />\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                    <vs-col vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <!-- {{tabusuario.pv_tipo_usuario}}  //Para ver que propiedad quiero guardar -->\r\n                                <vs-input label=\"Nombre \" placeholder=\"Nombre\" class=\"w-full\" icon=\"mode_edit\" v-model=\"tabProducto.pro_nombre\" />\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                    <vs-col vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <!-- {{tabusuario.pv_tipo_usuario}}  //Para ver que propiedad quiero guardar -->\r\n                                <vs-input label=\"Descripción \" placeholder=\"Descripción\" class=\"w-full\" icon=\"mode_edit\" v-model=\"tabProducto.pro_descripcion\" />\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                    <vs-col vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <!-- {{tabusuario.pv_tipo_usuario}}  //Para ver que propiedad quiero guardar -->\r\n                                <!-- <vs-input label=\"Iva *\" type=\"number\" placeholder=\"Iva\" class=\"w-full\" icon=\"mode_edit\" v-model=\"tabProducto.proIva\" /> -->\r\n                                <font style=\"font-size: 11.5px\">&nbsp;IVA *</font><br>\r\n                                <v-select :options=\"options1\" :reduce=\"options1 => options1.value\" label=\"text\" class=\"w-full h-100\" placeholder=\"--Seleccione--\" v-model=\"tabProducto.pro_iva\" />\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                    <vs-col vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <!-- {{tabusuario.pv_tipo_usuario}}  //Para ver que propiedad quiero guardar -->\r\n                                <vs-input label=\"Valor \" type=\"number\" placeholder=\"Valor\" class=\"w-full\" icon=\"mode_edit\" v-model=\"tabProducto.pro_valor\" @keypress=\"validarValor\" />\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                    <vs-col vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <!-- {{tabusuario.pv_tipo_usuario}}  //Para ver que propiedad quiero guardar -->\r\n                                <font style=\"font-size: 11.5px; display: inline-flex;\">&nbsp;Descuento * &emsp; Formato: 0.00</font><br>\r\n                                <vs-input type=\"number\" id=\"pro-descuento-input\" placeholder=\"Descuento\" class=\"w-full\" icon=\"mode_edit\" v-model=\"tabProducto.pro_descuento\" @keypress=\"validarDescuento\"/>\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                    <vs-col vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <!-- {{tabusuario.pv_tipo_usuario}}  //Para ver que propiedad quiero guardar -->\r\n                                <vs-input label=\"Stock \" type=\"number\" placeholder=\"Stock\" class=\"w-full\" icon=\"mode_edit\" v-model=\"tabProducto.pro_stock\" @keypress=\"validarStock\" />\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                    <vs-col vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <!-- {{tabusuario.pv_tipo_usuario}}  //Para ver que propiedad quiero guardar -->\r\n                                <vs-input label=\"Costo \" type=\"number\" placeholder=\"Costo\" class=\"w-full\" icon=\"mode_edit\" v-model=\"tabProducto.pro_costo\" @keypress=\"validarCosto\" />\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                    <vs-col vs-justify=\"center\" vs-align=\"center\" vs-lg=\"6\" vs-sm=\"6\" vs-xs=\"6\">\r\n                        <vs-row vs-type=\"flex\" vs-justify=\"center\" vs-w=\"12\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\">\r\n                                <!-- {{tabusuario.pv_tipo_usuario}}  //Para ver que propiedad quiero guardar -->\r\n                                <vs-input label=\"Peso \" type=\"number\" placeholder=\"Peso\" class=\"w-full\" icon=\"mode_edit\" v-model=\"tabProducto.pro_peso\" @keypress=\"validarPeso\"/>\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </vs-col>\r\n                </vs-row>\r\n                <br><br>\r\n                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\" class=\"mt-2\">\r\n                    <vs-button @click=\"guardarnuevo()\" class=\"mr-3 mb-2\" type=\"relief\">{{ title }}</vs-button>\r\n                    <vs-button @click=\"popupGuardar = false;\" type=\"relief\" color=\"danger\">Cancelar</vs-button>\r\n                </vs-col>\r\n            </vs-popup>\r\n      <!--PARA LOS MODALES -->\r\n      <!--MODAL PARA GUARDAR LIBRO-->\r\n      <vs-popup classContent=\"popup-example\" fullscreen :title=\"title+' Libro'\" :active.sync=\"popupGuardarLibro\">\r\n          <div style=\"color:#ff0000; text-align:center; font-weight: bold;\">PARA MODIFICAR EL NOMBRE, NOMBRE IMPRIMIR, DESCRIPCIÓN, CODIGO LIQUIDACIÓN Y YEAR, INGRESE EN LA SECCIÓN PRODUCTO.</div>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/3 w-full mb-2\">\r\n              <vs-input class=\"w-full\" label=\"Nombre\" icon-pack=\"feather\" icon=\"icon-book\" icon-no-border  v-model=\"libro.nombrelibro\" :readonly=\"modoEdicion\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/3 w-full mb-2\">\r\n                <vs-input class=\"w-full\" label=\"Nombre imprimir\" icon-pack=\"feather\" icon=\"icon-book\" icon-no-border  v-model=\"libro.nombre_imprimir\" :readonly=\"modoEdicion\"/>\r\n                </div>\r\n              <div class=\"vx-col sm:w-1/3 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"Descripción\" icon-pack=\"feather\" icon=\"icon-book\" icon-no-border  v-model=\"libro.descripcionlibro\" :readonly=\"modoEdicion\"/>\r\n              </div>\r\n          </div>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <p class=\"mt-2\">Seleccione la serie:</p>\r\n                  <ul class=\"flex mt-2\">\r\n                      <li>\r\n                      <vs-radio v-model=\"libro.serie\" vs-name=\"radios1serie\" vs-value=\"1\">con plus</vs-radio>\r\n                      </li>\r\n                      <li>\r\n                      <vs-radio v-model=\"libro.serie\" vs-name=\"radios1serie\" vs-value=\"0\" class=\"ml-2\">Sin plus</vs-radio>\r\n                      </li>\r\n                  </ul>\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"Web libro\" icon-pack=\"feather\" icon=\"icon-link\" icon-no-border  v-model=\"libro.weblibro\" />\r\n              </div>\r\n          </div>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"pdf sin guia\" icon-pack=\"feather\" icon=\"icon-link\" icon-no-border  v-model=\"libro.pdfsinguia\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"pdf con guia\" icon-pack=\"feather\" icon=\"icon-link\" icon-no-border  v-model=\"libro.pdfconguia\" />\r\n              </div>\r\n          </div>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"Guia didactica Libro\" icon-pack=\"feather\" icon=\"icon-link\" icon-no-border  v-model=\"libro.guiadidactica\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-6\">\r\n                  <p>Asignatura:</p>\r\n                  <v-select :options=\"Asignaturas\" :reduce=\"Asignaturas => Asignaturas\" label=\"nombreasignatura\" class=\"w-full\" v-model=\"libro.asignatura_idasignatura\" />\r\n              </div>\r\n          </div>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-full w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"Demo\" icon-pack=\"feather\" icon=\"icon-link\" icon-no-border  v-model=\"libro.demo\" />\r\n              </div>\r\n          </div>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/3 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"Portada\" icon-pack=\"feather\" icon=\"icon-archive\" icon-no-border  v-model=\"libro.portada\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/3 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"Portada (SIERRA)\" icon-pack=\"feather\" icon=\"icon-archive\" icon-no-border  v-model=\"libro.s_portada\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/3 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"Portada (COSTA)\" icon-pack=\"feather\" icon=\"icon-archive\" icon-no-border  v-model=\"libro.c_portada\" />\r\n              </div>\r\n          </div>\r\n          <!--DATOS SERIE-->\r\n          <vs-divider color=\"warning\">Datos serie</vs-divider>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <p>Serie:</p>\r\n                  <v-select :options=\"arregloSeries\" :reduce=\"arregloSeries => arregloSeries\" label=\"nombre_serie\" class=\"w-full\" v-model=\"serie.nombre_serie\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-6\">\r\n                  <vs-input class=\"w-full\" label=\"Liquidación\" icon-pack=\"feather\" icon=\"icon-bar-chart\" icon-no-border  v-model=\"serie.codigo_liquidacion\" :readonly=\"modoEdicion\" />\r\n              </div>\r\n          </div>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"Year\" icon-pack=\"feather\" icon=\"icon-bar-chart\" icon-no-border  v-model=\"serie.year\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-6\">\r\n                  <vs-input class=\"w-full\" label=\"Versión\" icon-pack=\"feather\" icon=\"icon-bar-chart\" icon-no-border  v-model=\"serie.version2\" />\r\n              </div>\r\n          </div>\r\n          <!--DATOS LIBRO SIERRA-->\r\n          <vs-divider color=\"primary\">Datos libro Sierra</vs-divider>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"Web libro\" icon-pack=\"feather\" icon=\"icon-link-2\" icon-no-border  v-model=\"libro.s_weblibro\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-6\">\r\n                  <vs-input class=\"w-full\" label=\"pdf sin guia\" icon-pack=\"feather\" icon=\"icon-link-2\" icon-no-border  v-model=\"libro.s_pdfsinguia\" />\r\n              </div>\r\n          </div>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"pdf con guia\" icon-pack=\"feather\" icon=\"icon-link-2\" icon-no-border  v-model=\"libro.s_pdfconguia\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-6\">\r\n                  <vs-input class=\"w-full\" label=\"Guia didactica Libro\" icon-pack=\"feather\" icon=\"icon-link-2\" icon-no-border  v-model=\"libro.s_guiadidactica\" />\r\n              </div>\r\n          </div>\r\n          <!--FIN DATOS LIBRO SIERRA-->\r\n          <!--DATOS LIBRO COSTA-->\r\n          <vs-divider color=\"success\">Datos libro Costa</vs-divider>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"Web libro\" icon-pack=\"feather\" icon=\"icon-link-2\" icon-no-border  v-model=\"libro.c_weblibro\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-6\">\r\n                  <vs-input class=\"w-full\" label=\"pdf sin guia\" icon-pack=\"feather\" icon=\"icon-link-2\" icon-no-border  v-model=\"libro.c_pdfsinguia\" />\r\n              </div>\r\n          </div>\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n                  <vs-input class=\"w-full\" label=\"pdf con guia\" icon-pack=\"feather\" icon=\"icon-link-2\" icon-no-border  v-model=\"libro.c_pdfconguia\" />\r\n              </div>\r\n              <div class=\"vx-col sm:w-1/2 w-full mb-6\">\r\n                  <vs-input class=\"w-full\" label=\"Guia didactica Libro\" icon-pack=\"feather\" icon=\"icon-link-2\" icon-no-border  v-model=\"libro.c_guiadidactica\" />\r\n              </div>\r\n          </div>\r\n          <!--FIN DATOS LIBRO COSTA-->\r\n          <div class=\"vx-row\">\r\n              <div class=\"vx-col w-full\">\r\n              <vs-button @click=\"guardarLibro()\" class=\"mr-3 mb-2\">{{ title }}</vs-button>\r\n              <vs-button color=\"warning\" type=\"border\" class=\"mb-2\" @click=\"popupGuardarLibro = false;\">Cancelar</vs-button>\r\n              </div>\r\n          </div>\r\n      </vs-popup>\r\n      <!-- Modal para ver la informacion libro serie de cada libro-->\r\n      <vs-popup class=\"holamundo\"  title=\"Libro - serie\" :active.sync=\"popupVerSerie\">\r\n        <vs-list>\r\n          <vs-list-header title=\"Informacion libro - serie del libro\"></vs-list-header>\r\n          <vs-list-item title=\"Libro\" :subtitle=\"lsnombre\"></vs-list-item>\r\n          <vs-list-item title=\"Codigo liquidacion\" :subtitle=\"lscodigo_liquidacion\"></vs-list-item>\r\n          <vs-list-item title=\"Año\" :subtitle=\"lsyear\"></vs-list-item>\r\n          <vs-list-item title=\"Version\" :subtitle=\"lsversion\"></vs-list-item>\r\n          <vs-list-item title=\"Inicial\" :subtitle=\"lsiniciales\"></vs-list-item>\r\n          <vs-list-item title=\"Serie\" :subtitle=\"lsnombre_serie\"></vs-list-item>\r\n        </vs-list>\r\n      </vs-popup>\r\n    </vx-card>\r\n    </template>\r\n    <script>\r\n    import Vue from 'vue'\r\n    import axios from 'axios'\r\n    import vSelect from 'vue-select'\r\n    import flatPickr from 'vue-flatpickr-component';\r\n    import 'flatpickr/dist/flatpickr.css';\r\n    export default {\r\n        data() {\r\n            return {\r\n                Asignaturas: [],\r\n                libroserieArreglo:[],\r\n                activeConfirm: false,\r\n                popupVerSerie:false,\r\n                id: 0,\r\n                idlibro: 0,\r\n                title:'',\r\n                popupGuardarLibro:false,\r\n                popupGuardar:false,\r\n                unidadesLibro:[],\r\n                arregloSeries:[],\r\n                options1: [\r\n                    { text: '--Seleccione--', value: null },\r\n                    { text: 'Si', value: true },\r\n                    { text: 'No', value: false },\r\n                ],\r\n                Grupos: [],\r\n                gru_pro_codigo: 1,\r\n                series:[],\r\n                tabProducto: {\r\n                    pro_codigo: '',\r\n                    gru_pro_codigo: '',\r\n                    pro_nombre: '',\r\n                    pro_descripcion: '',\r\n                    pro_iva: '',\r\n                    pro_valor: '',\r\n                    pro_descuento: '',\r\n                    pro_stock: '',\r\n                    pro_costo: '',\r\n                    pro_peso: '',\r\n                    pro_estado: '',                                \r\n                    id_serie:'',\r\n                    idlibro:'',\r\n                    year:''\r\n                },\r\n                libro: {\r\n                    nombrelibro: \"\",\r\n                    nombre_imprimir:\"\",\r\n                    descripcionlibro: \"\",\r\n                    serie: '0',\r\n                    weblibro: \"\",\r\n                    pdfsinguia: \"\",\r\n                    pdfconguia: \"\",\r\n                    guiadidactica: \"\",\r\n                    asignatura_idasignatura: \"\",\r\n                    demo:'',\r\n                    portada:\"portada.png\",\r\n                    //SIERRA LIBROS\r\n                    s_weblibro: \"\",\r\n                    s_pdfsinguia: \"\",\r\n                    s_pdfconguia: \"\",\r\n                    s_guiadidactica: \"\",\r\n                    s_portada:\"portada.png\",\r\n                    //COSTA LIBROS\r\n                    c_weblibro: \"\",\r\n                    c_pdfsinguia: \"\",\r\n                    c_pdfconguia: \"\",\r\n                    c_guiadidactica: \"\",\r\n                    c_portada:\"portada.png\",\r\n                },\r\n                serie:{\r\n                    nombrelibro:'',\r\n                    nombre_serie:'',\r\n                    iniciales:'',\r\n                    codigo_liquidacion:'',\r\n                    nombre:'',\r\n                    year:'',\r\n                    version2:''\r\n                },\r\n                //para mostrar lo de libro serie\r\n                lsnombre:\"\",\r\n                lscodigo_liquidacion:\"\",\r\n                lsyear:\"\",\r\n                lsversion:\"\",\r\n                lsiniciales:\"\",\r\n                lsnombre_serie:\"\",\r\n                popupLinkLibro: false,\r\n                link:{\r\n                  pag_ini: '',\r\n                  pag_fin: '',\r\n                  fecha_inicio: '',\r\n                  fecha_caducidad: '',\r\n                },\r\n                configdateTimePicker: {\r\n                  enableTime: true,\r\n                  dateFormat: 'Y-m-d H:i:s'\r\n                },\r\n                links: [],\r\n                permisoRoot:false,\r\n                usuario:[],\r\n                modoEdicion: false,\r\n                numeros: 0\r\n            }\r\n        },\r\n        components: {\r\n            'v-select': vSelect,\r\n            flatPickr\r\n        },\r\n        props:{\r\n            arreglosLibros:{\r\n              type:Array,\r\n              default:[],\r\n            },\r\n            //0 => no tendra botones; 1 => si\r\n            doActions:{\r\n              type:Number,\r\n              default:1\r\n            }\r\n        },\r\n        methods: {\r\n            validarStock() {\r\n                let stock = this.tabProducto.proStock;\r\n                if (!/^\\d+$/.test(stock) || isNaN(stock)) {\r\n                    this.tabProducto.proStock = '';\r\n                }\r\n            },\r\n            validarCosto() {\r\n                const costo = this.tabProducto.proCosto;\r\n                if (/^\\d/.test(costo)) { // si comienza con un dígito\r\n                 if (!/^\\d{0,18}(\\.\\d{1,5})?$/.test(costo)) {\r\n                    this.tabProducto.proCosto = '';\r\n                    }\r\n                } else if (/^[,.e]/.test(costo)) { // si comienza con una coma o un punto\r\n                    if (!/^([,.]\\d{1,5})?$/.test(costo)) {\r\n                    this.tabProducto.proCosto = '';\r\n                    }\r\n                } else { // si comienza con cualquier otro caracter\r\n                    this.tabProducto.proCosto = '';\r\n                }\r\n            },\r\n            validarPeso() {\r\n                const peso = this.tabProducto.proPeso;\r\n                if (/^\\d/.test(peso)) { // si comienza con un dígito\r\n                 if (!/^\\d{0,15}(\\.\\d{1,5})?$/.test(peso)) {\r\n                    this.tabProducto.proPeso = '';\r\n                    }\r\n                } else if (/^[,.e]/.test(peso)) { // si comienza con una coma o un punto\r\n                    if (!/^([,.]\\d{1,5})?$/.test(peso)) {\r\n                    this.tabProducto.proPeso = '';\r\n                    }\r\n                } else { // si comienza con cualquier otro caracter\r\n                    this.tabProducto.proPeso = '';\r\n                }\r\n            },\r\n            handleRadioInput(opcion) {\r\n                // Vacía el array Productos cuando se selecciona la opción 'nombres'\r\n                if (opcion === 'nombres') {\r\n                    this.Productos = [];\r\n                }\r\n                else if(opcion === 'codigopro'){\r\n                    this.Productos = [];\r\n                }\r\n            },\r\n            validarDescuento() {\r\n                let descuento = this.tabProducto.pro_descuento;\r\n                // Reemplazar comas por puntos solo si hay comas en la cadena\r\n                if (descuento.includes(',')) {\r\n                    descuento = descuento.replace(',', '.');\r\n                    this.tabProducto.pro_descuento = descuento;\r\n                }\r\n                // Validar el formato del número\r\n                if (!/^\\d{0,14}(\\.\\d{0,2})?$/.test(descuento)) {\r\n                    this.tabProducto.pro_descuento = '';\r\n                    console.log(\"reset\");\r\n                }\r\n            },\r\n            validarValor() {\r\n                const valor = this.tabProducto.proValor;\r\n                if (/^\\d/.test(valor)) { // si comienza con un dígito\r\n                 if (!/^\\d{0,18}(\\.\\d{1,5})?$/.test(valor)) {\r\n                    this.tabProducto.proValor = '';\r\n                    }\r\n                } else if (/^[,.e]/.test(valor)) { // si comienza con una coma o un punto\r\n                    if (!/^([,.]\\d{1,5})?$/.test(valor)) {\r\n                    this.tabProducto.proValor = '';\r\n                    }\r\n                } else { // si comienza con cualquier otro caracter\r\n                    this.tabProducto.proValor = '';\r\n                }\r\n            },\r\n            getGrupoProducto() {\r\n                let me = this;\r\n                this.$http.get(this.$server_url+'GetGrupoProducto_todo')\r\n                //axios.get(this.$apifacturacion_url + 'f_Producto')\r\n                .then(res => {\r\n                //let resultado = res.data.productos.filter(p => p.proCodigo !== 0);\r\n                //this.Productos = resultado;\r\n                this.Grupos = res.data;\r\n                // console.log(this.Productos);\r\n                // console.log(this.Grupos);\r\n                })\r\n                .catch(err => {\r\n                console.log(err)\r\n                })\r\n            },\r\n            convertirAMayusculas() {            \r\n                const numerosString = this.tabProducto.pro_codigo.replace(/\\D/g, '');\r\n                this.numeros = numerosString ? parseInt(numerosString) : 0; // Asignar el valor a tabProducto.pro_codigo             \r\n                // Extraer los números y almacenarlos en la variable 'numeros'\r\n            },\r\n            guardarnuevo() {\r\n                let me = this;\r\n                me.modoEdicion = true;\r\n                const usuariorespo = localStorage.getItem(\"usuario\");\r\n                const usuarioObjeto = JSON.parse(usuariorespo);\r\n                //VALIDACION DE CAMPOS NULOS Y VACIOS\r\n                if (me.tabProducto.pro_codigo === '' || me.tabProducto.pro_codigo === null) {\r\n                    this.$vs.notify({\r\n                        text: 'Escriba el código del Producto antes de guardar',\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    });\r\n                    return;\r\n                }\r\n                if (me.tabProducto.gru_pro_codigo === '' || me.tabProducto.gru_pro_codigo === null) {\r\n                    this.$vs.notify({\r\n                        text: 'Seleccione el grupo del producto antes de guardar',\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    });\r\n                    return;\r\n                }\r\n                let datos  = {\r\n                    \"pro_codigo\": me.tabProducto.pro_codigo,\r\n                    \"gru_pro_codigo\": me.tabProducto.gru_pro_codigo,\r\n                    \"pro_nombre\": me.tabProducto.pro_nombre,\r\n                    \"pro_descripcion\": me.tabProducto.pro_descripcion,\r\n                    \"pro_iva\": me.tabProducto.pro_iva,\r\n                    \"pro_valor\": parseFloat(me.tabProducto.pro_valor),\r\n                    \"pro_descuento\": parseFloat(me.tabProducto.pro_descuento),\r\n                    \"pro_stock\": parseFloat(me.tabProducto.pro_stock),\r\n                    \"pro_costo\": parseFloat(me.tabProducto.pro_costo),\r\n                    \"pro_peso\": parseFloat(me.tabProducto.pro_peso),\r\n                    \"nombrelibro\": me.tabProducto.pro_nombre,\r\n                    \"nombre_imprimir\": me.tabProducto.pro_nombre,\r\n                    \"descripcionlibro\": me.tabProducto.pro_descripcion,\r\n                    \"serie\": 0,\r\n                    \"weblibro\": null,\r\n                    \"pdfsinguia\":null ,\r\n                    \"pdfconguia\": null,\r\n                    \"guiadidactica\": null,\r\n                    \"asignatura_idasignatura\": null,\r\n                    \"portada\": \"portada.png\",\r\n                    \"demo\": null,\r\n                    \"id_serie\": me.tabProducto.id_serie,\r\n                    \"codigo_liquidacion\": me.tabProducto.pro_codigo,\r\n                    \"year\": parseInt(me.numeros),\r\n                    \"version2\": null,\r\n                    \"s_weblibro\": null,\r\n                    \"s_pdfsinguia\": null,\r\n                    \"s_pdfconguia\": null,\r\n                    \"s_guiadidactica\": null,\r\n                    \"s_portada\": \"portada.png\",\r\n                    \"c_weblibro\": null,\r\n                    \"c_pdfsinguia\": null,\r\n                    \"c_pdfconguia\": null,\r\n                    \"c_guiadidactica\": null,\r\n                    \"c_portada\": \"portada.png\",\r\n                    \"user_created\": usuarioObjeto.idusuario,                \r\n                }\r\n                me.$vs.loading()\r\n                //axios.post(this.$apifacturacion_url + 'f_Vendedor', datos)\r\n                this.$http.post(this.$server_url+'Registrar_modificar_producto', datos)\r\n                // this.$http.post(this.$server_url+'guardarLibro', datos2)\r\n                .then(res => {\r\n                    me.$vs.loading.close()\r\n                    me.popupGuardar = false\r\n                    if(res.data.message){\r\n                        me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-user'\r\n                        })\r\n                    }else{\r\n                        me.$vs.notify({\r\n                            text: 'Guardado con éxito',\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-check'\r\n                        });\r\n                    }\r\n                    limpiar()\r\n                })\r\n                .catch(function () {\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: 'Producto no se pudo guardar',\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-x'\r\n                    })\r\n                })\r\n            },\r\n            //para obtener el listado de los usuarios root\r\n            getUserRoot() {\r\n                let me = this;\r\n                this.$http.get(this.$server_url+'permisos?permiso=yes&usuario_id='+me.usuario.idusuario)\r\n                    .then(function (res) {\r\n                        if(res.data.status == '1'){\r\n                            me.permisoRoot = true\r\n                        }else{\r\n                            me.permisoRoot = false\r\n                        }\r\n                    })\r\n                    .catch(function (error) {\r\n                        console.log(error + ' error');\r\n                    })\r\n            },\r\n            //para obtener el listado de asignaturas\r\n            getAsignaturas() {\r\n                let me = this;\r\n                me.$vs.loading();\r\n                this.$http.get(this.$server_url + 'listaLibro')\r\n                    .then(function (res) {\r\n                        me.Asignaturas = res.data.asignatura\r\n                        me.$vs.loading.close()\r\n                    })\r\n                    .catch(function (error) {\r\n                        console.log(error + ' error');\r\n                        me.$vs.loading.close()\r\n                    })\r\n            },\r\n            //lista de series para usar en el select\r\n            listaSeries(){\r\n                let me = this\r\n            this.$http.get(this.$server_url+`libroserie`).then(res => {\r\n                me.arregloSeries = res.data.serieslista;\r\n                })\r\n                .catch(function (error) {\r\n                console.log(error)\r\n                })\r\n            },\r\n            //para ver el libro digital\r\n            datolibro(data,url) {\r\n                let me = this;\r\n                let region  = localStorage.region\r\n                 this.$http.get(this.$server_url+'menu_unidades_libros/' + data.idlibro+'/'+region)\r\n                .then(function (response) {\r\n                    me.unidadesLibro = response.data\r\n                })\r\n                .catch(function (error) {})\r\n                localStorage.url = url;\r\n                for (let index = 0; index < me.unidadesLibro.length; index++) {\r\n                    if (index == 0) {\r\n                        localStorage.pag_inicio = me.unidadesLibro[index].pag_inicio\r\n                    }\r\n                    localStorage.pag_fin = me.unidadesLibro[index].pag_fin\r\n                }\r\n                localStorage.vistalibro = 'por_unidad'\r\n                 let route = this.$router.resolve({path: '/admin/libro/desgloselibro'});\r\n                // let route = this.$router.resolve('/link/to/page'); // This also works.\r\n                window.open(route.href, '_blank');\r\n            },\r\n            //para ver el libro sin guia en el admin\r\n            datopdfsinguia(url) {\r\n                let me = this\r\n                if (url === null || url === 'null') {\r\n                    me.$vs.notify({\r\n                        text: 'El PDF sin guía aun no está disponible',\r\n                        color: 'warning',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    return\r\n                }\r\n                localStorage.pdfsinguia = url;\r\n                let route = this.$router.resolve({path: '/admin/libro/pdfsinguia'});\r\n                window.open(route.href, '_blank');\r\n            },\r\n            //para ver el libro con guia en el admin\r\n            datopdfconguia(url) {\r\n                let me = this\r\n                if (url === null || url === 'null') {\r\n                    me.$vs.notify({\r\n                        text: 'El PDF con guía aun no está disponible',\r\n                        color: 'warning',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    return\r\n                }\r\n                localStorage.url_guia = url;\r\n                let route = this.$router.resolve({path: '/docente/libro/pdfconguia'});\r\n                window.open(route.href, '_blank');\r\n            },\r\n            datopdfguiadidactica(url) {\r\n                let me = this\r\n                if (url === null || url === 'null') {\r\n                    me.$vs.notify({\r\n                        text: 'La guía didáctica aun no está disponible',\r\n                        color: 'warning',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    return\r\n                }\r\n                localStorage.url_guiadid = url;\r\n                let route = this.$router.resolve({path: '/docente/libro/pdfguiadidactica'});\r\n                window.open(route.href, '_blank');\r\n            },\r\n            //para eliminar el libro\r\n            eliminarLibro() {\r\n                let me = this;\r\n                let formData = new FormData();\r\n                formData.append('idlibro', me.idlibro);\r\n                me.$vs.loading()\r\n                this.$http.post(this.$server_url + 'eliminarLibro', formData)\r\n                    .then(res => {\r\n                        me.$vs.loading.close()\r\n                        me.$vs.notify({\r\n                            text: 'Libro desactivado con exito',\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-check'\r\n                        })\r\n                        me.$emit('recharge',true)\r\n                    })\r\n            },\r\n            //para activar el libro\r\n            activarLibro(){\r\n                let me = this;\r\n                let formData = new FormData();\r\n                formData.append('idlibro', me.idlibro);\r\n                me.$vs.loading()\r\n                this.$http.post(this.$server_url + 'activarLibro', formData)\r\n                    .then(res => {\r\n                        me.$vs.loading.close()\r\n                        me.$vs.notify({\r\n                            text: 'Libro Activado con exito',\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-check'\r\n                        })\r\n                        me.$emit('recharge',true)\r\n                    })\r\n            },\r\n            //para abrir el popup de confimacion para eliminar\r\n            openConfirm(idlibro) {\r\n                this.idlibro = idlibro;\r\n                this.$vs.dialog({\r\n                    type: 'confirm',\r\n                    color: 'danger',\r\n                    title: `Confirmación`,\r\n                    text: 'Está seguro de desactivar este libro?',\r\n                    acceptText:'Aceptar',\r\n                    cancelText:'Cancelar',\r\n                    accept: this.eliminarLibro\r\n                })\r\n            },\r\n            openConfirmActivar(idlibro){\r\n                 this.idlibro = idlibro;\r\n                this.$vs.dialog({\r\n                    type: 'confirm',\r\n                    color: 'danger',\r\n                    title: `Confirmación`,\r\n                    text: 'Está seguro de activar este libro?',\r\n                    acceptText:'Aceptar',\r\n                    cancelText:'Cancelar',\r\n                    accept: this.activarLibro\r\n                })\r\n            },\r\n            //para guardar las areas\r\n            guardarLibro() {\r\n                let me = this;\r\n                if (me.libro.nombrelibro === '' || me.libro.serie == '' || me.serie.year == '' ) {\r\n                  this.$vs.notify({\r\n                    text: 'Debe completar todos los campos antes de guardar',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                  })\r\n                  return;\r\n                }\r\n                if(me.libro.nombre_imprimir == \"\"){\r\n                  this.$vs.notify({\r\n                    text: 'Debe ingresar el nombre del libro para imprimir',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                  })\r\n                  return;\r\n                }\r\n                let formData = new FormData();\r\n                formData.append('idlibro',                  me.id);\r\n                formData.append('nombrelibro',              me.libro.nombrelibro);\r\n                formData.append('nombre_imprimir',          me.libro.nombre_imprimir)\r\n                formData.append('descripcionlibro',         me.libro.descripcionlibro);\r\n                formData.append('serie',                    me.libro.serie);\r\n                formData.append('weblibro',                 me.libro.weblibro);\r\n                formData.append('pdfsinguia',               me.libro.pdfsinguia);\r\n                formData.append('pdfconguia',               me.libro.pdfconguia);\r\n                formData.append('guiadidactica',            me.libro.guiadidactica);\r\n                formData.append('asignatura_idasignatura',  me.libro.asignatura_idasignatura.idasignatura);\r\n                formData.append('portada',                  me.libro.portada);\r\n                formData.append('demo',                     me.libro.demo)\r\n                //para guardar la serie\r\n                formData.append('id_serie',                 me.serie.nombre_serie.id_serie);\r\n                formData.append('codigo_liquidacion',       me.serie.codigo_liquidacion);\r\n                formData.append('year',                     me.serie.year);\r\n                formData.append('version2',                 me.serie.version2);\r\n                //SIERRA\r\n                formData.append('s_weblibro',               me.libro.s_weblibro);\r\n                formData.append('s_pdfsinguia',             me.libro.s_pdfsinguia);\r\n                formData.append('s_pdfconguia',             me.libro.s_pdfconguia);\r\n                formData.append('s_guiadidactica',          me.libro.s_guiadidactica);\r\n                formData.append('s_portada',                me.libro.s_portada);\r\n                //COSTA\r\n                formData.append('c_weblibro',               me.libro.c_weblibro);\r\n                formData.append('c_pdfsinguia',             me.libro.c_pdfsinguia);\r\n                formData.append('c_pdfconguia',             me.libro.c_pdfconguia);\r\n                formData.append('c_guiadidactica',          me.libro.c_guiadidactica);\r\n                formData.append('c_portada',                me.libro.c_portada);\r\n                me.$vs.loading()\r\n                this.$http.post(this.$server_url + 'guardarLibro', formData)\r\n                    .then(function (res) {\r\n                        me.$vs.notify({\r\n                            text: res.data.message,\r\n                            color: 'primary',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-alert-triangle'\r\n                        })\r\n                        me.$vs.loading.close()\r\n                        me.popupGuardarLibro = false\r\n                        if(me.id == 0){\r\n                            me.$emit('nuevoLibro',me.libro.nombrelibro)\r\n                        }else{\r\n                            console.log(\"mundo\")\r\n                            me.$emit('recharge',true)\r\n                        }\r\n                        limpiar()\r\n                    })\r\n                    .catch(function (error) {})\r\n    \r\n            },\r\n            //para editar los campos\r\n            openModalEditar(data = {}) {\r\n                let me = this;\r\n                //llenar la data en los campos\r\n                me.id = data.idlibro;\r\n                me.libro.nombrelibro            = data.nombrelibro;\r\n                me.libro.nombre_imprimir        = data.nombre_imprimir\r\n                me.libro.descripcionlibro       = data.descripcionlibro;\r\n                me.libro.serie                  = data.serie;\r\n                me.libro.weblibro               = data.weblibro;\r\n                me.libro.pdfsinguia             = data.pdfsinguia;\r\n                me.libro.pdfconguia             = data.pdfconguia;\r\n                me.libro.portada                = data.portada;\r\n                if(data.guiadidactica == null ||  data.guiadidactica == \"null\" ||   data.guiadidactica == \"0\")\r\n                {\r\n                    me.libro.guiadidactica = \"\";\r\n                }else{\r\n                    me.libro.guiadidactica = data.guiadidactica;\r\n                }\r\n                if(data.year == null ||  data.year == \"null\" ||   data.year == \"0\")\r\n                {\r\n                    me.serie.year = \"\";\r\n                }else{\r\n                    me.serie.year = data.year;\r\n                }\r\n                if(data.version == null ||  data.version == \"null\" ||   data.version == \"0\")\r\n                {\r\n                    me.serie.version2 = \"\";\r\n                }else{\r\n                    me.serie.version2 = data.version;\r\n                }\r\n                me.libro.asignatura_idasignatura = { idasignatura: data.asignatura_idasignatura, nombreasignatura: data.asignatura };\r\n                //para  editar la tabla serie\r\n                me.serie.nombre_serie = { id_serie: data.id_serie, nombre_serie: data.nombre_serie };\r\n                // me.serie.iniciales = data.iniciales;\r\n                me.serie.codigo_liquidacion = data.codigo_liquidacion;\r\n                //DATOS LIBRO SIERRA\r\n                me.libro.s_weblibro            = data.s_weblibro\r\n                me.libro.s_pdfsinguia          = data.s_pdfsinguia\r\n                me.libro.s_pdfconguia          = data.s_pdfconguia\r\n                me.libro.s_guiadidactica       = data.s_guiadidactica\r\n                me.libro.s_portada             = data.s_portada\r\n                me.libro.demo                  = data.demo\r\n                //DATOS LIBRO COSTA\r\n                me.libro.c_weblibro            = data.c_weblibro\r\n                me.libro.c_pdfsinguia          = data.c_pdfsinguia\r\n                me.libro.c_pdfconguia          = data.c_pdfconguia\r\n                me.libro.c_guiadidactica       = data.c_guiadidactica\r\n                me.libro.c_portada             = data.c_portada\r\n                me.popupGuardarLibro           = true;\r\n                me.modoEdicion                 = true;\r\n            },\r\n            //para ver el libro serie especifico\r\n            verLibroSerie(data={}){\r\n                let me =this;\r\n                me.popupVerSerie = true\r\n                 me.$vs.loading();\r\n                    this.$http.get(this.$server_url+'verLibroSerie?idlibro='+data.idlibro)\r\n                    .then(res => {\r\n                        me.lsiniciales = res.data[0].iniciales;\r\n                        me.lsnombre= res.data[0].nombre\r\n                        me.lscodigo_liquidacion= res.data[0].codigo_liquidacion\r\n                        me.lsyear= res.data[0].year\r\n                        me.lsversion= res.data[0].version\r\n                        me.lsnombre_serie= res.data[0].nombre_serie\r\n                        me.$vs.loading.close();\r\n                    })\r\n                    .catch(function (error) {\r\n                      console.log(error)\r\n                          me.$vs.loading.close();\r\n                    })\r\n            },\r\n            //para limpiar los campos\r\n            limpiar() {\r\n                let me                              = this;\r\n                me.id                               = 0\r\n                me.libro.nombrelibro                = \"\";\r\n                me.libro.nombre_imprimir            = \"\";\r\n                me.libro.descripcionlibro           = \"\";\r\n                me.libro.weblibro                   = \"\";\r\n                me.libro.pdfsinguia                 = \"\";\r\n                me.libro.pdfconguia                 = \"\";\r\n                me.libro.guiadidactica              = \"\";\r\n                me.libro.serie                      = \"0\";\r\n                me.libro.asignatura_idasignatura    = \"\";\r\n                me.libro.portada                    = \"portada.png\"\r\n                me.libro.demo                       = \"\"\r\n                //para limpiar la tabla serie\r\n                me.serie.nombre_serie               = \"\";\r\n                me.serie.iniciales                  = \"\";\r\n                me.serie.codigo_liquidacion         = \"\";\r\n                me.serie.year                       = \"\";\r\n                me.serie.version2                   = \"\";\r\n                //DATOS LIBRO SIERRA\r\n                me.libro.s_weblibro                 = \"\"\r\n                me.libro.s_pdfsinguia               = \"\"\r\n                me.libro.s_pdfconguia               = \"\"\r\n                me.libro.s_guiadidactica            = \"\"\r\n                me.libro.s_portada                  = \"portada.png\"\r\n                //DATOS LIBRO COSTA\r\n                me.libro.c_weblibro                 = \"\"\r\n                me.libro.c_pdfsinguia               = \"\"\r\n                me.libro.c_pdfconguia               = \"\"\r\n                me.libro.c_guiadidactica            = \"\"\r\n                me.libro.c_portada                  = \"portada.png\"\r\n                me.tabProducto.pro_codigo           = \"\"\r\n                me.tabProducto.gru_pro_codigo       = 1\r\n                me.tabProducto.pro_costo            = null\r\n                me.tabProducto.pro_descripcion      = \"\"\r\n                me.tabProducto.pro_descuento        = \"\"\r\n                me.tabProducto.pro_iva              = null\r\n                me.tabProducto.pro_nombre           = \"\"\r\n                me.tabProducto.pro_peso             = \"\"\r\n                me.tabProducto.pro_stock            = \"\"\r\n                me.tabProducto.pro_valor            = \"\"\r\n                me.tabProducto.id_serie             = \"\"\r\n            },\r\n            getLinksLibros(){\r\n              let me = this\r\n              me.$vs.loading();\r\n              me.$http.get(this.$server_url + 'get_links_libro/' + me.idlibro)\r\n              .then(res => {\r\n                  me.links = res.data\r\n                  me.$vs.loading.close()\r\n              })\r\n              .catch(function (error) { me.$vs.loading.close() })\r\n            },\r\n            guardarLink(){\r\n              let me = this\r\n              me.$vs.loading();\r\n              let formData = new FormData();\r\n              formData.append('id_libro', me.idlibro);\r\n              formData.append('pag_ini', me.link.pag_ini);\r\n              formData.append('pag_fin', me.link.pag_fin);\r\n              formData.append('fecha_ini', me.link.fecha_inicio);\r\n              formData.append('fecha_fin', me.link.fecha_caducidad);\r\n              me.$http.post(this.$server_url + 'guardar_link_libro', formData)\r\n              .then(res => {\r\n                  me.getLinksLibros();\r\n                  me.$vs.loading.close()\r\n                  me.$vs.notify({ text: 'Link guardado con éxito', color: 'success', iconPack: 'feather', icon: 'icon-check' })\r\n              })\r\n              .catch(function (error) { me.$vs.loading.close() })\r\n            },\r\n            copiarLink(item){\r\n              let me = this\r\n                let host = location.protocol + '//' + location.hostname +':'+ location.port\r\n                let ruta = host +'/libro_free/'+ item.pag_ini+'4.3'+item.pag_fin+'4.3'+item.fecha_ini+'4.3'+item.fecha_fin+'4.3'+item.weblibro\r\n                var aux = document.createElement(\"input\");\r\n                console.log('ruta',ruta)\r\n                aux.setAttribute(\"value\", ruta);\r\n                document.body.appendChild(aux);\r\n                aux.select();\r\n                try {\r\n                    var status = document.execCommand('copy');\r\n                    if (!status) {\r\n                        me.$vs.notify({ text: 'Error al copiar el link', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n                    } else {\r\n                        me.$vs.notify({ text: 'Link copiado', color: 'success', iconPack: 'feather', icon: 'icon-check' })\r\n                    }\r\n                } catch (err) {\r\n                    console.log('No se pudo copiar');\r\n                }\r\n                document.body.removeChild(aux);\r\n            }\r\n        },\r\n        created() {\r\n            this.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n            this.getAsignaturas();\r\n            this.listaSeries();\r\n            localStorage.vistalibro = 'todo'\r\n            this.getUserRoot()\r\n        }\r\n    }\r\n    </script>\r\n    <style>\r\n    .enlace{\r\n        cursor:pointer;\r\n        transition:1s ease all;\r\n        margin-top:20px!important;\r\n    }\r\n    .enlace:hover{\r\n        text-decoration:underline;\r\n        color:#63B8EC;\r\n    }\r\n    </style>\r\n    "]}]}