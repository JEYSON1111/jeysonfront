{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\home\\gerencia\\lista_aprobar.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\home\\gerencia\\lista_aprobar.vue","mtime":1712682815990},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\n    // import valoresAntererioresVue from './pedidos/components/valoresAntereriores.vue';\r\n    const anticiposAnteriosVue = () => import('../../pedidos/components/milton/anticiposAnterios.vue')\r\n    // import anticiposAnterios from '../../pedidos/components/milton/anticiposAnterios.vue';\r\n    export default {\r\n        components:{\r\n          anticiposAnteriosVue,\r\n        },\r\n        data() {\r\n            return {\r\n                usuario:[],\r\n                listaPendientes: [],\r\n                pedido:{},\r\n                datoAprobar: '',\r\n                op: '',\r\n                popupSolicitud:false,\r\n                popupMostraValoresAnteriores:false,\r\n                cantidadAprobar:0,\r\n                ifconvenio:0,\r\n                objectSelect:'',\r\n            }\r\n        },\r\n        mounted() {\r\n            let me = this;\r\n            me.getPedidosGerencia();\r\n            me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n        },\r\n        methods: {\r\n          filtrarDecimal(numero){\r\n            let me = this\r\n            if(numero == 0 || numero == null){\r\n                return numero\r\n            }else{\r\n                const transformar = (numero).toFixed(2).replace(/\\d(?=(\\d{3})+\\.)/g, '$&,');\r\n                return transformar\r\n            }\r\n          },\r\n          getPedidosGerencia() {\r\n            let me = this;\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + 'listaPedidosGerencia')\r\n              .then((res) => {\r\n                me.$vs.loading.close();\r\n                if(res.data.status == 0){\r\n                  me.$vs.notify({\r\n                  text:res.data.message,\r\n                  color:'danger',\r\n                  iconPack: 'feather',\r\n                  icon:'icon-check'})\r\n                  return\r\n                }\r\n                me.listaPendientes = res.data\r\n\r\n              }).catch((err) => {\r\n                console.log(err)\r\n                me.$vs.loading.close();\r\n              });\r\n          },\r\n            confirma_aprueba(item, tipo) {\r\n                let me = this;\r\n                me.datoAprobar = item;\r\n                me.datoAprobar.op = tipo\r\n                me.$vs.dialog({\r\n                    type: 'confirm',\r\n                    color: tipo == 0 ? 'success' : 'danger',\r\n                    title: 'Confirmar',\r\n                    text: tipo == 0 ? '¿Aprobar pago?' : 'Rechazar pago?',\r\n                    acceptText: 'Aceptar',\r\n                    cancelText: 'Cancelar',\r\n                    accept: me.f_aprobar_pago\r\n                })\r\n            },\r\n            updateConvenio(cantidad,campo1,valor1,campo2,valor2,campo3,valor3){\r\n              let me = this;\r\n              let formData = new FormData();\r\n              formData.append('updateCamposDatos',    'yes')\r\n              if(cantidad == 1)                       { formData.append('unCampo', 'yes') }\r\n              if(cantidad == 2)                       { formData.append('dosCampos', 'yes') }\r\n              if(cantidad == 3)                       { formData.append('tresCampos', 'yes') }\r\n              formData.append('id',                   me.objectSelect.idConvenio);\r\n              formData.append('campo1',               campo1);\r\n              formData.append('campo2',               campo2);\r\n              formData.append('campo3',               campo3);\r\n              formData.append('valor1',               valor1)\r\n              formData.append('valor2',               valor2)\r\n              formData.append('valor3',               valor3)\r\n              formData.append('user_created',         me.usuario.idusuario)\r\n              formData.append('idConvenio',           me.objectSelect.idConvenio)\r\n              this.$http.post(this.$server_url+'convenio', formData)\r\n              .then(res => {\r\n                  me.$vs.notify({\r\n                  text:'Se guardo correctamente',\r\n                  color:'success',\r\n                  iconPack: 'feather',\r\n                  icon:'icon-check'})\r\n                  me.getPedidosGerencia();\r\n                  me.popupSolicitud = false\r\n              })\r\n              .catch((e)=>{\r\n                // me.$vs.loading.close()\r\n              })\r\n            },\r\n            f_aprobar_pago() {\r\n                let me = this;\r\n                let msj, color;\r\n                me.datoAprobar.cantidadAprobar    = me.cantidadAprobar\r\n                me.datoAprobar.user_created       = me.usuario.idusuario\r\n                me.datoAprobar.id_group           = me.usuario.id_group\r\n                me.datoAprobar.anticipo_aprobado  = me.cantidadAprobar\r\n                me.datoAprobar.id_pedido          = me.pedido.pedido_id\r\n                me.$vs.loading();\r\n                this.$http.post(this.$server_url + 'aprobarPedidoGerencia', me.datoAprobar)\r\n                    .then((result) => {\r\n                        msj = me.datoAprobar.op == 0 ? 'Pago aprobado correctamente.' : 'Pago rechazado';\r\n                        color = me.datoAprobar.op == 0 ? 'success' : 'danger';\r\n                        me.f_notificaciones(msj, color, 'icon-alert-triangle')\r\n                        me.getPedidosGerencia();\r\n                        me.popupSolicitud = false\r\n                        me.$vs.loading.close();\r\n                    }).catch((err) => {\r\n                        console.log(err)\r\n                        me.$vs.loading.close();\r\n                    });\r\n            },\r\n            f_notificaciones(msj, color, icono) {\r\n                let me = this;\r\n                me.$vs.notify({\r\n                    text: msj,\r\n                    color: color,\r\n                    iconPack: 'feather',\r\n                    icon: icono\r\n                })\r\n                return;\r\n            }\r\n\r\n        },\r\n    }\r\n    ",{"version":3,"sources":["lista_aprobar.vue"],"names":[],"mappings":";AAkIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"lista_aprobar.vue","sourceRoot":"src/views/home/gerencia","sourcesContent":["<template>\r\n    <div>\r\n      <vx-card class=\"mt-4 mb-4\" v-for=\"(item,index) in listaPendientes\" :key=\"index\">\r\n          <div class=\"vx-row mr-1\">\r\n            <div class=\"vx-col w-full sm:w-1/2 md:w-1/2 lg:w-1/3 xl:w-1/3 mb-6\">\r\n              <div>\r\n                <!--TIPOS-->\r\n                <div v-if=\"item.convenio_anios > 0\">\r\n                  <vs-chip color=\"success\">Convenio: {{ item.convenio_anios }} años</vs-chip>\r\n                </div>\r\n                <vs-chip v-if=\"item.tipo_pago == 0 || item.tipo_pago == null\" color=\"warning\">\r\n                  Anticipo\r\n                </vs-chip>\r\n                <vs-chip v-if=\"item.tipo_pago == 1\" color=\"primary\">\r\n                  Liquidación\r\n                </vs-chip>\r\n                <br><br>\r\n                <p v-if=\"usuario.cedula == 'sgerencia'\">#{{ item.pedido_id }}</p>\r\n                <!--CONVENIO-->\r\n                <div v-if=\"item.valor_sugerido\">\r\n                  <div>\r\n                    <span>Asesor solicita más anticipo para el convenio</span>\r\n                    <h2 class=\"mt-1\"><small> $</small> {{ item.valor_sugerido }} </h2>\r\n                  </div>\r\n                  <!--SOLICITADO POR EL FACTURADOR EL ANTICIPO PARA QUE APRUEBE-->\r\n                  <div class=\"flex\">\r\n                    <vs-button color=\"success\" class=\"mr-2 p-2\" icon=\"check\" type=\"filled\" @click=\"ifconvenio=1;objectSelect = item;cantidadAprobar= item.valor_sugerido;pedido = item;popupSolicitud = true;\">Aprobar</vs-button>\r\n                    <!-- <vs-button color=\"danger\" type=\"border\" class=\"p-2\" @click=\"confirma_aprueba(item,op=1)\">Rechazar</vs-button> -->\r\n                  </div>\r\n                </div>\r\n                <!--ANTICIPO-->\r\n                <div v-if=\"item.ifagregado_anticipo_aprobado == 2\">\r\n                  <div>\r\n                    <span>Asesor solicita más anticipo</span>\r\n                    <h2 class=\"mt-1\"><small> $</small> {{ item.anticipo_solicitud_for_gerencia }} </h2>\r\n                  </div>\r\n                  <!--SOLICITADO POR EL FACTURADOR EL ANTICIPO PARA QUE APRUEBE-->\r\n                  <div class=\"flex\">\r\n                    <vs-button color=\"success\" class=\"mr-2 p-2\" icon=\"check\" type=\"filled\" @click=\"ifconvenio=0;cantidadAprobar= item.anticipo_solicitud_for_gerencia;pedido = item;popupSolicitud = true;\">Aprobar</vs-button>\r\n                    <vs-button color=\"danger\" type=\"border\" class=\"p-2\" @click=\"confirma_aprueba(item,op=1)\">Rechazar</vs-button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"vx-col w-full sm:w-1/2 md:w-1/2 lg:w-1/3 xl:w-1/3 mb-6\">\r\n              <!--INFORMACION-->\r\n              <b>Asesor:</b>\r\n              <p> {{ item.nombres }} {{ item.apellidos }} </p>\r\n              <b class=\"mt-1\">Institución</b>\r\n              <p>{{ item.nombreInstitucion }}</p>\r\n              <b>Ciudad</b>\r\n              <p>{{ item.nombre_ciudad }}</p>\r\n              <b>Período</b>\r\n              <p>{{ item.periodo }}</p>\r\n              <b>Fecha solicitud</b>\r\n              <p> {{ item.fechaCreacionPedido }}</p>\r\n            </div>\r\n            <div class=\"vx-col w-full sm:w-full md:w-1/2 lg:w-1/3 xl:w-1/3 mb-6\">\r\n              <!--DETALLE PEDIDO-->\r\n              <vs-divider>Detalle pedido</vs-divider>\r\n              <vs-button color=\"success\" @click=\"pedido = item;popupMostraValoresAnteriores = true;\" style=\"margin-left: -5px;\" type=\"flat\">Ver venta anteriores</vs-button>\r\n              <ul class=\"features\">\r\n                <li>\r\n                  <span class=\"icon\">\r\n                    <svg height=\"24\" width=\"24\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                      <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n                      <path fill=\"currentColor\" d=\"M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z\"></path>\r\n                    </svg>\r\n                  </span>\r\n                  <span><strong>Comisión:</strong> {{ item.descuento }}%</span>\r\n                </li>\r\n                <li>\r\n                  <span class=\"icon\">\r\n                    <svg height=\"24\" width=\"24\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                      <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n                      <path fill=\"currentColor\" d=\"M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z\"></path>\r\n                    </svg>\r\n                  </span>\r\n                  <span><strong>Venta series básicas:</strong> ${{ filtrarDecimal(item.total_series_basicas) }}</span>\r\n                </li>\r\n                <li>\r\n                  <span class=\"icon\">\r\n                    <svg height=\"24\" width=\"24\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                      <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\r\n                      <path fill=\"currentColor\" d=\"M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z\"></path>\r\n                    </svg>\r\n                  </span>\r\n                  <span><strong>Venta bruta:</strong> ${{ filtrarDecimal(item.total_venta) }}</span>\r\n                </li>\r\n              </ul>\r\n              <!--OBSERVACION ASESOR-->\r\n              <div v-if=\"item.observacion\">\r\n                  <vs-divider>Observación asesor</vs-divider>\r\n                  <div class=\"\">\r\n                      {{ item.observacion }}\r\n                  </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n\r\n          <!--MODAL PARA VER LOS COMENTARIOS DE LA SOLICITUD-->\r\n          <vs-popup class=\"holamundo\" title=\"Solicitud de más anticipo\" :active.sync=\"popupSolicitud\">\r\n              <p><b>Anticipo Solicitado:</b> {{  pedido.anticipo_solicitud_for_gerencia }}</p>\r\n              <p><b>Observación:</b> {{  pedido.anticipo_solicitud_observacion }}</p>\r\n              <vs-divider></vs-divider>\r\n              <div>\r\n                  <vx-input-group class=\"mb-base\">\r\n                  <template slot=\"prepend\">\r\n                  <div class=\"prepend-text bg-primary\">\r\n                      <span>Aprobar valor de:</span>\r\n                  </div>\r\n                  </template>\r\n                  <vs-input v-model=\"cantidadAprobar\" type=\"number\" placeholder=\"Ingrese el valor a aprobar\" />\r\n              </vx-input-group>\r\n              </div>\r\n              <div class=\"flex justify-center\">\r\n                  <vs-button color=\"success\" v-if=\"ifconvenio==0\" @click=\"f_aprobar_pago(datoAprobar=pedido,datoAprobar.op=0)\" type=\"gradient\">Aprobar anticipo</vs-button>\r\n                  <vs-button color=\"success\" v-if=\"ifconvenio=='1'\" @click=\"updateConvenio(3,'anticipo_global',cantidadAprobar,'convenio_aprobado',3,'valor_aprobado_gerencia',cantidadAprobar)\" type=\"gradient\">Aprobar Convenio</vs-button>\r\n                </div>\r\n          </vs-popup>\r\n          <!--MODAL VALORES ANTERIORES-->\r\n          <vs-popup class=\"holamundo\" title=\"Valores anteriores\" :active.sync=\"popupMostraValoresAnteriores\">\r\n            <anticiposAnteriosVue v-if=\"popupMostraValoresAnteriores\" :tmpPedidos=\"pedido\"/>\r\n          </vs-popup>\r\n      </vx-card>\r\n    </div>\r\n    </template>\r\n\r\n    <script>\r\n    // import valoresAntererioresVue from './pedidos/components/valoresAntereriores.vue';\r\n    const anticiposAnteriosVue = () => import('../../pedidos/components/milton/anticiposAnterios.vue')\r\n    // import anticiposAnterios from '../../pedidos/components/milton/anticiposAnterios.vue';\r\n    export default {\r\n        components:{\r\n          anticiposAnteriosVue,\r\n        },\r\n        data() {\r\n            return {\r\n                usuario:[],\r\n                listaPendientes: [],\r\n                pedido:{},\r\n                datoAprobar: '',\r\n                op: '',\r\n                popupSolicitud:false,\r\n                popupMostraValoresAnteriores:false,\r\n                cantidadAprobar:0,\r\n                ifconvenio:0,\r\n                objectSelect:'',\r\n            }\r\n        },\r\n        mounted() {\r\n            let me = this;\r\n            me.getPedidosGerencia();\r\n            me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n        },\r\n        methods: {\r\n          filtrarDecimal(numero){\r\n            let me = this\r\n            if(numero == 0 || numero == null){\r\n                return numero\r\n            }else{\r\n                const transformar = (numero).toFixed(2).replace(/\\d(?=(\\d{3})+\\.)/g, '$&,');\r\n                return transformar\r\n            }\r\n          },\r\n          getPedidosGerencia() {\r\n            let me = this;\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + 'listaPedidosGerencia')\r\n              .then((res) => {\r\n                me.$vs.loading.close();\r\n                if(res.data.status == 0){\r\n                  me.$vs.notify({\r\n                  text:res.data.message,\r\n                  color:'danger',\r\n                  iconPack: 'feather',\r\n                  icon:'icon-check'})\r\n                  return\r\n                }\r\n                me.listaPendientes = res.data\r\n\r\n              }).catch((err) => {\r\n                console.log(err)\r\n                me.$vs.loading.close();\r\n              });\r\n          },\r\n            confirma_aprueba(item, tipo) {\r\n                let me = this;\r\n                me.datoAprobar = item;\r\n                me.datoAprobar.op = tipo\r\n                me.$vs.dialog({\r\n                    type: 'confirm',\r\n                    color: tipo == 0 ? 'success' : 'danger',\r\n                    title: 'Confirmar',\r\n                    text: tipo == 0 ? '¿Aprobar pago?' : 'Rechazar pago?',\r\n                    acceptText: 'Aceptar',\r\n                    cancelText: 'Cancelar',\r\n                    accept: me.f_aprobar_pago\r\n                })\r\n            },\r\n            updateConvenio(cantidad,campo1,valor1,campo2,valor2,campo3,valor3){\r\n              let me = this;\r\n              let formData = new FormData();\r\n              formData.append('updateCamposDatos',    'yes')\r\n              if(cantidad == 1)                       { formData.append('unCampo', 'yes') }\r\n              if(cantidad == 2)                       { formData.append('dosCampos', 'yes') }\r\n              if(cantidad == 3)                       { formData.append('tresCampos', 'yes') }\r\n              formData.append('id',                   me.objectSelect.idConvenio);\r\n              formData.append('campo1',               campo1);\r\n              formData.append('campo2',               campo2);\r\n              formData.append('campo3',               campo3);\r\n              formData.append('valor1',               valor1)\r\n              formData.append('valor2',               valor2)\r\n              formData.append('valor3',               valor3)\r\n              formData.append('user_created',         me.usuario.idusuario)\r\n              formData.append('idConvenio',           me.objectSelect.idConvenio)\r\n              this.$http.post(this.$server_url+'convenio', formData)\r\n              .then(res => {\r\n                  me.$vs.notify({\r\n                  text:'Se guardo correctamente',\r\n                  color:'success',\r\n                  iconPack: 'feather',\r\n                  icon:'icon-check'})\r\n                  me.getPedidosGerencia();\r\n                  me.popupSolicitud = false\r\n              })\r\n              .catch((e)=>{\r\n                // me.$vs.loading.close()\r\n              })\r\n            },\r\n            f_aprobar_pago() {\r\n                let me = this;\r\n                let msj, color;\r\n                me.datoAprobar.cantidadAprobar    = me.cantidadAprobar\r\n                me.datoAprobar.user_created       = me.usuario.idusuario\r\n                me.datoAprobar.id_group           = me.usuario.id_group\r\n                me.datoAprobar.anticipo_aprobado  = me.cantidadAprobar\r\n                me.datoAprobar.id_pedido          = me.pedido.pedido_id\r\n                me.$vs.loading();\r\n                this.$http.post(this.$server_url + 'aprobarPedidoGerencia', me.datoAprobar)\r\n                    .then((result) => {\r\n                        msj = me.datoAprobar.op == 0 ? 'Pago aprobado correctamente.' : 'Pago rechazado';\r\n                        color = me.datoAprobar.op == 0 ? 'success' : 'danger';\r\n                        me.f_notificaciones(msj, color, 'icon-alert-triangle')\r\n                        me.getPedidosGerencia();\r\n                        me.popupSolicitud = false\r\n                        me.$vs.loading.close();\r\n                    }).catch((err) => {\r\n                        console.log(err)\r\n                        me.$vs.loading.close();\r\n                    });\r\n            },\r\n            f_notificaciones(msj, color, icono) {\r\n                let me = this;\r\n                me.$vs.notify({\r\n                    text: msj,\r\n                    color: color,\r\n                    iconPack: 'feather',\r\n                    icon: icono\r\n                })\r\n                return;\r\n            }\r\n\r\n        },\r\n    }\r\n    </script>\r\n    <style scoped>\r\n      .features {\r\n        display: flex;\r\n        flex-direction: column;\r\n      }\r\n      .features li {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 0.5rem;\r\n      }\r\n      .features li + * {\r\n        margin-top: 0.75rem;\r\n      }\r\n      .features .icon {\r\n        background-color: #1FCAC5;\r\n        display: inline-flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        color: #fff;\r\n        border-radius: 50%;\r\n        width: 20px;\r\n        height: 20px;\r\n      }\r\n      .features .icon svg {\r\n        width: 14px;\r\n        height: 14px;\r\n      }\r\n      .features + * {\r\n        margin-top: 1.25rem;\r\n      }\r\n\r\n    </style>\r\n"]}]}