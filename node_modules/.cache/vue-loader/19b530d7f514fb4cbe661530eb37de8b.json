{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\codigos\\components\\seccionBuscar.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\codigos\\components\\seccionBuscar.vue","mtime":1712682815641},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport gestionCodigosLista from './utils/gestionCodigosLista.vue'\r\nimport TableCodigosStorageVue from './utils/TableCodigosStorage.vue';\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nimport vSelect from 'vue-select'\r\nimport moment from 'moment'\r\nimport $ from 'jquery'\r\nexport default {\r\n    data() {\r\n        return{\r\n        activePrompt: false,\r\n        creador_codigo: null,\r\n        instituciones:[],\r\n        seriesEdit:[],\r\n        usuario:[],\r\n        series:[],\r\n        libros:[],\r\n        libros_series: [],\r\n        reportesActivo: 0,\r\n        codigoSelected: [],\r\n        porcentaje: 0,\r\n        codigo_busqueda: '',\r\n        fecha_busqueda: null,\r\n        codigosbuscar: [],\r\n        codigo:{\r\n            libro:'',\r\n        },\r\n        modalAgregar:false,\r\n        ing_codigo:'',\r\n        serieSelect: '',\r\n        longitud_numeros: '',\r\n        longitud_letras: '',\r\n        nombre_serie:'',\r\n        libroSelect: '',\r\n        codigobuscar: {\r\n            codigo: '',\r\n            libro: '',\r\n            serie: '',\r\n            anio: '',\r\n            libro_idlibro: '',\r\n            fecha_create: ''\r\n        },\r\n        estudiante: {\r\n            idusuario: '',\r\n            cedula: '',\r\n            nombres: '',\r\n            apellidos: '',\r\n            email: '',\r\n            nombreInstitucion: '',\r\n            nombreCiudad: ''\r\n        },\r\n        serieEditar: '',\r\n        libroEditar: '',\r\n        libro_idlibroEditar: '',\r\n        id_periodo: '',\r\n        popupEditCodigo:false,\r\n        itemEstado : [],\r\n        estadoCodigo :\"\",\r\n        observacionEstado:\"\",\r\n        idusuarioCodigo: '',\r\n        librosEdit: [],\r\n        libroEdit: {\r\n            id: '',\r\n            label: ''\r\n        },\r\n        dataBusqueda: '',\r\n        codigo_busqueda: '',\r\n        popupCambioEstadoCodigo:false,\r\n        activePrompt: false,\r\n        reporteAsesorActivo: false,\r\n        guardarActivo:'',\r\n        generarActivo:'',\r\n        textAlertCant:'',\r\n        cantidad:'',\r\n        periodo:{\r\n            region:'2',\r\n            getPeriodo:'',\r\n        },\r\n        periodos:[],\r\n        //VARIABLES PARA MOSTRAR CODIGOS EN EL STORAGE\r\n        contadorLibro:'',\r\n        arregloStorage:[],\r\n        popupMostrarCodigos:false,\r\n        userAdmin:false,\r\n        //FIN VARIABLES PARA MOSTRAR CODIGOS EN EL STORAGE\r\n        codigoTemp:'',\r\n        prueba_diagnostica:0,\r\n        tipo_codigo:'',\r\n      }\r\n    },\r\n    components:{\r\n      'v-select': vSelect,\r\n      gestionCodigosLista,\r\n      TableCodigosStorageVue,\r\n    },\r\n    mounted(){\r\n      let me = this;\r\n      me.getPeriodoxRegion()\r\n      //SI HAY CODIGOS EN EL STORAGE\r\n      let getStorage = JSON.parse(localStorage.getItem(\"getStorage\"))\r\n      if(getStorage){\r\n        me.arregloStorage  = getStorage\r\n      }\r\n      //user admin\r\n      if(me.usuario.id_group == 1) me.userAdmin = true\r\n    },\r\n    created() {\r\n        let me = this;\r\n        //para traer el listado de ciudades para filtrar por institucion\r\n        me.buscarlibros();\r\n        me.$http.get(me.$server_url+'series').then(res => {\r\n            me.series = res.data;\r\n        }),\r\n        me.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n        me.creador_codigo = me.usuario.idusuario;\r\n        me.$http.get(me.$server_url+'seriesCambiar').then(res => {\r\n            me.seriesEdit = res.data;\r\n        }),\r\n        me.$http.get(me.$server_url+'institucionesResportes').then(res => {\r\n            me.instituciones = res.data;\r\n        })\r\n    },\r\n    methods:{\r\n        changeHandle(e){\r\n            let me = this;\r\n            me.codigoTemp = e.info.codigo\r\n            if(e.tipo == \"editar\"){\r\n                me.popupEditCodigo = true\r\n                me.editarCodigo(e.info)\r\n            }else{\r\n                me.ConfirmCambiadoEstadoCodigo(e.info,e.estado)\r\n            }\r\n        },\r\n\r\n         buscarlibros() {\r\n            let me = this;\r\n            me.reportesActivo = 0;\r\n            me.codigoSelected = [];\r\n            me.porcentaje = 0;\r\n            me.$http.get(me.$server_url+'librosBuscar').then(res => {\r\n                me.libros = res.data;\r\n            })\r\n        },\r\n        buscarCodigoXContador(){\r\n          let me = this\r\n          let ruta = \"\"\r\n          me.codigosbuscar = []\r\n          if(me.contadorLibro == \"\" || me.contadorLibro == null || me.contadorLibro == undefined){\r\n            this.$vs.notify({\r\n              text: 'Ingrese un contador por favor',\r\n              color: 'warning',\r\n              iconPack: 'feather',\r\n              icon: 'icon-alert-triangle'\r\n            })\r\n            return\r\n          }\r\n          if(me.codigo.libro == \"\" || me.codigo.libro == null || me.codigo.libro == undefined){\r\n            this.$vs.notify({\r\n              text: 'Seleccione un libro por favor para buscar el contador',\r\n              color: 'warning',\r\n              iconPack: 'feather',\r\n              icon: 'icon-alert-triangle'\r\n            })\r\n            return\r\n          }\r\n          if(me.contadorLibro < 2){\r\n            this.$vs.notify({\r\n              text: 'No puede realizar búsquedas menos de 2 ',\r\n              color: 'warning',\r\n              iconPack: 'feather',\r\n              icon: 'icon-alert-triangle'\r\n            })\r\n            return\r\n          }\r\n          me.$vs.loading()\r\n          ruta = this.$server_url+'codigosBuscarCodigoXContador/' + me.codigo.libro.idLibro+'/'+me.contadorLibro\r\n          this.$http.get(ruta).then(res => {\r\n          this.$vs.loading.close()\r\n          this.codigosbuscar = res.data;\r\n            if (res.data[0] === undefined) {\r\n              this.$vs.notify({\r\n                text: 'Código no encontrado',\r\n                color: 'danger',\r\n                iconPack: 'feather',\r\n                icon: 'icon-alert-triangle'\r\n              })\r\n            }\r\n          })\r\n          .catch((err) => {\r\n            this.$vs.loading.close()\r\n          })\r\n        },\r\n        async buscarCodigos(codigo, libro, fecha_busqueda) {\r\n          let me = this;\r\n          this.popupEditCodigo = false;\r\n          if(me.usuario.id_group == 17){\r\n              if(codigo.length < 5){\r\n                  this.$vs.notify({\r\n                      text: 'Minimo 5 caracteres',\r\n                      color: 'danger',\r\n                      iconPack: 'feather',\r\n                      icon: 'icon-alert-triangle'\r\n                  })\r\n                  return false\r\n              }\r\n          }\r\n          this.codigoSelected = [];\r\n          if (codigo != '') {\r\n              this.openLoadingColor();\r\n              this.codigo_busqueda = '';\r\n              this.fecha_busqueda = '';\r\n              this.codigo.libro = '';\r\n              let ruta = \"\"\r\n              if(me.usuario.id_group == 11){\r\n                  ruta = this.$server_url+'codigosBuscarxCodigo/' + codigo\r\n              }else{\r\n                  ruta = this.$server_url+'codigosBuscarCodigo/' + codigo\r\n              }\r\n              this.$http.get(ruta).then(res => {\r\n                  this.$vs.loading.close()\r\n                  this.codigosbuscar = res.data;\r\n                  if (res.data[0] === undefined) {\r\n                      this.$vs.notify({\r\n                          text: 'Código no encontrado',\r\n                          color: 'danger',\r\n                          iconPack: 'feather',\r\n                          icon: 'icon-alert-triangle'\r\n                      })\r\n                  }\r\n              })\r\n\r\n          }else {\r\n              this.codigoSelected = [];\r\n              this.dataBusqueda = libro.label + '*' + fecha_busqueda;\r\n\r\n              this.openLoadingColor();\r\n              let data = libro.label + '*' + fecha_busqueda;\r\n\r\n              if (libro != '' && libro != null && fecha_busqueda != null) {\r\n                  this.$http.get(this.$server_url+'codigosLibrosFecha/' + data).then(res => {\r\n                      this.$vs.loading.close()\r\n                      this.codigosbuscar = res.data;\r\n                      if (res.data == 0) {\r\n                          this.$vs.notify({\r\n                              text: 'No existen códigos creados para este libro. Puede probar con otra fecha.',\r\n                              color: 'warning',\r\n                              iconPack: 'feather',\r\n                              icon: 'icon-alert-circle'\r\n                          })\r\n                      }\r\n                  })\r\n              } else {\r\n                  this.$vs.loading.close()\r\n                  this.$vs.notify({\r\n                      text: 'Seleccione un libro y escriba una fecha aproximada para realizar la búsqueda.',\r\n                      color: 'warning',\r\n                      iconPack: 'feather',\r\n                      icon: 'icon-alert-circle'\r\n                  })\r\n              }\r\n\r\n          }\r\n        },\r\n        async verLibrosSeries(id, item) {\r\n          console.log(id, item)\r\n          this.longitud_numeros = item.longitud_numeros\r\n          this.longitud_letras = item.longitud_letras\r\n          this.nombre_serie = item.nombre_serie\r\n          this.$http.get(this.$server_url+'libros_series/' + id).then(res => {\r\n            this.libros_series = res.data;\r\n          })\r\n        },\r\n         agregar_codigo_perdido() {\r\n            let me = this;\r\n            // console.log(me.ing_codigo, me.serieSelect.nombre_serie, me.libroSelect.nombre, String(me.libroSelect.year), 0, me.creador_codigo, me.libroSelect.idLibro, me.prueba_diagnostica);\r\n\r\n            let formData = new FormData();\r\n            formData.append('codigo', me.ing_codigo)\r\n            formData.append('serie', me.serieSelect.nombre_serie)\r\n            formData.append('libro', me.libroSelect.nombre)\r\n            formData.append('anio', String(me.libroSelect.year))\r\n            formData.append('idusuario', 0);\r\n            formData.append('idusuario_creador_codigo', me.usuario.idusuario)\r\n            formData.append('libro_idlibro', parseInt(me.libroSelect.idLibro))\r\n            formData.append('estado', 0);\r\n            formData.append('prueba_diagnostica', me.prueba_diagnostica);\r\n            this.$http.post(this.$server_url+'agregar_codigo_perdido', formData)\r\n                .then(res => {\r\n                    console.log(res.data)\r\n                    me.modalAgregar = false;\r\n                    me.buscarCodigos(me.ing_codigo)\r\n                    me.$vs.notify({\r\n                        text: 'Codigo agregado correctamente',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n\r\n                })\r\n                .catch(function (error) {\r\n                    console.log('error->  ' + me.ing_codigo);\r\n                });\r\n        },\r\n        editarCodigo(item) {\r\n\r\n            this.codigobuscar.codigo = '';\r\n            this.codigobuscar.libro = '';\r\n            this.codigobuscar.serie = '';\r\n            this.codigobuscar.anio = '';\r\n            this.codigobuscar.fecha_create = '';\r\n\r\n            this.estudiante.cedula = '';\r\n            this.estudiante.nombres = '';\r\n            this.estudiante.apellidos = '';\r\n            this.estudiante.email = '';\r\n            this.estudiante.nombreInstitucion = '';\r\n            this.estudiante.nombreCiudad = '';\r\n\r\n            this.codigobuscar.codigo = item.codigo;\r\n            this.codigobuscar.libro = item.libro;\r\n            this.codigobuscar.serie = item.serie;\r\n            this.codigobuscar.anio = item.anio;\r\n            this.codigobuscar.fecha_create = item.fecha_create;\r\n\r\n            this.serieEditar = item.serie;\r\n            this.libroEditar = item.libro;\r\n            this.libro_idlibroEditar = item.libro_idlibro;\r\n            this.periodo.getPeriodo  = \"\"\r\n            this.periodo.region      = 1\r\n            if (item.idusuario != 0 && item.idusuario !=null) {\r\n                this.idusuarioCodigo      = item.idusuario;\r\n                this.periodo.getPeriodo   = item.id_periodo\r\n                this.serieEditar          = item.serie;\r\n                this.libroEditar          = item.libro;\r\n                this.libro_idlibroEditar  = item.libro_idlibro;\r\n\r\n                //datos estudiante\r\n                this.$http.get(this.$server_url+'estudianteCodigo/' + item.idusuario).then(res => {\r\n                        this.estudiantes = res.data;\r\n                        this.estudiante.cedula    = res.data[0].cedula;\r\n                        this.estudiante.nombres   = res.data[0].nombres;\r\n                        this.estudiante.apellidos = res.data[0].apellidos;\r\n                        this.estudiante.email     = res.data[0].email;\r\n                    }),\r\n                    //institucion estudiante\r\n                    this.$http.get(this.$server_url+'institucionEstCod/' + item.idusuario).then(res => {\r\n                      if (res.data === undefined) {\r\n                        return;\r\n                      } else {\r\n                        this.estudiante.nombreInstitucion = {\r\n                          id: res.data[0].idInstitucion,\r\n                          label: res.data[0].nombreInstitucion,\r\n                          id_periodo: res.data[0].id_periodo\r\n                        };\r\n                        // this.id_periodo = res.data[0].id_periodo\r\n                        this.estudiante.nombreCiudad = res.data[0].nombre_ciudad;\r\n                        this.periodo.region          = res.data[0].region\r\n                      }\r\n                    })\r\n            } else {\r\n                return;\r\n            }\r\n        },\r\n\r\n          //para obtener el listado de los periodos\r\n        getPeriodoxRegion() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url+'periodo?porAllEstados=yes'+'&region='+me.periodo.region)\r\n                .then(function (res) {\r\n                    me.periodos = res.data\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n\r\n                })\r\n        },\r\n         editarCodigos(item) {\r\n          let me = this;\r\n            if (this.estudiante.cedula === '') {\r\n                this.$vs.notify({\r\n                    text: 'Ingrese un Estudiante antes de Modificar',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (this.estudiante.nombreInstitucion === null || this.estudiante.nombreInstitucion === '' || this.estudiante.nombreInstitucion === undefined) {\r\n                this.$vs.notify({\r\n                    text: 'Seleccione la Institución del Estudiante antes de modificar',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                });\r\n                return;\r\n            }\r\n            if(me.periodo.getPeriodo == null || me.periodo.getPeriodo == \"\" || me.periodo.getPeriodo == undefined){\r\n              this.$vs.notify({\r\n                    text: 'Seleccione un período por favor',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                });\r\n                return;\r\n            }\r\n            // this.openLoadingColor()\r\n            let datos = this.codigobuscar.codigo + '*'\r\n             + this.codigobuscar.libro + '*'\r\n             + this.serieEditar + '*'\r\n             + this.codigobuscar.anio + '*'\r\n             + this.creador_codigo + '*'\r\n             + this.idusuarioCodigo + '*'\r\n             + this.libro_idlibroEditar\r\n             + '*' + this.periodo.getPeriodo\r\n             + '*' + this.estudiante.nombreInstitucion.id;\r\n            //alert(this.codigobuscar.libro);\r\n            if (this.codigobuscar.libro != '' && this.codigobuscar.libro != 'null' && this.codigobuscar.libro != null) {\r\n              this.$http.get(this.$server_url+'editarCodigoBuscado/' + datos)\r\n              .then(function (res) {\r\n                // this.$vs.loading.close()\r\n                // this.popupEditCodigo = false;\r\n                me.buscarCodigos(me.codigoTemp)\r\n              })\r\n              .catch(function (error) {\r\n                // this.$vs.loading.close()\r\n                console.log(error + ' error');\r\n              })\r\n            } else {\r\n              console.log(\"dos\")\r\n                this.$vs.notify({\r\n                    text: 'Seleccione un libro antes de modificar',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n            }\r\n\r\n        },\r\n\r\n        cambiarSerie(item) {\r\n            this.$http.get(this.$server_url+'librosSerieCambiar/' + item.id).then(res => {\r\n                this.librosEdit = res.data;\r\n                this.serieEditar = item.label;\r\n\r\n                this.codigobuscar.libro = '';\r\n            })\r\n        },\r\n        cambiarLibro(item) {\r\n            this.$http.get(this.$server_url+'librosCambiar/' + item.id).then(res => {\r\n                this.codigobuscar.libro = res.data[0].nombre;\r\n                this.codigobuscar.anio = res.data[0].year;\r\n                this.codigobuscar.fecha_create = res.data[0].created_at;\r\n                this.libro_idlibroEditar = res.data[0].idLibro;\r\n            })\r\n        },\r\n\r\n        //Para confirmar el bloqueo del codigo\r\n        ConfirmCambiadoEstadoCodigo(item,estado){\r\n            let me = this;\r\n            me.itemEstado = item;\r\n            me.estadoCodigo = estado;\r\n            localStorage.estado = estado;\r\n            this.$vs.dialog({\r\n                type:'confirm',\r\n                color: 'danger',\r\n                title: `Confirm`,\r\n                text:  'Esta seguro de cambiar el estado del codigo?',\r\n                accept:this.ActivarModalEstadoCodigo\r\n            })\r\n        },\r\n        cargarEstudianteCod(cedula) {\r\n            this.openLoadingColor();\r\n            this.estudiante.cedula = '';\r\n            this.estudiante.nombres = '';\r\n            this.estudiante.apellidos = '';\r\n            this.estudiante.email = '';\r\n            this.estudiante.nombreInstitucion = '';\r\n            this.estudiante.nombreCiudad = '';\r\n            if (cedula != '') {\r\n                this.$http.get(this.$server_url+'cedulasEstudiantes/' + cedula).then(res => {\r\n                    if (res.data[0] === undefined) {\r\n                        this.$vs.loading.close()\r\n                        this.$vs.notify({\r\n                            text: 'Cédula no encontrada',\r\n                            color: 'danger',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-alert-triangle'\r\n                        })\r\n                    } else {\r\n                        this.$vs.notify({\r\n                            text: 'Estudiante encontrado',\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-check'\r\n                        })\r\n\r\n                        this.idusuarioCodigo = res.data[0].idusuario;\r\n                        this.estudiante.cedula = res.data[0].cedula;\r\n                        this.estudiante.nombres = res.data[0].nombres;\r\n                        this.estudiante.apellidos = res.data[0].apellidos;\r\n                        this.estudiante.email = res.data[0].email;\r\n\r\n                        //institucion estudiante\r\n                        this.$http.get(this.$server_url+'institucionEstCod/' + res.data[0].idusuario).then(res => {\r\n                            this.$vs.loading.close()\r\n                            if (res.data === undefined) {\r\n                                return;\r\n                            } else {\r\n                                this.estudiante.nombreInstitucion = {\r\n                                    id: res.data[0].idInstitucion,\r\n                                    label: res.data[0].nombreInstitucion,\r\n                                    id_periodo: res.data[0].id_periodo\r\n                                };\r\n                                this.id_periodo = res.data[0].id_periodo\r\n                                this.estudiante.nombreCiudad = res.data[0].nombre_ciudad;\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n            } else {\r\n              this.$vs.loading.close()\r\n              this.$vs.notify({\r\n                  text: 'Cédula no encontrada',\r\n                  color: 'danger',\r\n                  iconPack: 'feather',\r\n                  icon: 'icon-alert-triangle'\r\n              })\r\n            }\r\n        },\r\n         asignarInstitucionEstudiante(item) {\r\n            let me = this;\r\n            this.estudiante.nombreCiudad = item.nombre_ciudad;\r\n            this.id_periodo = item.id_periodo\r\n            if (this.estudiante.nombres == '') {\r\n                this.estudiante.nombreInstitucion = '';\r\n                this.estudiante.nombreCiudad = '';\r\n                this.$vs.notify({\r\n                    text: 'Ingrese un estudiante antes de asignar una Institución.',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return;\r\n            }\r\n            var formData = new FormData();\r\n            formData.append(\"id\", this.idusuarioCodigo);\r\n            formData.append(\"idInstitucion\", item.id);\r\n            formData.append(\"codigo\", me.codigobuscar.codigo);\r\n            this.$http.post(this.$server_url+'editarInstEstud', formData).then(res => {\r\n                this.$vs.notify({\r\n                    text: 'Institución asignada correctamente',\r\n                    color: 'success',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })\r\n                })\r\n                .catch(function (error) {\r\n                    alert('Error al asignar Institución');\r\n                });\r\n\r\n        },\r\n        modalAgregarCodigo() {\r\n            let me = this;\r\n            me.ing_codigo = ''\r\n            me.modalAgregar = true;\r\n        },\r\n\r\n         openLoadingColor(libro) {\r\n            this.$vs.loading({\r\n                color: '#1A76F2'\r\n            })\r\n        },\r\n\r\n           ActivarModalEstadoCodigo(){\r\n            let me = this;\r\n            me.popupCambioEstadoCodigo = true;\r\n        },\r\n\r\n        cambioEstadoCodigo() {\r\n          let me = this;\r\n          if(me.observacionEstado ==\"\"|| me.observacionEstado == undefined){\r\n            me.$vs.notify({\r\n                text: 'Ingrese una observacion por favor',\r\n                color: 'primary',\r\n                iconPack: 'feather',\r\n                icon: 'icon-check'\r\n            })\r\n            return false;\r\n          }\r\n          let formData = new FormData();\r\n          formData.append('periodo', me.itemEstado.idperiodoescolar);\r\n          formData.append(\"codigo\", me.itemEstado.codigo);\r\n          formData.append(\"estado\", me.estadoCodigo);\r\n          formData.append('usuario_editor',me.creador_codigo);\r\n          if(me.estadoCodigo == '2'){\r\n                formData.append(\"observacion\",me.observacionEstado);\r\n          }else{\r\n                formData.append(\"observacion\",me.observacionEstado);\r\n          }\r\n          this.$http.post(this.$server_url+'cambioEstadoCodigo', formData)\r\n            .then(res => {\r\n              if(res.data.message){\r\n                me.$vs.notify({\r\n                  text: res.data.message,\r\n                  color: 'primary',\r\n                  iconPack: 'feather',\r\n                  icon: 'icon-check'\r\n                })\r\n                return false;\r\n              }\r\n              if (me.estadoCodigo == 0) {\r\n                me.$vs.notify({\r\n                  text: 'Codigo activo nuevamente',\r\n                  color: 'success',\r\n                  iconPack: 'feather',\r\n                  icon: 'icon-check'\r\n                })\r\n                me.popupCambioEstadoCodigo = false;\r\n                me.observacionEstado = \"\";\r\n              } else {\r\n                me.$vs.notify({\r\n                  text: 'Codigo bloqueado',\r\n                  color: 'warning',\r\n                  iconPack: 'feather',\r\n                  icon: 'icon-check'\r\n                })\r\n                me.observacionEstado = \"\";\r\n                me.popupCambioEstadoCodigo = false;\r\n              }\r\n              me.buscarCodigos(me.itemEstado.codigo);\r\n            })\r\n            .catch(function (error) {\r\n                console.log('Error al bloquear el codigo solicitado ' + me.itemEstado.codigo);\r\n            });\r\n        },\r\n        //METODOS PARA CRUD STORAGE\r\n        changeAddStorage(e){\r\n          let me = this\r\n\r\n          let getStorage = JSON.parse(localStorage.getItem(\"getStorage\"))\r\n          if(getStorage){\r\n            me.arregloStorage  = getStorage\r\n          }\r\n          this.$vs.notify({\r\n            text:'Se agrego el código '+e.codigo +\" del libro \"+e.libro,\r\n            color:'primary',\r\n            iconPack: 'feather',\r\n            icon:'icon-check',\r\n            time:4000\r\n          })\r\n          var cal = new Object()\r\n          cal.codigo = e.codigo\r\n          cal.libro  = e.libro\r\n          me.arregloStorage.push(cal)\r\n          //quitar duplicados\r\n          localStorage.removeItem(\"getStorage\")\r\n          let hash = {};\r\n          let resultado     = me.arregloStorage.filter(o => hash[o.codigo] ? false : hash[o.codigo] = true);\r\n          me.arregloStorage = resultado\r\n          localStorage.setItem('getStorage', JSON.stringify(me.arregloStorage))\r\n        },\r\n        changeDeleteStorage(e){\r\n          let me = this\r\n          this.$vs.notify({\r\n            text:'Se elimino el código '+e.codigo +\" del libro \"+e.libro,\r\n            color:'warning',\r\n            iconPack: 'feather',\r\n            icon:'icon-check',\r\n            time:4000\r\n          })\r\n          let getStorage = JSON.parse(localStorage.getItem(\"getStorage\"))\r\n          me.arregloStorage = getStorage.filter(p => p.codigo != e.codigo)\r\n          //quitar duplicados\r\n          localStorage.removeItem(\"getStorage\")\r\n          let hash = {};\r\n          let resultado     = me.arregloStorage.filter(o => hash[o.codigo] ? false : hash[o.codigo] = true);\r\n          me.arregloStorage = resultado\r\n          localStorage.setItem('getStorage', JSON.stringify(me.arregloStorage))\r\n        },\r\n        quitarDuplicados(){\r\n          let me = this;\r\n          //quitar duplicados\r\n          localStorage.removeItem(\"getStorage\")\r\n          let hash = {};\r\n          let resultado     = me.arregloStorage.filter(o => hash[o.codigo] ? false : hash[o.codigo] = true);\r\n          me.arregloStorage = resultado\r\n          localStorage.setItem('getStorage', JSON.stringify(me.arregloStorage))\r\n        }\r\n        //FIN METODOS PARA CRUD STORAGE\r\n    }\r\n}\r\n",{"version":3,"sources":["seccionBuscar.vue"],"names":[],"mappings":";AAuKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"seccionBuscar.vue","sourceRoot":"src/views/codigos/components","sourcesContent":["<template>\r\n  <div>\r\n    <vs-card>\r\n        <vs-breadcrumb class=\"mb-5\">\r\n          <li>\r\n              <div class=\"mt-2\" style=\"font-size: 13px;\">Código</div>\r\n              <vs-input v-model=\"codigo_busqueda\" @keyup.enter=\"buscarCodigos(codigo_busqueda)\" class=\"mr-2\" />\r\n          </li>\r\n          <li><br>\r\n              <span style=\"font-size: 30px;\" class=\"vs-breadcrum--separator\">»</span>\r\n          </li>\r\n          <li v-if=\"usuario.id_group != 17\">\r\n              <div class=\"mt-2\" style=\"font-size: 13px;\">Seleccione un libro</div>\r\n              <v-select class=\"mr-2\" style=\"width: 250px; font-size: 15px; background-color: white;\" :options=\"libros\" v-model=\"codigo.libro\" :dir=\"$vs.rtl ? 'rtl' : 'ltr'\" />\r\n          </li>\r\n          <li v-if=\"usuario.id_group != 17 && codigo.libro && userAdmin\">\r\n            <div class=\"mt-2\" style=\"font-size: 13px;\">Escriba contador libro</div>\r\n            <vs-input v-model=\"contadorLibro\" @keyup.enter=\"buscarCodigoXContador()\" class=\"mr-2\" />\r\n          </li>\r\n          <li v-if=\"usuario.id_group != 17\"><br>\r\n              <span style=\"font-size: 30px;\" class=\"vs-breadcrum--separator\">»</span>\r\n          </li>\r\n          <div v-if=\"usuario.id_group == 11\">\r\n            <li>\r\n                <div class=\"mt-2\" style=\"font-size: 13px;\">Ej: 2020-08-24 19:05</div>\r\n                <vs-input v-model=\"fecha_busqueda\" class=\"mr-2\" />\r\n            </li>\r\n          </div>\r\n          <div v-else>\r\n            <li v-if=\"usuario.id_group != 17  && !codigo.libro\">\r\n              <div class=\"mt-2\" style=\"font-size: 13px;\">Ej: 2020-08-24 19:05</div>\r\n              <vs-input v-model=\"fecha_busqueda\" class=\"mr-2\" />\r\n            </li>\r\n          </div>\r\n          <li><br>\r\n            <vs-button v-if=\"codigo.libro && userAdmin\" class=\"mt-2\" radius color=\"success\" type=\"gradient\" icon-pack=\"feather\" icon=\"icon-search\" @click=\"buscarCodigoXContador()\"></vs-button>\r\n            <vs-button v-else class=\"mt-2\" radius color=\"success\" type=\"gradient\" icon-pack=\"feather\" icon=\"icon-search\" @click=\"buscarCodigos(codigo_busqueda, codigo.libro, fecha_busqueda)\"></vs-button>\r\n          </li>\r\n          <li v-if=\"creador_codigo===14818 || creador_codigo===5103 || creador_codigo===4853 || creador_codigo===35748\"><br> &nbsp;\r\n              <vs-button class=\"mt-2\" color=\"primary\" type=\"gradient\" @click=\"modalAgregarCodigo()\">Agregar</vs-button>\r\n          </li>\r\n          <li v-if=\"arregloStorage.length > 0 && userAdmin\"><br> &nbsp;\r\n              <vs-button class=\"mt-2\" color=\"success\" type=\"gradient\" @click=\"popupMostrarCodigos = true;\">Mostrar códigos storage: <b>{{ arregloStorage.length }}</b></vs-button>\r\n          </li>\r\n        </vs-breadcrumb>\r\n        <gestionCodigosLista\r\n            :arregloCodigos=\"codigosbuscar\"\r\n            btnEditar=\"0\"\r\n            btnEliminar=\"0\"\r\n            btnEstudiante=\"1\"\r\n            btnBloquear=\"1\"\r\n            ifFechaEstudiante=\"1\"\r\n            btnAddStorage=\"1\"\r\n            @crud=\"changeHandle\"\r\n            @changeAddStorage=\"changeAddStorage\"\r\n        />\r\n    </vs-card>\r\n    <!--Modal-->\r\n    <!-- modal agregar codigo perdido -->\r\n    <vs-popup title=\"Agregar código manualmente\" :active.sync=\"modalAgregar\">\r\n      <div class=\"mt-2\" style=\"font-size: 13px;\">Seleccione la serie</div>\r\n      <v-select class=\"mb-4 w-full\" v-model=\"serieSelect\" :options=\"series\" @input=\"verLibrosSeries(serieSelect.id_serie,1)\" label=\"nombre_serie\" :reduce=\"series => series\" />\r\n      <!-- {{serieSelect}} -->\r\n      <div class=\"mt-2\" style=\"font-size: 13px;\">Seleccione el libro</div>\r\n      <v-select class=\"mb-4 w-full\" v-model=\"libroSelect\" :options=\"libros_series\" label=\"nombre\" :reduce=\"libros_series => libros_series\" />\r\n      <!-- {{libroSelect}} -->\r\n      <p>\r\n        <vs-input label=\"Ingresar código\" v-model=\"ing_codigo\" />\r\n      </p>\r\n      <div class=\"mt-4\">\r\n        <vs-radio v-model=\"prueba_diagnostica\" vs-value=\"0\" class=\"mr-4\" vs-name=\"tipo_codigo\">Activacion</vs-radio>\r\n        <vs-radio v-model=\"prueba_diagnostica\" vs-value=\"1\" class=\"mr-4\" vs-name=\"tipo_codigo\">Diagnóstica</vs-radio>\r\n      </div>\r\n      <vs-divider></vs-divider>\r\n      <div class=\"mt-5\">\r\n          <vs-button class=\"mt-2\" color=\"primary\" type=\"gradient\" @click=\"agregar_codigo_perdido()\">Agregar código</vs-button>\r\n      </div>\r\n    </vs-popup>\r\n    <!-------modal editar codigo---------->\r\n    <vs-popup title=\"Editar Código\" fullscreen :active.sync=\"popupEditCodigo\">\r\n      <vs-divider> Estudiante </vs-divider>\r\n      <div class=\"vx-row\">\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <vs-input style=\"width: 85%; display: inline-block;\" label=\"Cédula\" v-model=\"estudiante.cedula\" />\r\n              <vs-button style=\"width: 14.9%; display: inline-block;\" class=\"mt-2\" color=\"primary\" type=\"gradient\" icon-pack=\"feather\" icon=\"icon-search\" @click=\"cargarEstudianteCod(estudiante.cedula)\"></vs-button>\r\n          </div>\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <vs-input disabled class=\"w-full\" label=\"Nombres\" v-model=\"estudiante.nombres\" />\r\n          </div>\r\n      </div>\r\n      <div class=\"vx-row\">\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <vs-input disabled class=\"w-full\" label=\"Apellidos\" v-model=\"estudiante.apellidos\" />\r\n          </div>\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <vs-input disabled class=\"w-full\" label=\"Email\" v-model=\"estudiante.email\" />\r\n          </div>\r\n      </div>\r\n      <vs-divider> Institución Estudiante </vs-divider>\r\n      <div class=\"vx-row\">\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <div style=\"font-size: 13px;\">Institución</div>\r\n              <ul class=\"leftx\" style=\"display:flex;flex-direction: row;\">\r\n                  <li class=\"ml-2\">\r\n                  <vs-radio v-model=\"periodo.region\" vs-name=\"radiosPeriodo\" @input=\"getPeriodoxRegion();periodo.region ='1'\" vs-value=\"1\">Sierra</vs-radio>\r\n                  </li>\r\n                  <li class=\"ml-2\">\r\n                  <vs-radio v-model=\"periodo.region\" vs-name=\"radiosPeriodo\" @input=\"getPeriodoxRegion();periodo.region ='2'\" vs-value=\"2\">Costa</vs-radio>\r\n                  </li>\r\n              </ul>\r\n          </div>\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <v-select :options=\"periodos\" :reduce=\"periodos => periodos.idperiodoescolar\" label=\"periodo\" class=\"w-full\" v-model=\"periodo.getPeriodo\" />\r\n          </div>\r\n      </div>\r\n      <div class=\"vx-row\">\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <div style=\"font-size: 13px;\">Institución</div>\r\n              <v-select class=\"w-full\" :options=\"instituciones\" v-model=\"estudiante.nombreInstitucion\" @input=\"asignarInstitucionEstudiante(estudiante.nombreInstitucion)\" :dir=\"$vs.rtl ? 'rtl' : 'ltr'\" />\r\n          </div>\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <vs-input disabled class=\"w-full\" label=\"Ciudad\" v-model=\"estudiante.nombreCiudad\" />\r\n          </div>\r\n      </div>\r\n      <vs-divider> Código </vs-divider>\r\n      <div class=\"vx-row\">\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <vs-input disabled class=\"w-full\" label=\"Código\" v-model=\"codigobuscar.codigo\" />\r\n          </div>\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <div style=\"font-size: 13px;\">Serie</div>\r\n              <v-select class=\"w-full\" :options=\"seriesEdit\" v-model=\"codigobuscar.serie\" @input=\"cambiarSerie(codigobuscar.serie)\" :dir=\"$vs.rtl ? 'rtl' : 'ltr'\" />\r\n          </div>\r\n      </div>\r\n      <div class=\"vx-row\">\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <div style=\"font-size: 13px;\">Libro</div>\r\n              <v-select class=\"w-full\" :options=\"librosEdit\" v-model=\"codigobuscar.libro\" @input=\"cambiarLibro(codigobuscar.libro)\" :dir=\"$vs.rtl ? 'rtl' : 'ltr'\" />\r\n          </div>\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <vs-input disabled class=\"w-full\" label=\"Año\" v-model=\"codigobuscar.anio\" />\r\n          </div>\r\n      </div>\r\n      <div class=\"vx-row\">\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <vs-input disabled class=\"w-full\" label=\"Fecha Creación\" v-model=\"codigobuscar.fecha_create\" />\r\n          </div>\r\n          <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n              <vs-button color=\"success\" class=\"mt-5\" style=\"width: 100%;\" type=\"gradient\" @click=\"editarCodigos(codigobuscar)\">Editar</vs-button>\r\n          </div>\r\n      </div>\r\n    </vs-popup>\r\n    <!-- Modal Agregar-->\r\n    <div class=\"demo-alignment\">\r\n      <vs-popup classContent=\"popup-example\" title=\"Cambiar Estado a codigo\" :active.sync=\"popupCambioEstadoCodigo\">\r\n          <vs-input class=\"inputx mb-3 w-full\" label=\"Observacion por que se realiza el bloqueo/desbloqueo del codigo\" v-model=\"observacionEstado\" />\r\n          <br><br>\r\n          <vs-button color=\"success\" class=\"w-full mb-3\" @click=\"cambioEstadoCodigo()\" type=\"gradient\" >Cambiar Estado</vs-button>\r\n      </vs-popup>\r\n    </div>\r\n    <!--MODAL PARA MOSTRAR LOS CODIGOS DEL STORAGE-->\r\n    <vs-popup title=\"Códigos agregados al storage\" :active.sync=\"popupMostrarCodigos\">\r\n      <TableCodigosStorageVue v-if=\"popupMostrarCodigos\" :arregloStorage=\"arregloStorage\" @changeDeleteStorage=\"changeDeleteStorage\"/>\r\n    </vs-popup>\r\n  </div>\r\n</template>\r\n<script>\r\nimport gestionCodigosLista from './utils/gestionCodigosLista.vue'\r\nimport TableCodigosStorageVue from './utils/TableCodigosStorage.vue';\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nimport vSelect from 'vue-select'\r\nimport moment from 'moment'\r\nimport $ from 'jquery'\r\nexport default {\r\n    data() {\r\n        return{\r\n        activePrompt: false,\r\n        creador_codigo: null,\r\n        instituciones:[],\r\n        seriesEdit:[],\r\n        usuario:[],\r\n        series:[],\r\n        libros:[],\r\n        libros_series: [],\r\n        reportesActivo: 0,\r\n        codigoSelected: [],\r\n        porcentaje: 0,\r\n        codigo_busqueda: '',\r\n        fecha_busqueda: null,\r\n        codigosbuscar: [],\r\n        codigo:{\r\n            libro:'',\r\n        },\r\n        modalAgregar:false,\r\n        ing_codigo:'',\r\n        serieSelect: '',\r\n        longitud_numeros: '',\r\n        longitud_letras: '',\r\n        nombre_serie:'',\r\n        libroSelect: '',\r\n        codigobuscar: {\r\n            codigo: '',\r\n            libro: '',\r\n            serie: '',\r\n            anio: '',\r\n            libro_idlibro: '',\r\n            fecha_create: ''\r\n        },\r\n        estudiante: {\r\n            idusuario: '',\r\n            cedula: '',\r\n            nombres: '',\r\n            apellidos: '',\r\n            email: '',\r\n            nombreInstitucion: '',\r\n            nombreCiudad: ''\r\n        },\r\n        serieEditar: '',\r\n        libroEditar: '',\r\n        libro_idlibroEditar: '',\r\n        id_periodo: '',\r\n        popupEditCodigo:false,\r\n        itemEstado : [],\r\n        estadoCodigo :\"\",\r\n        observacionEstado:\"\",\r\n        idusuarioCodigo: '',\r\n        librosEdit: [],\r\n        libroEdit: {\r\n            id: '',\r\n            label: ''\r\n        },\r\n        dataBusqueda: '',\r\n        codigo_busqueda: '',\r\n        popupCambioEstadoCodigo:false,\r\n        activePrompt: false,\r\n        reporteAsesorActivo: false,\r\n        guardarActivo:'',\r\n        generarActivo:'',\r\n        textAlertCant:'',\r\n        cantidad:'',\r\n        periodo:{\r\n            region:'2',\r\n            getPeriodo:'',\r\n        },\r\n        periodos:[],\r\n        //VARIABLES PARA MOSTRAR CODIGOS EN EL STORAGE\r\n        contadorLibro:'',\r\n        arregloStorage:[],\r\n        popupMostrarCodigos:false,\r\n        userAdmin:false,\r\n        //FIN VARIABLES PARA MOSTRAR CODIGOS EN EL STORAGE\r\n        codigoTemp:'',\r\n        prueba_diagnostica:0,\r\n        tipo_codigo:'',\r\n      }\r\n    },\r\n    components:{\r\n      'v-select': vSelect,\r\n      gestionCodigosLista,\r\n      TableCodigosStorageVue,\r\n    },\r\n    mounted(){\r\n      let me = this;\r\n      me.getPeriodoxRegion()\r\n      //SI HAY CODIGOS EN EL STORAGE\r\n      let getStorage = JSON.parse(localStorage.getItem(\"getStorage\"))\r\n      if(getStorage){\r\n        me.arregloStorage  = getStorage\r\n      }\r\n      //user admin\r\n      if(me.usuario.id_group == 1) me.userAdmin = true\r\n    },\r\n    created() {\r\n        let me = this;\r\n        //para traer el listado de ciudades para filtrar por institucion\r\n        me.buscarlibros();\r\n        me.$http.get(me.$server_url+'series').then(res => {\r\n            me.series = res.data;\r\n        }),\r\n        me.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n        me.creador_codigo = me.usuario.idusuario;\r\n        me.$http.get(me.$server_url+'seriesCambiar').then(res => {\r\n            me.seriesEdit = res.data;\r\n        }),\r\n        me.$http.get(me.$server_url+'institucionesResportes').then(res => {\r\n            me.instituciones = res.data;\r\n        })\r\n    },\r\n    methods:{\r\n        changeHandle(e){\r\n            let me = this;\r\n            me.codigoTemp = e.info.codigo\r\n            if(e.tipo == \"editar\"){\r\n                me.popupEditCodigo = true\r\n                me.editarCodigo(e.info)\r\n            }else{\r\n                me.ConfirmCambiadoEstadoCodigo(e.info,e.estado)\r\n            }\r\n        },\r\n\r\n         buscarlibros() {\r\n            let me = this;\r\n            me.reportesActivo = 0;\r\n            me.codigoSelected = [];\r\n            me.porcentaje = 0;\r\n            me.$http.get(me.$server_url+'librosBuscar').then(res => {\r\n                me.libros = res.data;\r\n            })\r\n        },\r\n        buscarCodigoXContador(){\r\n          let me = this\r\n          let ruta = \"\"\r\n          me.codigosbuscar = []\r\n          if(me.contadorLibro == \"\" || me.contadorLibro == null || me.contadorLibro == undefined){\r\n            this.$vs.notify({\r\n              text: 'Ingrese un contador por favor',\r\n              color: 'warning',\r\n              iconPack: 'feather',\r\n              icon: 'icon-alert-triangle'\r\n            })\r\n            return\r\n          }\r\n          if(me.codigo.libro == \"\" || me.codigo.libro == null || me.codigo.libro == undefined){\r\n            this.$vs.notify({\r\n              text: 'Seleccione un libro por favor para buscar el contador',\r\n              color: 'warning',\r\n              iconPack: 'feather',\r\n              icon: 'icon-alert-triangle'\r\n            })\r\n            return\r\n          }\r\n          if(me.contadorLibro < 2){\r\n            this.$vs.notify({\r\n              text: 'No puede realizar búsquedas menos de 2 ',\r\n              color: 'warning',\r\n              iconPack: 'feather',\r\n              icon: 'icon-alert-triangle'\r\n            })\r\n            return\r\n          }\r\n          me.$vs.loading()\r\n          ruta = this.$server_url+'codigosBuscarCodigoXContador/' + me.codigo.libro.idLibro+'/'+me.contadorLibro\r\n          this.$http.get(ruta).then(res => {\r\n          this.$vs.loading.close()\r\n          this.codigosbuscar = res.data;\r\n            if (res.data[0] === undefined) {\r\n              this.$vs.notify({\r\n                text: 'Código no encontrado',\r\n                color: 'danger',\r\n                iconPack: 'feather',\r\n                icon: 'icon-alert-triangle'\r\n              })\r\n            }\r\n          })\r\n          .catch((err) => {\r\n            this.$vs.loading.close()\r\n          })\r\n        },\r\n        async buscarCodigos(codigo, libro, fecha_busqueda) {\r\n          let me = this;\r\n          this.popupEditCodigo = false;\r\n          if(me.usuario.id_group == 17){\r\n              if(codigo.length < 5){\r\n                  this.$vs.notify({\r\n                      text: 'Minimo 5 caracteres',\r\n                      color: 'danger',\r\n                      iconPack: 'feather',\r\n                      icon: 'icon-alert-triangle'\r\n                  })\r\n                  return false\r\n              }\r\n          }\r\n          this.codigoSelected = [];\r\n          if (codigo != '') {\r\n              this.openLoadingColor();\r\n              this.codigo_busqueda = '';\r\n              this.fecha_busqueda = '';\r\n              this.codigo.libro = '';\r\n              let ruta = \"\"\r\n              if(me.usuario.id_group == 11){\r\n                  ruta = this.$server_url+'codigosBuscarxCodigo/' + codigo\r\n              }else{\r\n                  ruta = this.$server_url+'codigosBuscarCodigo/' + codigo\r\n              }\r\n              this.$http.get(ruta).then(res => {\r\n                  this.$vs.loading.close()\r\n                  this.codigosbuscar = res.data;\r\n                  if (res.data[0] === undefined) {\r\n                      this.$vs.notify({\r\n                          text: 'Código no encontrado',\r\n                          color: 'danger',\r\n                          iconPack: 'feather',\r\n                          icon: 'icon-alert-triangle'\r\n                      })\r\n                  }\r\n              })\r\n\r\n          }else {\r\n              this.codigoSelected = [];\r\n              this.dataBusqueda = libro.label + '*' + fecha_busqueda;\r\n\r\n              this.openLoadingColor();\r\n              let data = libro.label + '*' + fecha_busqueda;\r\n\r\n              if (libro != '' && libro != null && fecha_busqueda != null) {\r\n                  this.$http.get(this.$server_url+'codigosLibrosFecha/' + data).then(res => {\r\n                      this.$vs.loading.close()\r\n                      this.codigosbuscar = res.data;\r\n                      if (res.data == 0) {\r\n                          this.$vs.notify({\r\n                              text: 'No existen códigos creados para este libro. Puede probar con otra fecha.',\r\n                              color: 'warning',\r\n                              iconPack: 'feather',\r\n                              icon: 'icon-alert-circle'\r\n                          })\r\n                      }\r\n                  })\r\n              } else {\r\n                  this.$vs.loading.close()\r\n                  this.$vs.notify({\r\n                      text: 'Seleccione un libro y escriba una fecha aproximada para realizar la búsqueda.',\r\n                      color: 'warning',\r\n                      iconPack: 'feather',\r\n                      icon: 'icon-alert-circle'\r\n                  })\r\n              }\r\n\r\n          }\r\n        },\r\n        async verLibrosSeries(id, item) {\r\n          console.log(id, item)\r\n          this.longitud_numeros = item.longitud_numeros\r\n          this.longitud_letras = item.longitud_letras\r\n          this.nombre_serie = item.nombre_serie\r\n          this.$http.get(this.$server_url+'libros_series/' + id).then(res => {\r\n            this.libros_series = res.data;\r\n          })\r\n        },\r\n         agregar_codigo_perdido() {\r\n            let me = this;\r\n            // console.log(me.ing_codigo, me.serieSelect.nombre_serie, me.libroSelect.nombre, String(me.libroSelect.year), 0, me.creador_codigo, me.libroSelect.idLibro, me.prueba_diagnostica);\r\n\r\n            let formData = new FormData();\r\n            formData.append('codigo', me.ing_codigo)\r\n            formData.append('serie', me.serieSelect.nombre_serie)\r\n            formData.append('libro', me.libroSelect.nombre)\r\n            formData.append('anio', String(me.libroSelect.year))\r\n            formData.append('idusuario', 0);\r\n            formData.append('idusuario_creador_codigo', me.usuario.idusuario)\r\n            formData.append('libro_idlibro', parseInt(me.libroSelect.idLibro))\r\n            formData.append('estado', 0);\r\n            formData.append('prueba_diagnostica', me.prueba_diagnostica);\r\n            this.$http.post(this.$server_url+'agregar_codigo_perdido', formData)\r\n                .then(res => {\r\n                    console.log(res.data)\r\n                    me.modalAgregar = false;\r\n                    me.buscarCodigos(me.ing_codigo)\r\n                    me.$vs.notify({\r\n                        text: 'Codigo agregado correctamente',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n\r\n                })\r\n                .catch(function (error) {\r\n                    console.log('error->  ' + me.ing_codigo);\r\n                });\r\n        },\r\n        editarCodigo(item) {\r\n\r\n            this.codigobuscar.codigo = '';\r\n            this.codigobuscar.libro = '';\r\n            this.codigobuscar.serie = '';\r\n            this.codigobuscar.anio = '';\r\n            this.codigobuscar.fecha_create = '';\r\n\r\n            this.estudiante.cedula = '';\r\n            this.estudiante.nombres = '';\r\n            this.estudiante.apellidos = '';\r\n            this.estudiante.email = '';\r\n            this.estudiante.nombreInstitucion = '';\r\n            this.estudiante.nombreCiudad = '';\r\n\r\n            this.codigobuscar.codigo = item.codigo;\r\n            this.codigobuscar.libro = item.libro;\r\n            this.codigobuscar.serie = item.serie;\r\n            this.codigobuscar.anio = item.anio;\r\n            this.codigobuscar.fecha_create = item.fecha_create;\r\n\r\n            this.serieEditar = item.serie;\r\n            this.libroEditar = item.libro;\r\n            this.libro_idlibroEditar = item.libro_idlibro;\r\n            this.periodo.getPeriodo  = \"\"\r\n            this.periodo.region      = 1\r\n            if (item.idusuario != 0 && item.idusuario !=null) {\r\n                this.idusuarioCodigo      = item.idusuario;\r\n                this.periodo.getPeriodo   = item.id_periodo\r\n                this.serieEditar          = item.serie;\r\n                this.libroEditar          = item.libro;\r\n                this.libro_idlibroEditar  = item.libro_idlibro;\r\n\r\n                //datos estudiante\r\n                this.$http.get(this.$server_url+'estudianteCodigo/' + item.idusuario).then(res => {\r\n                        this.estudiantes = res.data;\r\n                        this.estudiante.cedula    = res.data[0].cedula;\r\n                        this.estudiante.nombres   = res.data[0].nombres;\r\n                        this.estudiante.apellidos = res.data[0].apellidos;\r\n                        this.estudiante.email     = res.data[0].email;\r\n                    }),\r\n                    //institucion estudiante\r\n                    this.$http.get(this.$server_url+'institucionEstCod/' + item.idusuario).then(res => {\r\n                      if (res.data === undefined) {\r\n                        return;\r\n                      } else {\r\n                        this.estudiante.nombreInstitucion = {\r\n                          id: res.data[0].idInstitucion,\r\n                          label: res.data[0].nombreInstitucion,\r\n                          id_periodo: res.data[0].id_periodo\r\n                        };\r\n                        // this.id_periodo = res.data[0].id_periodo\r\n                        this.estudiante.nombreCiudad = res.data[0].nombre_ciudad;\r\n                        this.periodo.region          = res.data[0].region\r\n                      }\r\n                    })\r\n            } else {\r\n                return;\r\n            }\r\n        },\r\n\r\n          //para obtener el listado de los periodos\r\n        getPeriodoxRegion() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url+'periodo?porAllEstados=yes'+'&region='+me.periodo.region)\r\n                .then(function (res) {\r\n                    me.periodos = res.data\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n\r\n                })\r\n        },\r\n         editarCodigos(item) {\r\n          let me = this;\r\n            if (this.estudiante.cedula === '') {\r\n                this.$vs.notify({\r\n                    text: 'Ingrese un Estudiante antes de Modificar',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                });\r\n                return;\r\n            }\r\n\r\n            if (this.estudiante.nombreInstitucion === null || this.estudiante.nombreInstitucion === '' || this.estudiante.nombreInstitucion === undefined) {\r\n                this.$vs.notify({\r\n                    text: 'Seleccione la Institución del Estudiante antes de modificar',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                });\r\n                return;\r\n            }\r\n            if(me.periodo.getPeriodo == null || me.periodo.getPeriodo == \"\" || me.periodo.getPeriodo == undefined){\r\n              this.$vs.notify({\r\n                    text: 'Seleccione un período por favor',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                });\r\n                return;\r\n            }\r\n            // this.openLoadingColor()\r\n            let datos = this.codigobuscar.codigo + '*'\r\n             + this.codigobuscar.libro + '*'\r\n             + this.serieEditar + '*'\r\n             + this.codigobuscar.anio + '*'\r\n             + this.creador_codigo + '*'\r\n             + this.idusuarioCodigo + '*'\r\n             + this.libro_idlibroEditar\r\n             + '*' + this.periodo.getPeriodo\r\n             + '*' + this.estudiante.nombreInstitucion.id;\r\n            //alert(this.codigobuscar.libro);\r\n            if (this.codigobuscar.libro != '' && this.codigobuscar.libro != 'null' && this.codigobuscar.libro != null) {\r\n              this.$http.get(this.$server_url+'editarCodigoBuscado/' + datos)\r\n              .then(function (res) {\r\n                // this.$vs.loading.close()\r\n                // this.popupEditCodigo = false;\r\n                me.buscarCodigos(me.codigoTemp)\r\n              })\r\n              .catch(function (error) {\r\n                // this.$vs.loading.close()\r\n                console.log(error + ' error');\r\n              })\r\n            } else {\r\n              console.log(\"dos\")\r\n                this.$vs.notify({\r\n                    text: 'Seleccione un libro antes de modificar',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n            }\r\n\r\n        },\r\n\r\n        cambiarSerie(item) {\r\n            this.$http.get(this.$server_url+'librosSerieCambiar/' + item.id).then(res => {\r\n                this.librosEdit = res.data;\r\n                this.serieEditar = item.label;\r\n\r\n                this.codigobuscar.libro = '';\r\n            })\r\n        },\r\n        cambiarLibro(item) {\r\n            this.$http.get(this.$server_url+'librosCambiar/' + item.id).then(res => {\r\n                this.codigobuscar.libro = res.data[0].nombre;\r\n                this.codigobuscar.anio = res.data[0].year;\r\n                this.codigobuscar.fecha_create = res.data[0].created_at;\r\n                this.libro_idlibroEditar = res.data[0].idLibro;\r\n            })\r\n        },\r\n\r\n        //Para confirmar el bloqueo del codigo\r\n        ConfirmCambiadoEstadoCodigo(item,estado){\r\n            let me = this;\r\n            me.itemEstado = item;\r\n            me.estadoCodigo = estado;\r\n            localStorage.estado = estado;\r\n            this.$vs.dialog({\r\n                type:'confirm',\r\n                color: 'danger',\r\n                title: `Confirm`,\r\n                text:  'Esta seguro de cambiar el estado del codigo?',\r\n                accept:this.ActivarModalEstadoCodigo\r\n            })\r\n        },\r\n        cargarEstudianteCod(cedula) {\r\n            this.openLoadingColor();\r\n            this.estudiante.cedula = '';\r\n            this.estudiante.nombres = '';\r\n            this.estudiante.apellidos = '';\r\n            this.estudiante.email = '';\r\n            this.estudiante.nombreInstitucion = '';\r\n            this.estudiante.nombreCiudad = '';\r\n            if (cedula != '') {\r\n                this.$http.get(this.$server_url+'cedulasEstudiantes/' + cedula).then(res => {\r\n                    if (res.data[0] === undefined) {\r\n                        this.$vs.loading.close()\r\n                        this.$vs.notify({\r\n                            text: 'Cédula no encontrada',\r\n                            color: 'danger',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-alert-triangle'\r\n                        })\r\n                    } else {\r\n                        this.$vs.notify({\r\n                            text: 'Estudiante encontrado',\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-check'\r\n                        })\r\n\r\n                        this.idusuarioCodigo = res.data[0].idusuario;\r\n                        this.estudiante.cedula = res.data[0].cedula;\r\n                        this.estudiante.nombres = res.data[0].nombres;\r\n                        this.estudiante.apellidos = res.data[0].apellidos;\r\n                        this.estudiante.email = res.data[0].email;\r\n\r\n                        //institucion estudiante\r\n                        this.$http.get(this.$server_url+'institucionEstCod/' + res.data[0].idusuario).then(res => {\r\n                            this.$vs.loading.close()\r\n                            if (res.data === undefined) {\r\n                                return;\r\n                            } else {\r\n                                this.estudiante.nombreInstitucion = {\r\n                                    id: res.data[0].idInstitucion,\r\n                                    label: res.data[0].nombreInstitucion,\r\n                                    id_periodo: res.data[0].id_periodo\r\n                                };\r\n                                this.id_periodo = res.data[0].id_periodo\r\n                                this.estudiante.nombreCiudad = res.data[0].nombre_ciudad;\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n            } else {\r\n              this.$vs.loading.close()\r\n              this.$vs.notify({\r\n                  text: 'Cédula no encontrada',\r\n                  color: 'danger',\r\n                  iconPack: 'feather',\r\n                  icon: 'icon-alert-triangle'\r\n              })\r\n            }\r\n        },\r\n         asignarInstitucionEstudiante(item) {\r\n            let me = this;\r\n            this.estudiante.nombreCiudad = item.nombre_ciudad;\r\n            this.id_periodo = item.id_periodo\r\n            if (this.estudiante.nombres == '') {\r\n                this.estudiante.nombreInstitucion = '';\r\n                this.estudiante.nombreCiudad = '';\r\n                this.$vs.notify({\r\n                    text: 'Ingrese un estudiante antes de asignar una Institución.',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return;\r\n            }\r\n            var formData = new FormData();\r\n            formData.append(\"id\", this.idusuarioCodigo);\r\n            formData.append(\"idInstitucion\", item.id);\r\n            formData.append(\"codigo\", me.codigobuscar.codigo);\r\n            this.$http.post(this.$server_url+'editarInstEstud', formData).then(res => {\r\n                this.$vs.notify({\r\n                    text: 'Institución asignada correctamente',\r\n                    color: 'success',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })\r\n                })\r\n                .catch(function (error) {\r\n                    alert('Error al asignar Institución');\r\n                });\r\n\r\n        },\r\n        modalAgregarCodigo() {\r\n            let me = this;\r\n            me.ing_codigo = ''\r\n            me.modalAgregar = true;\r\n        },\r\n\r\n         openLoadingColor(libro) {\r\n            this.$vs.loading({\r\n                color: '#1A76F2'\r\n            })\r\n        },\r\n\r\n           ActivarModalEstadoCodigo(){\r\n            let me = this;\r\n            me.popupCambioEstadoCodigo = true;\r\n        },\r\n\r\n        cambioEstadoCodigo() {\r\n          let me = this;\r\n          if(me.observacionEstado ==\"\"|| me.observacionEstado == undefined){\r\n            me.$vs.notify({\r\n                text: 'Ingrese una observacion por favor',\r\n                color: 'primary',\r\n                iconPack: 'feather',\r\n                icon: 'icon-check'\r\n            })\r\n            return false;\r\n          }\r\n          let formData = new FormData();\r\n          formData.append('periodo', me.itemEstado.idperiodoescolar);\r\n          formData.append(\"codigo\", me.itemEstado.codigo);\r\n          formData.append(\"estado\", me.estadoCodigo);\r\n          formData.append('usuario_editor',me.creador_codigo);\r\n          if(me.estadoCodigo == '2'){\r\n                formData.append(\"observacion\",me.observacionEstado);\r\n          }else{\r\n                formData.append(\"observacion\",me.observacionEstado);\r\n          }\r\n          this.$http.post(this.$server_url+'cambioEstadoCodigo', formData)\r\n            .then(res => {\r\n              if(res.data.message){\r\n                me.$vs.notify({\r\n                  text: res.data.message,\r\n                  color: 'primary',\r\n                  iconPack: 'feather',\r\n                  icon: 'icon-check'\r\n                })\r\n                return false;\r\n              }\r\n              if (me.estadoCodigo == 0) {\r\n                me.$vs.notify({\r\n                  text: 'Codigo activo nuevamente',\r\n                  color: 'success',\r\n                  iconPack: 'feather',\r\n                  icon: 'icon-check'\r\n                })\r\n                me.popupCambioEstadoCodigo = false;\r\n                me.observacionEstado = \"\";\r\n              } else {\r\n                me.$vs.notify({\r\n                  text: 'Codigo bloqueado',\r\n                  color: 'warning',\r\n                  iconPack: 'feather',\r\n                  icon: 'icon-check'\r\n                })\r\n                me.observacionEstado = \"\";\r\n                me.popupCambioEstadoCodigo = false;\r\n              }\r\n              me.buscarCodigos(me.itemEstado.codigo);\r\n            })\r\n            .catch(function (error) {\r\n                console.log('Error al bloquear el codigo solicitado ' + me.itemEstado.codigo);\r\n            });\r\n        },\r\n        //METODOS PARA CRUD STORAGE\r\n        changeAddStorage(e){\r\n          let me = this\r\n\r\n          let getStorage = JSON.parse(localStorage.getItem(\"getStorage\"))\r\n          if(getStorage){\r\n            me.arregloStorage  = getStorage\r\n          }\r\n          this.$vs.notify({\r\n            text:'Se agrego el código '+e.codigo +\" del libro \"+e.libro,\r\n            color:'primary',\r\n            iconPack: 'feather',\r\n            icon:'icon-check',\r\n            time:4000\r\n          })\r\n          var cal = new Object()\r\n          cal.codigo = e.codigo\r\n          cal.libro  = e.libro\r\n          me.arregloStorage.push(cal)\r\n          //quitar duplicados\r\n          localStorage.removeItem(\"getStorage\")\r\n          let hash = {};\r\n          let resultado     = me.arregloStorage.filter(o => hash[o.codigo] ? false : hash[o.codigo] = true);\r\n          me.arregloStorage = resultado\r\n          localStorage.setItem('getStorage', JSON.stringify(me.arregloStorage))\r\n        },\r\n        changeDeleteStorage(e){\r\n          let me = this\r\n          this.$vs.notify({\r\n            text:'Se elimino el código '+e.codigo +\" del libro \"+e.libro,\r\n            color:'warning',\r\n            iconPack: 'feather',\r\n            icon:'icon-check',\r\n            time:4000\r\n          })\r\n          let getStorage = JSON.parse(localStorage.getItem(\"getStorage\"))\r\n          me.arregloStorage = getStorage.filter(p => p.codigo != e.codigo)\r\n          //quitar duplicados\r\n          localStorage.removeItem(\"getStorage\")\r\n          let hash = {};\r\n          let resultado     = me.arregloStorage.filter(o => hash[o.codigo] ? false : hash[o.codigo] = true);\r\n          me.arregloStorage = resultado\r\n          localStorage.setItem('getStorage', JSON.stringify(me.arregloStorage))\r\n        },\r\n        quitarDuplicados(){\r\n          let me = this;\r\n          //quitar duplicados\r\n          localStorage.removeItem(\"getStorage\")\r\n          let hash = {};\r\n          let resultado     = me.arregloStorage.filter(o => hash[o.codigo] ? false : hash[o.codigo] = true);\r\n          me.arregloStorage = resultado\r\n          localStorage.setItem('getStorage', JSON.stringify(me.arregloStorage))\r\n        }\r\n        //FIN METODOS PARA CRUD STORAGE\r\n    }\r\n}\r\n</script>\r\n"]}]}