{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\pedidos\\listado_pedidos2.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\pedidos\\listado_pedidos2.vue","mtime":1712682816351},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport vSelect from 'vue-select'\r\nconst exportContratoVue             = () => import('../temporadas/components/exportContrato.vue')\r\nconst exportPedidoVue               = () => import('../temporadas/components/exportContrato2.vue')\r\nconst exportConvenioVue             = () => import('../temporadas/components/exportConvenio.vue')\r\n// const screenTransabilidaVue         = () => import('./transabilidad/screenTransabilida.vue')\r\nconst screenTransabilidaAlcanceVue  = () => import('@/views/pedidos/transabilidad/screenTransabilidaAlcance')\r\nconst exportPagareVue               = () => import('../temporadas/components/exportPagare.vue')\r\nconst generarContratoVue            = () => import('./components/milton/generarContrato.vue')\r\n// const historicoCodigosNuevoVue      = () => import('../temporadas/historicoCodigosNuevo.vue')\r\n// const VerificacionTrazabilidadVue   = () => import('../temporadas/VerificacionTrazabilidad.vue')\r\nconst pedidosDetalleVue             = () => import('../temporadas/components/pedidosDetalle.vue')\r\nconst LiquidacionVentaDirectaVue    = () => import('./asesor/contratos/LiquidacionVentaDirecta.vue')\r\nconst LiquidacionCodigosVue         = () => import('./asesor/contratos/LiquidacionCodigos.vue')\r\nconst PedidoScreenReportesVue       = () => import('../pedidos2/pedidos/reportes/PedidoScreenReportes.vue');\r\nimport moment from \"moment\";\r\nimport imageZoom from 'vue-image-zoomer';\r\nexport default{\r\n  components:{\r\n    vSelect,\r\n    // screenTransabilidaVue,\r\n    screenTransabilidaAlcanceVue,\r\n    exportContratoVue,\r\n    exportPedidoVue,\r\n    exportConvenioVue,\r\n    exportPagareVue,\r\n    imageZoom,\r\n    generarContratoVue,\r\n    // historicoCodigosNuevoVue,\r\n    // VerificacionTrazabilidadVue,\r\n    flatPickr,\r\n    pedidosDetalleVue,\r\n    // ScreenPagosVue,\r\n    LiquidacionVentaDirectaVue,\r\n    LiquidacionCodigosVue,\r\n    PedidoScreenReportesVue,\r\n  },\r\n  data(){\r\n    return{\r\n      usuario:[],\r\n      // pedidos:[],\r\n      tmpPedidos:[],\r\n      arregloBeneficiarios:[],\r\n      pedido:{},\r\n      contrato:'',\r\n      filtro:1,\r\n      id_periodo:0,\r\n      popupMostrarTransabilidad:false,\r\n      popupMostrarTransabilidadAlcance:false,\r\n      popupMostrarPedido:false,\r\n      //variables modales files export\r\n      mostrarReporte:false,\r\n      popupCarga:false,\r\n      mostrarReporteC:false,\r\n      mostrarReporteConvenio:false,\r\n      mostrarPagareAsesor:false,\r\n      activePrompt:false,\r\n      //variables modales filex export\r\n      //files de beneficiarios\r\n      id_beneficiario_pedido:'',\r\n      beneficiario:'',\r\n      tipo:'',\r\n      //fin files de beneficiarios\r\n      userFacturador:false,\r\n      userAdminFacturador:false,\r\n      userBodega:false,\r\n      tipoFile:0,\r\n      //variables historico\r\n      popupRecibiCheque:false,\r\n      popupEnviarCheque:false,\r\n      popupRecibirPagare:false,\r\n      mostrarDocumento:false,\r\n      //fin variables historico\r\n      popupGenerarContratoManual:false,\r\n      activeMenu:true,\r\n      //variables para verificaciones\r\n      menu:1,\r\n      //fin variables para verificaciones\r\n      //variables para exportar\r\n      fileName: null,\r\n      popupExport: false,\r\n      codigoSelected: [],\r\n      reportesActivo: 0,\r\n      fileName: null,\r\n      formats: ['xls', 'xlsx', 'csv', 'txt'],\r\n      cellAutoWidth: true,\r\n      selectedFormat: 'xlsx',\r\n      tipoExportacion: 0,\r\n      //fin variables para exportar excel\r\n      //variables para filtrar fechas\r\n      fechaSelect: null,\r\n      configdateTimePicker: {\r\n        enableTime: true,\r\n        dateFormat: 'Y-m-d'\r\n      },\r\n      flatpickrOptions: {\r\n        locale: 'es',\r\n        // Otras opciones de configuración...\r\n      },\r\n      //tipoFecha => 0 = fecha envio; 1 = fecha entrega\r\n      tipoFecha:0,\r\n      titleFecha:'Fecha envio',\r\n      //fin variables para filtrar fechas\r\n      //variables para anios anteriores\r\n      arregloAniosAnteriores:[],\r\n      aniosAnteriorSelect:'',\r\n      anioEmpieza:'',\r\n      //fin variables para anios anteriores\r\n      //variables bodega//\r\n      tipoBodega:2,\r\n      popupEntregarPedido:false,\r\n      //fin variables bodega\r\n      menuTab:0,\r\n      //variables para solicitar verificacion\r\n      popupVerLiquidacion:false,\r\n      popupCodigosLiquidarse:false,\r\n      //fin variables para solicitar verificacion\r\n      //Apis para empresas\r\n      arrayEmpresas:[],\r\n      empresaSelected: '',\r\n      //fin Apis para empresas\r\n      totalRealContratos:0,\r\n      popupReportes:false,\r\n    }\r\n  },\r\n  created(){\r\n    let me = this\r\n    me.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n    me.id_periodo = me.periodoSelect.idperiodoescolar\r\n    me.nombre_periodo = me.periodoSelect.periodoescolar\r\n  },\r\n  mounted(){\r\n    let me = this;\r\n    me.generateHistorico()\r\n    me.getAniosAnteriores()\r\n    me.anioEmpieza = moment().format('YYYY')\r\n    //user permisos\r\n    if(me.usuario.id_group == 22)                               me.userFacturador       = true\r\n    if(me.usuario.id_group == 23)                               me.userAdminFacturador  = true\r\n    if(me.usuario.id_group  == 27) me.userBodega = true\r\n    //fin user permisos\r\n    //menu bodega\r\n    if(me.userBodega){\r\n      me.filtroBodega()\r\n    }\r\n    //menu\r\n    else{\r\n      let menuSelect = localStorage.menuSelect\r\n      if(menuSelect){\r\n        me.filtro = menuSelect\r\n        setTimeout(function(){  me.filtroTipo() }, 1000);\r\n      }else{\r\n        setTimeout(function(){  me.filtroTipo() }, 1000);\r\n      }\r\n    }\r\n  },\r\n  props:{\r\n    periodoSelect:{\r\n      type:Object,\r\n      default:{},\r\n    },\r\n    pedidos: {\r\n      type: Array,\r\n      default: []\r\n    },\r\n    userAsesor:{\r\n      type:Boolean,\r\n      default:false,\r\n    },\r\n    userRoot:{\r\n      type:Boolean,\r\n      default:false,\r\n    },\r\n    groupFacturador:{\r\n      type:Boolean,\r\n      default:false,\r\n    },\r\n  },\r\n  watch:{\r\n    periodoSelect(results){\r\n      let me = this;\r\n      me.id_periodo = me.periodoSelect.idperiodoescolar\r\n      me.nombre_periodo = me.periodoSelect.periodoescolar\r\n      me.getTotalVentaRealContratos()\r\n    },\r\n    pedidos(results) {\r\n      let me = this;\r\n      me.tmpPedidos = []\r\n      if(me.userBodega){\r\n        me.filtroBodega()\r\n      }else{\r\n        me.filtroTipo()\r\n      }\r\n    },\r\n  },\r\n  computed:{\r\n    sumaTotal(){\r\n      let me = this;\r\n      let total = me.pedidos.length\r\n      return total\r\n    },\r\n    SumaSinAnticipo(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter(p => (p.estado == 1 || p.estado == 0 ) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && (p.ifanticipo == 0));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaConAnticipoSinAprobar(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1 || p.estado == 0 ) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && (p.ifanticipo == 1) &&  ( (p.ifagregado_anticipo_aprobado == 0) ) );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaConAnticipoAprobados(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && p.ifagregado_anticipo_aprobado == 1 );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaAnulados(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 2 );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //CHEQUES\r\n    SumaEntregaCheques(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 6 || p.historicoEstado == 7) );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaSolicitudesPagares(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 9));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaPagareFisicosEntregados(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 10 || p.historicoEstado == 11));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //FIN CHEQUES\r\n    //GERENCIA\r\n    SumaSolicitudAnticipos(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 2));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaAnticiposGerenciaAprobados(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 3));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaAnticiposGerenciaAnulados(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 4));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //FIN GERENCIA\r\n    SumaContratoSinAnticipo(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado != null)) && p.ifanticipo == 0 );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaContratosConAnticipoAprobados(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado != null)) && p.ifanticipo == 1 );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===TOTAL PENDIENTES=========\r\n    SumaTotalPendientes(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && (p.ifanticipo == 1 || p.ifanticipo == 0) &&  ( (p.ifagregado_anticipo_aprobado == 0) ) );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN TOTAL PENDIENTES=====\r\n    //===TOTAL GERENCIA=========\r\n    SumaTotalGerencia(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 2 || p.ifagregado_anticipo_aprobado == 3 || p.ifagregado_anticipo_aprobado == 4));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN TOTAL GERENCIA=====\r\n    //===TOTAL CONTRATOS========\r\n    SumaTotalContratos(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado != null)) && (p.ifanticipo == 1 || p.ifanticipo == 0 ) );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN TOTAL CONTRATOS====\r\n    //===TOTAL CHEQUES==========\r\n    SumaTotalCheques(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.historicoEstado == 6 || p.historicoEstado == 7 || p.historicoEstado == 9 || p.historicoEstado == 10 || p.historicoEstado == 11));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN TOTAL CHEQUES======\r\n    //===ALCANCE================\r\n    //ALCANCES PENDIENTES\r\n    SumaAlcancePendientes(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.contadorAlcanceAbierto > 0));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //ALCANCE CERRADOS O APROBADOS\r\n    SumaAlcanceCerrados(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.contadorAlcanceCerrado > 0));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN ALCANCE============\r\n    //===TIPOS DE VENTA=========\r\n    //venta directa\r\n    SumaVentaDirecta(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.tipo_venta == 1 && p.estado == 1  && (( p.contrato_generado != null)));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaVentaLista(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.tipo_venta == 2 && p.estado == 1  && (( p.contrato_generado != null)));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN TIPOS DE VENTA=====\r\n    //========================FILTROS PARA BODEGA============================\r\n    SumarPedidosNoentregadosSinContrato() {\r\n      let me = this;\r\n      let datos = me.pedidos.filter(p => (p.estado_entrega == 0) && p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\"));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumarPedidosNoentregadosConContrato() {\r\n      let me = this;\r\n      let datos = me.pedidos.filter(p => (p.estado_entrega == 0) && p.estado == 1 && ((p.contrato_generado != null)));      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaPedidosEntregados() {\r\n      let me = this;\r\n      let datos = me.pedidos.filter(p => (p.estado_entrega == 2) && p.estado == 1);\r\n      let resultado = datos.length\r\n      return resultado\r\n    },\r\n    //========================FIN FILTROS PARA BODEGA========================\r\n  },\r\n  methods:{\r\n    getAniosAnteriores(){\r\n      let me = this;\r\n      me.arregloAniosAnteriores = []\r\n      // Obtener la fecha actual\r\n      var fechaActual = new Date();\r\n      // Obtener el año actual\r\n      var añoActual = fechaActual.getFullYear();\r\n      // Array para almacenar los últimos 5 años anteriores\r\n      var ultimosCincoAñosAnteriores = [];\r\n      // Array para almacenar los próximos 10 años\r\n      var proximosCincoAños = [];\r\n      // Calcular los últimos 5 años anteriores\r\n      for (var i = 1; i <= 5; i++) {\r\n        ultimosCincoAñosAnteriores.push(añoActual - i);\r\n      }\r\n      // Calcular los próximos 10 años\r\n      for (var i = 0; i <= 10; i++) {\r\n        proximosCincoAños.push(añoActual + i);\r\n      }\r\n      var todosLosAños          =  [...ultimosCincoAñosAnteriores,...proximosCincoAños]\r\n      // Ordenar el array en orden ascendente\r\n      todosLosAños.sort(function(a, b) {\r\n        return a - b;\r\n      });\r\n      // Imprimir los próximos 5 años\r\n      me.arregloAniosAnteriores =  todosLosAños\r\n    },\r\n    llenarPedidos(){\r\n      let me = this;\r\n      this.$http.get(this.$server_url+'llenarInformacionContrato')\r\n      .then(res => {\r\n        console.log(res.data)\r\n        me.$vs.notify({\r\n        text:'Se guardo correctamente',\r\n        color:'success',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n      })\r\n    },\r\n    changeContratoManual(e){\r\n      let me = this\r\n      me.popupGenerarContratoManual = false;\r\n      me.$emit('changeRecarge',true)\r\n      // me.getPedidos()\r\n    },\r\n    generateHistorico(){\r\n      let me = this;\r\n      this.$http.get(this.$server_url+'pedidosConAnticipo')\r\n      .then(res => {\r\n      })\r\n    },\r\n    filtroTipo(){\r\n      let me = this;\r\n      me.estadoMenu()\r\n      me.tmpPedidos = []\r\n      me.tmparregloFiltroFecha = []\r\n      me.fechaSelect  = \"\"\r\n      //para ver todos\r\n      if(me.filtro == 100){\r\n        let total = me.pedidos\r\n        me.tmpPedidos = total\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los pedidos sin anticipo\r\n      if(me.filtro == 1){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1 || p.estado == 0) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && ( p.ifanticipo == 0 ));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los pedidos con anticipo(sin aprobar)\r\n      if(me.filtro == 2){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1 || p.estado == 0) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && (p.ifanticipo == 1) &&  ( (p.ifagregado_anticipo_aprobado == 0) ) );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //======Todos pendientes==========\r\n      if(me.filtro == 13){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && (p.ifanticipo == 1 || p.ifanticipo == 0) &&  ( (p.ifagregado_anticipo_aprobado == 0) ) );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //======Fin todos pendientes======\r\n      //para ver los pedidos con anticipo(aprobados)\r\n      if(me.filtro == 3){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && p.ifagregado_anticipo_aprobado == 1 );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los solicitudes de anticipos a gerencia\r\n      if(me.filtro == 4){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 2));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los anticipos solicitados al gerente aprobados\r\n      if(me.filtro == 5){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 3));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los anticipos solicitados al gerente anulados\r\n      if(me.filtro == 6){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 4));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los contratos con anticipos\r\n      if(me.filtro == 7){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado != null)) && p.ifanticipo == 1 );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los contratos sin anticipos\r\n      if(me.filtro == 8){\r\n        let datos       = me.pedidos.filter(p => (p.estado == 1) && (( p.contrato_generado != null)) && (p.ifanticipo == 0 || p.ifanticipo == null) );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver las entregas para el asesor(cheques generados)\r\n      if(me.filtro == 9){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 6 || p.historicoEstado == 7) );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver las posibles entregas de pagares\r\n      if(me.filtro == 10){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 9));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los pagares entregados fisicos\r\n      if(me.filtro == 11){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 10 || p.historicoEstado == 11));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //===TOTAL GERENCIA======\r\n      if(me.filtro == 14){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 2 || p.ifagregado_anticipo_aprobado == 3 || p.ifagregado_anticipo_aprobado == 4));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //===TOTAL CONTRATOS=====\r\n      if(me.filtro == 15){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado != null)) );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //==FIN TOTAL CONTRATOS===\r\n      //===TOTAL CHEQUES========\r\n      if(me.filtro == 16){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.historicoEstado == 6 || p.historicoEstado == 7 || p.historicoEstado == 9 || p.historicoEstado == 10 || p.historicoEstado == 11));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //===ALCANCE=============\r\n      //Alcance pendientes\r\n      if(me.filtro == 17){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.contadorAlcanceAbierto > 0));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //Alcance cerrado\r\n      if(me.filtro == 18){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.contadorAlcanceCerrado > 0));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //===FIN ALCACANCE=======\r\n      //para ver los pedidos anulados\r\n      if(me.filtro == 19){\r\n        let datos       = me.pedidos.filter( p => p.estado == 2);\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //TIPO VENTA=============\r\n      //Venta directa\r\n      if(me.filtro == 20){\r\n        let datos       = me.pedidos.filter( p => p.tipo_venta == 1 && p.estado == 1  && (( p.contrato_generado != null)));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n        //Venta Lista\r\n        if(me.filtro == 21){\r\n        let datos       = me.pedidos.filter( p => p.tipo_venta == 2 && p.estado == 1  && (( p.contrato_generado != null)));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //==FIN TOTAL CHEQUES\r\n      else{\r\n        let total = me.pedidos\r\n        me.tmpPedidos = total\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n    },\r\n    filtroBodega(){\r\n      let me = this;\r\n      me.tmpPedidos = []\r\n      //para ver los pedidos pendientes\r\n      if (me.tipoBodega == 0) {\r\n        //bodega mostrar los pedidos pendientes de bodega\r\n        let datos = me.pedidos\r\n        me.tmpPedidos = datos\r\n        return\r\n      }\r\n      //para ver los pedidos sin contratos\r\n      if (me.tipoBodega == 1) {\r\n        let datos = me.pedidos.filter(p => (p.estado_entrega == 0) && p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\"));\r\n        me.tmpPedidos = datos\r\n        return\r\n      }\r\n       //para ver los pedidos con contratos  sin entrega\r\n       if (me.tipoBodega == 2) {\r\n        let datos = me.pedidos.filter(p => (p.estado_entrega == 0) && p.estado == 1 && ((p.contrato_generado != null)));\r\n        me.tmpPedidos = datos\r\n        return\r\n      }\r\n      //para ver los pedidos entregados por bodega\r\n      if (me.tipoBodega == 3) {\r\n        let datos = me.pedidos.filter(p => (p.estado_entrega == 2) && p.estado == 1);\r\n        me.tmpPedidos = datos\r\n        return\r\n      }\r\n    },\r\n    estadoMenu(){\r\n      let me = this;\r\n      localStorage.setItem('menuSelect',me.filtro)\r\n      var divs = document.querySelectorAll(\".submenutitle\");\r\n      for (var i = 0; i < divs.length; i++) {\r\n        divs[i].classList.remove(\"active\");\r\n      }\r\n      const container = document.querySelector(\".menu\"+me.filtro);\r\n      container.classList.add(\"active\");\r\n    },\r\n    ver_pedido(item){\r\n      let me = this\r\n      this.$store.dispatch('setPedido',item)\r\n      localStorage.setItem(\"id_periodo_selected\", this.id_periodo)\r\n      localStorage.setItem(\"nombre_periodo_selected\", this.nombre_periodo)\r\n      localStorage.setItem(\"contrato_generado\", item.contrato_generado)\r\n      localStorage.setItem(\"pedido_desde_admin\", 'activo')\r\n      me.$emit('showPedido',1)\r\n      // this.$router.push('/pedidos/administrador/'+item.id_pedido)\r\n    },\r\n    SolicitarVerificacion(tr){\r\n      let me = this;\r\n      if(tr.id_pedido == null || tr.id_pedido == \"\"){\r\n        me.$vs.notify({\r\n        text:'Su contrato no tiene pedido en plataforma',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      me.popupVerLiquidacion = true;\r\n    },\r\n    anular_pedido(item){\r\n      let me = this\r\n      me.id_pedido = item.id_pedido\r\n      me.$vs.dialog({\r\n        type: 'confirm',\r\n        color: 'danger',\r\n        title: `Confirmar`,\r\n        text: '¿Está seguro en eliminar este pedido?',\r\n        acceptText: 'Aceptar',\r\n        cancelText: 'Cancelar',\r\n        accept: me.confirm_anular_pedido\r\n      })\r\n    },\r\n    confirm_anular_pedido(item){\r\n      let me = this\r\n      me.$vs.loading();\r\n      this.$http.get(this.$server_url+'anular_pedido_asesor/'+me.id_pedido+'/'+me.usuario.idusuario+'/'+me.pedido.contrato_generado)\r\n      .then(res => {\r\n        me.$vs.loading.close();\r\n        if(res.data.status == 0){\r\n          me.$vs.notify({\r\n            text: res.data.message,\r\n            color: 'danger',\r\n            iconPack: 'feather',\r\n            icon: 'icon-alert-triangle'\r\n          })\r\n          return\r\n        }\r\n        me.$vs.notify({\r\n          text: 'Se anulo correctamente',\r\n          color: 'success',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle'\r\n        })\r\n        me.$emit('changeRecarge',true)\r\n        // me.getPedidos()\r\n      })\r\n      .catch(function (error) {\r\n        me.$vs.notify({\r\n          text: 'No se pudo guardar',\r\n          color: 'danger',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle'\r\n        })\r\n        me.$vs.loading.close();\r\n      })\r\n    },\r\n    changeEstadoHistorico(estado){\r\n      let me = this\r\n      let formData = new FormData();\r\n      formData.append('id_pedido',  me.pedido.id_pedido);\r\n      formData.append('estado',     estado);\r\n      if(estado == 7 ) formData.append('campo','fecha_facturador_recibe_cheque')\r\n      if(estado == 8 ) formData.append('campo','fecha_envio_cheque_for_asesor')\r\n      if(estado == 10 ) formData.append('campo','fecha_que_recibe_orden_firmada')\r\n      me.$vs.loading();\r\n      this.$http.post(this.$server_url+'cambiarEstadoHistorico', formData)\r\n      .then(function (res) {\r\n        me.$vs.loading.close();\r\n        me.$emit('changeRecarge',true)\r\n        // me.getPedidos()\r\n        me.pedido = {}\r\n        me.popupEnviarCheque = false\r\n        me.popupRecibirPagare = false\r\n        me.popupRecibiCheque  = false\r\n        me.$vs.notify({\r\n          text: 'Se registro correctamente',\r\n          color: 'primary',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle'\r\n        })\r\n      })\r\n      .catch(function (error) {  me.$vs.loading.close(); })\r\n    },\r\n    //====METODOS PARA EMITIR LOS ARHIVOS\r\n    changeHandle(e){\r\n      let me = this;\r\n      me.mostrarReporte         = false\r\n      me.popupCarga             = false\r\n      me.mostrarReporteC        = false\r\n      me.mostrarReporteConvenio = false\r\n      me.mostrarPagareAsesor    = false\r\n    },\r\n    acceptAlert(){\r\n      let me = this\r\n      if(me.beneficiario == \"\" || me.beneficiario == null || me.beneficiario == undefined){\r\n        me.$vs.notify({\r\n        text:'Seleccione un beneficiario por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        me.activePrompt = true\r\n        return\r\n      }\r\n      //si es export pagare obligo a pedir un año\r\n      if(me.tipo == 4 || me.tipo == 3){\r\n        if(me.aniosAnteriorSelect == null || me.aniosAnteriorSelect == \"\" || me.aniosAnteriorSelect == undefined){\r\n          me.$vs.notify({\r\n          text:'Seleccione un año final a calcular por favor',\r\n          color:'warning',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          return\r\n        }\r\n        //EMPRESA\r\n        if(me.empresaSelected == \"\" || me.empresaSelected == null || me.empresaSelected == undefined){\r\n          me.$vs.notify({\r\n          text:'Seleccione una empresa por favor',\r\n          color:'warning',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          me.activePrompt = true\r\n          return\r\n        }\r\n      }\r\n      //si es convenio obligatorio seleccionar el año que empieza el convenio\r\n      if(me.tipo == 3){\r\n        if(me.anioEmpieza == null || me.anioEmpieza == \"\" || me.anioEmpieza == undefined){\r\n          me.$vs.notify({\r\n          text:'Seleccione el año que comienza el convenio por favor',\r\n          color:'warning',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          return\r\n        }\r\n      }\r\n      me.id_beneficiario_pedido = me.beneficiario.id_beneficiario_pedido\r\n      me.popupCarga                              = true\r\n      if(me.tipo == 1) me.mostrarReporte         = true\r\n      if(me.tipo == 2) me.mostrarReporteC        = true\r\n      if(me.tipo == 3) me.mostrarReporteConvenio = true\r\n      if(me.tipo == 4) me.mostrarPagareAsesor    = true\r\n    },\r\n    chooseBeneficiarioPedido(tr,tipo){\r\n      let me            = this;\r\n      me.getBeneficiarios(tr.id_pedido)\r\n      me.getEmpresas()\r\n      me.tipo           = tipo\r\n      me.contrato       = tr.contrato_generado\r\n      me.activePrompt   = true\r\n    },\r\n    generarReportePdfContrato(tr,tipo){\r\n      let me = this;\r\n      if(tr.contrato_generado == \"null\" || tr.contrato_generado == null || tr.contrato_generado == \"\" || tr.contrato_generado == undefined){\r\n        me.$vs.notify({\r\n          text: \"No se puede visualizar el reporte del contrato porque no tiene código de contrato\",\r\n          color: 'warning',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle',\r\n          time:7000\r\n        })\r\n        return\r\n      }\r\n      me.getBeneficiarios(tr.id_pedido)\r\n      me.tipo             = tipo\r\n      me.activePrompt     = true\r\n      me.contrato         = tr.contrato_generado\r\n    },\r\n    getBeneficiarios(pedido){\r\n      let me = this\r\n      me.arregloBeneficiarios = []\r\n      me.beneficiario         = ''\r\n      this.$http.get(this.$server_url+'get_beneficiarios_pedidos/'+pedido)\r\n      .then(res => {\r\n        me.arregloBeneficiarios = res.data\r\n      })\r\n    },\r\n    getEmpresas(){\r\n      let me = this\r\n      me.arrayEmpresas   = []\r\n      me.empresaSelected = ''\r\n      this.$http.get(this.$server_url+'empresa/')\r\n      .then(res => {\r\n        me.arrayEmpresas = res.data\r\n      })\r\n    },\r\n    close(){\r\n      this.$vs.notify({\r\n        color:'danger',\r\n        title:'Mensaje',\r\n        text:'Has cancelado la generación del reporte!'\r\n      })\r\n    },\r\n    //====FIN METODOS PARA EMITIR ARCHIVOS\r\n    //metodos para alcance\r\n    verAlcance(tr){\r\n      let me = this;\r\n      this.$store.dispatch('setPedido',tr)\r\n      me.$emit('showPedido',2)\r\n    },\r\n    //====METODOS PARA VERIFICACIONES========\r\n    VerVerificaciones(tr){\r\n      let me = this\r\n      if(tr.id_pedido == null || tr.id_pedido == \"\"){\r\n        me.$vs.notify({\r\n        text:'Su contrato no tiene pedido en plataforma',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      me.menu = 2\r\n    },\r\n    openConfirmLiquidar(){\r\n      let me = this\r\n      this.$vs.dialog({\r\n        type:'confirm',\r\n        color: 'danger',\r\n        title: `Confirmar`,\r\n        acceptText:'Si, deseo realizar la liquidación',\r\n        text: `Estás seguro de liquidar el contrato ${ me.pedido.contrato_generado }?`,\r\n        accept:this.LiquidarContrato\r\n      })\r\n    },\r\n    LiquidarContrato(){\r\n      let me  =this;\r\n      me.$vs.loading()\r\n      this.$http.get(this.$server_url+'nliquidacion/liquidar/'+me.pedido.contrato_generado)\r\n        .then(function (res) {\r\n          me.$vs.loading.close()\r\n          if(res.data.status == '0'){\r\n            me.$vs.notify({\r\n            text:res.data.message,\r\n            color:'danger',\r\n            iconPack: 'feather',\r\n            icon:'icon-check'})\r\n            return\r\n          }else{\r\n            me.$emit('changeRecarge',true)\r\n            me.$vs.notify({\r\n            text:'Se realizo la liquidación correctamente',\r\n            color:'success',\r\n            iconPack: 'feather',\r\n            icon:'icon-check'})\r\n          }\r\n        })\r\n        .catch(function (error) {\r\n          me.$vs.loading.close()\r\n          console.log(error + ' error');\r\n        })\r\n    },\r\n    /**\r\n     * Calcula el total de la venta real de contratos.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    getTotalVentaRealContratos() {\r\n      let me = this;\r\n      if(me.usuario.id_group == 11){\r\n        me.totalRealContratos = 0\r\n        me.$http.get(this.$server_url+`pedigo_Pagos?getVentaRealXAsesor=1&idAsesor=${me.usuario.idusuario}&idPeriodo=${me.id_periodo}`)\r\n        .then(function (res) {\r\n          let datos = res.data\r\n          if(datos.length>0){\r\n            datos.forEach(element => {\r\n              me.totalRealContratos += element.TotalVentaReal\r\n            });\r\n          }\r\n        })\r\n      }\r\n    },\r\n    //====FIN METODOS PARA VERIFICACIONES====\r\n    //====METODOS PARA EXCEL=====\r\n    //para limipiar los campos del excel\r\n    clearFields() {\r\n      this.fileName = ''\r\n      this.cellAutoWidth = true\r\n      this.selectedFormat = 'xls'\r\n    },\r\n    //metodo par descargar el excel\r\n    exportToExcel() {\r\n      let me = this\r\n      let predatos = []\r\n      predatos    = me.codigoSelected\r\n      //aumentar una propiedad llamada comisionAsesor en el array de predatos con un map\r\n      predatos.map(function(item){\r\n        let TotalVentaReal = 0\r\n        let valorDescuento = 0\r\n        let ven_neta       = 0\r\n        let waitTotalVentaReal = 0\r\n        //venta real\r\n        waitTotalVentaReal  = item.TotalVentaReal\r\n        console.log(\"uno\",waitTotalVentaReal)\r\n        console.log(\"dos\",waitTotalVentaReal.toFixed(2))\r\n        if(item.TotalVentaReal == null || item.TotalVentaReal == \"\"){ item.TotalVentaReal = 0 ;  }\r\n        else                                            { TotalVentaReal = item.TotalVentaReal.toFixed(2); }\r\n        //valorDescuento\r\n        if(item.valorDescuento == null || item.valorDescuento == \"\"){ item.valorDescuento = 0 ;  }\r\n        else                                            { valorDescuento = item.valorDescuento.toFixed(2); }\r\n        //ven_neta\r\n        if(item.ven_neta == null || item.ven_neta == \"\"){ item.ven_neta = 0 ;  }\r\n        else                                            { ven_neta = item.ven_neta.toFixed(2); }\r\n        let prevalores   = 0\r\n        //venta neta\r\n        if(item.ven_neta == null || item.ven_neta == \"\"){ item.venta = 0 ;  }\r\n        else                                            { prevalores = (item.ven_neta * 0.02).toFixed(2); }\r\n        item.comisionAsesor = prevalores\r\n        item.TotalVentaReal = TotalVentaReal\r\n        item.valorDescuento = valorDescuento\r\n        item.ven_neta       = ven_neta\r\n      })\r\n      //array final\r\n      console.log(\"uwu\",predatos)\r\n      let headerTitle = []; let headerVal = [];\r\n      //para exportar los pedidos\r\n      if(me.tipoExportacion == 0){\r\n        headerTitle = [\r\n          'Contrato',\r\n          'Tipo de venta' ,\r\n          'Asesor',\r\n          'Cédula asesor',\r\n          'Institución',\r\n          'Ciudad',\r\n          'Fecha envio',\r\n          'Fecha entrega',\r\n          'Total unidades',\r\n          'Venta bruta',\r\n          'Venta Real',\r\n          'Comisión',\r\n          'Anticipo aprobado',\r\n          'Estado'\r\n        ];\r\n        headerVal = [\r\n          'contrato_generado',\r\n          'tipo_venta_descr',\r\n          'responsable',\r\n          'cedula',\r\n          'nombreInstitucion',\r\n          'nombre_ciudad',\r\n          'fecha_envio',\r\n          'fecha_entrega',\r\n          'total_unidades',\r\n          'total_venta',\r\n          'TotalVentaReal',\r\n          'descuento',\r\n          'anticipo_aprobado',\r\n          'estadoPedido'\r\n        ];\r\n      }\r\n      //para exportar el reporte de venta\r\n      if(me.tipoExportacion == 1){\r\n        headerTitle = [\r\n          'CONTRATO',\r\n          'ASESOR',\r\n          'TIPO DE VENTA' ,\r\n          'ESTADO' ,\r\n          'CATEGORIA',\r\n          'ESTABLECIMIENTO',\r\n          'DEUDA ANTERIOR',\r\n          'DEUDA PRÓXIMA',\r\n          'VENTAS BRUTAS',\r\n          'COMISIÓN',\r\n          'VALOR DE ESCUELA',\r\n          'VENTAS NETAS',\r\n          'COMISION ASESOR 2%',\r\n          'CIUDAD',\r\n          'PERÍODO'\r\n        ];\r\n        headerVal = [\r\n          'contrato_generado',\r\n          'responsable',\r\n          'tipo_venta_descr',\r\n          '',\r\n          'tipo_descripcion',\r\n          'nombreInstitucion',\r\n          'deuda',\r\n          'totalDeudaProxima',\r\n          'TotalVentaReal',\r\n          'descuento',\r\n          'valorDescuento',\r\n          'ven_neta',\r\n          'comisionAsesor',\r\n          'nombre_ciudad',\r\n          'periodo'\r\n        ];\r\n      }\r\n      let codigoSelectedMayus = this.codigoSelected\r\n      for (var i = 0; i < codigoSelectedMayus.length; i++) {\r\n        for (var key in codigoSelectedMayus[i]) {\r\n          if (typeof codigoSelectedMayus[i][key] == \"string\") {\r\n              codigoSelectedMayus[i][key] = codigoSelectedMayus[i][key].toUpperCase();\r\n          }\r\n        }\r\n      }\r\n      import('@/vendor/Export2Excel').then(excel => {\r\n        const list = codigoSelectedMayus\r\n        const data = this.formatJson(headerVal, list)\r\n        excel.export_json_to_excel({\r\n            header: headerTitle,\r\n            data,\r\n            filename: this.fileName,\r\n            autoWidth: this.cellAutoWidth,\r\n            bookType: this.selectedFormat\r\n        })\r\n        this.clearFields()\r\n        this.guardarActivo = '';\r\n        this.generarActivo = ' ';\r\n        this.textAlertCant = '';\r\n        this.cantidad = '';\r\n        this.codigoSelected = [];\r\n        })\r\n    },\r\n    formatJson(filterVal, jsonData) {\r\n      return jsonData.map(v => filterVal.map(j => {\r\n        return v[j]\r\n      }))\r\n    },\r\n    //==FIN METODOS PARA EXPORTAR EXCEL=====\r\n    tryExport(){\r\n      let me = this\r\n      if(me.codigoSelected.length == 0){\r\n        me.$vs.notify({\r\n        text:'Debe seleccionar filas de la tabla para exportar por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      me.popupExport=true\r\n    },\r\n    //==METODOS PARA FILTRO FECHAS===\r\n    filtrarFechas(){\r\n      let me = this;\r\n      me.tmpPedidos = []\r\n      if(me.fechaSelect == null || me.fechaSelect == \"\" || me.fechaSelect == undefined){\r\n        me.tmpPedidos = me.tmparregloFiltroFecha\r\n        return\r\n      }\r\n      //fecha envio\r\n      if(me.tipoFecha == 0){\r\n        me.tmpPedidos = me.tmparregloFiltroFecha.filter(p => p.f_fecha_envio == me.fechaSelect)\r\n        return\r\n      }\r\n      //fecha entrega\r\n      if(me.tipoFecha == 1){\r\n        me.tmpPedidos = me.tmparregloFiltroFecha.filter(p => p.f_fecha_entrega == me.fechaSelect)\r\n        return\r\n      }\r\n    },\r\n    //===METODOS NOTIFICAR REVISION==\r\n    notificarPedido(notificados){\r\n      let me = this;\r\n      let formData = new FormData();\r\n      formData.append('changeRevisonNotificacion','yes')\r\n      formData.append('id_pedido',                me.pedido.id_pedido);\r\n      formData.append('notificados',              notificados);\r\n      me.$vs.loading()\r\n      this.$http.post(this.$server_url+'actualizarPedido', formData)\r\n      .then(function (res) {\r\n        me.$vs.loading.close()\r\n        me.$vs.notify({\r\n          text: res.data.message,\r\n          color: 'primary',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle'\r\n        })\r\n        me.recargarPedidos()\r\n      })\r\n      .catch(function (error) {  me.$vs.loading.close() })\r\n    },\r\n    //==FIN METODOS NOTIFICAR REVISION===\r\n    recargarPedidos(){\r\n      let me = this;\r\n      me.$emit('changeRecarge',true)\r\n      me.popupVerLiquidacion = false\r\n      me.popupEntregarPedido = false\r\n    },\r\n    ///====METODOS ASESOR====\r\n    //METODOS PARA GENERAR UN NUEVO PEDIDO A PARTIR DE UN PEDIDO ANULADO\r\n    ConfirmgenerarNuevoPedido(tr){\r\n    let me = this;\r\n    this.$vs.dialog({\r\n      type:'confirm',\r\n      color: 'danger',\r\n      title: `Confirmar`,\r\n      acceptText:'Aceptar',\r\n      cancelText:'Cancelar',\r\n      text: 'Estas seguro de generar un nuevo pedido con los mismos datos',\r\n      accept:this.generarNuevoPedido\r\n    })\r\n  },\r\n  generarNuevoPedido(){\r\n    let me = this;\r\n    let formData = new FormData();\r\n    formData.append('id_pedido',            0);\r\n    formData.append('pedidoAnterior',       me.pedido.id_pedido);\r\n    formData.append('tipo_venta',           me.pedido.tipo_venta);\r\n    formData.append('tipo_venta_descr',     me.pedido.tipo_venta_descr);\r\n    formData.append('fecha_envio',          me.pedido.fecha_envio);\r\n    formData.append('fecha_entrega',        me.pedido.fecha_entrega);\r\n    formData.append('institucion',          me.pedido.id_institucion);\r\n    formData.append('periodo',              me.pedido.id_periodo);\r\n    formData.append('descuento',            me.pedido.descuento);\r\n    formData.append('anticipo',             me.pedido.anticipo);\r\n    formData.append('id_asesor',            me.pedido.id_asesor);\r\n    formData.append('observacion',          me.pedido.observacion);\r\n    if(me.pedido.imagen == 'undefined'){\r\n      formData.append('imagen',             \"\");\r\n    }else{\r\n      formData.append('imagen',               me.pedido.imagen);\r\n    }\r\n    formData.append('ifanticipo',           me.pedido.ifanticipo);\r\n    formData.append('convenio_anios',       me.pedido.convenio_anios)\r\n    formData.append('anticipo_aprobado',    0)\r\n    formData.append('ifagregado_anticipo_aprobado', 0)\r\n    formData.append('id_responsable',       me.pedido.id_responsable)\r\n    formData.append('generarNuevo',         'yes')\r\n    me.$vs.loading()\r\n    this.$http.post(this.$server_url+'pedidos',formData)\r\n    .then(res => {\r\n    me.$vs.loading.close()\r\n    if(res.data.status == 0){\r\n      me.$vs.notify({\r\n      text:res.data.message,\r\n      color:'danger',\r\n      iconPack: 'feather',\r\n      icon:'icon-check'})\r\n      return\r\n    }\r\n    me.$vs.notify({\r\n      text:'Se genero un nuevo pedido correctamente',\r\n      color:'success',\r\n      iconPack: 'feather',\r\n      icon:'icon-check'})\r\n    })\r\n    me.recargarPedidos()\r\n  },\r\n  filtrarDecimal2(numero){\r\n    let me = this\r\n    //o o null o si no es numero\r\n    if(numero == 0 || numero == null || isNaN(numero)){\r\n        return numero\r\n    }else{\r\n      var numeroRedondeado = numero;\r\n      // Reemplazar el punto decimal con una coma\r\n      var numeroConComa = numeroRedondeado.replace('.', ',');\r\n      return numeroConComa;\r\n    }\r\n  },\r\n  }\r\n}\r\n",{"version":3,"sources":["listado_pedidos2.vue"],"names":[],"mappings":";AAgmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"listado_pedidos2.vue","sourceRoot":"src/views/pedidos","sourcesContent":["<template>\r\n  <div>\r\n    <!--MOSTRAR VERIFICACIONES; TRAZABILIDAD-->\r\n    <!-- <div v-if=\"menu == 2\">\r\n      <br>\r\n      <vs-button color=\"primary\" class=\"ml-4\" type=\"border\" @click=\"menu = 1;\">← Regresar</vs-button>\r\n      <vs-tabs alignment=\"fixed\">\r\n        <vs-tab label=\"Verificaciones\"  @click=\"menuTab=0\">\r\n            <div>\r\n              <historicoCodigosNuevoVue\r\n              :sendPedido=\"pedido\"\r\n              class=\"mt-2\"\r\n              :contratoPedido=\"pedido.contrato_generado\"\r\n              :desdePedido=\"1\"\r\n              />\r\n            </div>\r\n        </vs-tab>\r\n        <vs-tab label=\"Trazabilidad\"  @click=\"menuTab=1\">\r\n            <div>\r\n              <VerificacionTrazabilidadVue :contratoPedido=\"pedido.contrato_generado\"/>\r\n            </div>\r\n        </vs-tab>\r\n        <vs-tab label=\"Pagos\" @click=\"menuTab=2\">\r\n          <div v-if=\"menuTab == 2\">\r\n            <ScreenPagosVue :contrato=\"pedido.contrato_generado\" :sendPedido=\"pedido\"/>\r\n          </div>\r\n      </vs-tab>\r\n      </vs-tabs>\r\n    </div> -->\r\n    <!--LISTADO PEDIDOS-->\r\n    <div v-if=\"menu == 1\">\r\n      <!--MENU OPCIONES-->\r\n      <vs-button color=\"primary\" v-if=\"activeMenu == false\" @click=\"activeMenu = true;\" type=\"line\"><ion-icon name=\"grid-outline\"></ion-icon> Mostrar menú</vs-button>\r\n      <div class=\"vx-row\" v-if=\"activeMenu\">\r\n        <vx-card class=\"fade-in vx-col w-full sm:w-full md:w-full lg:w-full xl:w-full mb-6\"\r\n        >\r\n          <!--DIFERENTE DE BODEGA-->\r\n          <div v-if=\"!userBodega\">\r\n            <div class=\"header-sidebar\">\r\n              <h4>\r\n                <div>\r\n                  <span style=\"opacity:0.8;\" class=\"text-primary\"><ion-icon name=\"apps-outline\" style=\"position: relative;top:2px;\"></ion-icon> Menú de opciones</span>\r\n                  <!-- <vs-button size=\"small\" v-if=\"userFacturador\" class=\"ml-2\" @click=\"getPedidos()\" style=\"margin-top: -10px;\" type=\"relief\">Recargar pedidos</vs-button> -->\r\n                  <vs-button size=\"small\" v-if=\"userRoot\" class=\"ml-2\" @click=\"llenarPedidos()\" style=\"margin-top: -10px;\" type=\"relief\">llenar información en temporadas</vs-button>\r\n                  <vs-button size=\"small\" v-if=\"userFacturador\" class=\"ml-2\" @click=\"$emit('changeRecarge',true)\" style=\"margin-top: -10px;\" type=\"relief\">Recargar pedidos</vs-button>\r\n                </div>\r\n                <vs-button color=\"primary\" icon=\"close\" @click=\"activeMenu = false;\" type=\"flat\"></vs-button>\r\n              </h4>\r\n            </div>\r\n            <vs-divider></vs-divider>\r\n            <!--Opciones-->\r\n            <div class=\"vx-row\">\r\n              <!--PENDIENTES-->\r\n              <div class=\"vx-col w-full sm:w-full md:w-1/2 lg:w-1/5 xl:w-1/5 mb-6\">\r\n                <span class=\"menutitle\"><ion-icon name=\"cash-outline\"></ion-icon> Pendientes <small style=\"font-size:11px;\">(Sin contratos)</small></span>\r\n                <div class=\"submenu\">\r\n                  <span class=\"submenutitle menu1\"  v-if=\"userAdminFacturador || userRoot || userFacturador || userAsesor\" @click=\"filtro = 1;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Sin anticipos: <b>{{ SumaSinAnticipo }}</b></span>\r\n                  <span class=\"submenutitle menu2\"  v-if=\"userAdminFacturador || userRoot || userAsesor\"                   @click=\"filtro = 2;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Con anticipo (sin aprobar): <b>{{ SumaConAnticipoSinAprobar }}</b></span>\r\n                  <span class=\"submenutitle menu13\" v-if=\"userAdminFacturador || userRoot\"                   @click=\"filtro = 13;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Total: <b>{{ SumaTotalPendientes }}</b></span>\r\n                </div>\r\n              </div>\r\n              <!--APROBADOS-->\r\n              <div class=\"vx-col w-full sm:w-full md:w-1/2 lg:w-1/5 xl:w-1/5 mb-6\" v-if=\"userAdminFacturador || userRoot || userFacturador || userAsesor\">\r\n                <span class=\"menutitle\"><ion-icon name=\"cash-outline\"></ion-icon> Aprobados <small style=\"font-size:11px;\">(Sin contratos)</small></span>\r\n                <div class=\"submenu\">\r\n                  <span class=\"submenutitle menu3\"  @click=\"filtro = 3;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Con anticipo (aprobado): <b>{{ SumaConAnticipoAprobados }}</b></span>\r\n                </div>\r\n              </div>\r\n              <!--GERENCIA-->\r\n              <div class=\"vx-col w-full sm:w-full md:w-1/2 lg:w-1/5 xl:w-1/5 mb-6\" v-if=\"userAdminFacturador || userRoot || userFacturador\">\r\n                <span class=\"menutitle\"><ion-icon name=\"people-circle-outline\"></ion-icon> Gerencia <small style=\"font-size:11px;\">(Sin contratos)</small></span>\r\n                <div class=\"submenu\">\r\n                  <span class=\"submenutitle menu4\"  v-if=\"userAdminFacturador || userRoot\"                   @click=\"filtro = 4;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Solicitud anticipos: <b>{{ SumaSolicitudAnticipos }}</b></span>\r\n                  <span class=\"submenutitle menu5\"  v-if=\"userAdminFacturador || userRoot || userFacturador\" @click=\"filtro = 5;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Anticipos aprobados: <b>{{ SumaAnticiposGerenciaAprobados }}</b></span>\r\n                  <span class=\"submenutitle menu6\"  v-if=\"userAdminFacturador || userRoot\"                   @click=\"filtro = 6;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Anticipos anulados:  <b>{{ SumaAnticiposGerenciaAnulados }}</b></span>\r\n                  <span class=\"submenutitle menu14\" v-if=\"userAdminFacturador || userRoot\"                   @click=\"filtro = 14;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Total:     <b>{{ SumaTotalGerencia }}</b></span>\r\n                </div>\r\n              </div>\r\n              <!--CONTRATOS-->\r\n              <div class=\"vx-col w-full sm:w-full md:w-1/2 lg:w-1/5 xl:w-1/5 mb-6\">\r\n                <span class=\"menutitle\"><ion-icon name=\"albums-outline\"></ion-icon> Contratos</span>\r\n                <div class=\"submenu\">\r\n                  <span class=\"submenutitle menu7\" @click=\"filtro = 7;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Con anticipos: <b>{{ SumaContratosConAnticipoAprobados }}</b></span>\r\n                  <span class=\"submenutitle menu8\" @click=\"filtro = 8;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Sin anticipos: <b>{{ SumaContratoSinAnticipo }}</b></span>\r\n                  <span class=\"submenutitle menu15\" v-if=\"userAdminFacturador || userRoot\"                   @click=\"filtro = 15;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Total: <b>{{ SumaTotalContratos }}</b></span>\r\n                </div>\r\n              </div>\r\n              <!--CHEQUES-->\r\n              <div class=\"vx-col w-full sm:w-full md:w-1/2 lg:w-1/5 xl:w-1/5 mb-6\" v-if=\"userAdminFacturador || userRoot\">\r\n                <span class=\"menutitle\"><ion-icon name=\"wallet-outline\"></ion-icon> Cheques</span>\r\n                <div class=\"submenu\">\r\n                  <span class=\"submenutitle menu9\" @click=\"filtro = 9;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Cheques generados: <b>{{ SumaEntregaCheques }}</b></span>\r\n                  <span class=\"submenutitle menu10\" @click=\"filtro = 10;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Pagaré generados: <b>{{ SumaSolicitudesPagares }}</b></span>\r\n                  <span class=\"submenutitle menu11\" @click=\"filtro = 11;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Pagaré recibidos: <b>{{ SumaPagareFisicosEntregados }}</b></span>\r\n                  <span class=\"submenutitle menu16\" v-if=\"userAdminFacturador || userRoot\"                   @click=\"filtro = 16;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Total: <b>{{ SumaTotalCheques }}</b></span>\r\n                </div>\r\n              </div>\r\n              <!--ALCANCE-->\r\n              <div class=\"vx-col w-full sm:w-full md:w-1/2 lg:w-1/5 xl:w-1/5 mb-6\">\r\n                <span class=\"menutitle\"><ion-icon name=\"wallet-outline\"></ion-icon> Alcance</span>\r\n                <div class=\"submenu\">\r\n                  <span class=\"submenutitle menu17\" @click=\"filtro = 17;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Pendientes: <b>{{ SumaAlcancePendientes }}</b></span>\r\n                  <span class=\"submenutitle menu18\" @click=\"filtro = 18;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Aprobados:  <b>{{ SumaAlcanceCerrados }}</b></span>\r\n                </div>\r\n              </div>\r\n              <!--OTROS-->\r\n              <div class=\"vx-col w-full sm:w-full md:w-1/2 lg:w-1/5 xl:w-1/5 mb-6\">\r\n                <span class=\"menutitle\"><ion-icon name=\"contract-outline\"></ion-icon> Otros</span>\r\n                <div class=\"submenu\">\r\n                  <span class=\"submenutitle menu100 text-warning font-bold\" @click=\"filtro = 100;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Todos: <b>{{ sumaTotal }}</b></span>\r\n                  <span class=\"submenutitle menu19\" @click=\"filtro = 19;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Anulados: <b>{{ SumaAnulados }}</b></span>\r\n                </div>\r\n              </div>\r\n              <!--TIPOS DE VENTAS-->\r\n              <div class=\"vx-col w-full sm:w-full md:w-1/2 lg:w-1/5 xl:w-1/5 mb-6\">\r\n                <span class=\"menutitle\"><ion-icon name=\"contract-outline\"></ion-icon> Tipo de venta <small style=\"font-size:11px;\">(contratos)</small></span>\r\n                <div class=\"submenu\">\r\n                  <span class=\"submenutitle menu20\"  @click=\"filtro = 20;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Venta directa: <b>{{ SumaVentaDirecta }}</b></span>\r\n                  <span class=\"submenutitle menu21\" @click=\"filtro = 21;filtroTipo();estadoMenu();\"><ion-icon name=\"caret-forward-outline\"></ion-icon> Venta lista: <b>{{ SumaVentaLista }}</b></span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <vs-divider>Filtro por:</vs-divider>\r\n            <vs-row>\r\n              <vs-col  vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"6\">\r\n                <ul class=\"flex\">\r\n                  <li>\r\n                    <vs-radio v-model=\"tipoFecha\" @input=\"titleFecha='Fecha envio'\" vs-name=\"radios1tipoFecha\" vs-value=\"0\">Fecha envio</vs-radio>\r\n                  </li>\r\n                  <li>\r\n                    <vs-radio v-model=\"tipoFecha\" class=\"ml-2\" @input=\"titleFecha='Fecha entrega';\" vs-name=\"radios1tipoFecha\" vs-value=\"1\">Fecha Entrega</vs-radio>\r\n                  </li>\r\n                </ul>\r\n              </vs-col>\r\n              <vs-col  vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"6\">\r\n              <flat-pickr :config=\"configdateTimePicker\" v-model=\"fechaSelect\" @input=\"filtrarFechas()\" :placeholder=\"titleFecha\" class=\"m-1\" style=\"display: inline-block;width: 100%;\" />\r\n              <vx-tooltip style=\"display: inline-block;\" text=\"Limpiar filtro\" position=\"top\" color=\"primary\">\r\n                <vs-button v-if=\"fechaSelect\" radius color=\"primary\" type=\"border\" icon-pack=\"feather\" @click=\"fechaSelect='';filtrarFechas()\" icon=\"icon-x\"></vs-button>\r\n              </vx-tooltip>\r\n              </vs-col>\r\n            </vs-row>\r\n          </div>\r\n          <!--BODEGA-->\r\n          <div v-if=\"userBodega\">\r\n            <p>Filtrar por:</p>\r\n            <ul class=\"flex mt-2\">\r\n              <li>\r\n                <vs-radio v-model=\"tipoBodega\" @input=\"filtroBodega();\" class=\"mr-2\" vs-name=\"radios1filterBodega\" vs-value=\"0\">Todos</vs-radio>\r\n              </li>\r\n              <li>\r\n                <vs-radio v-model=\"tipoBodega\" @input=\"filtroBodega();\" class=\"mr-2\" vs-name=\"radios1filterBodega\" vs-value=\"1\"><b>{{ SumarPedidosNoentregadosSinContrato }}</b> Pedidos sin contrato (Sin contrato)</vs-radio>\r\n              </li>\r\n              <li>\r\n                <vs-radio v-model=\"tipoBodega\" @input=\"filtroBodega();\" class=\"mr-2\" vs-name=\"radios1filterBodega\" vs-value=\"2\"><b>{{ SumarPedidosNoentregadosConContrato }}</b> Pedidos sin Entregar (Contratos)</vs-radio>\r\n              </li>\r\n              <li>\r\n                <vs-radio v-model=\"tipoBodega\" @input=\"filtroBodega();\" vs-name=\"radios1filterBodega\" color=\"success\" vs-value=\"3\"><b>{{ SumaPedidosEntregados }}</b> Pedidos Entregados </vs-radio>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n          <!--venta real asesor todos los contratos-->\r\n            <!--TOTAL VENTA BRUTA-->\r\n          <div class=\"flex\">\r\n            <div class=\"p-6 pb-0\" v-if=\"totalRealContratos > 0\">\r\n              <div class=\"flex justify-center\">\r\n                  <span class=\"p-4 inline-flex rounded-full feather-icon select-none relative text-primary mb-4\" style=\"background: rgba(var(--vs-primary),0.15);\">\r\n                    <feather-icon icon=\"ShoppingBagIcon\"  svgClasses=\"h-8 w-7\" class=\"ml-1\" />\r\n                  </span>\r\n              </div>\r\n              <div class=\"flex justify-center\">\r\n                  <h2 class=\"mb-1 font-bold\" style=\"opacity:0.7;color:#1E9080;\">${{ totalRealContratos | filtrarDecimal }}</h2>\r\n              </div>\r\n              <div class=\"ml-4\"><span class=\"\">Total Venta Real Contratos</span></div>\r\n            </div>\r\n          </div>\r\n        </vx-card>\r\n      </div>\r\n      <!--MENU OPCIONES-->\r\n      <!--TABLA-->\r\n      <div>\r\n        <vs-table max-items=\"20\"  multiple v-model=\"codigoSelected\" search :data=\"tmpPedidos\" pagination>\r\n          <template slot=\"header\">\r\n            <vs-chip color=\"primary\" class=\"ml-1\">Cantidad: {{tmpPedidos.length}}</vs-chip>\r\n            <h5 v-if=\"!userBodega\" class=\"ml-2\">Pedidos período {{ periodoSelect.periodoescolar }} </h5>\r\n            <!-- <span @click=\"tipoExportacion=0;tryExport()\" class=\"cursor-pointer\">\r\n              <vx-tooltip style=\"display: inline-block;\" text=\"Seleccione los registros a exportar\" position=\"top\" color=\"primary\">\r\n                <vs-chip transparent class=\"py-3 ml-2\" style=\"font-weight: bold;\" color=\"warning\"><i class=\"fa-solid fa-download\"></i><span class=\"ml-2\">Exportar</span> </vs-chip>\r\n              </vx-tooltip>\r\n            </span> -->\r\n            <span @click=\"tipoExportacion=1;tryExport()\" class=\"cursor-pointer\">\r\n              <vx-tooltip style=\"display: inline-block;\" text=\"Seleccione los registros a exportar\" position=\"top\" color=\"primary\">\r\n                <vs-chip transparent class=\"py-3 ml-5\" style=\"font-weight: bold;\" color=\"dark\"><i class=\"fa-solid fa-download\"></i><span class=\"ml-2\">Exportar Reporte Venta</span> </vs-chip>\r\n              </vx-tooltip>\r\n            </span>\r\n            <span @click=\"popupReportes=true;\" class=\"cursor-pointer\" v-if=\"groupFacturador\">\r\n              <vx-tooltip style=\"display: inline-block;\" text=\"Exportar promocion\" position=\"top\" color=\"primary\">\r\n                <vs-chip transparent class=\"py-3 ml-5\" style=\"font-weight: bold;\" color=\"dark\"><i class=\"fa-solid fa-download\"></i><span class=\"ml-2\">REPORTE PROMOCIÓN TEXTOS</span> </vs-chip>\r\n              </vx-tooltip>\r\n            </span>\r\n          </template>\r\n          <template slot=\"thead\">\r\n            <vs-th>#</vs-th>\r\n            <vs-th sort-key=\"nombreInstitucion\">Institución</vs-th>\r\n            <vs-th sort-key=\"fecha_envio\">Fechas</vs-th>\r\n            <vs-th>Venta</vs-th>\r\n            <vs-th>Detalle V.</vs-th>\r\n            <vs-th>Contrato generado</vs-th>\r\n            <vs-th sort-key=\"asesor\">Pagos</vs-th>\r\n            <vs-th >Acciones</vs-th>\r\n          </template>\r\n          <template slot-scope=\"{data}\">\r\n            <vs-tr :data=\"tr\" :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n              <vs-td>\r\n                {{ tr.id_pedido }}\r\n                <p class=\"mt-1\" style=\"margin-left:-5px;\" v-if=\"groupFacturador\">\r\n                  <vs-chip  v-if=\"tr.notificados == 1\" color=\"#314278\">Notificado</vs-chip>\r\n                </p>\r\n              </vs-td>\r\n              <vs-td>\r\n                <b>Tipo de venta</b>\r\n                {{tr.tipo_venta_descr}}\r\n                <p v-if=\"userBodega\" class=\"mt-1\">\r\n                  <vs-chip color=\"primary\">{{ tr.periodoescolar }}</vs-chip>\r\n                </p>\r\n                <p class=\"font-bold\">Institución:\r\n                  <small v-if=\"usuario.cedula == 'facturadorm'\">{{ tr.codigo_institucion_milton }}</small>\r\n                  <small v-if=\"usuario.name_usuario == 'sguacan'\">{{ tr.id_institucion }}</small>\r\n                </p>\r\n                <span>{{ tr.nombreInstitucion }} </span>\r\n                <p><b>Ciudad:</b> {{ tr.nombre_ciudad }}</p>\r\n                <p class=\"font-bold\">Asesor:</p>\r\n                <span>{{ tr.responsable }} ( {{ tr.iniciales }} )</span>\r\n                <p><b>Cédula:</b> {{ tr.cedula_asesor }}</p>\r\n              </vs-td>\r\n              <vs-td>\r\n                <p class=\"font-bold\">Fecha de solicitud:</p>\r\n                <span>{{ tr.fecha_envio.substring(0,10) }} </span>\r\n                <p class=\"font-bold\">Fecha de entrega:</p>\r\n                <span>{{ tr.fecha_entrega.substring(0,10) }} </span>\r\n                <div v-if=\"tr.estado_entrega == 2\">\r\n                  <p class=\"font-bold\">Fecha de entrega Bodega:</p>\r\n                  <span>{{ tr.fecha_entrega_bodega }} </span>\r\n                </div>\r\n                <div>\r\n                  <p class=\"font-bold\">Fecha de actualización:</p>\r\n                  <span>{{ tr.updated_at }} </span>\r\n                </div>\r\n              </vs-td>\r\n              <vs-td>\r\n                <p class=\"font-bold\">Total unidades:</p>\r\n                <span v-if=\"tr.alcanceUnidades == null\">{{ tr.total_unidades }} </span>\r\n                <span v-else>{{  parseInt(tr.total_unidades) + parseInt(tr.alcanceUnidades) }}</span>\r\n                <p class=\"font-bold\">Venta bruta:</p>\r\n                <span>{{ tr.TotalVentaReal | filtrarDecimal}} </span>\r\n                <!-- <span v-if=\"tr.contador_alcance == null\">{{ tr.total_venta }} </span>\r\n                <span v-else>{{  parseFloat(tr.total_venta) + parseFloat(tr.contador_alcance) }}</span> -->\r\n                <div v-if=\"tr.ven_neta > 0\">\r\n                  <p class=\"font-bold\">Venta Neta:</p>\r\n                  <span>{{ tr.ven_neta | filtrarDecimal }} </span>\r\n                </div>\r\n              </vs-td>\r\n              <vs-td>\r\n                <p class=\"font-bold\">Comisión:</p>\r\n                <span>{{ tr.descuento }} </span>\r\n                <div v-if=\"tr.ifanticipo == 1\">\r\n                  <p class=\"font-bold\">Anticipo sugerido:</p>\r\n                  <span>{{ tr.anticipo }} </span>\r\n                  <p class=\"font-bold\">Anticipo aprobado:</p>\r\n                  <span>{{ tr.anticipo_aprobado }} </span>\r\n                </div>\r\n                <div v-if=\"tr.convenio_anios > 0\">\r\n                  <p class=\"font-bold\">Convenio:</p>\r\n                  <span>{{ tr.convenio_anios }} </span>\r\n                </div>\r\n              </vs-td>\r\n              <vs-td>\r\n                <span class=\"cursor-pointer\" v-if=\"tr.facturacion_vee == 0\" @click=\"pedido=tr;popupGenerarContratoManual = true\">\r\n                  <vs-chip color=\"danger\" >\r\n                    Generar contrato\r\n                  </vs-chip>\r\n                </span><br>\r\n                <p class=\"font-bold\">Contrato:</p>\r\n                <span>{{ tr.contrato_generado }} </span>\r\n                <label v-if=\"tr.contrato_generado == null\">\r\n                </label>\r\n                <label v-else>\r\n                  <p>\r\n                    <span v-if=\"tr.estado_entrega == 2\" color=\"primary\">\r\n                      <b>bodega</b> : Entregado\r\n                    </span>\r\n                    <span v-else color=\"warning\">\r\n                      <b>bodega</b> : Pendiente\r\n                    </span>\r\n                  </p>\r\n                </label>\r\n                <!--CHEQUE-->\r\n                <p v-if=\"tr.historicoEstado == 6 || tr.historicoEstado == 7 && groupFacturador\" @click=\"mostrarDocumento = true;pedido=tr;popupEnviarCheque = true;\" class=\"text-success cursor-pointer\"><span><i class=\"fa-solid fa-camera\"></i><b> Cheque:</b> enviado desde contabilidad</span></p>\r\n                <p v-if=\"tr.historicoEstado > 7\" @click=\"mostrarDocumento = true;pedido=tr;popupEnviarCheque = true;\" class=\"text-success cursor-pointer\"><span><i class=\"fa-solid fa-camera\"></i><b> Cheque:</b> entregado</span></p>\r\n                <!--PAGARE-->\r\n                <p v-if=\"tr.historicoEstado == 9\" @click=\"mostrarDocumento = true;pedido=tr;popupRecibirPagare = true;\" class=\"cursor-pointer\"><span><i class=\"fa-solid fa-camera\"></i><b> Pagaré:</b> subido</span></p>\r\n                <p v-if=\"tr.historicoEstado > 9\" @click=\"mostrarDocumento = true;pedido=tr;popupRecibirPagare = true;\" class=\"text-success cursor-pointer\"><span><i class=\"fa-solid fa-camera\"></i><b>Pagaré:</b> recibido (facturador)</span></p>\r\n                <p v-if=\"tr.historicoEstado > 10\" @click=\"mostrarDocumento = true;pedido=tr;popupRecibirPagare = true;\" class=\"text-success cursor-pointer\"><span><i class=\"fa-solid fa-camera\"></i><b>Pagaré:</b> recibido (contabilidad)</span></p>\r\n                <div class=\"mt-1\">\r\n                  <p class=\"mt-1\" v-if=\"tr.facturacion_vee == 0 && userAsesor\">\r\n                    <vs-chip color=\"danger\">Facturador no puede ver</vs-chip>\r\n                  </p>\r\n                  <vs-chip v-if=\"tr.estado == 0\" color=\"warning\">\r\n                    Pedido incompleto\r\n                  </vs-chip>\r\n                  <vs-chip v-if=\"tr.estado == 1\">\r\n                    Activo\r\n                  </vs-chip>\r\n                  <vs-chip v-if=\"tr.estado == 2\" color=\"danger\">\r\n                    Anulado\r\n                  </vs-chip>\r\n                </div>\r\n                <p class=\"mt-1\">\r\n                  <vs-chip color=\"#5E4BE5\" v-if=\"tr.ifagregado_anticipo_aprobado == 3\">\r\n                    Aprobado por Gerencia\r\n                  </vs-chip>\r\n                </p>\r\n                <p class=\"mt-1 cursor-pointer\" v-if=\"tr.verificaciones > 0\" @click=\"pedido = tr; ver_pedido(tr)\"><vs-chip><b>Verificaciones:  {{ tr.verificaciones }} </b></vs-chip></p><br><br>\r\n                <p class=\"mt-1 cursor-pointer\" v-if=\"tr.estado_verificacion > 0\"\r\n                  @click=\"pedido = tr; popupCodigosLiquidarse=true;\"\r\n                >\r\n                  <vs-chip color=\"warning\">Verificación pendiente</vs-chip>\r\n                </p>\r\n              </vs-td>\r\n              <vs-td>\r\n                <!-- <b>Total Liquidaciones:</b>\r\n                <p>{{ tr.TotalLiquidaciones | filtrarDecimal }}</p> -->\r\n                <b>Total Comision:</b>\r\n                <p>{{ tr.totalValorComision | filtrarDecimal }}</p>\r\n                <b v-if=\"tr.totalPagado  > 0\">Total Pagado a Clientes:</b>\r\n                <p v-if=\"tr.totalPagado > 0\" class=\"text-success\">{{ tr.totalPagado | filtrarDecimal }}</p>\r\n                <b v-if=\"tr.totalPendienteLiquidar > 0\" >Pendiente Liquidar:</b>\r\n                <p v-if=\"tr.totalPendienteLiquidar > 0\" class=\"text-danger\"> {{ tr.totalPendienteLiquidar | filtrarDecimal }}</p>\r\n                <div v-if=\"tr.deuda > 0\">\r\n                  <p class=\"font-bold\">Deuda anterior:</p>\r\n                  <span class=\"text-danger\">{{ tr.deuda }} </span>\r\n                </div>\r\n                <div v-if=\"tr.totalDeudaProxima > 0\">\r\n                  <p class=\"font-bold\">Deuda proximo año :</p>\r\n                  <span class=\"text-danger\">{{ tr.totalDeudaProxima }} </span>\r\n                </div>\r\n                <!-- <b v-if=\"(Math.abs(parseFloat(tr.PProlipaAumentar - tr.PProlipaDisminuir))) > 0\">Total Pagado a la Empresa:</b>\r\n                <p v-if=\"(Math.abs(parseFloat(tr.PProlipaAumentar - tr.PProlipaDisminuir))) > 0\">{{ (Math.abs(parseFloat(tr.PProlipaAumentar - tr.PProlipaDisminuir))) | filtrarDecimal }}</p> -->\r\n              </vs-td>\r\n              <vs-td align=\"center\">\r\n                <vs-dropdown vs-custom-content vs-trigger-click>\r\n                  <vs-button class=\"a-icons\" href.prevent icon=\"more_vert\" type=\"border\"></vs-button>\r\n                  <vs-dropdown-menu style=\"width: 320px;\" class=\"cursor\">\r\n                    <div v-if=\"!userBodega\">\r\n                      <!--TRANSABILIDAD-->\r\n                      <!-- <vs-dropdown-item v-if=\"groupFacturador\">\r\n                        <vs-button class=\"w-full\" color=\"primary\" @click=\"pedido=tr;popupMostrarTransabilidad = true;\" type=\"line\" ><ion-icon name=\"cellular-outline\"></ion-icon> Trazabilidad </vs-button>\r\n                      </vs-dropdown-item> -->\r\n                      <vs-dropdown-item>\r\n                        <!--VER PEDIDO-->\r\n                          <vs-button  color=\"success\" type=\"line\" class=\"w-full\" @click=\"ver_pedido(tr)\">&nbsp;&nbsp;&nbsp;Ver pedido&nbsp;&nbsp;&nbsp;</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"tr.estado == 1 && tr.historicoEstado < 4 && groupFacturador\">\r\n                        <!--ANULAR PEDIDO-->\r\n                        <vs-button color=\"danger\" type=\"line\"   class=\"w-full\" @click=\"pedido = tr;anular_pedido(tr)\">Anular pedido</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"tr.estado == 0 && userAsesor\">\r\n                        <!--ANULAR PEDIDO-->\r\n                        <vs-button color=\"danger\" type=\"line\"   class=\"w-full\" @click=\"pedido = tr;anular_pedido(tr)\">Anular pedido</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <!--GENERAR PEDIDO-->\r\n                      <vs-dropdown-item v-if=\"tr.estado == 2 && userAsesor\">\r\n                        <!--GENERAR PEDIDO-->\r\n                        <vs-button color=\"#5BB9E5\" type=\"line\" class=\"w-full\" @click=\"pedido = tr;ConfirmgenerarNuevoPedido(tr)\">&nbsp;&nbsp;&nbsp;Generar pedido&nbsp;&nbsp;&nbsp;</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"tr.estado == 1 && groupFacturador\">\r\n                        <!--REPORTE PEDIDO-->\r\n                        <vs-button icon-pack=\"feather\" class=\"w-full\" icon=\"icon-file\" @click=\"pedido = tr;chooseBeneficiarioPedido(tr,1);\" color=\"success\" type=\"line\">Reporte pedido</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"tr.contrato_generado !=null && tr.estado == 1 && groupFacturador\">\r\n                      <!--IMPRIMIR REPORTE CONTRATO WORD-->\r\n                        <vs-button class=\"w-full\"  @click=\"tipoFile = 0;generarReportePdfContrato(tr,2)\" color=\"primary\" type=\"line\">Reporte contrato word</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"tr.contrato_generado !=null && tr.estado == 1 && groupFacturador\">\r\n                        <!--IMPRIMIR REPORTE CONTRATO PDF-->\r\n                        <vs-button class=\"w-full\" icon=\"picture_as_pdf\" @click=\"tipoFile = 1;generarReportePdfContrato(tr,2)\" color=\"#6A33D2\" type=\"line\">Reporte contrato pdf</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"groupFacturador && tr.contrato_generado !=null && tr.estado == 1 && (tr.tipo_venta == '1' || tr.tipo_venta == '2') && (tr.contadorAlcanceAbierto > 0 || tr.contadorAlcanceCerrado > 0)\">\r\n                        <!--ALCANCE-->\r\n                        <vs-button  class=\"w-full\"  @click=\"pedido = tr;verAlcance(tr);\" color=\"warning\" type=\"line\">Alcance</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <!--ALCANCE ASESOR-->\r\n                      <vs-dropdown-item v-if=\"userAsesor && tr.contrato_generado !=null && tr.estado == 1\">\r\n                        <!--ALCANCE-->\r\n                        <vs-button icon-pack=\"feather\" class=\"w-full\"   icon=\"icon-file\" @click=\"pedido = tr;verAlcance(tr);\" color=\"warning\" type=\"line\">Alcance</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <!--SOLICITAR VERIFICACION-->\r\n                      <vs-dropdown-item v-if=\"tr.contrato_generado !=null && tr.estado == 1 && (userRoot || userAsesor || groupFacturador)\">\r\n                          <vs-button icon-pack=\"feather\" class=\"w-full\"  icon=\"icon-users\" @click=\"pedido = tr;SolicitarVerificacion(tr);\" color=\"dark\" type=\"line\">Solicitar Verificación</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"groupFacturador && tr.contrato_generado !=null && tr.estado == 1 && (tr.tipo_venta == '1' || tr.tipo_venta == '2') && (tr.contadorAlcanceAbierto > 0 || tr.contadorAlcanceCerrado > 0)\">\r\n                        <!--TRANSABILIDAD ALCANCE-->\r\n                        <vs-button class=\"w-full\" color=\"dark\" @click=\"pedido=tr;popupMostrarTransabilidadAlcance = true;\" type=\"line\" ><ion-icon name=\"cellular-outline\"></ion-icon> Trazabilidad Alcance</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"tr.convenio_anios > 0 && tr.contrato_generado !=null && tr.estado == 1 && groupFacturador\">\r\n                        <!--CONVENIO-->\r\n                        <vs-button class=\"w-full\" icon-pack=\"feather\" icon=\"icon-printer\" @click=\"pedido= tr;chooseBeneficiarioPedido(tr,3)\" color=\"#3D21C6\" type=\"line\">Imprimir convenio</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"tr.anticipo_aprobado > 0 && tr.contrato_generado !=null && tr.estado == 1\">\r\n                        <!--IMPRIMIR PAGARE-->\r\n                        <vs-button class=\"w-full\"  icon-pack=\"feather\" type=\"line\" icon=\"icon-upload-cloud\" @click=\"pedido=tr;chooseBeneficiarioPedido(tr,4)\" color=\"#5BB9E5\">Imprimir Pagaré</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"tr.historicoEstado == 6 && tr.estado == 1 && groupFacturador\">\r\n                        <!--MARCAR COMO RECIBIDO EL CHEQUE DE CONTABILIDAD-->\r\n                        <vs-button class=\"w-full\" icon-pack=\"feather\" icon=\"icon-credit-card\" @click=\"pedido = tr;popupRecibiCheque = true\" color=\"warning\" type=\"line\">Marcar como recibido cheque</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"tr.historicoEstado == 7 && tr.estado == 1 && groupFacturador\">\r\n                        <!--MARCAR CHEQUE COMO ENTREGADO AL ASESOR-->\r\n                        <vs-button class=\"w-full\" icon-pack=\"feather\" icon=\"icon-credit-card\" @click=\"pedido = tr;popupEnviarCheque = true\" color=\"dark\" type=\"line\">Entrega de cheque a asesor</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item v-if=\"tr.historicoEstado == 9 && tr.estado == 1 && groupFacturador\">\r\n                        <!--MARCAR PAGARE COMO RECIBIDO POR EL ASESOR-->\r\n                        <vs-button  class=\"w-full\"  icon-pack=\"feather\" icon=\"icon-file\" @click=\"mostrarDocumento=false;pedido = tr;popupRecibirPagare = true;\" color=\"dark\" type=\"line\">Marcar pagaré recibido</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <!--VER INFORMACION VERIFICACIONES-->\r\n                      <!-- <vs-dropdown-item v-if=\"tr.verificaciones > 0\">\r\n                        <vs-button icon-pack=\"feather\" class=\"w-full\" icon=\"icon-activity\" @click=\"pedido = tr; VerVerificaciones(tr)\" color=\"#7AD40E\" type=\"line\">Ver Verificación</vs-button>\r\n                      </vs-dropdown-item> -->\r\n                      <!--LIQUIDAR CONTRATO-->\r\n                      <vs-dropdown-item v-if=\"tr.estado_verificacion > 0 && groupFacturador\">\r\n                        <vs-button icon-pack=\"feather\" class=\"w-full\" icon=\"icon-shopping-bag\" @click=\"pedido = tr; openConfirmLiquidar(tr)\" color=\"#500ED4\" type=\"filled\">Liquidar Contrato</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <!--NOTIFICACION REVISACION-->\r\n                      <vs-dropdown-item v-if=\"userRoot || userAdminFacturador\">\r\n                        <vs-button icon-pack=\"feather\" v-if=\"tr.notificados == 0 && tr.contrato_generado == null\" class=\"w-full text-normal\" icon=\"icon-check\"  @click=\"pedido = tr; notificarPedido(1)\" color=\"#C74BDE\" type=\"line\">Marcar como notificado</vs-button>\r\n                        <vs-button icon-pack=\"feather\" v-if=\"tr.notificados == 1\" class=\"w-full\" icon=\"icon-check\" @click=\"pedido = tr; notificarPedido(0)\" color=\"#C74BDE\" type=\"line\">Quitar notificado</vs-button>\r\n                      </vs-dropdown-item>\r\n                    </div>\r\n                    <div v-if=\"userBodega || usuario.name_usuario == 'facturadorm'\">\r\n                      <vs-dropdown-item>\r\n                        <vs-button icon-pack=\"feather\" class=\"w-full\" icon=\"icon-airplay\" @click=\"pedido = tr;onlyVer = 1; popupEntregarPedido = true;\" color=\"dark\" type=\"line\">Ver Detalle</vs-button>\r\n                      </vs-dropdown-item>\r\n                      <vs-dropdown-item  v-if=\"tipoBodega == 2 && userBodega\">\r\n                        <vs-button icon-pack=\"feather\" class=\"w-full\" icon=\"icon-activity\" @click=\"pedido = tr;onlyVer = 0;popupEntregarPedido = true;\" color=\"#7AD40E\" type=\"line\">Entregar pedido</vs-button>\r\n                      </vs-dropdown-item>\r\n                    </div>\r\n                  </vs-dropdown-menu>\r\n                </vs-dropdown>\r\n              </vs-td>\r\n            </vs-tr>\r\n          </template>\r\n        </vs-table>\r\n      </div>\r\n    </div>\r\n    <!--DOWNLOAD DOCUMENTOS-->\r\n    <div v-if=\"mostrarReporte\">\r\n      <exportPedidoVue style=\"display:none;\" :id_beneficiario_pedido=\"id_beneficiario_pedido\" :id_pedido=\"pedido.id_pedido\" :id_periodo=\"pedido.id_periodo\" @change=\"changeHandle\" />\r\n    </div>\r\n    <div v-if=\"mostrarReporteC\">\r\n      <exportContratoVue style=\"display:none;\" :tipoFile=\"tipoFile\" :beneficiario=\"beneficiario\" :id_beneficiario_pedido=\"id_beneficiario_pedido\" :contrato=\"contrato\" @change=\"changeHandle\" />    </div>\r\n    <!--Export convenio-->\r\n    <div v-if=\"mostrarReporteConvenio\">\r\n      <exportConvenioVue style=\"display:none;\" :empresaSelected=\"empresaSelected\" :anioEmpieza=\"anioEmpieza\" :aniosAnteriorSelect=\"aniosAnteriorSelect\" :id_beneficiario_pedido=\"id_beneficiario_pedido\" :id_pedido=\"pedido.id_pedido\" :id_periodo=\"pedido.id_periodo\" @change=\"changeHandle\" />\r\n    </div>\r\n    <!--IMPRIMIR PAGARE-->\r\n    <div v-if=\"mostrarPagareAsesor\">\r\n      <exportPagareVue style=\"display:none;\" :empresaSelected=\"empresaSelected\" :aniosAnteriorSelect=\"aniosAnteriorSelect\" :id_beneficiario_pedido=\"id_beneficiario_pedido\" :id_pedido=\"pedido.id_pedido\" :id_periodo=\"pedido.id_periodo\" :contrato=\"contrato\" @change=\"changeHandle\" />\r\n    </div>\r\n    <!--FIN DOWNLOAD DOCUMENTOS-->\r\n    <!--MODALES-->\r\n    <vs-popup class=\"holamundo\" title=\"Cargando\" :active.sync=\"popupCarga\">\r\n      <p class=\"text-warning text-3xl bg-dark\"><i class=\"fa-solid fa-cloud\"></i> <b class=\"ml-2\">Espere mientras se descarga el archivo</b></p>\r\n      <img  class=\"mt-2\"  style=\"margin-left: 35px;\" src=\"https://cdn-icons-png.flaticon.com/512/4578/4578845.png\"/>\r\n    </vs-popup>\r\n    <!--MODAL PARA SELECCIONAR UN BENEFICIARIO-->\r\n    <!--MODAL PARA GENERAR CONTRATO MANUAL-->\r\n    <vs-popup class=\"holamundo\" fullscreen :title=\"'Colocar contrato al pedido #'+pedido.id_pedido\" :active.sync=\"popupGenerarContratoManual\">\r\n      <generarContratoVue v-if=\"popupGenerarContratoManual\" :pedido=\"pedido\" @changeContratoManual=\"changeContratoManual\"/>\r\n    </vs-popup>\r\n    <!--ESCOGER BENEFICIARIOS-->\r\n    <vs-prompt\r\n      title=\"Seleccione un beneficiario para poder generar el reporte\"\r\n      @cancel=\"close\"\r\n      cancelText=\"Cancelar\"\r\n      acceptText=\"Generar\"\r\n      @accept=\"acceptAlert\"\r\n      @close=\"close\"\r\n      :active.sync=\"activePrompt\">\r\n        <div class=\"con-exemple-prompt\">\r\n          <p class=\"mt-2\">Seleccione el Beneficiario</p>\r\n          <v-select :options=\"arregloBeneficiarios\" :reduce=\"arregloBeneficiarios => arregloBeneficiarios\" label=\"beneficiarioComision\" class=\"w-full\" v-model=\"beneficiario\" />\r\n        </div>\r\n        <!--TIPO 2 => Reporte contrato -->\r\n        <div v-if=\"tipo == 3 || tipo == 4\">\r\n          <p class=\"mt-4\">Seleccione la empresa por favor</p>\r\n          <v-select :options=\"arrayEmpresas\" :reduce=\"arrayEmpresas => arrayEmpresas\" label=\"descripcion_corta\" class=\"w-full\" v-model=\"empresaSelected\" />\r\n        </div>\r\n        <div v-if=\"tipo == 3\">\r\n          <p class=\"mt-4\">Seleccione el año que comienza el convenio</p>\r\n          <v-select :options=\"arregloAniosAnteriores\" :reduce=\"arregloAniosAnteriores => arregloAniosAnteriores\" class=\"w-full\" v-model=\"anioEmpieza\" />\r\n        </div>\r\n        <div v-if=\"tipo == 4 || tipo == 3\">\r\n          <p class=\"mt-4\">Seleccione el año final para calcular los dias</p>\r\n          <v-select :options=\"arregloAniosAnteriores\" :reduce=\"arregloAniosAnteriores => arregloAniosAnteriores\" class=\"w-full\" v-model=\"aniosAnteriorSelect\" />\r\n        </div>\r\n    </vs-prompt>\r\n    <!--MODAL PARA VER LA TRANSABILIDAD-->\r\n    <!-- <vs-popup class=\"holamundo\" title=\"Ver trazabilidad\" :active.sync=\"popupMostrarTransabilidad\">\r\n      <div v-if=\"popupMostrarTransabilidad\">\r\n        <screenTransabilidaVue :pedido=\"pedido\"/>\r\n      </div>\r\n    </vs-popup> -->\r\n    <!--MODAL PARA VER LA TRANSABILIDAD ALCANCE-->\r\n    <vs-popup class=\"holamundo\" title=\"Ver trazabilidad Alcance\" :active.sync=\"popupMostrarTransabilidadAlcance\">\r\n      <div v-if=\"popupMostrarTransabilidadAlcance\">\r\n        <screenTransabilidaAlcanceVue :pedido=\"pedido\"/>\r\n      </div>\r\n    </vs-popup>\r\n    <!--MODAL PARA MARCAR COMO RECIBIO EL CHEQUE-->\r\n    <vs-popup class=\"holamundo\" title=\"Marcar como recibi el cheque\" :active.sync=\"popupRecibiCheque\">\r\n      <div v-if=\"popupRecibiCheque\">\r\n        <div class=\"flex\" style=\"justify-content: center;\">\r\n          <img width=\"500\" :src=\"$data_url+'archivos/pedidos/cheque/'+pedido.evidencia_cheque\"/>\r\n        </div>\r\n        <vs-button color=\"success\" @click=\"changeEstadoHistorico(7)\" class=\"mt-5\" type=\"gradient\">Recibi el cheque</vs-button>\r\n      </div>\r\n    </vs-popup>\r\n    <!--MODAL PARA ENVIAR CHEQUE ASESOR-->\r\n    <vs-popup class=\"holamundo\" title=\"Cheque para el asesor\" fullscreen :active.sync=\"popupEnviarCheque\">\r\n      <div v-if=\"popupEnviarCheque\">\r\n        <div class=\"flex\" style=\"justify-content: center;\">\r\n          <image-zoom\r\n              :regular=\"$data_url+'archivos/pedidos/cheque/'+pedido.evidencia_cheque\"\r\n              :zoom-amount=\"3\"\r\n              :click-zoom=\"true\"\r\n              click-message=\"De click para aumentar\"\r\n              img-class=\"img-fluid\"\r\n              >\r\n          </image-zoom>\r\n          <img width=\"500\" v-if=\"mostrarDocumento == false\" :src=\"$data_url+'archivos/pedidos/cheque/'+pedido.evidencia_cheque\"/>\r\n        </div>\r\n        <div class=\"flex\" style=\"justify-content: center;\" v-if=\"mostrarDocumento == false\">\r\n          <vs-button color=\"success\" @click=\"changeEstadoHistorico(8)\" class=\"mt-5\" type=\"gradient\">Entregue cheque al asesor</vs-button>\r\n        </div>\r\n      </div>\r\n    </vs-popup>\r\n    <!--FIN MODAL PARA ENVIAR CHEQUE ASESOR-->\r\n    <!--MODAL PARA MARCAR COMO RECIBIDO PAGARE-->\r\n    <vs-popup class=\"holamundo\" title=\"Pagaré subido por el asesor\" :active.sync=\"popupRecibirPagare\">\r\n      <div v-if=\"popupRecibirPagare\">\r\n        <div class=\"flex\" style=\"justify-content: center;\">\r\n          <img width=\"500\" :src=\"$data_url+'archivos/pedidos/pagare/'+pedido.evidencia_pagare\"/>\r\n        </div>\r\n        <div class=\"flex\" style=\"justify-content: center;\" v-if=\"mostrarDocumento == false\">\r\n            <vs-button color=\"success\" @click=\"changeEstadoHistorico(10)\" class=\"mt-5\" type=\"gradient\">Recibi el pagaré fisico por parte del asesor</vs-button>\r\n        </div>\r\n      </div>\r\n    </vs-popup>\r\n    <!--MODAL PARA EXPORTAR A EXCEL-->\r\n    <vs-prompt title=\"Exportar a Excel\" class=\"export-options\" @cancle=\"clearFields\" @accept=\"exportToExcel\" accept-text=\"Exportar\" @close=\"clearFields\" :active.sync=\"popupExport\">\r\n      <vs-alert class=\"mb-3\" color=\"danger\" icon-pack=\"feather\" icon=\"icon-info\">\r\n        <span>Recuerde <b>seleccionar</b> los registros que desea exportar.</span>\r\n      </vs-alert>\r\n      <vs-input v-model=\"fileName\" placeholder=\"Ingrese el nombre del archivo\" class=\"w-full\" />\r\n    </vs-prompt>\r\n    <!--MODAL PARA ENTREGAR PEDIDO (BODEGA)-->\r\n    <vs-popup class=\"holamundo\" fullscreen title=\"Detalle pedido\" :active.sync=\"popupEntregarPedido\">\r\n      <pedidosDetalleVue :onlyVer=\"onlyVer\" @changeRecarge=\"recargarPedidos()\" v-if=\"popupEntregarPedido\" :id_pedido=\"pedido.id_pedido\" :id_periodo=\"pedido.id_periodo\" :pedido=\"pedido\"/>\r\n    </vs-popup>\r\n    <!--MODAL PARA VER CODIGOS A LIQUIDAR-->\r\n    <vs-popup class=\"holamundo\" fullscreen title=\"Códigos a liquidar\" :active.sync=\"popupVerLiquidacion\">\r\n      <div v-if=\"popupVerLiquidacion\">\r\n        <LiquidacionVentaDirectaVue :pedido=\"pedido\" @ChangeRecarge=\"recargarPedidos\"/>\r\n        <!--VENTA DIRECTA-->\r\n        <!-- <div v-if=\"pedido.tipo_venta == 1\">\r\n            <p>Verificación venta directa</p>\r\n            <LiquidacionVentaDirectaVue :pedido=\"pedido\" @ChangeRecarge=\"recargarPedidos\"/>\r\n        </div> -->\r\n        <!--VENTAS LISTA-->\r\n        <!-- <div v-if=\"pedido.tipo_venta == 2\">\r\n            <p>Verificación venta lista</p>\r\n            <LiquidacionCodigosVue\r\n                :contratoLiquidacion=\"pedido.contrato_generado\"\r\n                :estado_verificacion=\"pedido.estado_verificacion\"\r\n                :insNombre=\"pedido.nombreInstitucion\"\r\n                :ciuNombre=\"pedido.nombre_ciudad\"\r\n                @ChangeRegresar=\"recargarPedidos\"\r\n            /> -->\r\n        <!-- </div> -->\r\n      </div>\r\n    </vs-popup>\r\n    <!--MODAL PARA CODIGOS A LIQUIDARSE-->\r\n    <vs-popup fullscreen title=\"Codigos a liquidarse\" :active.sync=\"popupCodigosLiquidarse\">\r\n      <LiquidacionCodigosVue\r\n        v-if=\"popupCodigosLiquidarse\"\r\n        :contratoLiquidacion=\"pedido.contrato_generado\"\r\n        :estado_verificacion=\"pedido.estado_verificacion\"\r\n        :insNombre=\"pedido.nombreInstitucion\"\r\n        :ciuNombre=\"pedido.nombre_ciudad\"\r\n        @ChangeRegresar=\"recargarPedidos\"\r\n      />\r\n    </vs-popup>\r\n    <!--popup REPORTES PEDIDOS-->\r\n    <vs-popup :title=\"'Reportes de pedidos del período '\" fullscreen :active.sync=\"popupReportes\">\r\n      <PedidoScreenReportesVue v-if=\"popupReportes\" :periodoSelect=\"periodoSelect\"/>\r\n    </vs-popup>\r\n  </div>\r\n</template>\r\n<script>\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport vSelect from 'vue-select'\r\nconst exportContratoVue             = () => import('../temporadas/components/exportContrato.vue')\r\nconst exportPedidoVue               = () => import('../temporadas/components/exportContrato2.vue')\r\nconst exportConvenioVue             = () => import('../temporadas/components/exportConvenio.vue')\r\n// const screenTransabilidaVue         = () => import('./transabilidad/screenTransabilida.vue')\r\nconst screenTransabilidaAlcanceVue  = () => import('@/views/pedidos/transabilidad/screenTransabilidaAlcance')\r\nconst exportPagareVue               = () => import('../temporadas/components/exportPagare.vue')\r\nconst generarContratoVue            = () => import('./components/milton/generarContrato.vue')\r\n// const historicoCodigosNuevoVue      = () => import('../temporadas/historicoCodigosNuevo.vue')\r\n// const VerificacionTrazabilidadVue   = () => import('../temporadas/VerificacionTrazabilidad.vue')\r\nconst pedidosDetalleVue             = () => import('../temporadas/components/pedidosDetalle.vue')\r\nconst LiquidacionVentaDirectaVue    = () => import('./asesor/contratos/LiquidacionVentaDirecta.vue')\r\nconst LiquidacionCodigosVue         = () => import('./asesor/contratos/LiquidacionCodigos.vue')\r\nconst PedidoScreenReportesVue       = () => import('../pedidos2/pedidos/reportes/PedidoScreenReportes.vue');\r\nimport moment from \"moment\";\r\nimport imageZoom from 'vue-image-zoomer';\r\nexport default{\r\n  components:{\r\n    vSelect,\r\n    // screenTransabilidaVue,\r\n    screenTransabilidaAlcanceVue,\r\n    exportContratoVue,\r\n    exportPedidoVue,\r\n    exportConvenioVue,\r\n    exportPagareVue,\r\n    imageZoom,\r\n    generarContratoVue,\r\n    // historicoCodigosNuevoVue,\r\n    // VerificacionTrazabilidadVue,\r\n    flatPickr,\r\n    pedidosDetalleVue,\r\n    // ScreenPagosVue,\r\n    LiquidacionVentaDirectaVue,\r\n    LiquidacionCodigosVue,\r\n    PedidoScreenReportesVue,\r\n  },\r\n  data(){\r\n    return{\r\n      usuario:[],\r\n      // pedidos:[],\r\n      tmpPedidos:[],\r\n      arregloBeneficiarios:[],\r\n      pedido:{},\r\n      contrato:'',\r\n      filtro:1,\r\n      id_periodo:0,\r\n      popupMostrarTransabilidad:false,\r\n      popupMostrarTransabilidadAlcance:false,\r\n      popupMostrarPedido:false,\r\n      //variables modales files export\r\n      mostrarReporte:false,\r\n      popupCarga:false,\r\n      mostrarReporteC:false,\r\n      mostrarReporteConvenio:false,\r\n      mostrarPagareAsesor:false,\r\n      activePrompt:false,\r\n      //variables modales filex export\r\n      //files de beneficiarios\r\n      id_beneficiario_pedido:'',\r\n      beneficiario:'',\r\n      tipo:'',\r\n      //fin files de beneficiarios\r\n      userFacturador:false,\r\n      userAdminFacturador:false,\r\n      userBodega:false,\r\n      tipoFile:0,\r\n      //variables historico\r\n      popupRecibiCheque:false,\r\n      popupEnviarCheque:false,\r\n      popupRecibirPagare:false,\r\n      mostrarDocumento:false,\r\n      //fin variables historico\r\n      popupGenerarContratoManual:false,\r\n      activeMenu:true,\r\n      //variables para verificaciones\r\n      menu:1,\r\n      //fin variables para verificaciones\r\n      //variables para exportar\r\n      fileName: null,\r\n      popupExport: false,\r\n      codigoSelected: [],\r\n      reportesActivo: 0,\r\n      fileName: null,\r\n      formats: ['xls', 'xlsx', 'csv', 'txt'],\r\n      cellAutoWidth: true,\r\n      selectedFormat: 'xlsx',\r\n      tipoExportacion: 0,\r\n      //fin variables para exportar excel\r\n      //variables para filtrar fechas\r\n      fechaSelect: null,\r\n      configdateTimePicker: {\r\n        enableTime: true,\r\n        dateFormat: 'Y-m-d'\r\n      },\r\n      flatpickrOptions: {\r\n        locale: 'es',\r\n        // Otras opciones de configuración...\r\n      },\r\n      //tipoFecha => 0 = fecha envio; 1 = fecha entrega\r\n      tipoFecha:0,\r\n      titleFecha:'Fecha envio',\r\n      //fin variables para filtrar fechas\r\n      //variables para anios anteriores\r\n      arregloAniosAnteriores:[],\r\n      aniosAnteriorSelect:'',\r\n      anioEmpieza:'',\r\n      //fin variables para anios anteriores\r\n      //variables bodega//\r\n      tipoBodega:2,\r\n      popupEntregarPedido:false,\r\n      //fin variables bodega\r\n      menuTab:0,\r\n      //variables para solicitar verificacion\r\n      popupVerLiquidacion:false,\r\n      popupCodigosLiquidarse:false,\r\n      //fin variables para solicitar verificacion\r\n      //Apis para empresas\r\n      arrayEmpresas:[],\r\n      empresaSelected: '',\r\n      //fin Apis para empresas\r\n      totalRealContratos:0,\r\n      popupReportes:false,\r\n    }\r\n  },\r\n  created(){\r\n    let me = this\r\n    me.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n    me.id_periodo = me.periodoSelect.idperiodoescolar\r\n    me.nombre_periodo = me.periodoSelect.periodoescolar\r\n  },\r\n  mounted(){\r\n    let me = this;\r\n    me.generateHistorico()\r\n    me.getAniosAnteriores()\r\n    me.anioEmpieza = moment().format('YYYY')\r\n    //user permisos\r\n    if(me.usuario.id_group == 22)                               me.userFacturador       = true\r\n    if(me.usuario.id_group == 23)                               me.userAdminFacturador  = true\r\n    if(me.usuario.id_group  == 27) me.userBodega = true\r\n    //fin user permisos\r\n    //menu bodega\r\n    if(me.userBodega){\r\n      me.filtroBodega()\r\n    }\r\n    //menu\r\n    else{\r\n      let menuSelect = localStorage.menuSelect\r\n      if(menuSelect){\r\n        me.filtro = menuSelect\r\n        setTimeout(function(){  me.filtroTipo() }, 1000);\r\n      }else{\r\n        setTimeout(function(){  me.filtroTipo() }, 1000);\r\n      }\r\n    }\r\n  },\r\n  props:{\r\n    periodoSelect:{\r\n      type:Object,\r\n      default:{},\r\n    },\r\n    pedidos: {\r\n      type: Array,\r\n      default: []\r\n    },\r\n    userAsesor:{\r\n      type:Boolean,\r\n      default:false,\r\n    },\r\n    userRoot:{\r\n      type:Boolean,\r\n      default:false,\r\n    },\r\n    groupFacturador:{\r\n      type:Boolean,\r\n      default:false,\r\n    },\r\n  },\r\n  watch:{\r\n    periodoSelect(results){\r\n      let me = this;\r\n      me.id_periodo = me.periodoSelect.idperiodoescolar\r\n      me.nombre_periodo = me.periodoSelect.periodoescolar\r\n      me.getTotalVentaRealContratos()\r\n    },\r\n    pedidos(results) {\r\n      let me = this;\r\n      me.tmpPedidos = []\r\n      if(me.userBodega){\r\n        me.filtroBodega()\r\n      }else{\r\n        me.filtroTipo()\r\n      }\r\n    },\r\n  },\r\n  computed:{\r\n    sumaTotal(){\r\n      let me = this;\r\n      let total = me.pedidos.length\r\n      return total\r\n    },\r\n    SumaSinAnticipo(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter(p => (p.estado == 1 || p.estado == 0 ) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && (p.ifanticipo == 0));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaConAnticipoSinAprobar(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1 || p.estado == 0 ) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && (p.ifanticipo == 1) &&  ( (p.ifagregado_anticipo_aprobado == 0) ) );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaConAnticipoAprobados(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && p.ifagregado_anticipo_aprobado == 1 );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaAnulados(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 2 );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //CHEQUES\r\n    SumaEntregaCheques(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 6 || p.historicoEstado == 7) );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaSolicitudesPagares(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 9));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaPagareFisicosEntregados(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 10 || p.historicoEstado == 11));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //FIN CHEQUES\r\n    //GERENCIA\r\n    SumaSolicitudAnticipos(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 2));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaAnticiposGerenciaAprobados(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 3));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaAnticiposGerenciaAnulados(){\r\n      let me = this\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 4));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //FIN GERENCIA\r\n    SumaContratoSinAnticipo(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado != null)) && p.ifanticipo == 0 );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaContratosConAnticipoAprobados(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado != null)) && p.ifanticipo == 1 );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===TOTAL PENDIENTES=========\r\n    SumaTotalPendientes(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && (p.ifanticipo == 1 || p.ifanticipo == 0) &&  ( (p.ifagregado_anticipo_aprobado == 0) ) );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN TOTAL PENDIENTES=====\r\n    //===TOTAL GERENCIA=========\r\n    SumaTotalGerencia(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 2 || p.ifagregado_anticipo_aprobado == 3 || p.ifagregado_anticipo_aprobado == 4));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN TOTAL GERENCIA=====\r\n    //===TOTAL CONTRATOS========\r\n    SumaTotalContratos(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado != null)) && (p.ifanticipo == 1 || p.ifanticipo == 0 ) );\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN TOTAL CONTRATOS====\r\n    //===TOTAL CHEQUES==========\r\n    SumaTotalCheques(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.historicoEstado == 6 || p.historicoEstado == 7 || p.historicoEstado == 9 || p.historicoEstado == 10 || p.historicoEstado == 11));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN TOTAL CHEQUES======\r\n    //===ALCANCE================\r\n    //ALCANCES PENDIENTES\r\n    SumaAlcancePendientes(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.contadorAlcanceAbierto > 0));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //ALCANCE CERRADOS O APROBADOS\r\n    SumaAlcanceCerrados(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.contadorAlcanceCerrado > 0));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN ALCANCE============\r\n    //===TIPOS DE VENTA=========\r\n    //venta directa\r\n    SumaVentaDirecta(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.tipo_venta == 1 && p.estado == 1  && (( p.contrato_generado != null)));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaVentaLista(){\r\n      let me = this;\r\n      let datos       = me.pedidos.filter( p => p.tipo_venta == 2 && p.estado == 1  && (( p.contrato_generado != null)));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    //===FIN TIPOS DE VENTA=====\r\n    //========================FILTROS PARA BODEGA============================\r\n    SumarPedidosNoentregadosSinContrato() {\r\n      let me = this;\r\n      let datos = me.pedidos.filter(p => (p.estado_entrega == 0) && p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\"));\r\n      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumarPedidosNoentregadosConContrato() {\r\n      let me = this;\r\n      let datos = me.pedidos.filter(p => (p.estado_entrega == 0) && p.estado == 1 && ((p.contrato_generado != null)));      let resultado   = datos.length\r\n      return resultado\r\n    },\r\n    SumaPedidosEntregados() {\r\n      let me = this;\r\n      let datos = me.pedidos.filter(p => (p.estado_entrega == 2) && p.estado == 1);\r\n      let resultado = datos.length\r\n      return resultado\r\n    },\r\n    //========================FIN FILTROS PARA BODEGA========================\r\n  },\r\n  methods:{\r\n    getAniosAnteriores(){\r\n      let me = this;\r\n      me.arregloAniosAnteriores = []\r\n      // Obtener la fecha actual\r\n      var fechaActual = new Date();\r\n      // Obtener el año actual\r\n      var añoActual = fechaActual.getFullYear();\r\n      // Array para almacenar los últimos 5 años anteriores\r\n      var ultimosCincoAñosAnteriores = [];\r\n      // Array para almacenar los próximos 10 años\r\n      var proximosCincoAños = [];\r\n      // Calcular los últimos 5 años anteriores\r\n      for (var i = 1; i <= 5; i++) {\r\n        ultimosCincoAñosAnteriores.push(añoActual - i);\r\n      }\r\n      // Calcular los próximos 10 años\r\n      for (var i = 0; i <= 10; i++) {\r\n        proximosCincoAños.push(añoActual + i);\r\n      }\r\n      var todosLosAños          =  [...ultimosCincoAñosAnteriores,...proximosCincoAños]\r\n      // Ordenar el array en orden ascendente\r\n      todosLosAños.sort(function(a, b) {\r\n        return a - b;\r\n      });\r\n      // Imprimir los próximos 5 años\r\n      me.arregloAniosAnteriores =  todosLosAños\r\n    },\r\n    llenarPedidos(){\r\n      let me = this;\r\n      this.$http.get(this.$server_url+'llenarInformacionContrato')\r\n      .then(res => {\r\n        console.log(res.data)\r\n        me.$vs.notify({\r\n        text:'Se guardo correctamente',\r\n        color:'success',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n      })\r\n    },\r\n    changeContratoManual(e){\r\n      let me = this\r\n      me.popupGenerarContratoManual = false;\r\n      me.$emit('changeRecarge',true)\r\n      // me.getPedidos()\r\n    },\r\n    generateHistorico(){\r\n      let me = this;\r\n      this.$http.get(this.$server_url+'pedidosConAnticipo')\r\n      .then(res => {\r\n      })\r\n    },\r\n    filtroTipo(){\r\n      let me = this;\r\n      me.estadoMenu()\r\n      me.tmpPedidos = []\r\n      me.tmparregloFiltroFecha = []\r\n      me.fechaSelect  = \"\"\r\n      //para ver todos\r\n      if(me.filtro == 100){\r\n        let total = me.pedidos\r\n        me.tmpPedidos = total\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los pedidos sin anticipo\r\n      if(me.filtro == 1){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1 || p.estado == 0) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && ( p.ifanticipo == 0 ));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los pedidos con anticipo(sin aprobar)\r\n      if(me.filtro == 2){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1 || p.estado == 0) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && (p.ifanticipo == 1) &&  ( (p.ifagregado_anticipo_aprobado == 0) ) );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //======Todos pendientes==========\r\n      if(me.filtro == 13){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && (p.ifanticipo == 1 || p.ifanticipo == 0) &&  ( (p.ifagregado_anticipo_aprobado == 0) ) );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //======Fin todos pendientes======\r\n      //para ver los pedidos con anticipo(aprobados)\r\n      if(me.filtro == 3){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado == null || p.contrato_generado == \"\")) && p.ifagregado_anticipo_aprobado == 1 );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los solicitudes de anticipos a gerencia\r\n      if(me.filtro == 4){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 2));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los anticipos solicitados al gerente aprobados\r\n      if(me.filtro == 5){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 3));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los anticipos solicitados al gerente anulados\r\n      if(me.filtro == 6){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 4));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los contratos con anticipos\r\n      if(me.filtro == 7){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado != null)) && p.ifanticipo == 1 );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los contratos sin anticipos\r\n      if(me.filtro == 8){\r\n        let datos       = me.pedidos.filter(p => (p.estado == 1) && (( p.contrato_generado != null)) && (p.ifanticipo == 0 || p.ifanticipo == null) );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver las entregas para el asesor(cheques generados)\r\n      if(me.filtro == 9){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 6 || p.historicoEstado == 7) );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver las posibles entregas de pagares\r\n      if(me.filtro == 10){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 9));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //para ver los pagares entregados fisicos\r\n      if(me.filtro == 11){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.historicoEstado == 10 || p.historicoEstado == 11));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //===TOTAL GERENCIA======\r\n      if(me.filtro == 14){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\") && (p.ifagregado_anticipo_aprobado == 2 || p.ifagregado_anticipo_aprobado == 3 || p.ifagregado_anticipo_aprobado == 4));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //===TOTAL CONTRATOS=====\r\n      if(me.filtro == 15){\r\n        let datos       = me.pedidos.filter( p => (p.estado == 1) && ((p.contrato_generado != null)) );\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //==FIN TOTAL CONTRATOS===\r\n      //===TOTAL CHEQUES========\r\n      if(me.filtro == 16){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.historicoEstado == 6 || p.historicoEstado == 7 || p.historicoEstado == 9 || p.historicoEstado == 10 || p.historicoEstado == 11));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //===ALCANCE=============\r\n      //Alcance pendientes\r\n      if(me.filtro == 17){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.contadorAlcanceAbierto > 0));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //Alcance cerrado\r\n      if(me.filtro == 18){\r\n        let datos       = me.pedidos.filter( p => p.estado == 1 && ( p.contadorAlcanceCerrado > 0));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //===FIN ALCACANCE=======\r\n      //para ver los pedidos anulados\r\n      if(me.filtro == 19){\r\n        let datos       = me.pedidos.filter( p => p.estado == 2);\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //TIPO VENTA=============\r\n      //Venta directa\r\n      if(me.filtro == 20){\r\n        let datos       = me.pedidos.filter( p => p.tipo_venta == 1 && p.estado == 1  && (( p.contrato_generado != null)));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n        //Venta Lista\r\n        if(me.filtro == 21){\r\n        let datos       = me.pedidos.filter( p => p.tipo_venta == 2 && p.estado == 1  && (( p.contrato_generado != null)));\r\n        me.tmpPedidos   = datos\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n      //==FIN TOTAL CHEQUES\r\n      else{\r\n        let total = me.pedidos\r\n        me.tmpPedidos = total\r\n        me.tmparregloFiltroFecha = me.tmpPedidos\r\n        return\r\n      }\r\n    },\r\n    filtroBodega(){\r\n      let me = this;\r\n      me.tmpPedidos = []\r\n      //para ver los pedidos pendientes\r\n      if (me.tipoBodega == 0) {\r\n        //bodega mostrar los pedidos pendientes de bodega\r\n        let datos = me.pedidos\r\n        me.tmpPedidos = datos\r\n        return\r\n      }\r\n      //para ver los pedidos sin contratos\r\n      if (me.tipoBodega == 1) {\r\n        let datos = me.pedidos.filter(p => (p.estado_entrega == 0) && p.estado == 1 && (p.contrato_generado == null || p.contrato_generado == \"\"));\r\n        me.tmpPedidos = datos\r\n        return\r\n      }\r\n       //para ver los pedidos con contratos  sin entrega\r\n       if (me.tipoBodega == 2) {\r\n        let datos = me.pedidos.filter(p => (p.estado_entrega == 0) && p.estado == 1 && ((p.contrato_generado != null)));\r\n        me.tmpPedidos = datos\r\n        return\r\n      }\r\n      //para ver los pedidos entregados por bodega\r\n      if (me.tipoBodega == 3) {\r\n        let datos = me.pedidos.filter(p => (p.estado_entrega == 2) && p.estado == 1);\r\n        me.tmpPedidos = datos\r\n        return\r\n      }\r\n    },\r\n    estadoMenu(){\r\n      let me = this;\r\n      localStorage.setItem('menuSelect',me.filtro)\r\n      var divs = document.querySelectorAll(\".submenutitle\");\r\n      for (var i = 0; i < divs.length; i++) {\r\n        divs[i].classList.remove(\"active\");\r\n      }\r\n      const container = document.querySelector(\".menu\"+me.filtro);\r\n      container.classList.add(\"active\");\r\n    },\r\n    ver_pedido(item){\r\n      let me = this\r\n      this.$store.dispatch('setPedido',item)\r\n      localStorage.setItem(\"id_periodo_selected\", this.id_periodo)\r\n      localStorage.setItem(\"nombre_periodo_selected\", this.nombre_periodo)\r\n      localStorage.setItem(\"contrato_generado\", item.contrato_generado)\r\n      localStorage.setItem(\"pedido_desde_admin\", 'activo')\r\n      me.$emit('showPedido',1)\r\n      // this.$router.push('/pedidos/administrador/'+item.id_pedido)\r\n    },\r\n    SolicitarVerificacion(tr){\r\n      let me = this;\r\n      if(tr.id_pedido == null || tr.id_pedido == \"\"){\r\n        me.$vs.notify({\r\n        text:'Su contrato no tiene pedido en plataforma',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      me.popupVerLiquidacion = true;\r\n    },\r\n    anular_pedido(item){\r\n      let me = this\r\n      me.id_pedido = item.id_pedido\r\n      me.$vs.dialog({\r\n        type: 'confirm',\r\n        color: 'danger',\r\n        title: `Confirmar`,\r\n        text: '¿Está seguro en eliminar este pedido?',\r\n        acceptText: 'Aceptar',\r\n        cancelText: 'Cancelar',\r\n        accept: me.confirm_anular_pedido\r\n      })\r\n    },\r\n    confirm_anular_pedido(item){\r\n      let me = this\r\n      me.$vs.loading();\r\n      this.$http.get(this.$server_url+'anular_pedido_asesor/'+me.id_pedido+'/'+me.usuario.idusuario+'/'+me.pedido.contrato_generado)\r\n      .then(res => {\r\n        me.$vs.loading.close();\r\n        if(res.data.status == 0){\r\n          me.$vs.notify({\r\n            text: res.data.message,\r\n            color: 'danger',\r\n            iconPack: 'feather',\r\n            icon: 'icon-alert-triangle'\r\n          })\r\n          return\r\n        }\r\n        me.$vs.notify({\r\n          text: 'Se anulo correctamente',\r\n          color: 'success',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle'\r\n        })\r\n        me.$emit('changeRecarge',true)\r\n        // me.getPedidos()\r\n      })\r\n      .catch(function (error) {\r\n        me.$vs.notify({\r\n          text: 'No se pudo guardar',\r\n          color: 'danger',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle'\r\n        })\r\n        me.$vs.loading.close();\r\n      })\r\n    },\r\n    changeEstadoHistorico(estado){\r\n      let me = this\r\n      let formData = new FormData();\r\n      formData.append('id_pedido',  me.pedido.id_pedido);\r\n      formData.append('estado',     estado);\r\n      if(estado == 7 ) formData.append('campo','fecha_facturador_recibe_cheque')\r\n      if(estado == 8 ) formData.append('campo','fecha_envio_cheque_for_asesor')\r\n      if(estado == 10 ) formData.append('campo','fecha_que_recibe_orden_firmada')\r\n      me.$vs.loading();\r\n      this.$http.post(this.$server_url+'cambiarEstadoHistorico', formData)\r\n      .then(function (res) {\r\n        me.$vs.loading.close();\r\n        me.$emit('changeRecarge',true)\r\n        // me.getPedidos()\r\n        me.pedido = {}\r\n        me.popupEnviarCheque = false\r\n        me.popupRecibirPagare = false\r\n        me.popupRecibiCheque  = false\r\n        me.$vs.notify({\r\n          text: 'Se registro correctamente',\r\n          color: 'primary',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle'\r\n        })\r\n      })\r\n      .catch(function (error) {  me.$vs.loading.close(); })\r\n    },\r\n    //====METODOS PARA EMITIR LOS ARHIVOS\r\n    changeHandle(e){\r\n      let me = this;\r\n      me.mostrarReporte         = false\r\n      me.popupCarga             = false\r\n      me.mostrarReporteC        = false\r\n      me.mostrarReporteConvenio = false\r\n      me.mostrarPagareAsesor    = false\r\n    },\r\n    acceptAlert(){\r\n      let me = this\r\n      if(me.beneficiario == \"\" || me.beneficiario == null || me.beneficiario == undefined){\r\n        me.$vs.notify({\r\n        text:'Seleccione un beneficiario por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        me.activePrompt = true\r\n        return\r\n      }\r\n      //si es export pagare obligo a pedir un año\r\n      if(me.tipo == 4 || me.tipo == 3){\r\n        if(me.aniosAnteriorSelect == null || me.aniosAnteriorSelect == \"\" || me.aniosAnteriorSelect == undefined){\r\n          me.$vs.notify({\r\n          text:'Seleccione un año final a calcular por favor',\r\n          color:'warning',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          return\r\n        }\r\n        //EMPRESA\r\n        if(me.empresaSelected == \"\" || me.empresaSelected == null || me.empresaSelected == undefined){\r\n          me.$vs.notify({\r\n          text:'Seleccione una empresa por favor',\r\n          color:'warning',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          me.activePrompt = true\r\n          return\r\n        }\r\n      }\r\n      //si es convenio obligatorio seleccionar el año que empieza el convenio\r\n      if(me.tipo == 3){\r\n        if(me.anioEmpieza == null || me.anioEmpieza == \"\" || me.anioEmpieza == undefined){\r\n          me.$vs.notify({\r\n          text:'Seleccione el año que comienza el convenio por favor',\r\n          color:'warning',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          return\r\n        }\r\n      }\r\n      me.id_beneficiario_pedido = me.beneficiario.id_beneficiario_pedido\r\n      me.popupCarga                              = true\r\n      if(me.tipo == 1) me.mostrarReporte         = true\r\n      if(me.tipo == 2) me.mostrarReporteC        = true\r\n      if(me.tipo == 3) me.mostrarReporteConvenio = true\r\n      if(me.tipo == 4) me.mostrarPagareAsesor    = true\r\n    },\r\n    chooseBeneficiarioPedido(tr,tipo){\r\n      let me            = this;\r\n      me.getBeneficiarios(tr.id_pedido)\r\n      me.getEmpresas()\r\n      me.tipo           = tipo\r\n      me.contrato       = tr.contrato_generado\r\n      me.activePrompt   = true\r\n    },\r\n    generarReportePdfContrato(tr,tipo){\r\n      let me = this;\r\n      if(tr.contrato_generado == \"null\" || tr.contrato_generado == null || tr.contrato_generado == \"\" || tr.contrato_generado == undefined){\r\n        me.$vs.notify({\r\n          text: \"No se puede visualizar el reporte del contrato porque no tiene código de contrato\",\r\n          color: 'warning',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle',\r\n          time:7000\r\n        })\r\n        return\r\n      }\r\n      me.getBeneficiarios(tr.id_pedido)\r\n      me.tipo             = tipo\r\n      me.activePrompt     = true\r\n      me.contrato         = tr.contrato_generado\r\n    },\r\n    getBeneficiarios(pedido){\r\n      let me = this\r\n      me.arregloBeneficiarios = []\r\n      me.beneficiario         = ''\r\n      this.$http.get(this.$server_url+'get_beneficiarios_pedidos/'+pedido)\r\n      .then(res => {\r\n        me.arregloBeneficiarios = res.data\r\n      })\r\n    },\r\n    getEmpresas(){\r\n      let me = this\r\n      me.arrayEmpresas   = []\r\n      me.empresaSelected = ''\r\n      this.$http.get(this.$server_url+'empresa/')\r\n      .then(res => {\r\n        me.arrayEmpresas = res.data\r\n      })\r\n    },\r\n    close(){\r\n      this.$vs.notify({\r\n        color:'danger',\r\n        title:'Mensaje',\r\n        text:'Has cancelado la generación del reporte!'\r\n      })\r\n    },\r\n    //====FIN METODOS PARA EMITIR ARCHIVOS\r\n    //metodos para alcance\r\n    verAlcance(tr){\r\n      let me = this;\r\n      this.$store.dispatch('setPedido',tr)\r\n      me.$emit('showPedido',2)\r\n    },\r\n    //====METODOS PARA VERIFICACIONES========\r\n    VerVerificaciones(tr){\r\n      let me = this\r\n      if(tr.id_pedido == null || tr.id_pedido == \"\"){\r\n        me.$vs.notify({\r\n        text:'Su contrato no tiene pedido en plataforma',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      me.menu = 2\r\n    },\r\n    openConfirmLiquidar(){\r\n      let me = this\r\n      this.$vs.dialog({\r\n        type:'confirm',\r\n        color: 'danger',\r\n        title: `Confirmar`,\r\n        acceptText:'Si, deseo realizar la liquidación',\r\n        text: `Estás seguro de liquidar el contrato ${ me.pedido.contrato_generado }?`,\r\n        accept:this.LiquidarContrato\r\n      })\r\n    },\r\n    LiquidarContrato(){\r\n      let me  =this;\r\n      me.$vs.loading()\r\n      this.$http.get(this.$server_url+'nliquidacion/liquidar/'+me.pedido.contrato_generado)\r\n        .then(function (res) {\r\n          me.$vs.loading.close()\r\n          if(res.data.status == '0'){\r\n            me.$vs.notify({\r\n            text:res.data.message,\r\n            color:'danger',\r\n            iconPack: 'feather',\r\n            icon:'icon-check'})\r\n            return\r\n          }else{\r\n            me.$emit('changeRecarge',true)\r\n            me.$vs.notify({\r\n            text:'Se realizo la liquidación correctamente',\r\n            color:'success',\r\n            iconPack: 'feather',\r\n            icon:'icon-check'})\r\n          }\r\n        })\r\n        .catch(function (error) {\r\n          me.$vs.loading.close()\r\n          console.log(error + ' error');\r\n        })\r\n    },\r\n    /**\r\n     * Calcula el total de la venta real de contratos.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    getTotalVentaRealContratos() {\r\n      let me = this;\r\n      if(me.usuario.id_group == 11){\r\n        me.totalRealContratos = 0\r\n        me.$http.get(this.$server_url+`pedigo_Pagos?getVentaRealXAsesor=1&idAsesor=${me.usuario.idusuario}&idPeriodo=${me.id_periodo}`)\r\n        .then(function (res) {\r\n          let datos = res.data\r\n          if(datos.length>0){\r\n            datos.forEach(element => {\r\n              me.totalRealContratos += element.TotalVentaReal\r\n            });\r\n          }\r\n        })\r\n      }\r\n    },\r\n    //====FIN METODOS PARA VERIFICACIONES====\r\n    //====METODOS PARA EXCEL=====\r\n    //para limipiar los campos del excel\r\n    clearFields() {\r\n      this.fileName = ''\r\n      this.cellAutoWidth = true\r\n      this.selectedFormat = 'xls'\r\n    },\r\n    //metodo par descargar el excel\r\n    exportToExcel() {\r\n      let me = this\r\n      let predatos = []\r\n      predatos    = me.codigoSelected\r\n      //aumentar una propiedad llamada comisionAsesor en el array de predatos con un map\r\n      predatos.map(function(item){\r\n        let TotalVentaReal = 0\r\n        let valorDescuento = 0\r\n        let ven_neta       = 0\r\n        let waitTotalVentaReal = 0\r\n        //venta real\r\n        waitTotalVentaReal  = item.TotalVentaReal\r\n        console.log(\"uno\",waitTotalVentaReal)\r\n        console.log(\"dos\",waitTotalVentaReal.toFixed(2))\r\n        if(item.TotalVentaReal == null || item.TotalVentaReal == \"\"){ item.TotalVentaReal = 0 ;  }\r\n        else                                            { TotalVentaReal = item.TotalVentaReal.toFixed(2); }\r\n        //valorDescuento\r\n        if(item.valorDescuento == null || item.valorDescuento == \"\"){ item.valorDescuento = 0 ;  }\r\n        else                                            { valorDescuento = item.valorDescuento.toFixed(2); }\r\n        //ven_neta\r\n        if(item.ven_neta == null || item.ven_neta == \"\"){ item.ven_neta = 0 ;  }\r\n        else                                            { ven_neta = item.ven_neta.toFixed(2); }\r\n        let prevalores   = 0\r\n        //venta neta\r\n        if(item.ven_neta == null || item.ven_neta == \"\"){ item.venta = 0 ;  }\r\n        else                                            { prevalores = (item.ven_neta * 0.02).toFixed(2); }\r\n        item.comisionAsesor = prevalores\r\n        item.TotalVentaReal = TotalVentaReal\r\n        item.valorDescuento = valorDescuento\r\n        item.ven_neta       = ven_neta\r\n      })\r\n      //array final\r\n      console.log(\"uwu\",predatos)\r\n      let headerTitle = []; let headerVal = [];\r\n      //para exportar los pedidos\r\n      if(me.tipoExportacion == 0){\r\n        headerTitle = [\r\n          'Contrato',\r\n          'Tipo de venta' ,\r\n          'Asesor',\r\n          'Cédula asesor',\r\n          'Institución',\r\n          'Ciudad',\r\n          'Fecha envio',\r\n          'Fecha entrega',\r\n          'Total unidades',\r\n          'Venta bruta',\r\n          'Venta Real',\r\n          'Comisión',\r\n          'Anticipo aprobado',\r\n          'Estado'\r\n        ];\r\n        headerVal = [\r\n          'contrato_generado',\r\n          'tipo_venta_descr',\r\n          'responsable',\r\n          'cedula',\r\n          'nombreInstitucion',\r\n          'nombre_ciudad',\r\n          'fecha_envio',\r\n          'fecha_entrega',\r\n          'total_unidades',\r\n          'total_venta',\r\n          'TotalVentaReal',\r\n          'descuento',\r\n          'anticipo_aprobado',\r\n          'estadoPedido'\r\n        ];\r\n      }\r\n      //para exportar el reporte de venta\r\n      if(me.tipoExportacion == 1){\r\n        headerTitle = [\r\n          'CONTRATO',\r\n          'ASESOR',\r\n          'TIPO DE VENTA' ,\r\n          'ESTADO' ,\r\n          'CATEGORIA',\r\n          'ESTABLECIMIENTO',\r\n          'DEUDA ANTERIOR',\r\n          'DEUDA PRÓXIMA',\r\n          'VENTAS BRUTAS',\r\n          'COMISIÓN',\r\n          'VALOR DE ESCUELA',\r\n          'VENTAS NETAS',\r\n          'COMISION ASESOR 2%',\r\n          'CIUDAD',\r\n          'PERÍODO'\r\n        ];\r\n        headerVal = [\r\n          'contrato_generado',\r\n          'responsable',\r\n          'tipo_venta_descr',\r\n          '',\r\n          'tipo_descripcion',\r\n          'nombreInstitucion',\r\n          'deuda',\r\n          'totalDeudaProxima',\r\n          'TotalVentaReal',\r\n          'descuento',\r\n          'valorDescuento',\r\n          'ven_neta',\r\n          'comisionAsesor',\r\n          'nombre_ciudad',\r\n          'periodo'\r\n        ];\r\n      }\r\n      let codigoSelectedMayus = this.codigoSelected\r\n      for (var i = 0; i < codigoSelectedMayus.length; i++) {\r\n        for (var key in codigoSelectedMayus[i]) {\r\n          if (typeof codigoSelectedMayus[i][key] == \"string\") {\r\n              codigoSelectedMayus[i][key] = codigoSelectedMayus[i][key].toUpperCase();\r\n          }\r\n        }\r\n      }\r\n      import('@/vendor/Export2Excel').then(excel => {\r\n        const list = codigoSelectedMayus\r\n        const data = this.formatJson(headerVal, list)\r\n        excel.export_json_to_excel({\r\n            header: headerTitle,\r\n            data,\r\n            filename: this.fileName,\r\n            autoWidth: this.cellAutoWidth,\r\n            bookType: this.selectedFormat\r\n        })\r\n        this.clearFields()\r\n        this.guardarActivo = '';\r\n        this.generarActivo = ' ';\r\n        this.textAlertCant = '';\r\n        this.cantidad = '';\r\n        this.codigoSelected = [];\r\n        })\r\n    },\r\n    formatJson(filterVal, jsonData) {\r\n      return jsonData.map(v => filterVal.map(j => {\r\n        return v[j]\r\n      }))\r\n    },\r\n    //==FIN METODOS PARA EXPORTAR EXCEL=====\r\n    tryExport(){\r\n      let me = this\r\n      if(me.codigoSelected.length == 0){\r\n        me.$vs.notify({\r\n        text:'Debe seleccionar filas de la tabla para exportar por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      me.popupExport=true\r\n    },\r\n    //==METODOS PARA FILTRO FECHAS===\r\n    filtrarFechas(){\r\n      let me = this;\r\n      me.tmpPedidos = []\r\n      if(me.fechaSelect == null || me.fechaSelect == \"\" || me.fechaSelect == undefined){\r\n        me.tmpPedidos = me.tmparregloFiltroFecha\r\n        return\r\n      }\r\n      //fecha envio\r\n      if(me.tipoFecha == 0){\r\n        me.tmpPedidos = me.tmparregloFiltroFecha.filter(p => p.f_fecha_envio == me.fechaSelect)\r\n        return\r\n      }\r\n      //fecha entrega\r\n      if(me.tipoFecha == 1){\r\n        me.tmpPedidos = me.tmparregloFiltroFecha.filter(p => p.f_fecha_entrega == me.fechaSelect)\r\n        return\r\n      }\r\n    },\r\n    //===METODOS NOTIFICAR REVISION==\r\n    notificarPedido(notificados){\r\n      let me = this;\r\n      let formData = new FormData();\r\n      formData.append('changeRevisonNotificacion','yes')\r\n      formData.append('id_pedido',                me.pedido.id_pedido);\r\n      formData.append('notificados',              notificados);\r\n      me.$vs.loading()\r\n      this.$http.post(this.$server_url+'actualizarPedido', formData)\r\n      .then(function (res) {\r\n        me.$vs.loading.close()\r\n        me.$vs.notify({\r\n          text: res.data.message,\r\n          color: 'primary',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle'\r\n        })\r\n        me.recargarPedidos()\r\n      })\r\n      .catch(function (error) {  me.$vs.loading.close() })\r\n    },\r\n    //==FIN METODOS NOTIFICAR REVISION===\r\n    recargarPedidos(){\r\n      let me = this;\r\n      me.$emit('changeRecarge',true)\r\n      me.popupVerLiquidacion = false\r\n      me.popupEntregarPedido = false\r\n    },\r\n    ///====METODOS ASESOR====\r\n    //METODOS PARA GENERAR UN NUEVO PEDIDO A PARTIR DE UN PEDIDO ANULADO\r\n    ConfirmgenerarNuevoPedido(tr){\r\n    let me = this;\r\n    this.$vs.dialog({\r\n      type:'confirm',\r\n      color: 'danger',\r\n      title: `Confirmar`,\r\n      acceptText:'Aceptar',\r\n      cancelText:'Cancelar',\r\n      text: 'Estas seguro de generar un nuevo pedido con los mismos datos',\r\n      accept:this.generarNuevoPedido\r\n    })\r\n  },\r\n  generarNuevoPedido(){\r\n    let me = this;\r\n    let formData = new FormData();\r\n    formData.append('id_pedido',            0);\r\n    formData.append('pedidoAnterior',       me.pedido.id_pedido);\r\n    formData.append('tipo_venta',           me.pedido.tipo_venta);\r\n    formData.append('tipo_venta_descr',     me.pedido.tipo_venta_descr);\r\n    formData.append('fecha_envio',          me.pedido.fecha_envio);\r\n    formData.append('fecha_entrega',        me.pedido.fecha_entrega);\r\n    formData.append('institucion',          me.pedido.id_institucion);\r\n    formData.append('periodo',              me.pedido.id_periodo);\r\n    formData.append('descuento',            me.pedido.descuento);\r\n    formData.append('anticipo',             me.pedido.anticipo);\r\n    formData.append('id_asesor',            me.pedido.id_asesor);\r\n    formData.append('observacion',          me.pedido.observacion);\r\n    if(me.pedido.imagen == 'undefined'){\r\n      formData.append('imagen',             \"\");\r\n    }else{\r\n      formData.append('imagen',               me.pedido.imagen);\r\n    }\r\n    formData.append('ifanticipo',           me.pedido.ifanticipo);\r\n    formData.append('convenio_anios',       me.pedido.convenio_anios)\r\n    formData.append('anticipo_aprobado',    0)\r\n    formData.append('ifagregado_anticipo_aprobado', 0)\r\n    formData.append('id_responsable',       me.pedido.id_responsable)\r\n    formData.append('generarNuevo',         'yes')\r\n    me.$vs.loading()\r\n    this.$http.post(this.$server_url+'pedidos',formData)\r\n    .then(res => {\r\n    me.$vs.loading.close()\r\n    if(res.data.status == 0){\r\n      me.$vs.notify({\r\n      text:res.data.message,\r\n      color:'danger',\r\n      iconPack: 'feather',\r\n      icon:'icon-check'})\r\n      return\r\n    }\r\n    me.$vs.notify({\r\n      text:'Se genero un nuevo pedido correctamente',\r\n      color:'success',\r\n      iconPack: 'feather',\r\n      icon:'icon-check'})\r\n    })\r\n    me.recargarPedidos()\r\n  },\r\n  filtrarDecimal2(numero){\r\n    let me = this\r\n    //o o null o si no es numero\r\n    if(numero == 0 || numero == null || isNaN(numero)){\r\n        return numero\r\n    }else{\r\n      var numeroRedondeado = numero;\r\n      // Reemplazar el punto decimal con una coma\r\n      var numeroConComa = numeroRedondeado.replace('.', ',');\r\n      return numeroConComa;\r\n    }\r\n  },\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.header-sidebar {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  width: 100%;\r\n  h4 {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    width: 100%;\r\n    > button {\r\n      margin-left: 10px;\r\n    }\r\n  }\r\n}\r\n.active{\r\n  font-weight: bold;\r\n  color:#269CE3;\r\n  background-color: #F0F5F9;\r\n  padding:2px 0px;\r\n  border-radius: 5px;\r\n}\r\n.menutitle{\r\n  font-weight: bold;\r\n  font-size: 17px;\r\n}\r\n.submenu{\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-top: 5px;\r\n}\r\n.submenutitle{\r\n  padding: 5px 0px;\r\n  margin-top: 8px;\r\n  cursor: pointer;\r\n  transition: 0.2s ease-in all;\r\n  font-size: 12px;\r\n}\r\n.submenutitle:hover{\r\n  text-decoration: underline;\r\n  color:#41A7E5;\r\n}\r\n.fade-in {\r\n  opacity: 1;\r\n  animation-name: fadeInOpacity;\r\n  animation-iteration-count: 1;\r\n  animation-timing-function: ease-in;\r\n  animation-duration: 0.2s;\r\n}\r\n@keyframes fadeInOpacity {\r\n  0% {\r\n    opacity: 0;\r\n  }\r\n  50% {\r\n    opacity: 0.7;\r\n  }\r\n  100% {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n</style>\r\n"]}]}