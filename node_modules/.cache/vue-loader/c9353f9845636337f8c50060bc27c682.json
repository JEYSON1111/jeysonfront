{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\usuarios\\tipos\\Usuarios.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\usuarios\\tipos\\Usuarios.vue","mtime":1712682816662},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nimport vSelect from 'vue-select'\r\nimport 'vue-select/dist/vue-select.css';\r\nimport registro from '../agrega_usuario.vue'\r\nimport Datepicker from 'vuejs-datepicker'\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport moment from 'moment'\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport asignarLibrosVue from '../../institucion/components/asignarLibros.vue';\r\nimport visitasUsuario from './components/visitasUsuario.vue'\r\nimport editarUsuarioVue from './components/editarUsuario.vue';\r\nimport AsignarDocumentosVue from '@/views/nee_documentos/components/AsignarDocumentos'\r\nexport default {\r\n    components:{\r\n      'v-select': vSelect,\r\n      registro,\r\n      flatPickr,\r\n      asignarLibrosVue,\r\n      visitasUsuario,\r\n      editarUsuarioVue,\r\n      AsignarDocumentosVue,\r\n    },\r\n    data() {\r\n        return {\r\n            popupAsignacion:false,\r\n            op_agregar: 0,\r\n            popupVistaUsuarios:false,\r\n            popupCursosEstudiantes:false,\r\n            popupLibrosEstudiantes:false,\r\n            valorBusqueda:\"2\",\r\n            codigosLibros:[],\r\n            estudiantesCursos : [],\r\n            estudiantesCodigos :[],\r\n            busqueda:\"usuario\",\r\n            estudiantes:[],\r\n            usuario:{\r\n                razonBusqueda:\"\",\r\n            },\r\n            popupActivo:false,\r\n            instituciones:[],\r\n            usuarios:{\r\n                idusuario:\"\",\r\n                cedula:\"\",\r\n                nombres:\"\",\r\n                apellidos:\"\",\r\n                email:\"\",\r\n                name_usuario:\"\",\r\n                telefono:\"\",\r\n                estado_idEstado:\"\",\r\n                institucion_idInstitucion:\"\",\r\n                id_group:\"\",\r\n                fecha_nacimiento:'',\r\n                cargo_id:'',\r\n                iniciales:'',\r\n                foto_user:'',\r\n                capacitador:''\r\n            },\r\n            docente: '',\r\n            listaVisitas: [],\r\n            datoU:'',\r\n            cantidad_cursos:\"\",\r\n            cursosCodigos:[],\r\n            user:[],\r\n            seleccionadas:'',\r\n            area:[],\r\n            user_institucion:'',\r\n            user_email:'',\r\n            show_inst:'',\r\n            user_nombre:'',\r\n            fromDate:null,\r\n            toDate:null,\r\n            //variables para el historico\r\n            datosHistorico:{\r\n                nombre:''\r\n            },\r\n            arregloHistorico:[],\r\n            //fin variables para el historico\r\n            periodo:{\r\n                periodo_id:0,\r\n                estado:0,\r\n                descripcion:'',\r\n            },\r\n            userRoot: false,\r\n            //VARIABLES NEE\r\n            popupAsignacionNEE:false,\r\n            userSelect:{},\r\n            arregloTemas:[],\r\n            //FIN VARIABLES NEE\r\n            userFacturadores:false,\r\n        };\r\n    },\r\n    mounted() {\r\n        let me = this;\r\n        me.user = JSON.parse(localStorage.getItem('usuario'))\r\n        me.$http.get(me.$server_url+'institucionesResportes').then(res => {\r\n            me.instituciones = res.data;\r\n        })\r\n        me.getUserRoot(me.user);\r\n        if(me.user.id_group == 22 || me.user.id_group == 23){\r\n            me.userFacturadores = true\r\n        }\r\n    },\r\n    methods:{\r\n      changeHandle(e){\r\n            let me = this\r\n            me.busquedaFiltroEstudiante();\r\n            me.popupActivo = false;\r\n        },\r\n        getUserRoot(dato) {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'permisos/' + dato.idusuario)\r\n                .then((result) => {\r\n                    if (result.data.length > 0) {\r\n                        me.userRoot = true;\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err)\r\n                })\r\n        },\r\n\r\n        //agregar usuario\r\n        agrega_nuevo_user() {\r\n            let me = this;\r\n            me.op_agregar = 1;\r\n        },\r\n        listaUsuarios(){\r\n            let me = this;\r\n            me.op_agregar = 2;\r\n        },\r\n        variableHijo(valor) {\r\n            let me = this;\r\n            me.op_agregar = valor;\r\n        },\r\n        //====METODOS NEET\r\n        irAsignacionNEE(item){\r\n          let me = this;\r\n          me.getPeriodo(item);\r\n          me.popupAsignacionNEE = true;\r\n        },\r\n        getTemas(){\r\n          let me = this\r\n          this.$http.get(this.$server_url+`neetTema?listadoTemas=yes`).then(res => {\r\n            me.arregloTemas = res.data;\r\n            })\r\n            .catch(function (error) {\r\n              console.log(error)\r\n            })\r\n        },\r\n        //asignacion del usuario docente\r\n        //FIN METODOS NEETT\r\n       irAsignacion(item) {\r\n            let me = this;\r\n            localStorage.setItem('user_select', (JSON.stringify(item)));\r\n            localStorage.setItem('show_inst', 'si'); //desde vista docentes, mostrar institucion\r\n            me.show_inst            = (localStorage.getItem('show_inst'));\r\n            me.usuarioAsignacion    = JSON.parse(localStorage.getItem('user_select'));\r\n            me.user_seleccionado    = me.usuarioAsignacion.idusuario\r\n            me.user_nombre          = me.usuarioAsignacion.nombres + ' ' + me.usuarioAsignacion.apellidos\r\n            me.user_email           = me.usuarioAsignacion.email\r\n            me.user_institucion     = item.nombreInstitucion\r\n            me.getAreaSelect();\r\n            me.getSeleccionadas();\r\n            me.getPeriodo(item);\r\n            me.popupAsignacion = true;\r\n        },\r\n         //=======METODOS PARA MODAL DE ASIGNACION DE LIBROS\r\n        getPeriodo(tr){\r\n            let me = this\r\n            this.$http.get(this.$server_url + \"institucionTraerPeriodo?institucion_id=\"+tr.institucion_idInstitucion)\r\n            .then(function (res) {\r\n                if(res.data.length == 0){\r\n                    me.periodo.periodo_id   = 0\r\n                    me.periodo.estado       = 0\r\n                    me.periodo.descripcion  = \"\"\r\n                }\r\n                let datos                   = res.data[0]\r\n                me.periodo.periodo_id       = datos.periodo\r\n                me.periodo.estado           = datos.estado\r\n                me.periodo.descripcion      = datos.descripcion\r\n            });\r\n        },\r\n        getSeleccionadas() {\r\n            let me = this;\r\n            me.$vs.loading();\r\n            let data = new FormData();\r\n            data.append('idusuario', me.user_seleccionado)\r\n            this.$http.post(this.$server_url + \"asignaturasDocent\", data)\r\n                .then(res => {\r\n                    // console.log(res.data);\r\n                    me.seleccionadas = res.data;\r\n                    // me.popupDocentes = true;\r\n                    me.$vs.loading.close();\r\n                });\r\n        },\r\n        getAreaSelect() {\r\n            let me = this;\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + \"areaSelect\").then(function (response) {\r\n                me.area = response.data.items;\r\n                // console.log(me.area);\r\n                me.$vs.loading.close();\r\n            });\r\n        },\r\n        getVisitas(tr){\r\n            let me = this;\r\n            me.datoU = tr;\r\n            me.op_agregar=3;\r\n        },\r\n        agregaAsignacion(item) {\r\n            let me = this;\r\n            let data = new FormData();\r\n            if(me.periodo.periodo_id == 0){\r\n                me.$vs.notify({time: 4000,text: 'La institución no tiene período',color: 'danger', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n                return\r\n            }\r\n            if(me.periodo.estado == 0){\r\n                me.$vs.notify({time: 4000,text: 'La institución tiene período inactivo',color: 'danger', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n                return\r\n            }\r\n            data.append('usuario_idusuario', me.user_seleccionado)\r\n            data.append('asignatura_idasignatura', item.id)\r\n            this.$http.post(this.$server_url + \"asignar_asignatura_docentes\", data)\r\n                .then(function (res) {\r\n                    // console.log(res.data);\r\n                    if (res.data > 0) {\r\n                        me.$vs.notify({\r\n                            time: 7000,\r\n                            text: 'Esta asignatura ya se encuentra asignada al docente',\r\n                            color: 'danger',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-alert-triangle'\r\n                        })\r\n                    } else {\r\n                        me.$vs.notify({\r\n                            text: 'Asignatura agregada',\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-check'\r\n                        })\r\n                        me.getSeleccionadas();\r\n                    }\r\n                    me.$vs.loading.close();\r\n                });\r\n        },\r\n        eliminaAsignacion(item) {\r\n            let me = this;\r\n            // console.log(item)\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + \"eliminaAsignacion/\" + item.idasignado)\r\n                .then(function (res) {\r\n                    // console.log(res.data);\r\n                    me.$vs.notify({\r\n                        text: item.nombreasignatura + ' eliminada',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                    me.getSeleccionadas();\r\n                    me.$vs.loading.close();\r\n                });\r\n        },\r\n        confirmaQuitar() {\r\n            let me = this;\r\n            me.popupAsignacion = false\r\n            me.$vs.dialog({\r\n                type: 'confirm',\r\n                color: 'danger',\r\n                title: 'Confirmar',\r\n                text: '¿Está seguro de eliminar este contenido?',\r\n                acceptText: 'Aceptar',\r\n                cancelText: 'Cancelar',\r\n                accept: me.f_quitarTodo,\r\n                cancel:me.f_regresar\r\n            })\r\n        },\r\n        moverPeriodoActual(){\r\n          let me = this\r\n          this.$http.get(this.$server_url+'moverAsignaturasPeriodo/'+me.user_seleccionado+'/'+me.periodo.periodo_id)\r\n            .then(function (res) {\r\n              me.$vs.notify({\r\n              text:'Se cambio correctamente',\r\n              color:'success',\r\n              iconPack: 'feather',\r\n              icon:'icon-check'})\r\n              me.getSeleccionadas();\r\n            })\r\n            .catch(function (error) {\r\n                console.log(error + ' error');\r\n            })\r\n        },\r\n        f_regresar(){\r\n            let me = this\r\n            me.popupAsignacion = true\r\n        },\r\n        f_quitarTodo() {\r\n            let me = this;\r\n            let idSelects = [];\r\n            for (let index = 0; index < me.seleccionadas.length; index++) {\r\n                idSelects.push(me.seleccionadas[index].idasignado)\r\n            }\r\n            me.$vs.loading();\r\n            let data = new FormData();\r\n            data.append('idasiguser', idSelects)\r\n            this.$http.post(this.$server_url + \"quitaTodasAsignaturas\", data)\r\n                .then(function (res) {\r\n                    // console.log(res.data);\r\n                     me.$vs.notify({\r\n                        text: 'Asignaturas quitadas correctamente.',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                    me.getSeleccionadas();\r\n                    me.$vs.loading.close();\r\n                });\r\n        },\r\n        //=======FIN DE METODOS PARA MODAL DE ASIGNACION DE LIBROS\r\n        busquedaFiltroEstudiante(){\r\n            let me = this;\r\n            me.estudiantesCursos = [];\r\n            me.arregloHistorico  = [];\r\n            if(me.usuario.razonBusqueda.length < 5){\r\n                me.$vs.notify({\r\n                text:'Minimo 5 caracteres de busqueda',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false;\r\n            }\r\n            me.$vs.loading();\r\n            if(me.user.id_group == 11){\r\n                //PARA LOS ASESORES\r\n                this.$http.get(this.$server_url+'busquedaFiltroEstudiante?busqueda='+me.busqueda+'&razonBusqueda='+me.usuario.razonBusqueda+'&asesor=yes')\r\n                .then(function (res) {\r\n                     me.$vs.loading.close()\r\n                     if(res.data.status == '0'){\r\n                        me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color:'primary',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                        return false;\r\n                    }else{\r\n                        me.estudiantesCursos = res.data\r\n                    }\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n            }else{\r\n                //para los administradores\r\n                this.$http.get(this.$server_url+'busquedaFiltroEstudiante?busqueda='+me.busqueda+'&razonBusqueda='+me.usuario.razonBusqueda)\r\n                .then(function (res) {\r\n                     me.$vs.loading.close()\r\n                     if(res.data.status == '0'){\r\n                        me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color:'primary',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                        return false;\r\n                    }else{\r\n                        var datos = res.data\r\n                        if(me.userFacturadores){\r\n                            datos  = res.data.filter(p => p.id_group != 1)\r\n                        }\r\n                        me.estudiantesCursos = datos\r\n                    }\r\n                    if(me.estudiantesCursos.length == 0){\r\n                        me.$vs.notify({\r\n                        text: 'No se encontro resultados',\r\n                        color:'primary',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                    }\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n            }\r\n        },\r\n        //historico de cambios instituciones\r\n        getHistoricoChangeInstitucion(tr){\r\n            let me = this;\r\n            me.arregloHistorico = []\r\n            me.datosHistorico.nombre = tr.nombres + \" \" + tr.apellidos\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url+'gestionEstudiante?getHistorico=yes&idusuario='+tr.idusuario)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    if(res.data.length == 0){\r\n                        me.$vs.notify({\r\n                        text: 'No hay historico del estudiante',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                        return false;\r\n                    }\r\n                    me.arregloHistorico = res.data\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        //editar\r\n        getEdit(data={}){\r\n            let me = this;\r\n            console.log(data)\r\n            me.usuarios = data\r\n        },\r\n        //para ver los libros de los estudiantes\r\n        verLibrosEstudiante(idusuario,institucion_idInstitucion){\r\n            let me = this;\r\n            me.$vs.loading();\r\n            let libro = \"yes\"\r\n            this.$http.get(this.$server_url+'busquedaFiltroEstudiante?libroEstudiante='+libro + '&idusuario='+idusuario +'&institucion='+institucion_idInstitucion)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    me.codigosLibros = res.data.codigos;\r\n                    me.popupLibrosEstudiantes = true;\r\n                   if(res.data.message){\r\n                          me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-user'\r\n                    })\r\n                   }\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n      //para ver los cursos de los estudiantes\r\n      verCursos(idusuario){\r\n          let me = this;\r\n          me.$vs.loading();\r\n          let busquedaCurso = \"yes\"\r\n          this.$http.get(this.$server_url+'busquedaFiltroEstudiante?busquedaCurso='+busquedaCurso + '&idusuario='+idusuario)\r\n          .then(function (res) {\r\n              me.$vs.loading.close()\r\n              me.cantidad_cursos = res.data.cantidad[0].cantidad_cursos;\r\n              me.cursosCodigos = res.data.codigos;\r\n              me.popupCursosEstudiantes = true;\r\n          })\r\n          .catch(function (error) {\r\n              console.log(error + ' error');\r\n              me.$vs.loading.close()\r\n          })\r\n      },\r\n      openConfirmResetear(){\r\n      this.$vs.dialog({\r\n        type:'confirm',\r\n        color: 'danger',\r\n        title: `Confirmar`,\r\n        acceptText:'Si, deseo resetear',\r\n        cancelText:'Cancelar',\r\n        text: 'Estas seguro de resetear el password?',\r\n        accept:this.generarPassword\r\n      })\r\n      },\r\n      generarPassword(tr) {\r\n        let me = this;\r\n        let formData = new FormData();\r\n        this.$vs.loading({\r\n            background: this.backgroundLoading,\r\n            color: this.colorLoading,\r\n            container: \"#button-with-loading\",\r\n            scale: 0.45\r\n        })\r\n        formData.append('email', me.userSelect.email);\r\n        this.$http.post(this.$server_url + 'restaurarPassword', formData)\r\n            .then(function (response) {\r\n                me.$vs.notify({\r\n                    text: 'Use el número de cédula para acceder al perfil del usuario.',\r\n                    color: 'success',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-lock'\r\n                })\r\n                me.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n            })\r\n            .catch(function (error) {\r\n                me.$vs.notify({\r\n                    text: 'Error en el proceso',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-lock'\r\n                })\r\n                me.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n            })\r\n      },\r\n    }\r\n}\r\n",{"version":3,"sources":["Usuarios.vue"],"names":[],"mappings":";AAoVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Usuarios.vue","sourceRoot":"src/views/usuarios/tipos","sourcesContent":["<template>\r\n    <div>\r\n    <br>\r\n        <div v-if=\"op_agregar==0\" >\r\n            <vs-card v-if=\"user.id_group == 1 || user.id_group == 11 || user.id_group == 23 || user.id_group == 22\">\r\n                <vs-row vs-justify=\"flex-start\">\r\n                    <vs-col type=\"flex\" vs-justify=\"flex-start\" vs-align=\"flex-start\" class=\"m-2\" vs-w=\"12\">\r\n                        <div class=\"flex\">\r\n                            <vs-button type=\"border\" icon-pack=\"feather\" icon=\"icon-user-plus\" @click=\"agrega_nuevo_user()\">\r\n                                Agregar usuario\r\n                            </vs-button>\r\n                        </div>\r\n                        <br/>\r\n                        <p>Filtro de busquedas</p>\r\n                        <br>\r\n                        <vs-card>\r\n                            <div style=\"\">\r\n                                <vs-input class=\"w-full\" @keyup.enter=\"busquedaFiltroEstudiante()\" icon-after=\"true\" label-placeholder=\"icon-after\" style=\"margin:0px 0px 20px 0px;\"  icon=\"search\" placeholder=\"Ingrese el criterio de busqueda\"  v-model=\"usuario.razonBusqueda\"/>\r\n                            </div>\r\n                            <div style=\"\">\r\n                                <ul class=\"leftx\" style=\"display:flex;margin:0px 0px 0px 20px;\">\r\n                                    <li class=\"modelx\">\r\n                                    </li>\r\n                                    <li style=\"margin:10px 20px 0px 0px;\">\r\n                                    <vs-radio vs-name=\"radios1\" vs-value=\"0\" v-model=\"valorBusqueda\" @input=\"busqueda='email'\">Email</vs-radio>\r\n                                    </li>\r\n                                    <li style=\"margin:10px 10px 0px 0px;\">\r\n                                    <vs-radio vs-name=\"radios1\" vs-value=\"1\" v-model=\"valorBusqueda\"  @input=\"busqueda='cedula'\">Cedula</vs-radio>\r\n                                    </li>\r\n                                    <li style=\"margin:10px 10px 0px 0px;\">\r\n                                    <vs-radio vs-name=\"radios1\" vs-value=\"2\" v-model=\"valorBusqueda\"  @input=\"busqueda='usuario'\">Usuario</vs-radio>\r\n                                    </li>\r\n                                    <li>\r\n                                        <vs-button color=\"warning\" type=\"filled\" style=\"margin-left:10px;\" @click=\"busquedaFiltroEstudiante();\" icon=\"search\"></vs-button>\r\n                                    </li>\r\n                                </ul>\r\n                            </div>\r\n                        </vs-card>\r\n                    </vs-col>\r\n                </vs-row>\r\n                <vs-row>\r\n                    <vs-col  type=\"flex\" vs-justify=\"flex-start\" vs-align=\"flex-start\" class=\"m-2\" vs-w=\"12\">\r\n                        <vs-table max-items=\"3\"  pagination :data=\"estudiantesCursos\">\r\n                        <template slot=\"thead\">\r\n                            <vs-th style=\"width:40%;\">Datos Personales</vs-th>\r\n                            <vs-th style=\"width:10%;\">Perfil</vs-th>\r\n                            <vs-th style=\"width:20%;\">Accion</vs-th>\r\n                        </template>\r\n                        <template slot-scope=\"{data}\">\r\n                            <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\" >\r\n                                <vs-td>\r\n                                    {{ tr.idusuario }}\r\n                                    <br/>\r\n                                    Nombres:\r\n                                    <br>\r\n                                    <span style=\"font-weight:600;\">\r\n                                    {{ tr.nombres }} {{ tr.apellidos }}<br>\r\n                                    </span>\r\n                                    usuario:\r\n                                    <br>\r\n                                    <span style=\"font-weight:600;\">\r\n                                    {{ tr.name_usuario }}<br>\r\n                                    </span>\r\n                                    Clave:\r\n                                    <br>\r\n                                    <span style=\"font-weight:600;\">\r\n                                    {{ tr.cedula }}<br>\r\n                                    </span>\r\n                                    Email:\r\n                                    <br>\r\n                                    <span style=\" font-weight:600;\">\r\n                                    {{ tr.email }}<br>\r\n                                    </span>\r\n                                    Institucion:\r\n                                    <br>\r\n                                    <span  style=\"font-weight:600;\">\r\n                                    {{ tr.nombreInstitucion }}<br>\r\n                                    </span>\r\n                                    Cargo:\r\n                                    <br>\r\n                                    <span  style=\"font-weight:600;\">\r\n                                    {{ tr.cargo }}<br>\r\n                                    </span>\r\n                                    <template>\r\n                                        <div v-if=\"tr.estado_idEstado == 1\" style=\"margin-top:-10px\">\r\n                                            <vs-chip color=\"primary\">\r\n                                                <p>Activo</p>\r\n                                            </vs-chip>\r\n                                        </div>\r\n                                        <div v-else>\r\n                                            <vs-chip color=\"danger\">\r\n                                                <p>Desactivado</p>\r\n                                            </vs-chip>\r\n                                        </div>\r\n                                    </template>\r\n                                </vs-td>\r\n                                <vs-td>\r\n                                    {{ tr.perfil }}\r\n                                   <vs-chip v-if=\"tr.change_password == 0 && tr.fecha_change_password == null\" color=\"primary\">Contraseña actualizada</vs-chip>\r\n                                   <vs-chip v-if=\"tr.capacitador == 1\" color=\"success\">Capacitador</vs-chip>\r\n                                </vs-td>\r\n                                <vs-td align=\"center\">\r\n                                    <vs-dropdown vs-custom-content vs-trigger-click>\r\n                                        <vs-button class=\"a-icons\" href.prevent icon=\"more_vert\" type=\"border\"></vs-button>\r\n                                        <vs-dropdown-menu style=\"width: 250px;\" class=\"cursor\">\r\n                                            <div v-if=\"userRoot || user.id_group == 11 || user.id_group == 1\">\r\n                                              <!--VER CURSOS ESTUDIANTE-->\r\n                                              <vs-dropdown-item v-if=\"tr.id_group == 4\">\r\n                                                  <vs-button color=\"success\" type=\"line\"   class=\"w-full\" @click=\"verCursos(tr.idusuario)\">Ver cursos estudiante</vs-button>\r\n                                              </vs-dropdown-item>\r\n                                              <!--VER LIBROS ESTUDIANTE-->\r\n                                              <vs-dropdown-item v-if=\"tr.id_group == 4\">\r\n                                                  <vs-button color=\"primary\" type=\"line\"   class=\"w-full\" @click=\"verLibrosEstudiante(tr.idusuario,tr.institucion_idInstitucion)\">Ver libros estudiante</vs-button>\r\n                                              </vs-dropdown-item>\r\n                                              <!--VER HISTORICO INSTITUCIONES-->\r\n                                              <vs-dropdown-item v-if=\"tr.id_group == 4\">\r\n                                                  <vs-button color=\"dark\" type=\"line\"   class=\"w-full\" @click=\"getHistoricoChangeInstitucion(tr)\">Ver historico instituciones</vs-button>\r\n                                              </vs-dropdown-item>\r\n                                              <!--ASIGNAR LIBROS-->\r\n                                              <vs-dropdown-item v-if=\"tr.id_group == '6' || tr.id_group == '10' || tr.id_group == '9'\">\r\n                                                  <vs-button color=\"#5E4BE5\" type=\"line\"   class=\"w-full\" @click=\"irAsignacion(tr)\">Asignar libros</vs-button>\r\n                                              </vs-dropdown-item>\r\n                                              <vs-dropdown-item>\r\n                                                <vs-button color=\"#97AADB\" type=\"line\"   class=\"w-full\" @click=\"userSelect=tr;openConfirmResetear(tr)\">Resetear password</vs-button>\r\n                                              </vs-dropdown-item>\r\n                                              <!--DOCUMENTOS NEET-->\r\n                                              <vs-dropdown-item>\r\n                                                <vs-button color=\"#569B58\" type=\"line\" class=\"w-full\" @click=\"userSelect=tr;getTemas();irAsignacionNEE(tr)\">Asignar Documentos NEE</vs-button>\r\n                                              </vs-dropdown-item>\r\n                                            </div>\r\n                                            <!--EDITAR-->\r\n                                            <vs-dropdown-item>\r\n                                                <vs-button color=\"warning\" type=\"line\" class=\"w-full\" @click=\"popupActivo=true;getEdit(tr)\">Editar</vs-button>\r\n                                            </vs-dropdown-item>\r\n                                            <!--VISITAS DEL USUARIO-->\r\n                                            <vs-dropdown-item>\r\n                                                <vs-button color=\"primary\" type=\"line\" class=\"w-full\" @click=\"getVisitas(tr)\">Visitas del usuario</vs-button>\r\n                                            </vs-dropdown-item>\r\n                                        </vs-dropdown-menu>\r\n                                    </vs-dropdown>\r\n                                </vs-td>\r\n                            </vs-tr>\r\n                        </template>\r\n                        </vs-table>\r\n                    </vs-col>\r\n                </vs-row>\r\n            </vs-card>\r\n            <vx-card>\r\n                <vs-collapse v-if=\"arregloHistorico.length > 0\">\r\n                    <vs-collapse-item>\r\n                        <div slot=\"header\">\r\n                            <p style=\"color:#2A9FF6;\"><span><i class=\"fa-solid fa-flag\"></i> Histórico del estudiante: <b>{{ datosHistorico.nombre }}</b> </span> </p>\r\n                        </div>\r\n                        <div>\r\n                            <vs-table max-items=\"5\" search pagination :data=\"arregloHistorico\">\r\n                                <template slot=\"header\">\r\n                                    <vs-chip tranparent color=\"primary\">Cantidad {{ arregloHistorico.length }}</vs-chip>\r\n                                </template>\r\n                                <template slot=\"thead\">\r\n                                    <vs-th>Editor</vs-th>\r\n                                    <vs-th>Institución Anterior</vs-th>\r\n                                    <vs-th>Institución Nueva</vs-th>\r\n                                    <vs-th>Período</vs-th>\r\n                                    <vs-th>Fecha</vs-th>\r\n                                </template>\r\n                                <template slot-scope=\"{data}\">\r\n                                    <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                                        <vs-td>\r\n                                            {{data[indextr].editor}}<br>\r\n                                        </vs-td>\r\n                                        <vs-td>\r\n                                            {{data[indextr].institucionAnterior}}<br>\r\n                                        </vs-td>\r\n                                        <vs-td>\r\n                                            {{data[indextr].institucionNueva}}<br>\r\n                                        </vs-td>\r\n                                        <vs-td>\r\n                                            {{data[indextr].periodo}}<br>\r\n                                        </vs-td>\r\n                                        <vs-td>\r\n                                            {{data[indextr].created_at}}<br>\r\n                                        </vs-td>\r\n                                    </vs-tr>\r\n                                </template>\r\n                            </vs-table>\r\n                        </div>\r\n                    </vs-collapse-item>\r\n                </vs-collapse>\r\n            </vx-card>\r\n        </div>\r\n        <div v-if=\"op_agregar==1\">\r\n            <registro @escuchar=\"variableHijo\"></registro>\r\n        </div>\r\n        <vs-card v-if=\"op_agregar == 3\">\r\n            <visitasUsuario @escuchar=\"variableHijo\" :datoU=\"datoU\"/>\r\n        </vs-card>\r\n        <!--Modal de Editar-->\r\n        <vs-popup class=\"editpop\"  fullscreen title=\"Editar\" :active.sync=\"popupActivo\">\r\n            <editarUsuarioVue @saveChange=\"changeHandle\" :usuarios=\"usuarios\" :instituciones=\"instituciones\"/>\r\n        </vs-popup>\r\n        <!-- MODAL PARA LOS CURSOS DE ESTUDIANTES -->\r\n        <vs-popup class=\"holamundo\"  title=\"Cursos del estudiante\" :active.sync=\"popupCursosEstudiantes\">\r\n            <vs-list>\r\n                <vs-chip color=\"primary\">\r\n                    Cantidad de Cursos {{ cantidad_cursos }}\r\n                </vs-chip>\r\n                <br><br>\r\n                <vs-list-header color=\"success\" title=\"Codigos de cursos\"></vs-list-header>\r\n                <vs-list-item :key=\"index\" v-for=\"(item, index) in cursosCodigos\" :title=\"item.codigo\" ></vs-list-item>\r\n            </vs-list>\r\n         </vs-popup>\r\n        <!-- FIN MODAL PARA LOS CURSOS DE LOS ESTUDIANTES-->\r\n        <!-- MODAL PARA LOS LIBROS DE ESTUDIANTES -->\r\n        <vs-popup class=\"holamundo\"  title=\"Libros del estudiante\" :active.sync=\"popupLibrosEstudiantes\">\r\n            <vs-table max-items=\"10\" search pagination :data=\"codigosLibros\">\r\n                <template slot=\"header\">\r\n                    <vs-chip color=\"primary\">\r\n                        Cantidad de libros: {{ codigosLibros.length }}\r\n                    </vs-chip>\r\n                </template>\r\n                <template slot=\"thead\">\r\n                    <vs-th>\r\n                    Codigo\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Periodo\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Ultima actualizacion\r\n                    </vs-th>\r\n                    <vs-th>\r\n                    Datos Verificación\r\n                    </vs-th>\r\n                </template>\r\n                <template slot-scope=\"{data}\">\r\n                    <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\" >\r\n                        <vs-td :data=\"data[indextr].codigo\">\r\n                            <b>Libro:</b>\r\n                            <p>{{ tr.nombrelibro }}</p>\r\n                            <b>Código:</b>\r\n                        {{data[indextr].codigo}}\r\n                        <p style=\"font-weight:bold;\">Estado_liquidacion:</p>\r\n                        <span>{{tr.liquidacion}}</span>\r\n                        <p style=\"font-weight:bold;\">Estado:</p>\r\n                        <span>\r\n                        {{ tr.codigoEstado }}<br>\r\n                        </span>\r\n                        </vs-td>\r\n                        <vs-td :data=\"data[indextr].descripcion\">\r\n                            {{data[indextr].descripcion}}\r\n                        </vs-td>\r\n                        <vs-td :data=\"data[indextr].updated_at\">\r\n                            {{data[indextr].updated_at}}\r\n                        </vs-td>\r\n                        <vs-td>\r\n                            <span style=\" font-weight:600; \">\r\n                                <vs-chip color=\"primary\" v-if=\"tr.verif1 >0\">Verificación Nº 1</vs-chip>\r\n                                <vs-chip color=\"primary\" v-if=\"tr.verif2 >0\">Verificación Nº 2</vs-chip>\r\n                                <vs-chip color=\"primary\" v-if=\"tr.verif3 >0\">Verificación Nº 3</vs-chip>\r\n                                <vs-chip color=\"primary\" v-if=\"tr.verif4 >0\">Verificación Nº 4</vs-chip>\r\n                                <vs-chip color=\"primary\" v-if=\"tr.verif5 >0\">Verificación Nº 5</vs-chip>\r\n                                <vs-chip color=\"primary\" v-if=\"tr.verif6 >0\">Verificación Nº 6</vs-chip>\r\n                                <vs-chip color=\"primary\" v-if=\"tr.verif7 >0\">Verificación Nº 7</vs-chip>\r\n                                <vs-chip color=\"primary\" v-if=\"tr.verif8 >0\">Verificación Nº 8</vs-chip>\r\n                                <vs-chip color=\"primary\" v-if=\"tr.verif9 >0\">Verificación Nº 9</vs-chip>\r\n                                <vs-chip color=\"primary\" v-if=\"tr.verif10 >0\">Verificación Nº 10</vs-chip>\r\n                            </span>\r\n                        </vs-td>\r\n                    </vs-tr>\r\n                </template>\r\n            </vs-table>\r\n        </vs-popup>\r\n        <!-- FIN MODAL PARA LOS LIBROS DE LOS ESTUDIANTES-->\r\n        <!-- Modal para Asignacion de libros al docente-->\r\n        <vs-popup title=\"Asignacion\" fullscreen :active.sync=\"popupAsignacion\">\r\n            <vx-card>\r\n                <br/>\r\n                <div class=\"m-2\">\r\n                    <vs-list>\r\n                        <vs-list-item v-if=\"show_inst== 'si'\" title=\"Institución\" :subtitle=\"user_institucion\"></vs-list-item>\r\n                        <vs-list-item v-if=\"periodo.periodo_id > 0\" title=\"Período\" :subtitle=\"periodo.descripcion\">\r\n                           <vs-chip v-if=\"periodo.estado == 1\" color=\"success\">Activo</vs-chip>\r\n                           <vs-chip v-else color=\"danger\">Desactivado</vs-chip>\r\n                        </vs-list-item>\r\n                        <vs-list-item title=\"Nombre\" :subtitle=\"user_nombre\"></vs-list-item>\r\n                        <vs-list-item title=\"Email\" :subtitle=\"user_email\"></vs-list-item>\r\n                    </vs-list>\r\n                    <vs-divider color=\"success\">Areas seleccionadas ( {{seleccionadas.length}} ) </vs-divider>\r\n                    <vs-collapse>\r\n                        <vs-collapse-item icon-pack=\"feather\" icon-arrow=\"icon-arrow-down\">\r\n                            <div slot=\"header\">\r\n                                Ver ( {{seleccionadas.length}} )\r\n                            </div>\r\n                            <div class=\"vx-row\">\r\n                                <div class=\"vx-col sm:w-full text-right\" v-if=\"seleccionadas.length >1\">\r\n                                    <vs-button type=\"border\" color=\"danger\" size=\"small\" @click=\"confirmaQuitar()\">Quitar todas <span class=\"feather icon icon-trash\"></span></vs-button>\r\n                                    <vs-button type=\"filled\" color=\"primary\" size=\"small\" @click=\"moverPeriodoActual()\" class=\"ml-2\">Mover a período actual<span class=\"feather icon icon-check\"></span></vs-button>\r\n                                  </div>\r\n                                <div class=\"vx-col sm:w-full\">\r\n                                    <div v-for=\"(item, index) in seleccionadas\" :key=\"index\" class=\"m-1 p-1 asig-select text-dark\">\r\n                                      {{item.nombreasignatura}} ( {{ item.periodoescolar }} )&nbsp; &nbsp;\r\n                                        <vs-button @click=\"eliminaAsignacion(item)\" style=\"display:inline\" size=\"small\" color=\"danger\" radius type=\"border\" icon-pack=\"feather\" icon=\"icon-trash\"></vs-button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </vs-collapse-item>\r\n                    </vs-collapse>\r\n                </div>\r\n                <div class=\"m-2\">\r\n                    <vs-divider color=primary> Areas ( {{area.length}} ) </vs-divider>\r\n                    <vs-collapse>\r\n                        <vs-collapse-item icon-pack=\"feather\" icon-arrow=\"icon-arrow-down\" v-for=\"(listItem, index) in area\" :key=\"index\" :title=\"listItem.name\">\r\n                            <div slot=\"header\">\r\n                                {{listItem.name}}\r\n                            </div>\r\n                            <vs-button v-for=\"(listIAsig, indexAsig) in listItem.children\" :key=\"indexAsig\" type=\"border\" color=\"primary\" class=\"p-2 m-1\" @click=\"agregaAsignacion(listIAsig)\">\r\n                                {{listIAsig.name}}\r\n                            </vs-button>\r\n                        </vs-collapse-item>\r\n                    </vs-collapse>\r\n                </div>\r\n            </vx-card>\r\n        </vs-popup>\r\n        <vs-popup title=\"Asignacion Documentos NEET\" fullscreen :active.sync=\"popupAsignacionNEE\">\r\n          <vs-list>\r\n            <vs-list-item v-if=\"show_inst== 'si'\" title=\"Institución\" :subtitle=\"user_institucion\"></vs-list-item>\r\n            <vs-list-item v-if=\"periodo.periodo_id > 0\" title=\"Período\" :subtitle=\"periodo.descripcion\">\r\n              <vs-chip v-if=\"periodo.estado == 1\" color=\"success\">Activo</vs-chip>\r\n              <vs-chip v-else color=\"danger\">Desactivado</vs-chip>\r\n            </vs-list-item>\r\n            <vs-list-item title=\"Nombre\" :subtitle=\"userSelect.nombres+' '+userSelect.apellidos\"></vs-list-item>\r\n            <vs-list-item title=\"Cédula\" :subtitle=\"userSelect.cedula\"></vs-list-item>\r\n            <vs-list-item title=\"Email\" :subtitle=\"userSelect.email\"></vs-list-item>\r\n          </vs-list>\r\n          <br><br>\r\n          <AsignarDocumentosVue v-if=\"popupAsignacionNEE\" :arregloTemas=\"arregloTemas\" :userExterno=\"userSelect\" externo=\"1\"/>\r\n        </vs-popup>\r\n    </div>\r\n</template>\r\n<script>\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nimport vSelect from 'vue-select'\r\nimport 'vue-select/dist/vue-select.css';\r\nimport registro from '../agrega_usuario.vue'\r\nimport Datepicker from 'vuejs-datepicker'\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport moment from 'moment'\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport asignarLibrosVue from '../../institucion/components/asignarLibros.vue';\r\nimport visitasUsuario from './components/visitasUsuario.vue'\r\nimport editarUsuarioVue from './components/editarUsuario.vue';\r\nimport AsignarDocumentosVue from '@/views/nee_documentos/components/AsignarDocumentos'\r\nexport default {\r\n    components:{\r\n      'v-select': vSelect,\r\n      registro,\r\n      flatPickr,\r\n      asignarLibrosVue,\r\n      visitasUsuario,\r\n      editarUsuarioVue,\r\n      AsignarDocumentosVue,\r\n    },\r\n    data() {\r\n        return {\r\n            popupAsignacion:false,\r\n            op_agregar: 0,\r\n            popupVistaUsuarios:false,\r\n            popupCursosEstudiantes:false,\r\n            popupLibrosEstudiantes:false,\r\n            valorBusqueda:\"2\",\r\n            codigosLibros:[],\r\n            estudiantesCursos : [],\r\n            estudiantesCodigos :[],\r\n            busqueda:\"usuario\",\r\n            estudiantes:[],\r\n            usuario:{\r\n                razonBusqueda:\"\",\r\n            },\r\n            popupActivo:false,\r\n            instituciones:[],\r\n            usuarios:{\r\n                idusuario:\"\",\r\n                cedula:\"\",\r\n                nombres:\"\",\r\n                apellidos:\"\",\r\n                email:\"\",\r\n                name_usuario:\"\",\r\n                telefono:\"\",\r\n                estado_idEstado:\"\",\r\n                institucion_idInstitucion:\"\",\r\n                id_group:\"\",\r\n                fecha_nacimiento:'',\r\n                cargo_id:'',\r\n                iniciales:'',\r\n                foto_user:'',\r\n                capacitador:''\r\n            },\r\n            docente: '',\r\n            listaVisitas: [],\r\n            datoU:'',\r\n            cantidad_cursos:\"\",\r\n            cursosCodigos:[],\r\n            user:[],\r\n            seleccionadas:'',\r\n            area:[],\r\n            user_institucion:'',\r\n            user_email:'',\r\n            show_inst:'',\r\n            user_nombre:'',\r\n            fromDate:null,\r\n            toDate:null,\r\n            //variables para el historico\r\n            datosHistorico:{\r\n                nombre:''\r\n            },\r\n            arregloHistorico:[],\r\n            //fin variables para el historico\r\n            periodo:{\r\n                periodo_id:0,\r\n                estado:0,\r\n                descripcion:'',\r\n            },\r\n            userRoot: false,\r\n            //VARIABLES NEE\r\n            popupAsignacionNEE:false,\r\n            userSelect:{},\r\n            arregloTemas:[],\r\n            //FIN VARIABLES NEE\r\n            userFacturadores:false,\r\n        };\r\n    },\r\n    mounted() {\r\n        let me = this;\r\n        me.user = JSON.parse(localStorage.getItem('usuario'))\r\n        me.$http.get(me.$server_url+'institucionesResportes').then(res => {\r\n            me.instituciones = res.data;\r\n        })\r\n        me.getUserRoot(me.user);\r\n        if(me.user.id_group == 22 || me.user.id_group == 23){\r\n            me.userFacturadores = true\r\n        }\r\n    },\r\n    methods:{\r\n      changeHandle(e){\r\n            let me = this\r\n            me.busquedaFiltroEstudiante();\r\n            me.popupActivo = false;\r\n        },\r\n        getUserRoot(dato) {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'permisos/' + dato.idusuario)\r\n                .then((result) => {\r\n                    if (result.data.length > 0) {\r\n                        me.userRoot = true;\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err)\r\n                })\r\n        },\r\n\r\n        //agregar usuario\r\n        agrega_nuevo_user() {\r\n            let me = this;\r\n            me.op_agregar = 1;\r\n        },\r\n        listaUsuarios(){\r\n            let me = this;\r\n            me.op_agregar = 2;\r\n        },\r\n        variableHijo(valor) {\r\n            let me = this;\r\n            me.op_agregar = valor;\r\n        },\r\n        //====METODOS NEET\r\n        irAsignacionNEE(item){\r\n          let me = this;\r\n          me.getPeriodo(item);\r\n          me.popupAsignacionNEE = true;\r\n        },\r\n        getTemas(){\r\n          let me = this\r\n          this.$http.get(this.$server_url+`neetTema?listadoTemas=yes`).then(res => {\r\n            me.arregloTemas = res.data;\r\n            })\r\n            .catch(function (error) {\r\n              console.log(error)\r\n            })\r\n        },\r\n        //asignacion del usuario docente\r\n        //FIN METODOS NEETT\r\n       irAsignacion(item) {\r\n            let me = this;\r\n            localStorage.setItem('user_select', (JSON.stringify(item)));\r\n            localStorage.setItem('show_inst', 'si'); //desde vista docentes, mostrar institucion\r\n            me.show_inst            = (localStorage.getItem('show_inst'));\r\n            me.usuarioAsignacion    = JSON.parse(localStorage.getItem('user_select'));\r\n            me.user_seleccionado    = me.usuarioAsignacion.idusuario\r\n            me.user_nombre          = me.usuarioAsignacion.nombres + ' ' + me.usuarioAsignacion.apellidos\r\n            me.user_email           = me.usuarioAsignacion.email\r\n            me.user_institucion     = item.nombreInstitucion\r\n            me.getAreaSelect();\r\n            me.getSeleccionadas();\r\n            me.getPeriodo(item);\r\n            me.popupAsignacion = true;\r\n        },\r\n         //=======METODOS PARA MODAL DE ASIGNACION DE LIBROS\r\n        getPeriodo(tr){\r\n            let me = this\r\n            this.$http.get(this.$server_url + \"institucionTraerPeriodo?institucion_id=\"+tr.institucion_idInstitucion)\r\n            .then(function (res) {\r\n                if(res.data.length == 0){\r\n                    me.periodo.periodo_id   = 0\r\n                    me.periodo.estado       = 0\r\n                    me.periodo.descripcion  = \"\"\r\n                }\r\n                let datos                   = res.data[0]\r\n                me.periodo.periodo_id       = datos.periodo\r\n                me.periodo.estado           = datos.estado\r\n                me.periodo.descripcion      = datos.descripcion\r\n            });\r\n        },\r\n        getSeleccionadas() {\r\n            let me = this;\r\n            me.$vs.loading();\r\n            let data = new FormData();\r\n            data.append('idusuario', me.user_seleccionado)\r\n            this.$http.post(this.$server_url + \"asignaturasDocent\", data)\r\n                .then(res => {\r\n                    // console.log(res.data);\r\n                    me.seleccionadas = res.data;\r\n                    // me.popupDocentes = true;\r\n                    me.$vs.loading.close();\r\n                });\r\n        },\r\n        getAreaSelect() {\r\n            let me = this;\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + \"areaSelect\").then(function (response) {\r\n                me.area = response.data.items;\r\n                // console.log(me.area);\r\n                me.$vs.loading.close();\r\n            });\r\n        },\r\n        getVisitas(tr){\r\n            let me = this;\r\n            me.datoU = tr;\r\n            me.op_agregar=3;\r\n        },\r\n        agregaAsignacion(item) {\r\n            let me = this;\r\n            let data = new FormData();\r\n            if(me.periodo.periodo_id == 0){\r\n                me.$vs.notify({time: 4000,text: 'La institución no tiene período',color: 'danger', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n                return\r\n            }\r\n            if(me.periodo.estado == 0){\r\n                me.$vs.notify({time: 4000,text: 'La institución tiene período inactivo',color: 'danger', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n                return\r\n            }\r\n            data.append('usuario_idusuario', me.user_seleccionado)\r\n            data.append('asignatura_idasignatura', item.id)\r\n            this.$http.post(this.$server_url + \"asignar_asignatura_docentes\", data)\r\n                .then(function (res) {\r\n                    // console.log(res.data);\r\n                    if (res.data > 0) {\r\n                        me.$vs.notify({\r\n                            time: 7000,\r\n                            text: 'Esta asignatura ya se encuentra asignada al docente',\r\n                            color: 'danger',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-alert-triangle'\r\n                        })\r\n                    } else {\r\n                        me.$vs.notify({\r\n                            text: 'Asignatura agregada',\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-check'\r\n                        })\r\n                        me.getSeleccionadas();\r\n                    }\r\n                    me.$vs.loading.close();\r\n                });\r\n        },\r\n        eliminaAsignacion(item) {\r\n            let me = this;\r\n            // console.log(item)\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + \"eliminaAsignacion/\" + item.idasignado)\r\n                .then(function (res) {\r\n                    // console.log(res.data);\r\n                    me.$vs.notify({\r\n                        text: item.nombreasignatura + ' eliminada',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                    me.getSeleccionadas();\r\n                    me.$vs.loading.close();\r\n                });\r\n        },\r\n        confirmaQuitar() {\r\n            let me = this;\r\n            me.popupAsignacion = false\r\n            me.$vs.dialog({\r\n                type: 'confirm',\r\n                color: 'danger',\r\n                title: 'Confirmar',\r\n                text: '¿Está seguro de eliminar este contenido?',\r\n                acceptText: 'Aceptar',\r\n                cancelText: 'Cancelar',\r\n                accept: me.f_quitarTodo,\r\n                cancel:me.f_regresar\r\n            })\r\n        },\r\n        moverPeriodoActual(){\r\n          let me = this\r\n          this.$http.get(this.$server_url+'moverAsignaturasPeriodo/'+me.user_seleccionado+'/'+me.periodo.periodo_id)\r\n            .then(function (res) {\r\n              me.$vs.notify({\r\n              text:'Se cambio correctamente',\r\n              color:'success',\r\n              iconPack: 'feather',\r\n              icon:'icon-check'})\r\n              me.getSeleccionadas();\r\n            })\r\n            .catch(function (error) {\r\n                console.log(error + ' error');\r\n            })\r\n        },\r\n        f_regresar(){\r\n            let me = this\r\n            me.popupAsignacion = true\r\n        },\r\n        f_quitarTodo() {\r\n            let me = this;\r\n            let idSelects = [];\r\n            for (let index = 0; index < me.seleccionadas.length; index++) {\r\n                idSelects.push(me.seleccionadas[index].idasignado)\r\n            }\r\n            me.$vs.loading();\r\n            let data = new FormData();\r\n            data.append('idasiguser', idSelects)\r\n            this.$http.post(this.$server_url + \"quitaTodasAsignaturas\", data)\r\n                .then(function (res) {\r\n                    // console.log(res.data);\r\n                     me.$vs.notify({\r\n                        text: 'Asignaturas quitadas correctamente.',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                    me.getSeleccionadas();\r\n                    me.$vs.loading.close();\r\n                });\r\n        },\r\n        //=======FIN DE METODOS PARA MODAL DE ASIGNACION DE LIBROS\r\n        busquedaFiltroEstudiante(){\r\n            let me = this;\r\n            me.estudiantesCursos = [];\r\n            me.arregloHistorico  = [];\r\n            if(me.usuario.razonBusqueda.length < 5){\r\n                me.$vs.notify({\r\n                text:'Minimo 5 caracteres de busqueda',\r\n                color:'warning',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return false;\r\n            }\r\n            me.$vs.loading();\r\n            if(me.user.id_group == 11){\r\n                //PARA LOS ASESORES\r\n                this.$http.get(this.$server_url+'busquedaFiltroEstudiante?busqueda='+me.busqueda+'&razonBusqueda='+me.usuario.razonBusqueda+'&asesor=yes')\r\n                .then(function (res) {\r\n                     me.$vs.loading.close()\r\n                     if(res.data.status == '0'){\r\n                        me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color:'primary',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                        return false;\r\n                    }else{\r\n                        me.estudiantesCursos = res.data\r\n                    }\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n            }else{\r\n                //para los administradores\r\n                this.$http.get(this.$server_url+'busquedaFiltroEstudiante?busqueda='+me.busqueda+'&razonBusqueda='+me.usuario.razonBusqueda)\r\n                .then(function (res) {\r\n                     me.$vs.loading.close()\r\n                     if(res.data.status == '0'){\r\n                        me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color:'primary',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                        return false;\r\n                    }else{\r\n                        var datos = res.data\r\n                        if(me.userFacturadores){\r\n                            datos  = res.data.filter(p => p.id_group != 1)\r\n                        }\r\n                        me.estudiantesCursos = datos\r\n                    }\r\n                    if(me.estudiantesCursos.length == 0){\r\n                        me.$vs.notify({\r\n                        text: 'No se encontro resultados',\r\n                        color:'primary',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                    }\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n            }\r\n        },\r\n        //historico de cambios instituciones\r\n        getHistoricoChangeInstitucion(tr){\r\n            let me = this;\r\n            me.arregloHistorico = []\r\n            me.datosHistorico.nombre = tr.nombres + \" \" + tr.apellidos\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url+'gestionEstudiante?getHistorico=yes&idusuario='+tr.idusuario)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    if(res.data.length == 0){\r\n                        me.$vs.notify({\r\n                        text: 'No hay historico del estudiante',\r\n                        color:'warning',\r\n                        iconPack: 'feather',\r\n                        icon:'icon-check'})\r\n                        return false;\r\n                    }\r\n                    me.arregloHistorico = res.data\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        //editar\r\n        getEdit(data={}){\r\n            let me = this;\r\n            console.log(data)\r\n            me.usuarios = data\r\n        },\r\n        //para ver los libros de los estudiantes\r\n        verLibrosEstudiante(idusuario,institucion_idInstitucion){\r\n            let me = this;\r\n            me.$vs.loading();\r\n            let libro = \"yes\"\r\n            this.$http.get(this.$server_url+'busquedaFiltroEstudiante?libroEstudiante='+libro + '&idusuario='+idusuario +'&institucion='+institucion_idInstitucion)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    me.codigosLibros = res.data.codigos;\r\n                    me.popupLibrosEstudiantes = true;\r\n                   if(res.data.message){\r\n                          me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-user'\r\n                    })\r\n                   }\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n      //para ver los cursos de los estudiantes\r\n      verCursos(idusuario){\r\n          let me = this;\r\n          me.$vs.loading();\r\n          let busquedaCurso = \"yes\"\r\n          this.$http.get(this.$server_url+'busquedaFiltroEstudiante?busquedaCurso='+busquedaCurso + '&idusuario='+idusuario)\r\n          .then(function (res) {\r\n              me.$vs.loading.close()\r\n              me.cantidad_cursos = res.data.cantidad[0].cantidad_cursos;\r\n              me.cursosCodigos = res.data.codigos;\r\n              me.popupCursosEstudiantes = true;\r\n          })\r\n          .catch(function (error) {\r\n              console.log(error + ' error');\r\n              me.$vs.loading.close()\r\n          })\r\n      },\r\n      openConfirmResetear(){\r\n      this.$vs.dialog({\r\n        type:'confirm',\r\n        color: 'danger',\r\n        title: `Confirmar`,\r\n        acceptText:'Si, deseo resetear',\r\n        cancelText:'Cancelar',\r\n        text: 'Estas seguro de resetear el password?',\r\n        accept:this.generarPassword\r\n      })\r\n      },\r\n      generarPassword(tr) {\r\n        let me = this;\r\n        let formData = new FormData();\r\n        this.$vs.loading({\r\n            background: this.backgroundLoading,\r\n            color: this.colorLoading,\r\n            container: \"#button-with-loading\",\r\n            scale: 0.45\r\n        })\r\n        formData.append('email', me.userSelect.email);\r\n        this.$http.post(this.$server_url + 'restaurarPassword', formData)\r\n            .then(function (response) {\r\n                me.$vs.notify({\r\n                    text: 'Use el número de cédula para acceder al perfil del usuario.',\r\n                    color: 'success',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-lock'\r\n                })\r\n                me.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n            })\r\n            .catch(function (error) {\r\n                me.$vs.notify({\r\n                    text: 'Error en el proceso',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-lock'\r\n                })\r\n                me.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n            })\r\n      },\r\n    }\r\n}\r\n</script>\r\n"]}]}