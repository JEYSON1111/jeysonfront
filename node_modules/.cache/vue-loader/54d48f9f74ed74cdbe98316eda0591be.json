{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\salle\\administrador\\evaluaciones\\PreguntasExportar.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\salle\\administrador\\evaluaciones\\PreguntasExportar.vue","mtime":1712682816506},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport vSelect from 'vue-select'\r\nexport default{\r\n  data(){\r\n      return{\r\n        arregloPeriodos:[],\r\n        arregloAreas:[],\r\n        arregloAsignaturas:[],\r\n        arregloPreguntas:[],\r\n        periodoSelect:'',\r\n        areaSelect:'',\r\n        asignaturaSelected:'',\r\n      }\r\n  },\r\n  components:{\r\n    vSelect,\r\n  },\r\n  mounted(){\r\n    let me = this;\r\n    me.getPeriodosEvaluacion()\r\n    me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n  },\r\n  methods:{\r\n    getPeriodosEvaluacion() {\r\n      let me = this;\r\n      this.$http.get(this.$server_url+'salle/periodos')\r\n        .then(function (response) {\r\n          me.arregloPeriodos = response.data;\r\n          if(me.arregloPeriodos.length > 0){\r\n            me.periodoSelect = me.arregloPeriodos[0].id\r\n            me.getAreas()\r\n          }\r\n        })\r\n        .catch(function (error) {\r\n        })\r\n    },\r\n    getAreas(){\r\n      let me                = this\r\n      me.arregloAreas       = []\r\n      me.arregloAsignaturas = []\r\n      me.arregloPreguntas   = []\r\n      me.areaSelect         = \"\"\r\n      me.asignaturaSelected = \"\"\r\n      if(me.periodoSelect == null || me.periodoSelect == \"\" || me.periodoSelect == undefined){\r\n        me.$vs.notify({\r\n        text:'Seleccione una Evaluación Período por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      this.$http.get(this.$server_url+'areas_salle')\r\n      .then(res => {\r\n        let datos = res.data\r\n        if(datos.length > 0){\r\n          me.arregloAreas = datos.filter(p => p.n_evaluacion == me.periodoSelect)\r\n        }\r\n      })\r\n      .catch(function (error) {\r\n          console.log(error);\r\n      })\r\n    },\r\n    getAsignaturasFiltro(){\r\n      let me = this\r\n      me.arregloPreguntas    = []\r\n      me.asignaturaSelected  = \"\"\r\n      this.$http.get(this.$server_url+'asignaturas_area_salle/' + me.areaSelect)\r\n      .then(res => {\r\n        me.arregloAsignaturas = res.data;\r\n      })\r\n      .catch(function (error) {\r\n          console.log(error);\r\n      })\r\n    },\r\n    getPreguntas(tipo){\r\n      let me = this;\r\n      me.arregloPreguntas = []\r\n      //tipo => 0 = por areas; 1 = por asignaturas\r\n      if(me.areaSelect == null || me.areaSelect == \"\" || me.areaSelect == undefined){\r\n        me.$vs.notify({\r\n        text:'Seleccione una area por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      if(tipo == 1){\r\n        if(me.asignaturaSelected == null || me.asignaturaSelected == \"\" || me.asignaturaSelected == undefined){\r\n          me.$vs.notify({\r\n          text:'Seleccione una Asignatura por favor',\r\n          color:'warning',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          return\r\n        }\r\n      }\r\n      this.$http.get(this.$server_url+'salle/exportAllPreguntasXAsignatura?periodo='+me.periodoSelect+'&area='+me.areaSelect+'&asignatura='+me.asignaturaSelected+'&tipo='+tipo)\r\n        .then(function (res) {\r\n          me.arregloPreguntas = res.data\r\n        })\r\n        .catch(function (error) {\r\n          console.log(error + ' error');\r\n        })\r\n    },\r\n    ExportToDoc(){\r\n      let me = this;\r\n      if(me.periodoSelect == null || me.periodoSelect == \"\" || me.periodoSelect == undefined){\r\n        me.$vs.notify({\r\n        text:'Seleccione una Evaluación Período por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      if(me.areaSelect == null || me.areaSelect == \"\" || me.areaSelect == undefined){\r\n        me.$vs.notify({\r\n        text:'Seleccione una area por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      let getPeriodo = me.arregloPeriodos.filter(p => p.id == me.periodoSelect)\r\n      let setPeriodo = getPeriodo[0].nombre\r\n      let getArea    = me.arregloAreas.filter(p => p.id_area == me.areaSelect)\r\n      let setArea    = getArea[0].nombre_area\r\n      let filename = \"\"\r\n      filename = 'Preguntas '+setPeriodo+'_'+setArea\r\n      var HtmlHead = \"<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>\";\r\n      var EndHtml = \"</body></html>\";\r\n      //complete html\r\n      var html = HtmlHead +document.getElementById(\"MainHTML\").innerHTML+EndHtml;\r\n      //specify the type\r\n      var blob = new Blob(['\\ufeff', html], {\r\n        type: 'application/msword'\r\n      });\r\n      // Specify link url\r\n      var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);\r\n      // Specify file name\r\n      filename = filename?filename+'.doc':'document.doc';\r\n      // Create download link element\r\n      var downloadLink = document.createElement(\"a\");\r\n      document.body.appendChild(downloadLink);\r\n      if(navigator.msSaveOrOpenBlob ){\r\n        navigator.msSaveOrOpenBlob(blob, filename);\r\n      }else{\r\n        // Create a link to the file\r\n        downloadLink.href = url;\r\n        // Setting the file name\r\n        downloadLink.download = filename;\r\n        //triggering the function\r\n        downloadLink.click();\r\n      }\r\n      document.body.removeChild(downloadLink);\r\n    },\r\n  }\r\n}\r\n",{"version":3,"sources":["PreguntasExportar.vue"],"names":[],"mappings":";AAoEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PreguntasExportar.vue","sourceRoot":"src/views/salle/administrador/evaluaciones","sourcesContent":["<template>\r\n  <vx-card\r\n  title=\"Exportar preguntas del banco de preguntas\"\r\n  title-color=\"primary\"\r\n  subtitle=\"Seleccione una área para exportar por áreas o por asignaturas si desea por asignaturas\"\r\n  style=\"min-height: 100vh;\"\r\n  >\r\n    <div class=\"flex mt-5\">\r\n      <div style=\"width: 40%;\">\r\n        <p> <ion-icon name=\"contract-outline\"></ion-icon>  Filtro por Evalución período</p>\r\n      </div>\r\n      <div style=\"width: 60%;\">\r\n        <!-- idperiodoescolar -->\r\n        <v-select :options=\"arregloPeriodos\" @input=\"getAreas()\" :reduce=\"arregloPeriodos => arregloPeriodos.id\" label=\"nombre\" class=\"w-full\" v-model=\"periodoSelect\" />\r\n      </div>\r\n    </div>\r\n    <div class=\"vx-row mt-3\">\r\n      <!------------FILTROS BUSQUEDA PREGUNTAS-------------------->\r\n      <div class=\"vx-col sm:w-1/2 w-full\">\r\n        Área\r\n        <v-select :options=\"arregloAreas\" :reduce=\"arregloAreas => arregloAreas.id_area\" label=\"nombre_area\" v-model=\"areaSelect\" @input=\"getAsignaturasFiltro();getPreguntas(0)\"></v-select>\r\n      </div>\r\n      <div class=\"vx-col sm:w-1/2 w-full\">\r\n        Asignaturas\r\n        <v-select :options=\"arregloAsignaturas\" :reduce=\"arregloAsignaturas => arregloAsignaturas.id_asignatura\" label=\"nombre_asignatura\" @input=\"getPreguntas(1)\" v-model=\"asignaturaSelected\" ></v-select>\r\n      </div>\r\n      <!------------FIN FILTROS BUSQUEDA PREGUNTAS------------------->\r\n    </div>\r\n    <div v-if=\"arregloPreguntas.length > 0\" class=\"flex mt-3\">\r\n        <vs-button @click=\"ExportToDoc()\"  color=\"#3dd495\"  gradient-color-secondary=\"rgb(130, 207, 23)\" type=\"gradient\"><i class=\"fa-solid fa-download\"></i><span class=\"ml-2\">Exportar</span></vs-button>\r\n    </div>\r\n    <div id=\"MainHTML\" class=\"mt-3\" v-if=\"arregloPreguntas.length > 0\">\r\n        <div v-for=\"(tr,index) in arregloPreguntas\" :key=\"index\">\r\n          <h2 class=\"p-2 text-3xl\" style=\"color:#42E667\">Área: {{ tr.nombre_area }}</h2>\r\n            <div v-for=\"(item,index2) in tr.asignatura\" :key=\"index2\">\r\n              <h2 class=\"p-2 text-warning\" style=\"color:#D6B93A;\">Asignatura: {{ item.nombre_asignatura }}</h2>\r\n              <vs-table stripe :data=\"item.preguntas\" no-data-text=\"No hay preguntas de este tema\">\r\n                <template slot=\"thead\">\r\n                  <vs-th sort-key=\"pregunta\">Pregunta</vs-th>\r\n                  <vs-th sort-key=\"id_tipo_pregunta\">Tipo</vs-th>\r\n                </template>\r\n                <template slot-scope=\"{data}\">\r\n                  <vs-tr :data=\"tr\" :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                    <vs-td :data=\"data[indextr].pregunta.descripcion\">\r\n                      <b>{{indextr+1}}. <span v-html=\"data[indextr].pregunta.descripcion\"></span></b><br>\r\n                      <img v-if=\"data[indextr].img_pregunta!='' && data[indextr].img_pregunta!='null' && data[indextr].img_pregunta!=null\" v-bind:src=\"$data_url+'archivos/img/salle/img_preguntas/'+data[indextr].img_pregunta\" class=\"img-responsive\" width=\"50\" height=\"50\" style=\"border-radius: 5px;\">\r\n                      <div slot=\"header\">\r\n                            Opciones\r\n                      </div>\r\n                      <div class=\"mb-5\" :key=\"indexitem\" v-for=\"(item, indexitem) in data[indextr].opciones\">\r\n                        <div style=\"width: 100%; font-size: 12px; color: #0DCD88;\" v-if=\"item.tipo===1\">Respuesta correcta<br></div>\r\n                        <div style=\"width: 100%; font-size: 12px; color: #FD5858;\" v-else>Respuesta incorrecta<br></div>\r\n                        <div style=\"width: 100%\"> {{ item.opcion }}<br></div>\r\n                        <div style=\"width: 100%\" ><img v-if=\"item.img_opcion!='' && item.img_opcion!='null' && item.img_opcion!=null\" v-bind:src=\"$data_url+'archivos/img/salle/img_preguntas/'+item.img_opcion\" class=\"img-responsive\" style=\"border-radius: 5px;\" width=\"50\" height=\"50\"></div>\r\n                      </div>\r\n                    </vs-td>\r\n                    <vs-td :data=\"data[indextr].pregunta.nombre_tipo\">\r\n                      <p>{{data[indextr].pregunta.nombre_tipo}}</p>\r\n                    </vs-td>\r\n                  </vs-tr>\r\n                </template>\r\n              </vs-table>\r\n            </div>\r\n        </div>\r\n    </div>\r\n  </vx-card>\r\n</template>\r\n<script>\r\nimport vSelect from 'vue-select'\r\nexport default{\r\n  data(){\r\n      return{\r\n        arregloPeriodos:[],\r\n        arregloAreas:[],\r\n        arregloAsignaturas:[],\r\n        arregloPreguntas:[],\r\n        periodoSelect:'',\r\n        areaSelect:'',\r\n        asignaturaSelected:'',\r\n      }\r\n  },\r\n  components:{\r\n    vSelect,\r\n  },\r\n  mounted(){\r\n    let me = this;\r\n    me.getPeriodosEvaluacion()\r\n    me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n  },\r\n  methods:{\r\n    getPeriodosEvaluacion() {\r\n      let me = this;\r\n      this.$http.get(this.$server_url+'salle/periodos')\r\n        .then(function (response) {\r\n          me.arregloPeriodos = response.data;\r\n          if(me.arregloPeriodos.length > 0){\r\n            me.periodoSelect = me.arregloPeriodos[0].id\r\n            me.getAreas()\r\n          }\r\n        })\r\n        .catch(function (error) {\r\n        })\r\n    },\r\n    getAreas(){\r\n      let me                = this\r\n      me.arregloAreas       = []\r\n      me.arregloAsignaturas = []\r\n      me.arregloPreguntas   = []\r\n      me.areaSelect         = \"\"\r\n      me.asignaturaSelected = \"\"\r\n      if(me.periodoSelect == null || me.periodoSelect == \"\" || me.periodoSelect == undefined){\r\n        me.$vs.notify({\r\n        text:'Seleccione una Evaluación Período por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      this.$http.get(this.$server_url+'areas_salle')\r\n      .then(res => {\r\n        let datos = res.data\r\n        if(datos.length > 0){\r\n          me.arregloAreas = datos.filter(p => p.n_evaluacion == me.periodoSelect)\r\n        }\r\n      })\r\n      .catch(function (error) {\r\n          console.log(error);\r\n      })\r\n    },\r\n    getAsignaturasFiltro(){\r\n      let me = this\r\n      me.arregloPreguntas    = []\r\n      me.asignaturaSelected  = \"\"\r\n      this.$http.get(this.$server_url+'asignaturas_area_salle/' + me.areaSelect)\r\n      .then(res => {\r\n        me.arregloAsignaturas = res.data;\r\n      })\r\n      .catch(function (error) {\r\n          console.log(error);\r\n      })\r\n    },\r\n    getPreguntas(tipo){\r\n      let me = this;\r\n      me.arregloPreguntas = []\r\n      //tipo => 0 = por areas; 1 = por asignaturas\r\n      if(me.areaSelect == null || me.areaSelect == \"\" || me.areaSelect == undefined){\r\n        me.$vs.notify({\r\n        text:'Seleccione una area por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      if(tipo == 1){\r\n        if(me.asignaturaSelected == null || me.asignaturaSelected == \"\" || me.asignaturaSelected == undefined){\r\n          me.$vs.notify({\r\n          text:'Seleccione una Asignatura por favor',\r\n          color:'warning',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          return\r\n        }\r\n      }\r\n      this.$http.get(this.$server_url+'salle/exportAllPreguntasXAsignatura?periodo='+me.periodoSelect+'&area='+me.areaSelect+'&asignatura='+me.asignaturaSelected+'&tipo='+tipo)\r\n        .then(function (res) {\r\n          me.arregloPreguntas = res.data\r\n        })\r\n        .catch(function (error) {\r\n          console.log(error + ' error');\r\n        })\r\n    },\r\n    ExportToDoc(){\r\n      let me = this;\r\n      if(me.periodoSelect == null || me.periodoSelect == \"\" || me.periodoSelect == undefined){\r\n        me.$vs.notify({\r\n        text:'Seleccione una Evaluación Período por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      if(me.areaSelect == null || me.areaSelect == \"\" || me.areaSelect == undefined){\r\n        me.$vs.notify({\r\n        text:'Seleccione una area por favor',\r\n        color:'warning',\r\n        iconPack: 'feather',\r\n        icon:'icon-check'})\r\n        return\r\n      }\r\n      let getPeriodo = me.arregloPeriodos.filter(p => p.id == me.periodoSelect)\r\n      let setPeriodo = getPeriodo[0].nombre\r\n      let getArea    = me.arregloAreas.filter(p => p.id_area == me.areaSelect)\r\n      let setArea    = getArea[0].nombre_area\r\n      let filename = \"\"\r\n      filename = 'Preguntas '+setPeriodo+'_'+setArea\r\n      var HtmlHead = \"<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>\";\r\n      var EndHtml = \"</body></html>\";\r\n      //complete html\r\n      var html = HtmlHead +document.getElementById(\"MainHTML\").innerHTML+EndHtml;\r\n      //specify the type\r\n      var blob = new Blob(['\\ufeff', html], {\r\n        type: 'application/msword'\r\n      });\r\n      // Specify link url\r\n      var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);\r\n      // Specify file name\r\n      filename = filename?filename+'.doc':'document.doc';\r\n      // Create download link element\r\n      var downloadLink = document.createElement(\"a\");\r\n      document.body.appendChild(downloadLink);\r\n      if(navigator.msSaveOrOpenBlob ){\r\n        navigator.msSaveOrOpenBlob(blob, filename);\r\n      }else{\r\n        // Create a link to the file\r\n        downloadLink.href = url;\r\n        // Setting the file name\r\n        downloadLink.download = filename;\r\n        //triggering the function\r\n        downloadLink.click();\r\n      }\r\n      document.body.removeChild(downloadLink);\r\n    },\r\n  }\r\n}\r\n</script>\r\n"]}]}