{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\temporadas\\temporada.vue?vue&type=style&index=0&id=12ddb01e&scoped=true&lang=css","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\temporadas\\temporada.vue","mtime":1712682816627},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n@media(max-width: 576px) {\n     .periodo {\n        width: 576px!important;\n     }\n }\n",{"version":3,"sources":["temporada.vue"],"names":[],"mappings":";AAm7BA;AACA;AACA;AACA;AACA","file":"temporada.vue","sourceRoot":"src/views/temporadas","sourcesContent":["<template>\r\n<div>\r\n    <div v-if=\"verLiquidacion == false\">\r\n        <vs-card>\r\n            <div class=\"card-title\">Filtro de Busquedas</div>\r\n            <div class=\"flex mb-4 mt-4\" style=\"flex-wrap:wrap;\">\r\n                <div class=\"w-1/5 p-2 bg-gray-400 text-center\">\r\n                    <ul class=\"leftx ml-3\" style=\"display:flex;flex-direction: row;\">       \r\n                        <li class=\"ml-2\">\r\n                        <vs-radio v-model=\"region2\"  vs-name=\"rdxRegion\" @input=\"getPeriodos2()\" vs-value=\"1\">Sierra</vs-radio>\r\n                        </li>\r\n                        <li class=\"ml-2\">\r\n                        <vs-radio v-model=\"region2\" vs-name=\"rdxRegion\" @input=\"getPeriodos2()\" vs-value=\"2\">Costa</vs-radio>\r\n                        </li>               \r\n                    </ul>\r\n                </div>\r\n                <div class=\"w-4/5 p-2 bg-gray-500 text-center periodo\" style=\"display:flex;flex-wrap:wrap;\">\r\n                    <div style=\"width:30%\">\r\n                        Seleccione el periodo\r\n                    </div>\r\n                    <v-select @input=\"tipo=1;list();\" style=\"width:70%;margin-left: 0px;\" :options=\"arregloPeriodos\" :reduce=\"arregloPeriodos => arregloPeriodos\" label=\"periodo\"  v-model=\"periodo\" />\r\n                </div>\r\n            </div>\r\n            <vs-divider></vs-divider>\r\n            <div class=\"flex mb-4\">\r\n                <div class=\"w-1/4 p-2 bg-gray-400 text-center\">Filtro por contrato</div>\r\n                <div class=\"w-3/4 p-2 bg-gray-500 text-center flex\">\r\n                    <vs-input class=\"inputx w-full\" @keyup.enter=\"tipo=2;filtroContrato();\" placeholder=\"Ingrese el contrato\" v-model=\"contrato\"/>\r\n                    <vs-button icon=\"search\" class=\"ml-2\" @click=\"tipo=2;filtroContrato();\" type=\"relief\"></vs-button>\r\n                </div>\r\n            </div>\r\n        </vs-card>\r\n        <vx-card>\r\n            <!--Modal para agregar  Temporada-->\r\n            <div class=\"centerx\">\r\n                <vs-button @click=\"update = false;openModal();getPeriodos();limpiar();\" color=\"primary\" type=\"filled\">+ Temporada</vs-button>\r\n                <vs-popup classContent=\"popup-example\" title=\"Agregar Temporadas\" :active.sync=\"popupActivo4\">\r\n                    <div class=\"vx-col w-full mt-5\">\r\n                        Ciudad:\r\n                        <v-select @input=\"filtrarInstituciones()\" :options=\"arregloCiudad\" :reduce=\"arregloCiudad => arregloCiudad\" label=\"nombre\" class=\"w-full\" v-model=\"ciudadSelect\" />\r\n                    </div>\r\n                    <div class=\"vx-col w-full mt-5\">\r\n                        Institucion:\r\n                        <v-select @input=\"filtrarProfesores()\" :options=\"arregloTraeInstitucion\" :reduce=\"arregloTraeInstitucion => arregloTraeInstitucion\" label=\"nombreInstitucion\" class=\"w-full\" v-model=\"temporada.institucion\" />\r\n                    </div>\r\n                    <vs-row class=\"mt-3\">\r\n                        <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                            <ul class=\"leftx\" style=\"display:flex;flex-direction: row;\">    \r\n                                <li class=\"ml-2\">\r\n                                <vs-radio v-model=\"region\" vs-name=\"regionAdd\" @input=\"getPeriodos()\" vs-value=\"1\">Sierra</vs-radio>\r\n                                </li>\r\n                                <li class=\"ml-2\">\r\n                                <vs-radio v-model=\"region\" vs-name=\"regionAdd\" @input=\"getPeriodos()\" vs-value=\"2\">Costa</vs-radio>\r\n                                </li>               \r\n                            </ul>\r\n                        </vs-col>\r\n                    </vs-row>\r\n                    <div class=\"vx-col w-full mt-5\">\r\n                        Seleccione el periodo:\r\n                        <v-select @input=\"verificarContratoPeriodo()\" :options=\"arregloPeriodos\" :reduce=\"arregloPeriodos => arregloPeriodos\" label=\"periodo\" class=\"w-full\" v-model=\"temporada.periodo\" />\r\n                    </div>\r\n                    <div v-if=\"bloquear == false\">\r\n                        <div class=\"vx-col w-full mt-5\">\r\n                            Profesor:(Busque por su cedula)\r\n                            <v-select :options=\"arregloTraeProfesor\" :reduce=\"arregloTraeProfesor => arregloTraeProfesor\" label=\"cedula\" class=\"w-full\" v-model=\"temporada.profesor\" />\r\n                            <br>\r\n                            <div style=\"display:flex;\">\r\n                                <div>\r\n                                    <p>Si el docente no existe </p>\r\n                                </div>\r\n                                <vs-button @click=\"popupActivo4=false;popupActivo3=true;\" style=\"margin-left: 5px;\" size=\"small\" color=\"success\" type=\"filled\">+ Docente</vs-button>\r\n                            </div>\r\n                        </div>\r\n                        <!-- {{ temporada.asesor  }} -->\r\n                        <div class=\"vx-col w-full mt-5\">\r\n                            Asesor:\r\n                            <v-select :options=\"arregloAsesores\" :reduce=\"arregloAsesores => arregloAsesores\" label=\"asesornombres\" class=\"w-full\" v-model=\"temporada.asesor\" />\r\n                        </div>\r\n                        <div class=\"vx-col w-full mt-5\">\r\n                            <label>Contrato</label>\r\n                            <vs-input class=\"inputx w-full\" name=\"contrato\" placeholder=\"Contrato\" v-model=\"temporada.contrato\" />\r\n                        </div>\r\n                        <div class=\"vx-col w-full mt-5\">\r\n                            <label>Año</label>\r\n                            <vs-input class=\"inputx w-full\" name=\"year\" placeholder=\"Año\" v-model=\"temporada.year\" />\r\n                        </div>\r\n                        <div class=\"vx-col w-full mt-5\">\r\n                            <label>temporada</label>\r\n                            <vs-input class=\"inputx w-full\" name=\"temporada\" placeholder=\"temporada\" v-model=\"temporada.temporada\" />\r\n                        </div>\r\n                        <br>\r\n                        <vs-button @click=\"agregarTemporada();\" color=\"primary\" type=\"filled\">Guardar Cambios</vs-button>\r\n                    </div>\r\n                </vs-popup>\r\n            </div>\r\n            <!--- MODAL PARA Actualizar -->\r\n            <div class=\"centerx\">\r\n                <!--Contenido del boton editar para actualizar la  temporada-->\r\n                <div>\r\n                    <vs-popup classContent=\"popup-example\" :title=\"titleModal\" fullscreen :active.sync=\"popupActivo2\">\r\n                        <div class=\"vx-col w-full mt-5\">\r\n                            <p style=\"color:red\"> (Ciudad temporal {{ temporada.ciudad }} )</p>\r\n                            Ciudad:\r\n                            <v-select @input=\"filtrarInstituciones()\" :options=\"arregloCiudad\" :reduce=\"arregloCiudad => arregloCiudad\" label=\"nombre\" class=\"w-full\" v-model=\"ciudadSelect\" />\r\n                        </div>\r\n                        <div class=\"vx-col w-full mt-5\">\r\n                            <p style=\"color:red\"> (Institucion temporal {{ temporada.instituciontemporal }} )</p>\r\n                            Institucion:\r\n                            <v-select @input=\"filtrarProfesores()\" :options=\"arregloTraeInstitucion\" :reduce=\"arregloTraeInstitucion => arregloTraeInstitucion\" label=\"nombreInstitucion\" class=\"w-full\" v-model=\"temporada.institucion\" />\r\n                        </div>\r\n                        <vs-row class=\"mt-3\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                                <ul class=\"leftx\" style=\"display:flex;flex-direction: row;\">       \r\n                                    <li class=\"ml-2\">\r\n                                    <vs-radio v-model=\"region\" vs-name=\"radiosRegionEdit\" @input=\"getPeriodos()\" vs-value=\"1\">Sierra</vs-radio>\r\n                                    </li>\r\n                                    <li class=\"ml-2\">\r\n                                    <vs-radio v-model=\"region\" vs-name=\"radiosRegionEdit\" @input=\"getPeriodos()\" vs-value=\"2\">Costa</vs-radio>\r\n                                    </li>               \r\n                                </ul>\r\n                            </vs-col>\r\n                        </vs-row>\r\n                        <div class=\"vx-col w-full mt-5\">\r\n                             Seleccione el periodo:\r\n                            <v-select @input=\"verificarContratoPeriodo()\" :options=\"arregloPeriodos\" :reduce=\"arregloPeriodos => arregloPeriodos\" label=\"periodo\" class=\"w-full\" v-model=\"temporada.periodo\" />\r\n                        </div>\r\n                        <div v-if=\"bloquear == false\"> \r\n                            <!-- {{ temporada.asesor  }} -->\r\n                            <div class=\"vx-col w-full mt-5\">\r\n                                <p style=\"color:red\"> (Nombre temporal {{ temporada.nombresasesortemporal }} )</p>\r\n                                Asesor:\r\n                                <v-select :options=\"arregloAsesores\" :reduce=\"arregloAsesores => arregloAsesores\" label=\"asesornombres\" class=\"w-full\" v-model=\"temporada.asesor\" />\r\n                            </div>\r\n                            <br>\r\n                            <div class=\"vx-col w-full mt-5\">\r\n                                <p style=\"color:red\"> (Docente temporal {{ temporada.temporal_nombre_docente }} )</p>\r\n                                <br>\r\n                                <p style=\"color:red\"> (Cedula temporal {{ temporada.cedulaprofesortemporal }} )</p>\r\n                                Profesor:(Busque por su cedula)\r\n                                <v-select :options=\"arregloTraeProfesor\" :reduce=\"arregloTraeProfesor => arregloTraeProfesor\" label=\"cedula\" class=\"w-full\" v-model=\"temporada.profesor\" />\r\n                                <br>\r\n                                <div style=\"display:flex;\">\r\n                                    <div>\r\n                                        <p>Si el docente no existe </p>\r\n                                    </div>\r\n                                    <vs-button @click=\"popupActivo2=false;popupActivo3=true;\" style=\"margin-left: 5px;\" size=\"small\" color=\"success\" type=\"filled\">+ Docente</vs-button>\r\n                                </div>\r\n                            </div>\r\n                            <br>\r\n                            <br>\r\n                            <vs-row>\r\n                                <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                                    <vs-button @click=\"agregar();\" color=\"primary\" type=\"filled\">Guardar Cambios</vs-button>\r\n                                </vs-col>\r\n                            </vs-row>\r\n                        </div>\r\n                        <div v-if=\"codigos.length > 0\">\r\n                            <vs-table max-items=\"10\" search pagination :data=\"codigos\">\r\n                                <template slot=\"header\">\r\n                                    <p>Cantidad {{ codigos.length }}  </p>\r\n                                    <p> Codigos que tiene contrato</p>   \r\n                                </template>\r\n                                <template slot=\"thead\">     \r\n                                    <vs-th>codigo</vs-th>\r\n                                    <vs-th>idusuario</vs-th>\r\n                                    <vs-th>libro</vs-th>\r\n                                    <vs-th>Periodo</vs-th>\r\n                                    <vs-th>Contrato</vs-th>\r\n                                </template>\r\n                                <template slot-scope=\"{data}\">\r\n                                    <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                                        <vs-td>\r\n                                            {{data[indextr].codigo}}<br>\r\n                                        </vs-td>\r\n                                        <vs-td>\r\n                                            {{data[indextr].idusuario}}<br>\r\n                                        </vs-td>\r\n                                        <vs-td>\r\n                                            {{ tr.libro }}\r\n                                        </vs-td>\r\n                                        <vs-td>\r\n                                            {{ tr.id_periodo }}\r\n                                        </vs-td>\r\n                                        <vs-td>\r\n                                            {{ tr.contrato }}\r\n                                        </vs-td>   \r\n                                    </vs-tr>\r\n                                </template>\r\n                            </vs-table>  \r\n                        </div>    \r\n                    </vs-popup>\r\n                </div>\r\n                <!--Modal para editar el asesor-->   \r\n                <div>\r\n                    <vs-popup classContent=\"popup-example\" title=\"Editar asesor\" :active.sync=\"popupEditarAsesor\">\r\n                        <div class=\"vx-col w-full mt-5\">   \r\n                            Asesor:\r\n                            <v-select :options=\"arregloAsesores\" :reduce=\"arregloAsesores => arregloAsesores\" label=\"asesornombres\" class=\"w-full\" v-model=\"temporada.asesor\" />\r\n                        </div>\r\n                        <br>\r\n                        <div style=\"width:100%;display:flex;justify-content:center;\">\r\n                            <div>\r\n                                <vs-button @click=\"actualizarAsesor();\" color=\"primary\" type=\"filled\">Actualizar Asesor</vs-button>\r\n                            </div>      \r\n                        </div>\r\n                    </vs-popup>\r\n                </div>\r\n            </div>\r\n            <!--Contenido del boton agregar un docente-->\r\n            <div class=\"centerx\">\r\n                <vs-popup classContent=\"popup-example\" title=\"Agregar Nuevo Docente\" :active.sync=\"popupActivo3\">\r\n                    <div class=\"vx-col w-full mt-5\">\r\n                        <label>Cedula</label>\r\n                        <vs-input class=\"inputx w-full\" name=\"cedula\" placeholder=\"cedula\" v-model=\"docente.cedula\" />\r\n                    </div>\r\n                    <div class=\"vx-col w-full mt-5\">\r\n                        <label>Nombres</label>\r\n                        <vs-input class=\"inputx w-full\" name=\"nombres\" placeholder=\"Nombres\" v-model=\"docente.nombres\" />\r\n                    </div>\r\n                    <div class=\"vx-col w-full mt-5\">\r\n                        <label>Apellidos</label>\r\n                        <vs-input class=\"inputx w-full\" name=\"apellidos\" placeholder=\"Apellidos\" v-model=\"docente.apellidos\" />\r\n                    </div>\r\n                    <div class=\"vx-col w-full mt-5\">\r\n                        <label>Email</label>\r\n                        <vs-input class=\"inputx w-full\" name=\"email\" placeholder=\"Email\" v-model=\"docente.email\" />\r\n                    </div>\r\n                    <div class=\"vx-col w-full mt-5\">\r\n                        <label>Usuario</label>\r\n                        <vs-input class=\"inputx w-full\" name=\"name_usuario\" placeholder=\"Usuario\" v-model=\"docente.name_usuario\" />\r\n                    </div>\r\n                    <div class=\"vx-col w-full mt-5\">\r\n                        Institucion:\r\n                        <v-select :options=\"arregloInstitucion\" :reduce=\"arregloInstitucion => arregloInstitucion\" label=\"nombreInstitucion\" class=\"w-full\" v-model=\"docente.institucion_idInstitucion\" />\r\n                    </div>\r\n                    <br>\r\n                    <vs-button @click=\"agregarDocente();\" color=\"primary\" type=\"filled\">Guardar Cambios</vs-button>\r\n                </vs-popup>\r\n            </div>\r\n            <!--FIN DEL CONTENIDO POPUP PARA AGREGAR UN DOCENTE -->\r\n            <!-- LISTADO DE LA TABLA TEMPORADAS-->\r\n            <div>\r\n                <vs-table max-items=\"10\" search pagination :data=\"arregloTemporada\">\r\n                    <template slot=\"header\">\r\n                        <p>\r\n                        Cantidad:  <span style=\"font-weight:bold;\">{{ arregloTemporada.length }}</span>\r\n                        </p>\r\n                    </template>\r\n                    <template slot=\"thead\">\r\n                        <vs-th>\r\n                            Contrato\r\n                        </vs-th>\r\n                        <vs-th>\r\n                            Datos Temporales\r\n                        </vs-th>\r\n                        <vs-th>\r\n                            Datos asignados\r\n                        </vs-th>\r\n                        <vs-th>\r\n                            Acciones\r\n                        </vs-th>\r\n                        <vs-th>\r\n                            Liquidación\r\n                        </vs-th>\r\n                    </template>\r\n                    <template slot-scope=\"{data}\">\r\n                        <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                            <vs-td style=\"width:20%\">\r\n                                {{data[indextr].contrato}}<br>\r\n                                <p>{{data[indextr].ciudad}} - {{data[indextr].year}}</p>   \r\n                            </vs-td>\r\n                            <vs-td style=\"width:25%\">\r\n                                <p style=\"font-weight:bold;\">Institucion:</p>\r\n                                <span>{{ data[indextr].temporal_institucion }}</span><br/>\r\n                                <p style=\"font-weight:bold;\">Docente:</p>\r\n                                <span>{{ data[indextr].temporal_nombre_docente }}</span><br/>\r\n                                <p style=\"font-weight:bold;\">Cedula docente:</p>\r\n                                <span>{{ data[indextr].temporal_cedula_docente }}</span><br/>\r\n                                <p style=\"font-weight:bold;\">Asesor:</p>\r\n                                <span>{{ data[indextr].nombre_asesor }}</span><br/>\r\n                            </vs-td>\r\n                            <vs-td  style=\"width:25%\">\r\n                                <p style=\"font-weight:bold;\">Institucion:</p>\r\n                                <span>{{ data[indextr].nombreInstitucion }}</span><br/>\r\n                                <p style=\"font-weight:bold;\">Ciudad:</p>\r\n                                <span>{{ data[indextr].ciudad_prolipa }}</span><br/>\r\n                                <p style=\"font-weight:bold;\">Periodo:</p>\r\n                                <span>{{ data[indextr].periodo }}</span><br/>\r\n                                <p style=\"font-weight:bold;\">Asesor:</p>\r\n                                <span>{{ data[indextr].asesorProlipa }}</span><br/>\r\n                                <p style=\"font-weight:bold;\">F. ultima:</p>\r\n                                <span>{{ data[indextr].updated_at }}</span><br/>\r\n                                <template v-if=\"data[indextr].estado == '1'\">\r\n                                <vs-chip color=\"primary\">\r\n                                        Activo\r\n                                    </vs-chip>\r\n                                </template>\r\n                                <template v-else>\r\n                                    <vs-chip color=\"primary\">\r\n                                        Desactivado\r\n                                    </vs-chip>\r\n                                </template>\r\n                            </vs-td>\r\n                            <vs-td>\r\n                                <div class=\"flex\">\r\n                                    <template v-if=\"tr.id_periodo == null || tr.id_periodo == 0\">\r\n                                    <vx-tooltip style=\"display: inline-block;\" text=\"editar\" position=\"top\" color=\"warning\">\r\n                                        <vs-button class=\"m-1\" icon-pack=\"feather\" icon=\"icon-edit\" color=\"warning\" size=\"small\" type=\"filled\" @click=\"update = true; openModal(data[indextr],1);\">\r\n                                        </vs-button>\r\n                                    </vx-tooltip>\r\n                                    </template>\r\n                                    <template v-if=\"tr.id_periodo !== null || tr.id_periodo !== 0\">\r\n                                    <vx-tooltip style=\"display: inline-block;\" text=\"Editar Asesor\" position=\"top\" color=\"primary\">\r\n                                        <vs-button class=\"m-1\" icon-pack=\"feather\" icon=\"icon-user\" color=\"dark\" size=\"small\" type=\"filled\" @click=\"update = true; openModal(data[indextr],2);getPeriodos()\">\r\n                                        </vs-button>\r\n                                        </vx-tooltip>\r\n                                    </template>\r\n                                    <template v-if=\"data[indextr].estado == '1'\">\r\n                                        <vx-tooltip style=\"display: inline-block;\" text=\"desactivar contrato\" position=\"top\" color=\"primary\">\r\n                                            <vs-button class=\"m-1\" icon-pack=\"feather\" icon=\"icon-bell-off\" color=\"primary\" size=\"small\" type=\"filled\" @click=\"desactivarTemporada(data[indextr].id_temporada)\">\r\n                                            </vs-button>\r\n                                        </vx-tooltip>\r\n                                    </template>\r\n                                    <template v-else>\r\n                                        <vx-tooltip style=\"display: inline-block;\" text=\"Activar contrato\" position=\"top\" color=\"success\">\r\n                                            <vs-button class=\"m-1\" icon-pack=\"feather\" icon=\"icon-check\" color=\"success\" size=\"small\" type=\"filled\" @click=\"activarTemporada(data[indextr].id_temporada)\">\r\n                                            </vs-button>\r\n                                        </vx-tooltip>\r\n                                    </template>\r\n                                    <vx-tooltip v-if=\"permisoRoot == true\" style=\"display: inline-block;\" text=\"eliminar\" position=\"top\" color=\"danger\">\r\n                                        <vs-button class=\"m-1\" icon-pack=\"feather\" icon=\"icon-trash\" color=\"danger\" size=\"small\" type=\"filled\" @click=\"openConfirm(tr)\"></vs-button>\r\n                                    </vx-tooltip>\r\n                                </div>\r\n                            \r\n                            </vs-td>\r\n                            <vs-td>\r\n                                <template v-if=\"data[indextr].id_profesor ==0  && data[indextr].id_asesor ==0 && data[indextr].idInstitucion ==0\">\r\n                                    <p style=\"color:red\">Agregue los ids</p>\r\n                                </template>\r\n                                <template v-else>\r\n                                    <vx-tooltip style=\"display: inline-block;\" text=\"Generar liquidación\" position=\"top\" color=\"rgb(134, 4, 98)\">\r\n                                        <vs-button class=\"m-1\" icon-pack=\"feather\" icon=\"icon-layers\" color=\"rgb(134, 4, 98)\" @click=\"irAshowLiquidacion(data[indextr].contrato)\" size=\"small\" type=\"filled\"></vs-button>\r\n                                    </vx-tooltip>\r\n                                </template>\r\n                            </vs-td>\r\n                        </vs-tr>\r\n                    </template>\r\n                </vs-table>\r\n            </div>\r\n        </vx-card>\r\n    </div>\r\n    <vs-card v-else>\r\n        <vs-button icon=\"reply\" color=\"success\" @click=\"verLiquidacion = false;\" type=\"relief\">Regresar</vs-button>\r\n        <showliquidacion :contratoLiquidacion=\"contratoLiquidacion\"/>\r\n    </vs-card>\r\n</div>\r\n</template>\r\n<script>\r\nimport axios from 'axios'\r\nimport moment from 'moment'\r\nimport vSelect from 'vue-select'\r\nimport showliquidacion from \"./showliquidacion.vue\";\r\nexport default {\r\n    data: () => ({\r\n        usuario:[],\r\n        update: true,\r\n        id: 0,\r\n        titleModal: '',\r\n        // para el select de libros\r\n        arregloAsesores: [],\r\n        // arreglorProfesores: [],\r\n        arregloInstitucion: [],\r\n        //para traer las ciudades\r\n        arregloCiudad: [],\r\n        //arreglo para filtrar las instituciones por ciudades\r\n        arregloTraeInstitucion: [],\r\n        //arreglo para filtar los profesores por institucion\r\n        arregloTraeProfesor: [],\r\n        //para el select de la ciudades\r\n        ciudadSelect: '',\r\n        /*Modal identificadores a cada modal*/\r\n        popupActivo2: false,\r\n        popupActivo3: false,\r\n        popupActivo4: false,\r\n        popupEditarAsesor:false,\r\n        //arreglo para la tabla temporada\r\n        arregloTemporada: [],\r\n        //objeto para guardar el valor de los inputs,select etc \r\n        temporada: {\r\n            contrato: '',\r\n            year: '',\r\n            ciudad: '',\r\n            temporada: '',\r\n            profesor: '',\r\n            cedulaprofesor: '',\r\n            asesor: '',\r\n            institucion: '',\r\n            //para el modal de editar que se muestre la cedula del profesor para que el administrador pueda copiar y buscar en el select\r\n            temporal_nombre_docente: '',\r\n            cedulaprofesortemporal: '',\r\n            nombresasesortemporal: '',\r\n            instituciontemporal: '',\r\n            periodo:'',\r\n        },\r\n        //objeto para guardar el valor de los inputs,select etc de la tabla docentes\r\n        docente: {\r\n            cedula: '',\r\n            nombres: '',\r\n            apellidos: '',\r\n            email: '',\r\n            name_usuario: '',\r\n            institucion_idInstitucion: '',\r\n        },\r\n        //Para el showliquidacion\r\n        fecha: '',\r\n        liquidacionArreglo: [],\r\n        arregloPeriodos:[],\r\n        bloquear:true,\r\n        codigos:[],\r\n        contratoLiquidacion:'',\r\n        verLiquidacion:false,\r\n        //variables para filtro\r\n        periodo:'',\r\n        region2:'2',\r\n        region:'2',\r\n        contrato:'',\r\n        tipo:'1',\r\n        //fin variables para filtro,\r\n        permisoRoot:false,\r\n        temporada_id:0,\r\n    }),\r\n    components: {\r\n        'v-select': vSelect,\r\n        showliquidacion,\r\n    },\r\n    watch:{\r\n        contrato(){\r\n            let me = this;\r\n            me.periodo = \"\"\r\n            me.arregloTemporada = []\r\n        }\r\n    },\r\n    methods: {\r\n        //para obtener el listado de los usuarios root\r\n        getUserRoot() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url+'permisos?permiso=yes&usuario_id='+me.usuario.idusuario)\r\n                .then(function (res) {\r\n                    if(res.data.status == '1'){\r\n                        me.permisoRoot = true\r\n                    }else{\r\n                        me.permisoRoot = false\r\n                    }\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                })\r\n        },\r\n        verificarContratoPeriodo(){\r\n            let me = this;\r\n             this.$http.get(this.$server_url+'validarContrato?institucion_id='+me.temporada.institucion.idInstitucion+'&periodo_id='+me.temporada.periodo.idperiodoescolar)\r\n                .then(function (res) {\r\n                    me.$vs.loading.close()\r\n                    if(res.data.status == 0){\r\n                        me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check',\r\n                        time:8000,\r\n                        })\r\n                        me.bloquear = true\r\n                        me.codigos = res.data.codigos\r\n                        return false\r\n                    }\r\n                    if(res.data.status == 1){\r\n                        me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                        })\r\n                        me.bloquear = false\r\n                    }\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        fechaActual() {\r\n            var fecha = moment().format('YYYY/MM/DD');\r\n            this.fecha = fecha;\r\n        },\r\n        openConfirm(tr){\r\n            let me = this;\r\n            me.temporada_id = tr.id_temporada\r\n            this.$vs.dialog({\r\n                type:'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: 'Al aceptar BORRARA todas las verificaciones si tuviera',\r\n                accept:this.eliminarTemporada\r\n            })\r\n        },\r\n        //eliminar temporada\r\n        eliminarTemporada() {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            formData.append('id_temporada', me.temporada_id);\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'temporadas/eliminar', formData)\r\n                .then(res => {\r\n                    me.listarTemporadas();\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: 'Temporada  eliminada y contrato',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                })\r\n        },\r\n        // lista de asesores para usar en el select\r\n        listaAsesores() {\r\n            let me = this\r\n            this.$http.get(this.$server_url + 'temporadas?asesores=yes').then(res => {\r\n                    me.arregloAsesores = res.data;\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        //lista de profesores para usar en el select\r\n        // listaProfesores() {\r\n        //     let me = this\r\n        //     me.$vs.loading()\r\n        //     this.$http.get(this.$server_url + `temporadas`).then(res => {\r\n        //             me.arreglorProfesores = res.data.profesores;\r\n        //             me.$vs.loading.close()\r\n        //         })\r\n        //         .catch(function (error) {\r\n        //             console.log(error)\r\n        //         })\r\n        // },\r\n        //lista de instituciones para usar en el select\r\n        // listaInstituciones() {\r\n        //     let me = this\r\n        //     this.$http.get(this.$server_url + `temporadas`).then(res => {\r\n        //             me.arregloInstitucion = res.data.listainstitucion;\r\n        //             me.arregloCiudad = res.data.ciudad;\r\n        //         })\r\n        //         .catch(function (error) {\r\n        //             console.log(error)\r\n        //         })\r\n        // },\r\n        //lista de ciudades para usar en el select\r\n        listaCiudades() {\r\n            let me = this\r\n            this.$http.get(this.$server_url + `temporadas`).then(res => {\r\n                    me.arregloCiudad = res.data.ciudad;\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        //lista de ciudades para usar en el select\r\n        getPeriodos() {\r\n            let me = this\r\n            this.$http.get(this.$server_url + 'periodo?porAllEstados=yes&region='+me.region).then(res => {\r\n                    me.arregloPeriodos = res.data;\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        getPeriodos2() {\r\n            let me = this\r\n            me.contrato = \"\"\r\n            me.arregloTemporada = []\r\n            this.$http.get(this.$server_url + 'periodo?porAllEstados=yes&region='+me.region2).then(res => {\r\n                    me.arregloPeriodos = res.data;\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        //listar Temporadas\r\n        list(){\r\n            let me = this;\r\n            me.arregloTemporada = []\r\n            me.contrato = \"\"\r\n            if(me.periodo == null || me.periodo == undefined || me.periodo == \"\"){\r\n                me.$vs.notify({\r\n                    text: 'Seleccione un periodo',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })    \r\n                return\r\n            }\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'getTemporadas?periodo_id='+me.periodo.idperiodoescolar+'&temporada=yes').then(res => {\r\n                    this.arregloTemporada = res.data;\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        listarTemporadas(){\r\n            let me = this;\r\n            if(me.tipo == 1){\r\n                me.list()\r\n            }else{\r\n                me.filtroContrato()\r\n            }\r\n        },\r\n          //listar Temporadas\r\n        filtroContrato(){\r\n            let me = this;\r\n            me.arregloTemporada = []\r\n            if(me.contrato.length < 2){\r\n                me.$vs.notify({\r\n                    text: 'Ingrese mas de 3 caracteres',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })    \r\n                return    \r\n            }\r\n            if(me.contrato.trim() == \"\"){\r\n                me.$vs.notify({\r\n                    text: 'Debe escribir un contrato',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })    \r\n                return\r\n            }\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'getTemporadas?contrato='+me.contrato+'&filtroContrato=yes').then(res => {\r\n                    this.arregloTemporada = res.data;\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        // desactivar el estado de la tabla \r\n        desactivarTemporada(id_temporada) {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            formData.append('id_temporada', id_temporada);\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'temporadas/desactivar', formData)\r\n                .then(res => {\r\n                    me.listarTemporadas();\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: 'Temporada  actualizada',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                })\r\n        },\r\n        activarTemporada(id_temporada) {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            formData.append('id_temporada', id_temporada);\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'temporadas/activar', formData)\r\n                .then(res => {\r\n                    me.listarTemporadas();\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: 'Temporada  actualizada',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                })\r\n        },\r\n        //para actualizar temporada\r\n        agregar() {\r\n            //datos para guardar\r\n            let me = this;\r\n            let formData = new FormData();\r\n            if (me.update) {\r\n                formData.append('id', me.id);\r\n            }\r\n            /*Fin de enviar el backend el id */\r\n            formData.append('contrato', me.temporada.contrato);\r\n            formData.append('year', me.temporada.year);\r\n            formData.append('ciudad', me.temporada.ciudad);\r\n            formData.append('temporada', me.temporada.temporada);\r\n            formData.append('id_asesor', me.temporada.asesor.idusuario);\r\n            formData.append('cedula_asesor', me.temporada.asesor.cedula);\r\n            formData.append('id_profesor', me.temporada.profesor.idusuario);\r\n            formData.append('idInstitucion', me.temporada.institucion.idInstitucion);\r\n            formData.append('periodo',me.temporada.periodo.idperiodoescolar);\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'temporadas', formData)\r\n                .then(res => {\r\n                    me.listarTemporadas();\r\n                    me.popupActivo4 = false;\r\n                    me.popupActivo2 = false;\r\n                    me.limpiar()\r\n                    me.$vs.loading.close()\r\n                     me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'primary',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    this.bloquear = true\r\n                })\r\n        },\r\n        actualizarAsesor(){\r\n              //actualizar al asesor r\r\n            let me = this;\r\n            let formData = new FormData();\r\n            if (me.update) {\r\n                formData.append('id', me.id);\r\n            }\r\n            formData.append('contrato', me.temporada.contrato);\r\n            formData.append('id_asesor', me.temporada.asesor.idusuario);\r\n            formData.append('cedula_asesor', me.temporada.asesor.cedula);\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'temporadas?editarAsesor=yes&contrato='+me.temporada.contrato+'&id_asesor='+me.temporada.asesor.idusuario+'&cedula_asesor='+me.temporada.asesor.cedula)\r\n                .then(res => {\r\n                    me.listarTemporadas();\r\n                    me.popupEditarAsesor = false\r\n                    me.$vs.loading.close()\r\n                     me.$vs.notify({\r\n                        text: res.data.message,\r\n                        color: 'primary',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    this.temporada.asesor = '';\r\n                    this.temporada.profesor = '';\r\n                    this.temporada.institucion = '';\r\n                    this.bloquear = true\r\n\r\n                })\r\n                .catch(error =>{\r\n                     me.$vs.loading.close()\r\n                })\r\n        },\r\n        //para agregar temporada\r\n        agregarTemporada() {\r\n            //datos para guardar\r\n            let me = this;\r\n            let formData = new FormData();\r\n            /* idusuario enviar al backend para la auditoria */\r\n            // formData.append('id_asesor', me.temporada.asesor.idusuario);\r\n            formData.append('contrato', me.temporada.contrato);\r\n            formData.append('year', me.temporada.year);\r\n            formData.append('ciudad', me.ciudadSelect.nombre);\r\n            formData.append('temporada', me.temporada.temporada);\r\n            formData.append('id_profesor', me.temporada.profesor.idusuario);\r\n            formData.append('temporal_cedula_docente', me.temporada.profesor.cedula);\r\n            formData.append('temporal_nombre_docente', me.temporada.profesor.profesornombres);\r\n            formData.append('idInstitucion', me.temporada.institucion.idInstitucion);\r\n            formData.append('temporal_institucion', me.temporada.institucion.nombreInstitucion);\r\n            formData.append('id_asesor', me.temporada.asesor.idusuario);\r\n            formData.append('cedula_asesor', me.temporada.asesor.cedula);\r\n            formData.append('nombre_asesor', me.temporada.asesor.asesornombres);\r\n            formData.append('periodo',me.temporada.periodo.idperiodoescolar)\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'temporadas', formData)\r\n                .then(res => {\r\n                    me.contrato = me.temporada.contrato\r\n                    me.tipo = 2\r\n                    me.listarTemporadas();\r\n                    me.popupActivo4 = false;\r\n                    me.popupActivo2 = false;\r\n                    me.limpiar()\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: 'Temporada guardada  exitosamente',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    });\r\n                })\r\n        },\r\n        agregarDocente() {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            // formData.append('id_asesor', me.temporada.asesor.idusuario);\r\n            formData.append('cedula', me.docente.cedula);\r\n            formData.append('nombres', me.docente.nombres);\r\n            formData.append('apellidos', me.docente.apellidos);\r\n            formData.append('email', me.docente.email);\r\n            formData.append('name_usuario', me.docente.name_usuario);\r\n            formData.append('institucion_idInstitucion', me.docente.institucion_idInstitucion.idInstitucion);\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'temporadas/docente', formData)\r\n                .then(res => {\r\n                    // me.listaProfesores();\r\n                    me.$vs.loading.close()\r\n                    me.$vs.notify({\r\n                        text: 'Docente guardado  exitosamente',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    });\r\n\r\n                })\r\n        },\r\n        //cuando abre el modal  se le agre lo siguiente\r\n        openModal(data,condicion) {\r\n          let me = this;\r\n            if (this.update) {\r\n                if(condicion == 1){  \r\n                    this.popupActivo2 = true;\r\n                }\r\n                //para editar solo el asesor\r\n                else{\r\n                    this.popupEditarAsesor = true;\r\n                    me.temporada.asesor = {idusuario:data.id_asesor, nombres:data.asesorProlipa};\r\n                }\r\n                this.id = data.id_temporada;\r\n                this.titleModal = 'Editar contrato '+data.contrato \r\n                // this.titleModal = \"Modificar Temporada\";\r\n                //llenar los datos base de datos en los inputs para editar\r\n                this.temporada.contrato = data.contrato;\r\n                this.temporada.year = data.year;\r\n                this.temporada.ciudad = data.ciudad;\r\n                this.temporada.temporada = data.temporada;\r\n                this.temporada.temporal_nombre_docente = data.temporal_nombre_docente;\r\n                this.temporada.cedulaprofesortemporal = data.temporal_cedula_docente;\r\n                this.temporada.nombresasesortemporal = data.nombre_asesor;\r\n                this.temporada.instituciontemporal = data.temporal_institucion;\r\n                // this.temporada.profesor = {idusuario:data.idusuarios, nombres:data.profesor, apellidos:data.papellido};\r\n                // this.temporada.institucion = {idInstitucion:data.idInstitucion, nombreInstitucion:data.nombreInstitucion};\r\n            } else {\r\n                this.popupActivo4 = true;\r\n                this.id = 0;\r\n                this.titleModal = \"Crear Temporada\";\r\n            }\r\n        },\r\n        limpiar(){\r\n            let me = this;\r\n            me.temporada.asesor                     = \"\"\r\n            me.temporada.profesor                   = \"\"\r\n            me.temporada.institucion                = \"\"\r\n            me.temporada.periodo                    = \"\"\r\n            me.ciudadSelect                         = \"\"\r\n            this.temporada.contrato                 = \"\"\r\n            this.temporada.year                     = \"\"\r\n            this.temporada.ciudad                   = \"\"\r\n            this.temporada.temporada                = \"\"\r\n            this.temporada.temporal_nombre_docente  = \"\"\r\n            this.temporada.cedulaprofesortemporal   = \"\"\r\n            this.temporada.nombresasesortemporal    = \"\"\r\n            this.temporada.instituciontemporal      = \"\"\r\n        },\r\n        //LIQUIDACIONES\r\n        irAshowLiquidacion(contrato) {\r\n            let me = this;\r\n            me.contratoLiquidacion = contrato\r\n            me.verLiquidacion = true\r\n            // me.$vs.loading()\r\n            // this.$http.get(this.$server_url + 'temporadas/liquidacion/' + contratoLiquidacion)\r\n            //     .then(res => {\r\n            //         console.log(res)\r\n            //         this.liquidacionArreglo = res.data;\r\n            //         localStorage.setItem(\"liquidacionArreglo\", JSON.stringify(this.liquidacionArreglo));\r\n            //         me.$router.push('/showliquidacion/');\r\n            //         me.$vs.loading.close()\r\n            //     })\r\n        },\r\n        //para filtrar instituciones por ciudades\r\n        filtrarInstituciones() {\r\n            let me = this;\r\n            if (me.ciudadSelect.idciudad === undefined) {\r\n                me.$vs.notify({\r\n                    text: 'Seleccione una ciudad antes de filtrar por Instituciones',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })\r\n                return;\r\n            }\r\n            me.arregloTraeInstitucion = []\r\n            me.$vs.loading()\r\n            const formData = new FormData();\r\n            formData.append('ciudad_id', me.ciudadSelect.idciudad);\r\n            this.$http.post(this.$server_url + 'traerinstituciones', formData)\r\n            .then(res => {\r\n                me.arregloTraeInstitucion = res.data;\r\n                me.$vs.loading.close()\r\n            })\r\n            .catch(function (error) {\r\n                console.log(error);\r\n            })\r\n        },\r\n        //para filtrar instituciones por ciudades\r\n        filtrarProfesores() {\r\n            let me = this;\r\n            if (me.temporada.institucion.idInstitucion === undefined) {\r\n                me.$vs.notify({\r\n                    text: 'Seleccione una institucion antes de filtrar por profesores',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })\r\n                return;\r\n            }\r\n            me.arregloTraeProfesor = []\r\n            me.$vs.loading()\r\n            const formData = new FormData();\r\n            formData.append('idInstitucion', me.temporada.institucion.idInstitucion);\r\n            this.$http.post(this.$server_url + 'traerprofesor', formData).then(res => {\r\n                me.arregloTraeProfesor = res.data;\r\n                me.$vs.loading.close()\r\n            })\r\n            .catch(function (error) {\r\n                console.log(error);\r\n            })\r\n        },\r\n    },\r\n    created() {\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n        //para se carguen al cargar la pagina\r\n        this.fechaActual();\r\n        // this.list();\r\n        this.listaCiudades();\r\n        this.listaAsesores();\r\n        this.getPeriodos2();\r\n        this.getUserRoot();\r\n    }\r\n}\r\n</script>\r\n<style scoped>\r\n   @media(max-width: 576px) {\r\n        .periodo {\r\n           width: 576px!important;\r\n        }\r\n    }\r\n</style>\r\n"]}]}