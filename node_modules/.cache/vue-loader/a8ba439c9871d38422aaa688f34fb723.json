{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\asesor\\admin\\components\\planificacionAsesor.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\asesor\\admin\\components\\planificacionAsesor.vue","mtime":1712682815513},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport moduleCalendar from '@/store/calendar2/moduleCalendar.js'\r\nimport vSelect from 'vue-select'\r\nimport moment from 'moment'\r\nimport Datepicker from 'vuejs-datepicker'\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport {\r\n    en,\r\n    he\r\n} from 'vuejs-datepicker/src/locale'\r\nexport default {\r\n\r\n    data() {\r\n      return{\r\n        institucionesProlipa:[],\r\n        institucionesTemporales:[],\r\n        abrirModal:false,\r\n         //VARIABLES DE AGREGAR PLANIFICACION\r\n\r\n          popupFiltroInstitucion:false,\r\n            error: false,\r\n            messageError: \"\",\r\n            ciudadSelect: '',\r\n            popupAddNuevaInstitucion: false,\r\n            seleccionadoInsitucion: false,\r\n            nombreInstitucion: '',\r\n            busquedaInstitucion: \"\",\r\n            instituciones: [],\r\n            popupaddInstitucion: false,\r\n            opciones: {\r\n                presentacion: false,\r\n                entrega_muestras: false,\r\n                reunion: false,\r\n                seguimiento: false,\r\n                cierre: false,\r\n                cobranza: false,\r\n                post_venta: false,\r\n                retiro_cartas: false,\r\n                retiro_muestras: false,\r\n                sinSello: true,\r\n                editorial: '',\r\n                otraEditorial: false,\r\n            },\r\n\r\n            usuario: [],\r\n            showDate: new Date(),\r\n            disabledFrom: false,\r\n            titulo: '',\r\n            id: 0,\r\n            title: '',\r\n            startDate: '',\r\n            endDate: '',\r\n            labelLocal: {\r\n                text: 'Baja',\r\n                color: 'success'\r\n            },\r\n            startDate_send: '',\r\n            endDate_sed: '',\r\n            langHe: he,\r\n            langEn: en,\r\n\r\n            url: '',\r\n            calendarView: 'month',\r\n\r\n            activePromptAddEvent: false,\r\n            label_cancel: 'Cancelar',\r\n            calendarViewTypes: [{\r\n                    label: 'Mes',\r\n                    val: 'month'\r\n                },\r\n                {\r\n                    label: 'Semana',\r\n                    val: 'week'\r\n                },\r\n                {\r\n                    label: 'Año',\r\n                    val: 'year'\r\n                }\r\n            ],\r\n            time: null,\r\n            configdateTimePicker: {\r\n                enableTime: true,\r\n                enableSeconds: false,\r\n                noCalendar: true\r\n            },\r\n            hora_inicio: '',\r\n            hora_fin: '',\r\n            institucion_id: '',\r\n            counterDanger: false,\r\n            arregloCiudad: [],\r\n            temporalInstitucion: {\r\n                ciudad: '',\r\n                nombreInstitucion: '',\r\n                region: '2',\r\n            },\r\n            institucion_id_temporal: '',\r\n            estado_institucion_temporal: 0,\r\n            periodo_id_temporal: 0,\r\n            nombreInstitucionTemporal: '',\r\n            filtroInstituciones:[],\r\n            estado: '0',\r\n            institucionesAsesor:[],\r\n            titulo:'',\r\n      }\r\n    },\r\n    components: {\r\n        Datepicker,\r\n        flatPickr,\r\n        'v-select': vSelect,\r\n\r\n    },\r\n    mounted(){\r\n        let me = this;\r\n        me.getRegistrosPendientes();\r\n         this.listaCiudades()\r\n    },\r\n    computed: {\r\n        simpleCalendarEvents() {\r\n            return this.$store.state.calendar.events\r\n        },\r\n        disabledDatesTo() {\r\n            return {\r\n                to: new Date(this.startDate)\r\n            }\r\n        },\r\n        disabledDatesFrom() {\r\n            return {\r\n                from: new Date(this.endDate)\r\n            }\r\n        },\r\n        calendarLabels() {\r\n            return this.$store.state.calendar.eventLabels\r\n        },\r\n        labelColor() {\r\n            return (label) => {\r\n                if (label === 'business') return 'success'\r\n                else if (label === 'work') return 'warning'\r\n                else if (label === 'personal') return 'danger'\r\n                else if (label === 'baja') return 'primary'\r\n            }\r\n        },\r\n        windowWidth() {\r\n            return this.$store.state.windowWidth\r\n        }\r\n    },\r\n    methods:{\r\n         //para obtener el listado de los asesores\r\n        getRegistrosPendientes() {\r\n            let me = this;\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + 'seguimiento?asesor_id=' + localStorage.planificacion_asesor_id + '&pendientes=yes')\r\n                .then(function (res) {\r\n                    let datosProlipa = res.data.institucionesProlipa\r\n\r\n                    for (let i = 0; i < datosProlipa.length; i++) {\r\n\r\n                        me.institucionesProlipa.push({\r\n                            \"id\": datosProlipa[i].id,\r\n                            \"id_usuario\": datosProlipa[i].id_usuario,\r\n                            \"title\": datosProlipa[i].title,\r\n                            \"label\": datosProlipa[i].label,\r\n                            \"classes\": datosProlipa[i].classes,\r\n                            \"startDate\": datosProlipa[i].startDate,\r\n                            \"endDate\": datosProlipa[i].endDate,\r\n                            \"hora_inicio\": datosProlipa[i].hora_inicio,\r\n                            \"hora_fin\": datosProlipa[i].hora_fin,\r\n                            \"url\": datosProlipa[i].url,\r\n                            \"institucion_id\": datosProlipa[i].institucion_id,\r\n                            \"institucion_id_temporal\": datosProlipa[i].institucion_id_temporal,\r\n                            \"nombre_institucion_temporal\": datosProlipa[i].nombre_institucion_temporal,\r\n                            \"estado_institucion_temporal\": datosProlipa[i].estado_institucion_temporal,\r\n                            \"opciones\": JSON.parse(datosProlipa[i].opciones),\r\n                            \"periodo_id\": datosProlipa[i].periodo_id,\r\n                            \"estado\": datosProlipa[i].estado,\r\n                            \"idperiodoescolar\": datosProlipa[i].idperiodoescolar,\r\n                            \"periodo\": datosProlipa[i].periodo,\r\n                            \"nombreInstitucion\": datosProlipa[i].nombreInstitucion,\r\n                            \"vendedor\": datosProlipa[i].vendedor\r\n                        })\r\n                    }\r\n\r\n                    //para las instituciones temporales\r\n                    let datosTemporales = res.data.institucionesTemporales\r\n\r\n                    for (let i = 0; i < datosTemporales.length; i++) {\r\n\r\n                        me.institucionesTemporales.push({\r\n                            \"id\": datosTemporales[i].id,\r\n                            \"id_usuario\": datosTemporales[i].id_usuario,\r\n                            \"title\": datosTemporales[i].title,\r\n                            \"label\": datosTemporales[i].label,\r\n                            \"classes\": datosTemporales[i].classes,\r\n                            \"startDate\": datosTemporales[i].startDate,\r\n                            \"endDate\": datosTemporales[i].endDate,\r\n                            \"hora_inicio\": datosTemporales[i].hora_inicio,\r\n                            \"hora_fin\": datosTemporales[i].hora_fin,\r\n                            \"url\": datosTemporales[i].url,\r\n                            \"institucion_id\": datosTemporales[i].institucion_id,\r\n                            \"institucion_id_temporal\": datosTemporales[i].institucion_id_temporal,\r\n                            \"nombre_institucion_temporal\": datosTemporales[i].nombre_institucion_temporal,\r\n                            \"estado_institucion_temporal\": datosTemporales[i].estado_institucion_temporal,\r\n                            \"opciones\": JSON.parse(datosTemporales[i].opciones),\r\n                            \"periodo_id\": datosTemporales[i].periodo_id,\r\n                            \"estado\": datosTemporales[i].estado,\r\n                            \"idperiodoescolar\": datosTemporales[i].idperiodoescolar,\r\n                            \"periodo\": datosTemporales[i].periodo,\r\n                            \"nombreInstitucion\": datosTemporales[i].nombreInstitucion,\r\n                            \"vendedor\": datosTemporales[i].vendedor\r\n                        })\r\n                    }\r\n\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n        },\r\n\r\n         openEditPlanificacion(tr) {\r\n            let datos = tr.opciones\r\n            this.id = tr.id\r\n            if(tr.title == null){\r\n            }else{\r\n                this.title = tr.title.split('(')[0]\r\n            }\r\n            this.startDate = tr.startDate\r\n            this.endDate = tr.endDate\r\n            this.url = tr.url\r\n            if(tr.classes == null){\r\n            }else{\r\n                this.labelLocal = {\r\n                    text: tr.label,\r\n                    color: tr.classes.split('-')[1]\r\n                }\r\n            }\r\n\r\n            this.startDate_send = this.startDate\r\n            this.endDate_send = this.endDate\r\n            this.hora_inicio = tr.hora_inicio\r\n            this.hora_fin = tr.hora_fin\r\n            this.label_cancel = 'Cancelar'\r\n            this.abrirModal = true\r\n            this.estado = tr.estado\r\n            this.opciones.presentacion = datos.presentacion\r\n            this.opciones.entrega_muestras = datos.entrega_muestras\r\n            this.opciones.reunion = datos.reunion\r\n            this.opciones.seguimiento = datos.seguimiento\r\n            this.opciones.cierre = datos.cierre\r\n            this.opciones.cobranza = datos.cobranza\r\n            this.opciones.post_venta = datos.post_venta\r\n            this.opciones.retiro_cartas = datos.retiro_cartas\r\n            this.opciones.retiro_muestras = datos.retiro_muestras\r\n            // this.opciones.sinSello = datos.sinSello\r\n            this.opciones.otraEditorial = datos.otraEditorial\r\n            if (this.opciones.otraEditorial == false) {\r\n                this.opciones.editorial = \"\"\r\n            } else {\r\n                this.opciones.editorial = datos.editorial\r\n            }\r\n\r\n            if (tr.estado_institucion_temporal == \"1\") {\r\n                this.nombreInstitucion = tr.nombre_institucion_temporal\r\n                this.institucion_id_temporal = tr.institucion_id_temporal\r\n                this.periodo_id_temporal = tr.periodo_id\r\n                this.estado_institucion_temporal = 1\r\n            } else {\r\n                this.nombreInstitucion = tr.nombreInstitucion\r\n                this.institucion_id = tr.institucion_id\r\n                this.estado_institucion_temporal = 0\r\n\r\n            }\r\n\r\n        },\r\n        agregarInstitucionTemporal() {\r\n            let me = this;\r\n            if (me.temporalInstitucion.nombre_institucion == \"\" || me.temporalInstitucion.nombre_institucion == null || me.temporalInstitucion.nombre_institucion == undefined) {\r\n                me.$vs.notify({\r\n                    color: 'primary',\r\n                    title: 'Mensaje',\r\n                    text: 'Debe escribir una institución por favor'\r\n                })\r\n                return false;\r\n            }\r\n\r\n            let formData = new FormData();\r\n            formData.append('nombre_institucion', me.temporalInstitucion.nombre_institucion);\r\n            formData.append('ciudad', me.temporalInstitucion.ciudad.nombre);\r\n            formData.append('region', me.temporalInstitucion.region);\r\n            formData.append('asesor_id', localStorage.planificacion_asesor_id);\r\n\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'GuardarInstitucionTemporal', formData)\r\n                .then(res => {\r\n\r\n                    me.$vs.loading.close()\r\n                    me.popupAddNuevaInstitucion = false;\r\n                    me.abrirModal = true\r\n                    me.seleccionadoInsitucion = false;\r\n                    me.nombreInstitucion = me.temporalInstitucion.nombre_institucion\r\n                    me.institucion_id_temporal = res.data.institucion_temporal_id\r\n                    me.institucionesAsesor = []\r\n                    me.periodo_id_temporal = res.data.periodo_id\r\n                    me.estado_institucion_temporal = 1;\r\n\r\n                    me.$vs.notify({\r\n                        text: \"Se guardo correctamente\",\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                })\r\n        },\r\n        //lista de ciudades para usar en el select\r\n        listaCiudades() {\r\n            let me = this\r\n            this.$http.get(this.$server_url + `ciudad`).then(res => {\r\n                    me.arregloCiudad = res.data;\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        regresar() {\r\n            let me = this;\r\n            me.seleccionadoInsitucion = false;\r\n            me.institucionesAsesor = []\r\n            me.error = false\r\n        },\r\n\r\n        asginarInstitucion(tr) {\r\n            let me = this;\r\n            me.institucion_id = tr.idInstitucion\r\n            me.nombreInstitucion = tr.nombreInstitucion\r\n            me.estado_institucion_temporal = 0;\r\n            me.seleccionadoInsitucion = false;\r\n            me.institucionesAsesor = []\r\n\r\n        },\r\n\r\n        getInstitucionAsesor() {\r\n            let me = this;\r\n            me.institucionesAsesor = [];\r\n            if (me.busquedaInstitucion.length < 5) {\r\n                me.$vs.notify({\r\n                    text: 'Minimo 5 caracteres de busqueda',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })\r\n                return false;\r\n            }\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'listaInsitucionAsesor?busqueda=' + me.busquedaInstitucion + '&cedula=' + localStorage.planificacion_cedula)\r\n                .then(function (res) {\r\n                    // me.tmpInstituciones = res.data;\r\n                    me.institucionesAsesor = res.data;\r\n                    // me.filtroRegion();\r\n                    me.$vs.loading.close()\r\n                    if (res.data.message) {\r\n                        me.$vs.notify({\r\n                            text: res.data.message,\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-user',\r\n                            time: 8000\r\n                        })\r\n                    }\r\n\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n        },\r\n        addEvent() {\r\n            let me = this\r\n            if(this.estado == 1){\r\n                me.error = true\r\n                me.messageError = \"La Planificación ya fue registrada ya no puede ser modificada\"\r\n                me.abrirModal = true\r\n                return false\r\n            }\r\n            if (this.institucion_id == \"\" && this.institucion_id_temporal == \"\") {\r\n              if (me.longitudCapacitaciones > 1) {\r\n                me.error = true\r\n                me.messageError = \"Existe mas de 2 capacitaciones para este libro, eliga para otro dia\"\r\n                me.abrirModal = true\r\n                return false\r\n               }\r\n                me.error = true;\r\n                me.messageError = \"Seleccione una institución por favor\";\r\n                me.abrirModal = true\r\n                return false;\r\n            }\r\n            if (this.title == '' || this.startDate_send == '') {\r\n                me.error = true;\r\n                me.messageError = \"Complete todos los campos antes de guardar\";\r\n                me.abrirModal = true\r\n                return false;\r\n            }\r\n             //si el asesor agrega otra editorial debe validarse que ingrese una institucion\r\n            if (this.opciones.otraEditorial == true) {\r\n                // si es tipo de institucion  de prolipa\r\n                me.abrirModal = true\r\n                if (this.opciones.editorial == \"\") {\r\n                    me.error = true;\r\n                    me.messageError = \"Ha seleccionado otra editorial tiene que agregar una editorial por favor\";\r\n                    me.abrirModal = true\r\n                    return false;\r\n                }\r\n                if (this.estado_institucion_temporal == 0) {\r\n                    if (this.institucion_id == \"\" || this.institucion_id == null || this.institucion_id == 0 || this.institucion_id == \"null\") {\r\n                        me.error = true;\r\n                        me.messageError = \"Ha seleccionado otra editorial tiene que agregar una institución por favor\";\r\n                        me.abrirModal = true\r\n                        return false;\r\n                    }\r\n                }\r\n                if (this.estado_institucion_temporal == 1) {\r\n                    if (this.institucion_id_temporal == \"\" || this.institucion_id_temporal == null || this.institucion_id_temporal == 0 || this.institucion_id_temporal == \"null\") {\r\n                        me.error = true;\r\n                        me.messageError = \"Ha seleccionado otra editorial tiene que agregar una institución por favor\";\r\n                        me.abrirModal = true\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n            const obj = {\r\n\r\n                idusuario: localStorage.planificacion_asesor_id,\r\n                title: this.title,\r\n                startDate: this.startDate_send,\r\n                endDate: this.endDate_send,\r\n                classes: 'event-' + this.labelLocal.color,\r\n                label: this.labelLocal.text,\r\n                url: this.url,\r\n                hora_inicio: this.hora_inicio.substring(0, 5),\r\n                hora_fin: this.hora_fin.substring(0, 5),\r\n                institucion_id: this.institucion_id,\r\n                opciones: this.opciones,\r\n                institucion_id_temporal: this.institucion_id_temporal,\r\n                estado_institucion_temporal: this.estado_institucion_temporal,\r\n                periodo_id_temporal: this.periodo_id_temporal,\r\n                nombreInstitucion: this.nombreInstitucion,\r\n                otraEditorial: this.opciones.otraEditorial,\r\n                nombre_editorial: this.opciones.editorial\r\n\r\n            }\r\n            me.save(obj)\r\n\r\n        },\r\n\r\n        save(obj){\r\n            let me = this;\r\n            let formData = new FormData();\r\n            me.institucionesProlipa = []\r\n            me.institucionesTemporales = []\r\n            formData.append('id', 0);\r\n            formData.append('idusuario', obj.idusuario);\r\n            formData.append('title', obj.title);\r\n            formData.append('label', obj.label);\r\n            formData.append('classes', obj.classes);\r\n            formData.append('startDate', obj.startDate);\r\n            formData.append('endDate', obj.endDate);\r\n            formData.append('hora_inicio', obj.hora_inicio);\r\n            formData.append('hora_fin', obj.hora_fin);\r\n            formData.append('url', obj.url);\r\n            formData.append('institucion_id', obj.institucion_id);\r\n            formData.append('opciones', JSON.stringify(obj.opciones));\r\n            formData.append('institucion_id_temporal', obj.institucion_id_temporal);\r\n            formData.append('estado_institucion_temporal', obj.estado_institucion_temporal);\r\n            formData.append('periodo_id_temporal', obj.periodo_id_temporal);\r\n            formData.append('nombreInstitucion', obj.nombreInstitucion);\r\n            formData.append('otraEditorial', obj.otraEditorial);\r\n            formData.append('nombre_editorial', obj.nombre_editorial);\r\n               me.$vs.loading()\r\n              this.$http.post(this.$server_url+'save_planificacion', formData)\r\n              .then(res => {\r\n\r\n                  me.$vs.loading.close()\r\n                  me.abrirModal = false;\r\n                //   me.registrarPendiente()\r\n                  me.limpiar();\r\n                  me.$vs.notify({\r\n                  text:'Planificación agregada con exito',\r\n                  color:'success',\r\n                  iconPack: 'feather',\r\n                  icon:'icon-check'})\r\n              })\r\n        },\r\n\r\n           registrarPendiente() {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            formData.append('id', me.id);\r\n            this.$http.post(this.$server_url + 'seguimiento-registrar', formData)\r\n                .then(res => {\r\n                    me.getRegistrosPendientes();\r\n                    me.$vs.notify({\r\n                        text: 'Se registro con exito',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n\r\n\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                })\r\n\r\n        },\r\n\r\n        limpiar(){\r\n            let me = this;\r\n            me.title = \"\";\r\n            me.titulo = \"\";\r\n            me.hora_inicio = \"\";\r\n            me.hora_fin = \"\";\r\n            me.nombre_institucion = \"\";\r\n            me.url = \"\";\r\n\r\n        },\r\n    }\r\n}\r\n",{"version":3,"sources":["planificacionAsesor.vue"],"names":[],"mappings":";AAuYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"planificacionAsesor.vue","sourceRoot":"src/views/asesor/admin/components","sourcesContent":["<template>\r\n    <div>\r\n        <vs-card>\r\n            <div v-if=\"abrirModal == true\">\r\n                <div class=\"mt-3\">\r\n                    <div class=\"calendar__label-container flex mb-6\" v-if=\"seleccionadoInsitucion == false\">\r\n                        <vs-chip style=\"width: 100px;height: 25px;margin-top: 1px;\" class=\"text-white\" :class=\"'bg-' + labelLocal.color\">{{ labelLocal.text }}</vs-chip>\r\n                            <span v-if=\"estado == 1\"  style=\"margin-top:2px;\">\r\n                                <vs-chip color=\"success\">Realizada</vs-chip>\r\n                            </span>\r\n                        <vs-dropdown vs-custom-content vs-trigger-click class=\"ml-auto my-2 cursor-pointer\">\r\n                            <feather-icon icon=\"TagIcon\" svgClasses=\"h-5 w-5\" class=\"cursor-pointer\" @click.prevent></feather-icon>\r\n                            <vs-dropdown-menu style=\"z-index: 200001\">\r\n                                <vs-dropdown-item v-for=\"(label, index) in calendarLabels\" :key=\"index\" @click=\"labelLocal = label\">\r\n                                    <div class=\"h-3 w-3 inline-block rounded-full mr-2\" :class=\"'bg-' + label.color\"></div>\r\n                                    <span>{{ label.text }}</span>\r\n                                </vs-dropdown-item>\r\n                            </vs-dropdown-menu>\r\n                        </vs-dropdown>\r\n                    </div>\r\n\r\n                    <div>\r\n\r\n                        <vs-row v-if=\"seleccionadoInsitucion ==  false\" class=\"mt-2\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                                <p style=\"color:red;\" v-if=\"nombreInstitucion == '' || nombreInstitucion == null \">\r\n                                    Sin Institución\r\n                                </p>\r\n                                <vs-chip color=\"success\" v-else>\r\n                                    Institución {{ nombreInstitucion}}\r\n                                </vs-chip>\r\n                            </vs-col>\r\n                        </vs-row>\r\n                        <vs-row v-if=\"seleccionadoInsitucion ==  true\" class=\"mt-2\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"6\">\r\n                                <vs-button size=\"small\" color=\"success\" radius=\"\" @click=\"regresar()\" icon=\"reply\" type=\"gradient\"></vs-button>\r\n                                <vs-button size=\"small\" class=\"ml-3\" @click=\"popupAddNuevaInstitucion = true;activePromptAddEvent = false;\" type=\"relief\">Añadir nueva institución</vs-button>\r\n                            </vs-col>\r\n\r\n                        </vs-row>\r\n\r\n                        <vs-button color=\"warning\" class=\"mt-2\" v-if=\"seleccionadoInsitucion == false\" size=\"small\" style=\"margin:0 auto;\" @click=\"seleccionadoInsitucion = true;\" type=\"relief\">Asignar Institución</vs-button>\r\n                        <div style=\"width:100%;display:flex;\" v-if=\"seleccionadoInsitucion ==  true\" class=\"mt-5\">\r\n                            <div style=\"width:80%;\">\r\n                                <vs-input icon=\"search\" style=\"width:100%;\" placeholder=\"Search\" @keyup.enter=\"getInstitucionAsesor()\" v-model=\"busquedaInstitucion\" />\r\n                            </div>\r\n\r\n                            <div style=\"width:20%;margin-left:15px;\">\r\n                                <vs-button radius color=\"warning\" @click=\"getInstitucionAsesor()\" type=\"filled\" icon=\"search\"></vs-button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div v-if=\"institucionesAsesor.length >0\">\r\n                            <vs-table stripe max-items=\"5\" search pagination :data=\"institucionesAsesor\">\r\n                                <template slot=\"header\">\r\n                                    <div class=\"vx-row\">\r\n                                        <div class=\"vx-col w-full m-3\">\r\n                                            Cantidad: {{institucionesAsesor.length}}\r\n                                        </div>\r\n\r\n                                    </div>\r\n                                </template>\r\n                                <template slot=\"thead\">\r\n                                    <vs-th sort-key=\"nombreInstitucion\">Institución</vs-th>\r\n                                    <vs-th sort-key=\"nombre\">Localidad</vs-th>\r\n                                    <vs-th>Acciones</vs-th>\r\n                                </template>\r\n                                <template slot-scope=\"{data}\">\r\n                                    <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n\r\n                                        <vs-td :data=\"data[indextr].nombreInstitucion\">\r\n                                            {{data[indextr].nombreInstitucion}}<br>\r\n\r\n                                        </vs-td>\r\n                                        <vs-td :data=\"data[indextr].nombreregion\">\r\n                                            {{data[indextr].nombreregion}} <br>\r\n                                            <small>{{data[indextr].ciudad}}</small>\r\n                                        </vs-td>\r\n                                        <vs-td>\r\n                                            <div class=\"flex\">\r\n                                                <vs-button size=\"small\" type=\"relief\" style=\"border-radius: 5px;\" icon-pack=\"feather\" icon=\"icon-bookmark\" class=\"mr-2\" color=\"primary\" @click=\"asginarInstitucion(tr);error=false\">\r\n                                                    Asignar\r\n                                                </vs-button>\r\n                                            </div>\r\n                                        </vs-td>\r\n                                    </vs-tr>\r\n                                </template>\r\n                            </vs-table>\r\n                        </div>\r\n\r\n                    </div>\r\n                    <vs-row v-if=\"error ==  true\" class=\"mt-3\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n                                <vs-alert active=\"true\" color=\"danger\">\r\n                                    {{messageError}}\r\n                                </vs-alert>\r\n                            </vs-col>\r\n                    </vs-row>\r\n                    <div v-if=\"seleccionadoInsitucion == false\">\r\n                        <br>\r\n                        <vs-input class=\"w-full mb-3 \" label-placeholder=\"Título del evento *\" v-model=\"title\"></vs-input>\r\n                        <div class=\"vx-row mb-3\">\r\n                            <div class=\"vx-col sm:w-1/2 w-full\">\r\n                                <small class=\"date-label\">Fecha inicio *</small>\r\n                                <datepicker class=\"w-full\" name=\"start-date\" v-model=\"startDate\" @input=\"formatoFechas()\" :disabled=\"disabledFrom\"></datepicker>\r\n                            </div>\r\n                            <div class=\"vx-col sm:w-1/2 w-full\">\r\n                                <small class=\"date-label\">Fecha fin *</small>\r\n                                <datepicker class=\"w-full\" :disabledDates=\"disabledDatesTo\" @input=\"formatoFechas()\" name=\"end-date\" v-model=\"endDate\"></datepicker>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class=\"vx-row mb-3\">\r\n                            <div class=\"vx-col sm:w-1/2 w-full\">\r\n                                <small class=\"date-label\">Hora inicio *</small>\r\n                                <flat-pickr class=\"w-full\" :config=\"configdateTimePicker\" v-model=\"hora_inicio\" />\r\n                            </div>\r\n                            <div class=\"vx-col sm:w-1/2 w-full\">\r\n                                <small class=\"date-label\">Hora fin *</small>\r\n                                <flat-pickr class=\"w-full\" :config=\"configdateTimePicker\" v-model=\"hora_fin\" />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div>\r\n\r\n                        <vs-divider color=\"success\" v-if=\"seleccionadoInsitucion == false\">Opciones</vs-divider>\r\n                        <vs-row v-if=\"seleccionadoInsitucion == false\">\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-checkbox color=\"success\" v-model=\"opciones.presentacion\">Presentación</vs-checkbox>\r\n                            </vs-col>\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-checkbox color=\"success\" v-model=\"opciones.entrega_muestras\">Entregas de muestras</vs-checkbox>\r\n                            </vs-col>\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-checkbox color=\"success\" v-model=\"opciones.reunion\">Reunión</vs-checkbox>\r\n                            </vs-col>\r\n                            <vs-col vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-checkbox color=\"success\" v-model=\"opciones.seguimiento\">Seguimiento</vs-checkbox>\r\n                            </vs-col>\r\n\r\n                            <vs-col class=\"mt-2\" vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-checkbox color=\"success\" v-model=\"opciones.cierre\">Cierre</vs-checkbox>\r\n                            </vs-col>\r\n                            <vs-col class=\"mt-2\" vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-checkbox color=\"success\" v-model=\"opciones.cobranza\">Cobranza</vs-checkbox>\r\n                            </vs-col>\r\n                            <vs-col class=\"mt-2\" vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-checkbox color=\"success\" v-model=\"opciones.post_venta\">Post Venta</vs-checkbox>\r\n                            </vs-col>\r\n                            <vs-col class=\"mt-2\" vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-checkbox color=\"success\" v-model=\"opciones.retiro_cartas\">Retiro de cartas</vs-checkbox>\r\n                            </vs-col>\r\n\r\n                            <vs-col class=\"mt-2\" vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-checkbox color=\"success\" v-model=\"opciones.retiro_muestras\">Retiro de muestras</vs-checkbox>\r\n                            </vs-col>\r\n\r\n                            <vs-col class=\"mt-2\" vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-switch color=\"danger\" v-model=\"opciones.sinSello\" style=\"width: 60%;\">\r\n                                    <span slot=\"on\">Sin sello</span>\r\n                                    <span slot=\"off\">Con Sello</span>\r\n                                </vs-switch>\r\n                            </vs-col>\r\n                            <vs-col class=\"mt-2\" vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-checkbox color=\"success\" v-model=\"opciones.otraEditorial\">Otra Editorial</vs-checkbox>\r\n                            </vs-col>\r\n                            <vs-col v-if=\"opciones.otraEditorial == true\" class=\"mt-2\" vs-type=\"flex\" vs-justify=\"left\" vs-align=\"left\" vs-w=\"3\" vs-lg=\"3\" vs-sm=\"4\" vs-xs=\"4\">\r\n                                <vs-input class=\"inputx w-full\" placeholder=\"Escriba el nombre de la editorial\" v-model=\"opciones.editorial\" />\r\n                            </vs-col>\r\n                        </vs-row>\r\n                    </div>\r\n\r\n                    <vs-textarea counter=\"250\" label=\"Mensaje\" :counter-danger.sync=\"counterDanger\" v-if=\"seleccionadoInsitucion == false\" name=\"event-url\" class=\"w-full mb-3 mt-4\" v-model=\"url\" />\r\n                    <vs-row class=\"mt-3\">\r\n                        <vs-col vs-type=\"flex\" vs-justify=\"right\" vs-align=\"right\" vs-w=\"12\">\r\n                            <vs-button @click=\"addEvent()\" type=\"relief\">Guardar</vs-button>\r\n                            <vs-button color=\"warning\" class=\"ml-2\" type=\"relief\">{{label_cancel}}</vs-button>\r\n                        </vs-col>\r\n                    </vs-row>\r\n                </div>\r\n            </div>\r\n            <vs-collapse accordion v-if=\"abrirModal == false\">\r\n                <vs-collapse-item>\r\n                    <div slot=\"header\">\r\n                        Registros Pendientes con Instituciones de Prolipa\r\n                    </div>\r\n                    <div>\r\n                        <vs-table max-items=\"10\" stripe search pagination :data=\"institucionesProlipa\" class=\"mt-2\">\r\n                            <template slot=\"thead\">\r\n                                <vs-th>Datos Planificación</vs-th>\r\n                                <vs-th>Opciones</vs-th>\r\n                                <vs-th>Prioridad</vs-th>\r\n                                <vs-th>Observación</vs-th>\r\n                                <vs-th>Acciones</vs-th>\r\n                            </template>\r\n                            <template slot-scope=\"{data}\">\r\n                                <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n\r\n                                    <vs-td>\r\n                                        Titulo:\r\n                                        <br>\r\n                                        <span style=\"font-weight:600;\">\r\n\r\n                                            {{ tr.title }}<br>\r\n                                        </span>\r\n\r\n                                        Fecha inicio:\r\n                                        <br>\r\n                                        <span style=\" font-weight:600; \">\r\n                                            {{ tr.startDate }}<br>\r\n                                        </span>\r\n\r\n                                        Fecha Fin:\r\n                                        <br>\r\n                                        <span style=\"font-weight:600;  \">\r\n                                            {{ tr.endDate }}<br>\r\n                                        </span>\r\n                                        Institución:\r\n                                        <br>\r\n                                        <span style=\"font-weight:600;  \">\r\n                                            {{ tr.nombreInstitucion }}<br>\r\n                                        </span>\r\n                                    </vs-td>\r\n                                    <vs-td height=\"30%\" width=\"50%\">\r\n                                        <div class=\"overflow-y-auto h-24\">\r\n\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.presentacion\">\r\n                                                Presentación\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.entrega_muestras\">\r\n                                                Entrega muestras\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.reunion\">\r\n                                                Reunión\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.seguimiento\">\r\n                                                Seguimiento\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.cierre\">\r\n                                                Cierre\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.cobranza\">\r\n                                                Cobranza\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.post_venta\">\r\n                                                Post venta\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.retiro_cartas\">\r\n                                                Retiro cartas\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.retiro_muestras\">\r\n                                                Retiro muestras\r\n                                            </vs-chip>\r\n                                        </div>\r\n                                    </vs-td>\r\n                                    <vs-td>\r\n                                        <vs-chip color=\"success\">\r\n                                            {{tr.label}}\r\n                                        </vs-chip>\r\n                                    </vs-td>\r\n                                    <vs-td>\r\n                                        {{tr.url}}\r\n                                    </vs-td>\r\n                                    <vs-td>\r\n                                        <div style=\"display: flex;\">\r\n                                            <vx-tooltip style=\"display: inline-block;\" text=\"Registrar Planificación\" position=\"top\" color=\"warning\">\r\n                                                <vs-button   @click=\"openEditPlanificacion(tr)\"  size=\"small\" color=\"primary\" type=\"line\" icon-pack=\"feather\" icon=\"icon-bookmark\">\r\n\r\n                                                </vs-button>\r\n                                            </vx-tooltip> &nbsp;\r\n                                            <!-- <vx-tooltip style=\"display: inline-block;\" text=\"Marcar como registrado\" position=\"top\" color=\"primary\">\r\n                                                <vs-button class=\"modal-default-button\" radius @click=\"confirmarRegistroPendiente(tr)\" size=\"small\" color=\"success\" type=\"line\" icon-pack=\"feather\" icon=\"icon-check-circle\">\r\n                                                </vs-button>\r\n                                            </vx-tooltip> &nbsp; -->\r\n                                        </div>\r\n                                    </vs-td>\r\n\r\n                                </vs-tr>\r\n                            </template>\r\n                        </vs-table>\r\n                    </div>\r\n                </vs-collapse-item>\r\n                <vs-collapse-item>\r\n                    <div slot=\"header\">\r\n                        Registros Pendientes con Instituciones Nuevas\r\n                    </div>\r\n                    <div>\r\n\r\n                        <vs-table max-items=\"10\" stripe search pagination :data=\"institucionesTemporales\" class=\"mt-2\">\r\n                            <template slot=\"thead\">\r\n                                <vs-th>Datos Planificación</vs-th>\r\n                                <vs-th>Opciones</vs-th>\r\n                                <vs-th>Prioridad</vs-th>\r\n                                <vs-th>Observación</vs-th>\r\n                                <vs-th>Acciones</vs-th>\r\n                            </template>\r\n                            <template slot-scope=\"{data}\">\r\n                                <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n\r\n                                    <vs-td>\r\n\r\n                                        Titulo:\r\n                                        <br>\r\n                                        <span style=\"font-weight:600;  \">\r\n                                            {{ tr.title }}<br>\r\n                                        </span>\r\n\r\n                                        Fecha inicio:\r\n                                        <br>\r\n                                        <span style=\" font-weight:600; \">\r\n                                            {{ tr.startDate }}<br>\r\n                                        </span>\r\n\r\n                                        Fecha Fin:\r\n                                        <br>\r\n                                        <span style=\"font-weight:600;  \">\r\n                                            {{ tr.endDate }}<br>\r\n                                        </span>\r\n                                        Institución:\r\n                                        <br>\r\n                                        <span style=\"font-weight:600;  \">\r\n                                            {{ tr.nombre_institucion_temporal }}<br>\r\n                                        </span>\r\n                                    </vs-td>\r\n                                    <vs-td height=\"30%\" width=\"50%\">\r\n                                        <div class=\"overflow-y-auto h-24\">\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.presentacion\">\r\n                                                Presentación\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.entrega_muestras\">\r\n                                                Entrega muestras\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.reunion\">\r\n                                                Reunión\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.seguimiento\">\r\n                                                Seguimiento\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.cierre\">\r\n                                                Cierre\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.cobranza\">\r\n                                                Cobranza\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.post_venta\">\r\n                                                Post venta\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.retiro_cartas\">\r\n                                                Retiro cartas\r\n                                            </vs-chip>\r\n                                            <vs-chip color=\"primary\" v-if=\"tr.opciones.retiro_muestras\">\r\n                                                Retiro muestras\r\n                                            </vs-chip>\r\n                                        </div>\r\n                                    </vs-td>\r\n                                    <vs-td>\r\n                                        <vs-chip color=\"success\">\r\n                                            {{tr.label}}\r\n                                        </vs-chip>\r\n                                    </vs-td>\r\n                                    <vs-td>\r\n                                        {{tr.url}}\r\n                                    </vs-td>\r\n                                    <vs-td>\r\n                                        <div style=\"display: flex;\">\r\n                                            <vx-tooltip style=\"display: inline-block;\" text=\"Registrar Planificación\" position=\"top\" color=\"warning\">\r\n                                                <vs-button class=\"modal-default-button\"  @click=\"openEditPlanificacion(tr)\" radius size=\"small\" color=\"primary\" type=\"line\" icon-pack=\"feather\" icon=\"icon-bookmark\">\r\n\r\n                                                </vs-button>\r\n                                            </vx-tooltip> &nbsp;\r\n                                            <!-- <vx-tooltip style=\"display: inline-block;\" text=\"Marcar como registrado\" position=\"top\" color=\"primary\">\r\n                                                <vs-button class=\"modal-default-button\" radius @click=\"confirmarRegistroPendiente(tr)\" size=\"small\" color=\"success\" type=\"line\" icon-pack=\"feather\" icon=\"icon-check-circle\">\r\n                                                </vs-button>\r\n                                            </vx-tooltip> &nbsp; -->\r\n                                        </div>\r\n                                    </vs-td>\r\n\r\n                                </vs-tr>\r\n                            </template>\r\n                        </vs-table>\r\n                    </div>\r\n\r\n                </vs-collapse-item>\r\n\r\n            </vs-collapse>\r\n        </vs-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport moduleCalendar from '@/store/calendar2/moduleCalendar.js'\r\nimport vSelect from 'vue-select'\r\nimport moment from 'moment'\r\nimport Datepicker from 'vuejs-datepicker'\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport {\r\n    en,\r\n    he\r\n} from 'vuejs-datepicker/src/locale'\r\nexport default {\r\n\r\n    data() {\r\n      return{\r\n        institucionesProlipa:[],\r\n        institucionesTemporales:[],\r\n        abrirModal:false,\r\n         //VARIABLES DE AGREGAR PLANIFICACION\r\n\r\n          popupFiltroInstitucion:false,\r\n            error: false,\r\n            messageError: \"\",\r\n            ciudadSelect: '',\r\n            popupAddNuevaInstitucion: false,\r\n            seleccionadoInsitucion: false,\r\n            nombreInstitucion: '',\r\n            busquedaInstitucion: \"\",\r\n            instituciones: [],\r\n            popupaddInstitucion: false,\r\n            opciones: {\r\n                presentacion: false,\r\n                entrega_muestras: false,\r\n                reunion: false,\r\n                seguimiento: false,\r\n                cierre: false,\r\n                cobranza: false,\r\n                post_venta: false,\r\n                retiro_cartas: false,\r\n                retiro_muestras: false,\r\n                sinSello: true,\r\n                editorial: '',\r\n                otraEditorial: false,\r\n            },\r\n\r\n            usuario: [],\r\n            showDate: new Date(),\r\n            disabledFrom: false,\r\n            titulo: '',\r\n            id: 0,\r\n            title: '',\r\n            startDate: '',\r\n            endDate: '',\r\n            labelLocal: {\r\n                text: 'Baja',\r\n                color: 'success'\r\n            },\r\n            startDate_send: '',\r\n            endDate_sed: '',\r\n            langHe: he,\r\n            langEn: en,\r\n\r\n            url: '',\r\n            calendarView: 'month',\r\n\r\n            activePromptAddEvent: false,\r\n            label_cancel: 'Cancelar',\r\n            calendarViewTypes: [{\r\n                    label: 'Mes',\r\n                    val: 'month'\r\n                },\r\n                {\r\n                    label: 'Semana',\r\n                    val: 'week'\r\n                },\r\n                {\r\n                    label: 'Año',\r\n                    val: 'year'\r\n                }\r\n            ],\r\n            time: null,\r\n            configdateTimePicker: {\r\n                enableTime: true,\r\n                enableSeconds: false,\r\n                noCalendar: true\r\n            },\r\n            hora_inicio: '',\r\n            hora_fin: '',\r\n            institucion_id: '',\r\n            counterDanger: false,\r\n            arregloCiudad: [],\r\n            temporalInstitucion: {\r\n                ciudad: '',\r\n                nombreInstitucion: '',\r\n                region: '2',\r\n            },\r\n            institucion_id_temporal: '',\r\n            estado_institucion_temporal: 0,\r\n            periodo_id_temporal: 0,\r\n            nombreInstitucionTemporal: '',\r\n            filtroInstituciones:[],\r\n            estado: '0',\r\n            institucionesAsesor:[],\r\n            titulo:'',\r\n      }\r\n    },\r\n    components: {\r\n        Datepicker,\r\n        flatPickr,\r\n        'v-select': vSelect,\r\n\r\n    },\r\n    mounted(){\r\n        let me = this;\r\n        me.getRegistrosPendientes();\r\n         this.listaCiudades()\r\n    },\r\n    computed: {\r\n        simpleCalendarEvents() {\r\n            return this.$store.state.calendar.events\r\n        },\r\n        disabledDatesTo() {\r\n            return {\r\n                to: new Date(this.startDate)\r\n            }\r\n        },\r\n        disabledDatesFrom() {\r\n            return {\r\n                from: new Date(this.endDate)\r\n            }\r\n        },\r\n        calendarLabels() {\r\n            return this.$store.state.calendar.eventLabels\r\n        },\r\n        labelColor() {\r\n            return (label) => {\r\n                if (label === 'business') return 'success'\r\n                else if (label === 'work') return 'warning'\r\n                else if (label === 'personal') return 'danger'\r\n                else if (label === 'baja') return 'primary'\r\n            }\r\n        },\r\n        windowWidth() {\r\n            return this.$store.state.windowWidth\r\n        }\r\n    },\r\n    methods:{\r\n         //para obtener el listado de los asesores\r\n        getRegistrosPendientes() {\r\n            let me = this;\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + 'seguimiento?asesor_id=' + localStorage.planificacion_asesor_id + '&pendientes=yes')\r\n                .then(function (res) {\r\n                    let datosProlipa = res.data.institucionesProlipa\r\n\r\n                    for (let i = 0; i < datosProlipa.length; i++) {\r\n\r\n                        me.institucionesProlipa.push({\r\n                            \"id\": datosProlipa[i].id,\r\n                            \"id_usuario\": datosProlipa[i].id_usuario,\r\n                            \"title\": datosProlipa[i].title,\r\n                            \"label\": datosProlipa[i].label,\r\n                            \"classes\": datosProlipa[i].classes,\r\n                            \"startDate\": datosProlipa[i].startDate,\r\n                            \"endDate\": datosProlipa[i].endDate,\r\n                            \"hora_inicio\": datosProlipa[i].hora_inicio,\r\n                            \"hora_fin\": datosProlipa[i].hora_fin,\r\n                            \"url\": datosProlipa[i].url,\r\n                            \"institucion_id\": datosProlipa[i].institucion_id,\r\n                            \"institucion_id_temporal\": datosProlipa[i].institucion_id_temporal,\r\n                            \"nombre_institucion_temporal\": datosProlipa[i].nombre_institucion_temporal,\r\n                            \"estado_institucion_temporal\": datosProlipa[i].estado_institucion_temporal,\r\n                            \"opciones\": JSON.parse(datosProlipa[i].opciones),\r\n                            \"periodo_id\": datosProlipa[i].periodo_id,\r\n                            \"estado\": datosProlipa[i].estado,\r\n                            \"idperiodoescolar\": datosProlipa[i].idperiodoescolar,\r\n                            \"periodo\": datosProlipa[i].periodo,\r\n                            \"nombreInstitucion\": datosProlipa[i].nombreInstitucion,\r\n                            \"vendedor\": datosProlipa[i].vendedor\r\n                        })\r\n                    }\r\n\r\n                    //para las instituciones temporales\r\n                    let datosTemporales = res.data.institucionesTemporales\r\n\r\n                    for (let i = 0; i < datosTemporales.length; i++) {\r\n\r\n                        me.institucionesTemporales.push({\r\n                            \"id\": datosTemporales[i].id,\r\n                            \"id_usuario\": datosTemporales[i].id_usuario,\r\n                            \"title\": datosTemporales[i].title,\r\n                            \"label\": datosTemporales[i].label,\r\n                            \"classes\": datosTemporales[i].classes,\r\n                            \"startDate\": datosTemporales[i].startDate,\r\n                            \"endDate\": datosTemporales[i].endDate,\r\n                            \"hora_inicio\": datosTemporales[i].hora_inicio,\r\n                            \"hora_fin\": datosTemporales[i].hora_fin,\r\n                            \"url\": datosTemporales[i].url,\r\n                            \"institucion_id\": datosTemporales[i].institucion_id,\r\n                            \"institucion_id_temporal\": datosTemporales[i].institucion_id_temporal,\r\n                            \"nombre_institucion_temporal\": datosTemporales[i].nombre_institucion_temporal,\r\n                            \"estado_institucion_temporal\": datosTemporales[i].estado_institucion_temporal,\r\n                            \"opciones\": JSON.parse(datosTemporales[i].opciones),\r\n                            \"periodo_id\": datosTemporales[i].periodo_id,\r\n                            \"estado\": datosTemporales[i].estado,\r\n                            \"idperiodoescolar\": datosTemporales[i].idperiodoescolar,\r\n                            \"periodo\": datosTemporales[i].periodo,\r\n                            \"nombreInstitucion\": datosTemporales[i].nombreInstitucion,\r\n                            \"vendedor\": datosTemporales[i].vendedor\r\n                        })\r\n                    }\r\n\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n        },\r\n\r\n         openEditPlanificacion(tr) {\r\n            let datos = tr.opciones\r\n            this.id = tr.id\r\n            if(tr.title == null){\r\n            }else{\r\n                this.title = tr.title.split('(')[0]\r\n            }\r\n            this.startDate = tr.startDate\r\n            this.endDate = tr.endDate\r\n            this.url = tr.url\r\n            if(tr.classes == null){\r\n            }else{\r\n                this.labelLocal = {\r\n                    text: tr.label,\r\n                    color: tr.classes.split('-')[1]\r\n                }\r\n            }\r\n\r\n            this.startDate_send = this.startDate\r\n            this.endDate_send = this.endDate\r\n            this.hora_inicio = tr.hora_inicio\r\n            this.hora_fin = tr.hora_fin\r\n            this.label_cancel = 'Cancelar'\r\n            this.abrirModal = true\r\n            this.estado = tr.estado\r\n            this.opciones.presentacion = datos.presentacion\r\n            this.opciones.entrega_muestras = datos.entrega_muestras\r\n            this.opciones.reunion = datos.reunion\r\n            this.opciones.seguimiento = datos.seguimiento\r\n            this.opciones.cierre = datos.cierre\r\n            this.opciones.cobranza = datos.cobranza\r\n            this.opciones.post_venta = datos.post_venta\r\n            this.opciones.retiro_cartas = datos.retiro_cartas\r\n            this.opciones.retiro_muestras = datos.retiro_muestras\r\n            // this.opciones.sinSello = datos.sinSello\r\n            this.opciones.otraEditorial = datos.otraEditorial\r\n            if (this.opciones.otraEditorial == false) {\r\n                this.opciones.editorial = \"\"\r\n            } else {\r\n                this.opciones.editorial = datos.editorial\r\n            }\r\n\r\n            if (tr.estado_institucion_temporal == \"1\") {\r\n                this.nombreInstitucion = tr.nombre_institucion_temporal\r\n                this.institucion_id_temporal = tr.institucion_id_temporal\r\n                this.periodo_id_temporal = tr.periodo_id\r\n                this.estado_institucion_temporal = 1\r\n            } else {\r\n                this.nombreInstitucion = tr.nombreInstitucion\r\n                this.institucion_id = tr.institucion_id\r\n                this.estado_institucion_temporal = 0\r\n\r\n            }\r\n\r\n        },\r\n        agregarInstitucionTemporal() {\r\n            let me = this;\r\n            if (me.temporalInstitucion.nombre_institucion == \"\" || me.temporalInstitucion.nombre_institucion == null || me.temporalInstitucion.nombre_institucion == undefined) {\r\n                me.$vs.notify({\r\n                    color: 'primary',\r\n                    title: 'Mensaje',\r\n                    text: 'Debe escribir una institución por favor'\r\n                })\r\n                return false;\r\n            }\r\n\r\n            let formData = new FormData();\r\n            formData.append('nombre_institucion', me.temporalInstitucion.nombre_institucion);\r\n            formData.append('ciudad', me.temporalInstitucion.ciudad.nombre);\r\n            formData.append('region', me.temporalInstitucion.region);\r\n            formData.append('asesor_id', localStorage.planificacion_asesor_id);\r\n\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'GuardarInstitucionTemporal', formData)\r\n                .then(res => {\r\n\r\n                    me.$vs.loading.close()\r\n                    me.popupAddNuevaInstitucion = false;\r\n                    me.abrirModal = true\r\n                    me.seleccionadoInsitucion = false;\r\n                    me.nombreInstitucion = me.temporalInstitucion.nombre_institucion\r\n                    me.institucion_id_temporal = res.data.institucion_temporal_id\r\n                    me.institucionesAsesor = []\r\n                    me.periodo_id_temporal = res.data.periodo_id\r\n                    me.estado_institucion_temporal = 1;\r\n\r\n                    me.$vs.notify({\r\n                        text: \"Se guardo correctamente\",\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n                })\r\n        },\r\n        //lista de ciudades para usar en el select\r\n        listaCiudades() {\r\n            let me = this\r\n            this.$http.get(this.$server_url + `ciudad`).then(res => {\r\n                    me.arregloCiudad = res.data;\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        regresar() {\r\n            let me = this;\r\n            me.seleccionadoInsitucion = false;\r\n            me.institucionesAsesor = []\r\n            me.error = false\r\n        },\r\n\r\n        asginarInstitucion(tr) {\r\n            let me = this;\r\n            me.institucion_id = tr.idInstitucion\r\n            me.nombreInstitucion = tr.nombreInstitucion\r\n            me.estado_institucion_temporal = 0;\r\n            me.seleccionadoInsitucion = false;\r\n            me.institucionesAsesor = []\r\n\r\n        },\r\n\r\n        getInstitucionAsesor() {\r\n            let me = this;\r\n            me.institucionesAsesor = [];\r\n            if (me.busquedaInstitucion.length < 5) {\r\n                me.$vs.notify({\r\n                    text: 'Minimo 5 caracteres de busqueda',\r\n                    color: 'warning',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-check'\r\n                })\r\n                return false;\r\n            }\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'listaInsitucionAsesor?busqueda=' + me.busquedaInstitucion + '&cedula=' + localStorage.planificacion_cedula)\r\n                .then(function (res) {\r\n                    // me.tmpInstituciones = res.data;\r\n                    me.institucionesAsesor = res.data;\r\n                    // me.filtroRegion();\r\n                    me.$vs.loading.close()\r\n                    if (res.data.message) {\r\n                        me.$vs.notify({\r\n                            text: res.data.message,\r\n                            color: 'success',\r\n                            iconPack: 'feather',\r\n                            icon: 'icon-user',\r\n                            time: 8000\r\n                        })\r\n                    }\r\n\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                    me.$vs.loading.close()\r\n\r\n                })\r\n        },\r\n        addEvent() {\r\n            let me = this\r\n            if(this.estado == 1){\r\n                me.error = true\r\n                me.messageError = \"La Planificación ya fue registrada ya no puede ser modificada\"\r\n                me.abrirModal = true\r\n                return false\r\n            }\r\n            if (this.institucion_id == \"\" && this.institucion_id_temporal == \"\") {\r\n              if (me.longitudCapacitaciones > 1) {\r\n                me.error = true\r\n                me.messageError = \"Existe mas de 2 capacitaciones para este libro, eliga para otro dia\"\r\n                me.abrirModal = true\r\n                return false\r\n               }\r\n                me.error = true;\r\n                me.messageError = \"Seleccione una institución por favor\";\r\n                me.abrirModal = true\r\n                return false;\r\n            }\r\n            if (this.title == '' || this.startDate_send == '') {\r\n                me.error = true;\r\n                me.messageError = \"Complete todos los campos antes de guardar\";\r\n                me.abrirModal = true\r\n                return false;\r\n            }\r\n             //si el asesor agrega otra editorial debe validarse que ingrese una institucion\r\n            if (this.opciones.otraEditorial == true) {\r\n                // si es tipo de institucion  de prolipa\r\n                me.abrirModal = true\r\n                if (this.opciones.editorial == \"\") {\r\n                    me.error = true;\r\n                    me.messageError = \"Ha seleccionado otra editorial tiene que agregar una editorial por favor\";\r\n                    me.abrirModal = true\r\n                    return false;\r\n                }\r\n                if (this.estado_institucion_temporal == 0) {\r\n                    if (this.institucion_id == \"\" || this.institucion_id == null || this.institucion_id == 0 || this.institucion_id == \"null\") {\r\n                        me.error = true;\r\n                        me.messageError = \"Ha seleccionado otra editorial tiene que agregar una institución por favor\";\r\n                        me.abrirModal = true\r\n                        return false;\r\n                    }\r\n                }\r\n                if (this.estado_institucion_temporal == 1) {\r\n                    if (this.institucion_id_temporal == \"\" || this.institucion_id_temporal == null || this.institucion_id_temporal == 0 || this.institucion_id_temporal == \"null\") {\r\n                        me.error = true;\r\n                        me.messageError = \"Ha seleccionado otra editorial tiene que agregar una institución por favor\";\r\n                        me.abrirModal = true\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n            const obj = {\r\n\r\n                idusuario: localStorage.planificacion_asesor_id,\r\n                title: this.title,\r\n                startDate: this.startDate_send,\r\n                endDate: this.endDate_send,\r\n                classes: 'event-' + this.labelLocal.color,\r\n                label: this.labelLocal.text,\r\n                url: this.url,\r\n                hora_inicio: this.hora_inicio.substring(0, 5),\r\n                hora_fin: this.hora_fin.substring(0, 5),\r\n                institucion_id: this.institucion_id,\r\n                opciones: this.opciones,\r\n                institucion_id_temporal: this.institucion_id_temporal,\r\n                estado_institucion_temporal: this.estado_institucion_temporal,\r\n                periodo_id_temporal: this.periodo_id_temporal,\r\n                nombreInstitucion: this.nombreInstitucion,\r\n                otraEditorial: this.opciones.otraEditorial,\r\n                nombre_editorial: this.opciones.editorial\r\n\r\n            }\r\n            me.save(obj)\r\n\r\n        },\r\n\r\n        save(obj){\r\n            let me = this;\r\n            let formData = new FormData();\r\n            me.institucionesProlipa = []\r\n            me.institucionesTemporales = []\r\n            formData.append('id', 0);\r\n            formData.append('idusuario', obj.idusuario);\r\n            formData.append('title', obj.title);\r\n            formData.append('label', obj.label);\r\n            formData.append('classes', obj.classes);\r\n            formData.append('startDate', obj.startDate);\r\n            formData.append('endDate', obj.endDate);\r\n            formData.append('hora_inicio', obj.hora_inicio);\r\n            formData.append('hora_fin', obj.hora_fin);\r\n            formData.append('url', obj.url);\r\n            formData.append('institucion_id', obj.institucion_id);\r\n            formData.append('opciones', JSON.stringify(obj.opciones));\r\n            formData.append('institucion_id_temporal', obj.institucion_id_temporal);\r\n            formData.append('estado_institucion_temporal', obj.estado_institucion_temporal);\r\n            formData.append('periodo_id_temporal', obj.periodo_id_temporal);\r\n            formData.append('nombreInstitucion', obj.nombreInstitucion);\r\n            formData.append('otraEditorial', obj.otraEditorial);\r\n            formData.append('nombre_editorial', obj.nombre_editorial);\r\n               me.$vs.loading()\r\n              this.$http.post(this.$server_url+'save_planificacion', formData)\r\n              .then(res => {\r\n\r\n                  me.$vs.loading.close()\r\n                  me.abrirModal = false;\r\n                //   me.registrarPendiente()\r\n                  me.limpiar();\r\n                  me.$vs.notify({\r\n                  text:'Planificación agregada con exito',\r\n                  color:'success',\r\n                  iconPack: 'feather',\r\n                  icon:'icon-check'})\r\n              })\r\n        },\r\n\r\n           registrarPendiente() {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            formData.append('id', me.id);\r\n            this.$http.post(this.$server_url + 'seguimiento-registrar', formData)\r\n                .then(res => {\r\n                    me.getRegistrosPendientes();\r\n                    me.$vs.notify({\r\n                        text: 'Se registro con exito',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check'\r\n                    })\r\n\r\n\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                })\r\n\r\n        },\r\n\r\n        limpiar(){\r\n            let me = this;\r\n            me.title = \"\";\r\n            me.titulo = \"\";\r\n            me.hora_inicio = \"\";\r\n            me.hora_fin = \"\";\r\n            me.nombre_institucion = \"\";\r\n            me.url = \"\";\r\n\r\n        },\r\n    }\r\n}\r\n</script>\r\n"]}]}