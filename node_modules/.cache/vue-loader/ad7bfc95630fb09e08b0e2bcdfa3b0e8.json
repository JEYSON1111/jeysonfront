{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\pedidos\\components\\Guias\\form_pedido.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\pedidos\\components\\Guias\\form_pedido.vue","mtime":1712682816278},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport {FormWizard, TabContent} from 'vue-form-wizard'\r\nimport 'vue-form-wizard/dist/vue-form-wizard.min.css'\r\nimport vSelect from 'vue-select';\r\nimport axios from 'axios'\r\nexport default {\r\n    components:{\r\n      FormWizard,\r\n      TabContent,\r\n      flatPickr,\r\n      'v-select': vSelect,\r\n    },\r\n    data: () => ({\r\n      usuario:[],\r\n      configdateTimePicker: {\r\n        enableTime: true,\r\n        dateFormat: 'Y-m-d'\r\n      },\r\n      periodos: [],\r\n      instituciones: [],\r\n      tipos_venta: [\r\n        {id_tipo: 1, tipo_venta: 'Directa'},\r\n        {id_tipo: 2, tipo_venta: 'Comisión o lista'},\r\n        // {id_tipo: 3, tipo_venta: 'Comisión en Libros'},\r\n        // {id_tipo: 4, tipo_venta: 'Operativa'},\r\n        // {id_tipo: 5, tipo_venta: 'Consignación'},\r\n      ],\r\n      pedido:{\r\n        id_pedido: 0,\r\n        periodo: '',\r\n        tipo_venta: '', \r\n        fecha_envio: '',\r\n        fecha_entrega: '',\r\n        institucion: '',\r\n        asesor: '',\r\n        descuento: '',\r\n        anticipo: '',\r\n        observacion:'',\r\n        ruc:'',\r\n        direccionInstitucion:'',\r\n        nivel:'',\r\n        tipo_descripcion:'',\r\n        telefonoInstitucion:'',\r\n        porcentaje_anticipo:0,\r\n        ifanticipo:0,\r\n        pendiente_liquidar:0,\r\n        convenio_anios:0,\r\n        anticipo_aprobado:0,\r\n        contrato_generado:'',\r\n        estado_entrega:0,\r\n      },\r\n      cant_sms: 0,\r\n      responsables: [],\r\n      modalResponsable: false,\r\n      id_pedido: '',\r\n      cedula_asesor: '',\r\n      disableAsesor:false,\r\n      counterDanger: false\r\n    }),\r\n    mounted() {\r\n      let me = this\r\n      this.usuario    = JSON.parse(localStorage.getItem('usuario'));\r\n      console.log(\"uwu\",me.sendPedido)\r\n      this.id_pedido  = me.sendPedido.id_pedido\r\n      this.pedido.periodo = {idperiodoescolar: localStorage.id_periodo_selected, periodoescolar: localStorage.nombre_periodo_selected}\r\n      this.usuario_id = this.usuario.idusuario\r\n      this.getPeriodos()\r\n      this.get_datos_pedido()\r\n      if(me.usuario.id_group == 11){\r\n        me.disableAsesor = false\r\n      }else{\r\n        me.disableAsesor = true\r\n      }\r\n    },\r\n    props:{\r\n      sendPedido:{\r\n        type:Object,\r\n        default:function(){\r\n          return {}\r\n        }\r\n      },\r\n    },\r\n    methods: {\r\n      openConfirm(){\r\n        this.$vs.dialog({\r\n          type:'confirm',\r\n          color: 'danger',\r\n          title: `Confirmar`,\r\n          text: 'Esta seguro de aprobar la solicitud de guias?',\r\n          accept:this.aprobarSolicitud\r\n        })\r\n      },\r\n      aprobarSolicitud(){\r\n        let me = this;\r\n        let formData = new FormData();\r\n        formData.append('id_pedido',me.id_pedido);\r\n        me.$vs.loading()\r\n        this.$http.post(this.$server_url+'entregarPedido', formData)\r\n        .then(res => {\r\n          me.get_datos_pedido();\r\n          me.$vs.loading.close()\r\n          me.$vs.notify({\r\n          text:'Solicitud de guia entregado con exito',\r\n          color:'success',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n        })\r\n        .catch(function (error) { me.$vs.loading.close() })\r\n      },\r\n      getPeriodos(){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_periodos_activos')\r\n        .then(res => {\r\n          me.periodos = res.data\r\n        })\r\n      },\r\n      guardarPedido(){\r\n        let me = this\r\n        if( me.pedido.periodo == '' || me.pedido.asesor == ''){\r\n          me.$vs.notify({ text: 'Llene todos los campos antes de guardar.', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n          return\r\n        }\r\n        let formData = new FormData();\r\n        formData.append('id_pedido',            me.pedido.id_pedido);\r\n        formData.append('fecha_envio',          me.pedido.fecha_envio);\r\n        formData.append('periodo',              me.pedido.periodo.idperiodoescolar);\r\n        formData.append('id_asesor',            me.pedido.asesor.idusuario);\r\n        formData.append('id_usuario_verif',     me.usuario.idusuario);\r\n        formData.append('observacion',          me.pedido.observacion);\r\n        me.$vs.loading();\r\n        //axios.post(this.$data_url+'api/guardarPedidoGuias',formData)\r\n        this.$http.post(this.$server_url+'guardarPedidoGuias', formData)\r\n        .then(res => {\r\n          me.$vs.loading.close();\r\n          if(res.data.status == 0){\r\n            me.$vs.notify({ text: res.data.message, color: 'danger', iconPack: 'feather', icon: 'icon-check', time:8000 })\r\n            return\r\n          }\r\n          if( res.data.error ){\r\n            alert(res.data.error)\r\n          }else{\r\n            me.$vs.notify({\r\n            color: 'primary',\r\n            title: 'Mensaje',\r\n            text: 'Se guardo correctamente'\r\n            })\r\n            me.pedido.id_pedido = res.data.pedido.id_pedido\r\n            this.$store.dispatch('setGuia',res.data.pedido)\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.log(err)\r\n          me.$vs.loading.close();\r\n        })\r\n      },\r\n      get_datos_pedido(){\r\n        let me = this\r\n        console.log(localStorage.id_pedido)\r\n        if( localStorage.id_pedido == 0 ){\r\n            me.pedido.asesor = {idusuario: me.usuario.idusuario, nombres: me.usuario.nombres+' '+me.usuario.apellidos}\r\n            me.cedula_asesor = me.usuario.cedula\r\n          return\r\n        }\r\n        this.$http.get(this.$server_url+'get_datos_pedido_guias/'+localStorage.id_pedido)\r\n        .then(res => {\r\n            me.pedido.id_pedido = res.data[0].id_pedido\r\n            me.pedido.fecha_envio = res.data[0].fecha_envio\r\n            me.pedido.asesor = {idusuario: res.data[0].id_asesor, nombres: res.data[0].nombres+' '+res.data[0].apellidos}\r\n            me.cedula_asesor = res.data[0].cedula\r\n            me.pedido.estado_entrega = res.data[0].estado_entrega\r\n            me.pedido.observacion    = res.data[0].observacion\r\n            //localStorage.setItem(\"institucion_selected_pedido\", me.pedido.institucion.id_institucion)\r\n            localStorage.setItem(\"id_asesor_pedido\", me.pedido.asesor.idusuario)\r\n        })\r\n        .catch(err => {\r\n          console.log(err)\r\n        })\r\n      },\r\n      guardarInstituciones(id_pedido){\r\n        let me = this\r\n        //asesor\r\n        if(me.usuario.id_group == 11){\r\n          window.location.href = \"/pedidos/guias/\"+id_pedido;\r\n          return\r\n        }\r\n        if(me.usuario.id_group == 27){\r\n          window.location.href = \"/pedidos/guias/bodega/\"+id_pedido;\r\n          return\r\n        }else{\r\n          window.location.href = \"/pedidos/administrador/guias/\"+id_pedido;\r\n        }\r\n        // this.$http.get(this.$server_url+'guardar_institucines_base_milton')\r\n        // .then(res => {\r\n        //   window.location.href = \"/pedidos/guias/\"+id_pedido;\r\n        // })\r\n        // .catch(err => {\r\n        // })\r\n      },\r\n     \r\n      limpiar(){\r\n        let me = this;\r\n        me.pedido.ruc                   = \"\"\r\n        me.pedido.direccionInstitucion  = \"\"\r\n        me.pedido.nivel                 = \"\"\r\n        me.pedido.tipo_descripcion      = \"\"\r\n        me.pedido.telefonoInstitucion   = \"\"\r\n      }\r\n    },\r\n}\r\n",{"version":3,"sources":["form_pedido.vue"],"names":[],"mappings":";AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"form_pedido.vue","sourceRoot":"src/views/pedidos/components/Guias","sourcesContent":["<template>\r\n<div>\r\n  <vs-chip class=\"mt-5 ml-4\" v-if=\"pedido.estado_entrega == 0\"><b>ESTADO:</b> <span class=\"ml-1\">PEDIDO NO ENTREGADO AUN</span></vs-chip>\r\n  <vs-chip class=\"mt-5 ml-4\" color=\"primary\" v-if=\"pedido.estado_entrega == 1\"><b>ESTADO:</b> <span class=\"ml-1\">PEDIDO APROBADO(FACTURADOR)</span></vs-chip>\r\n  <vs-chip class=\"mt-5 ml-4\" color=\"success\" v-if=\"pedido.estado_entrega == 2\"><b>ESTADO:</b> <span class=\"ml-1\">PEDIDO ENTREGADO(BODEGA)</span></vs-chip>\r\n  <br><br>\r\n    <div class=\"vx-row mt-3\">\r\n      <div class=\"vx-col md:w-1/5 w-full mb-3\" style=\"margin-left: 30px;\">\r\n        <div class=\"label_inputs\">Asesor</div>\r\n        <p style=\"font-weight: 500;\" class=\"text-primary\">{{pedido.asesor.nombres}}</p>\r\n      </div>\r\n      <div class=\"vx-col lg:w-1/3 md:w-full sm:w-full mb-3\">\r\n        <div class=\"label_inputs\">Periodo</div>\r\n        <v-select disabled :options=\"periodos\" :reduce=\"periodos => periodos\" label=\"periodoescolar\" v-model=\"pedido.periodo\" class=\"w-full\" />\r\n      </div>\r\n      <div class=\"vx-col lg:w-1/3 md:w-full sm:w-full mb-3\">\r\n        <div class=\"label_inputs\">Fecha envío</div>\r\n        <flat-pickr :config=\"configdateTimePicker\" v-model=\"pedido.fecha_envio\" placeholder=\"Fecha envío\" class=\"w-full\" />\r\n      </div>\r\n      <div class=\"vx-col lg:w-full md:w-full sm:w-full mb-3\">\r\n        <vs-textarea class=\"mt-2\" counter=\"500\" label=\"Observaciones\" placeholder=\"Indique la, Ciudad, dirección en donde desea recibir su pedido\" :counter-danger.sync=\"counterDanger\" v-model=\"pedido.observacion\" />\r\n      </div>\r\n      <div class=\"vx-col w-full  flex flex-grap gap-12 justify-center items-center\" align=\"center\">\r\n        <vs-button color=\"warning\" type=\"border\" icon-pack=\"feather\" icon=\"icon-save\" v-if=\"( usuario.id_group == 11 || usuario.id_group == 27 ) && pedido.estado_entrega == 0\" @click=\"guardarPedido\">Guardar pedido</vs-button>\r\n      </div>\r\n      <!-- <div class=\"vx-col w-full mt-6 flex flex-grap gap-12 justify-center items-center\" align=\"center\">\r\n        <vs-button color=\"warning\" type=\"border\" icon-pack=\"feather\" icon=\"icon-save\" v-if=\"usuario.id_group == 17 && pedido.estado_entrega == 0\" @click=\"openConfirm()\">Aprobar solicitud</vs-button>\r\n      </div> -->\r\n    </div>\r\n</div>\r\n</template>\r\n<script>\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport {FormWizard, TabContent} from 'vue-form-wizard'\r\nimport 'vue-form-wizard/dist/vue-form-wizard.min.css'\r\nimport vSelect from 'vue-select';\r\nimport axios from 'axios'\r\nexport default {\r\n    components:{\r\n      FormWizard,\r\n      TabContent,\r\n      flatPickr,\r\n      'v-select': vSelect,\r\n    },\r\n    data: () => ({\r\n      usuario:[],\r\n      configdateTimePicker: {\r\n        enableTime: true,\r\n        dateFormat: 'Y-m-d'\r\n      },\r\n      periodos: [],\r\n      instituciones: [],\r\n      tipos_venta: [\r\n        {id_tipo: 1, tipo_venta: 'Directa'},\r\n        {id_tipo: 2, tipo_venta: 'Comisión o lista'},\r\n        // {id_tipo: 3, tipo_venta: 'Comisión en Libros'},\r\n        // {id_tipo: 4, tipo_venta: 'Operativa'},\r\n        // {id_tipo: 5, tipo_venta: 'Consignación'},\r\n      ],\r\n      pedido:{\r\n        id_pedido: 0,\r\n        periodo: '',\r\n        tipo_venta: '', \r\n        fecha_envio: '',\r\n        fecha_entrega: '',\r\n        institucion: '',\r\n        asesor: '',\r\n        descuento: '',\r\n        anticipo: '',\r\n        observacion:'',\r\n        ruc:'',\r\n        direccionInstitucion:'',\r\n        nivel:'',\r\n        tipo_descripcion:'',\r\n        telefonoInstitucion:'',\r\n        porcentaje_anticipo:0,\r\n        ifanticipo:0,\r\n        pendiente_liquidar:0,\r\n        convenio_anios:0,\r\n        anticipo_aprobado:0,\r\n        contrato_generado:'',\r\n        estado_entrega:0,\r\n      },\r\n      cant_sms: 0,\r\n      responsables: [],\r\n      modalResponsable: false,\r\n      id_pedido: '',\r\n      cedula_asesor: '',\r\n      disableAsesor:false,\r\n      counterDanger: false\r\n    }),\r\n    mounted() {\r\n      let me = this\r\n      this.usuario    = JSON.parse(localStorage.getItem('usuario'));\r\n      console.log(\"uwu\",me.sendPedido)\r\n      this.id_pedido  = me.sendPedido.id_pedido\r\n      this.pedido.periodo = {idperiodoescolar: localStorage.id_periodo_selected, periodoescolar: localStorage.nombre_periodo_selected}\r\n      this.usuario_id = this.usuario.idusuario\r\n      this.getPeriodos()\r\n      this.get_datos_pedido()\r\n      if(me.usuario.id_group == 11){\r\n        me.disableAsesor = false\r\n      }else{\r\n        me.disableAsesor = true\r\n      }\r\n    },\r\n    props:{\r\n      sendPedido:{\r\n        type:Object,\r\n        default:function(){\r\n          return {}\r\n        }\r\n      },\r\n    },\r\n    methods: {\r\n      openConfirm(){\r\n        this.$vs.dialog({\r\n          type:'confirm',\r\n          color: 'danger',\r\n          title: `Confirmar`,\r\n          text: 'Esta seguro de aprobar la solicitud de guias?',\r\n          accept:this.aprobarSolicitud\r\n        })\r\n      },\r\n      aprobarSolicitud(){\r\n        let me = this;\r\n        let formData = new FormData();\r\n        formData.append('id_pedido',me.id_pedido);\r\n        me.$vs.loading()\r\n        this.$http.post(this.$server_url+'entregarPedido', formData)\r\n        .then(res => {\r\n          me.get_datos_pedido();\r\n          me.$vs.loading.close()\r\n          me.$vs.notify({\r\n          text:'Solicitud de guia entregado con exito',\r\n          color:'success',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n        })\r\n        .catch(function (error) { me.$vs.loading.close() })\r\n      },\r\n      getPeriodos(){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_periodos_activos')\r\n        .then(res => {\r\n          me.periodos = res.data\r\n        })\r\n      },\r\n      guardarPedido(){\r\n        let me = this\r\n        if( me.pedido.periodo == '' || me.pedido.asesor == ''){\r\n          me.$vs.notify({ text: 'Llene todos los campos antes de guardar.', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n          return\r\n        }\r\n        let formData = new FormData();\r\n        formData.append('id_pedido',            me.pedido.id_pedido);\r\n        formData.append('fecha_envio',          me.pedido.fecha_envio);\r\n        formData.append('periodo',              me.pedido.periodo.idperiodoescolar);\r\n        formData.append('id_asesor',            me.pedido.asesor.idusuario);\r\n        formData.append('id_usuario_verif',     me.usuario.idusuario);\r\n        formData.append('observacion',          me.pedido.observacion);\r\n        me.$vs.loading();\r\n        //axios.post(this.$data_url+'api/guardarPedidoGuias',formData)\r\n        this.$http.post(this.$server_url+'guardarPedidoGuias', formData)\r\n        .then(res => {\r\n          me.$vs.loading.close();\r\n          if(res.data.status == 0){\r\n            me.$vs.notify({ text: res.data.message, color: 'danger', iconPack: 'feather', icon: 'icon-check', time:8000 })\r\n            return\r\n          }\r\n          if( res.data.error ){\r\n            alert(res.data.error)\r\n          }else{\r\n            me.$vs.notify({\r\n            color: 'primary',\r\n            title: 'Mensaje',\r\n            text: 'Se guardo correctamente'\r\n            })\r\n            me.pedido.id_pedido = res.data.pedido.id_pedido\r\n            this.$store.dispatch('setGuia',res.data.pedido)\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.log(err)\r\n          me.$vs.loading.close();\r\n        })\r\n      },\r\n      get_datos_pedido(){\r\n        let me = this\r\n        console.log(localStorage.id_pedido)\r\n        if( localStorage.id_pedido == 0 ){\r\n            me.pedido.asesor = {idusuario: me.usuario.idusuario, nombres: me.usuario.nombres+' '+me.usuario.apellidos}\r\n            me.cedula_asesor = me.usuario.cedula\r\n          return\r\n        }\r\n        this.$http.get(this.$server_url+'get_datos_pedido_guias/'+localStorage.id_pedido)\r\n        .then(res => {\r\n            me.pedido.id_pedido = res.data[0].id_pedido\r\n            me.pedido.fecha_envio = res.data[0].fecha_envio\r\n            me.pedido.asesor = {idusuario: res.data[0].id_asesor, nombres: res.data[0].nombres+' '+res.data[0].apellidos}\r\n            me.cedula_asesor = res.data[0].cedula\r\n            me.pedido.estado_entrega = res.data[0].estado_entrega\r\n            me.pedido.observacion    = res.data[0].observacion\r\n            //localStorage.setItem(\"institucion_selected_pedido\", me.pedido.institucion.id_institucion)\r\n            localStorage.setItem(\"id_asesor_pedido\", me.pedido.asesor.idusuario)\r\n        })\r\n        .catch(err => {\r\n          console.log(err)\r\n        })\r\n      },\r\n      guardarInstituciones(id_pedido){\r\n        let me = this\r\n        //asesor\r\n        if(me.usuario.id_group == 11){\r\n          window.location.href = \"/pedidos/guias/\"+id_pedido;\r\n          return\r\n        }\r\n        if(me.usuario.id_group == 27){\r\n          window.location.href = \"/pedidos/guias/bodega/\"+id_pedido;\r\n          return\r\n        }else{\r\n          window.location.href = \"/pedidos/administrador/guias/\"+id_pedido;\r\n        }\r\n        // this.$http.get(this.$server_url+'guardar_institucines_base_milton')\r\n        // .then(res => {\r\n        //   window.location.href = \"/pedidos/guias/\"+id_pedido;\r\n        // })\r\n        // .catch(err => {\r\n        // })\r\n      },\r\n     \r\n      limpiar(){\r\n        let me = this;\r\n        me.pedido.ruc                   = \"\"\r\n        me.pedido.direccionInstitucion  = \"\"\r\n        me.pedido.nivel                 = \"\"\r\n        me.pedido.tipo_descripcion      = \"\"\r\n        me.pedido.telefonoInstitucion   = \"\"\r\n      }\r\n    },\r\n}\r\n</script>\r\n\r\n<style>\r\n.label_inputs{\r\n  font-size: 12px;\r\n  color: rgb(143, 143, 143);\r\n  margin-top: 4px;\r\n  padding-left: 4px;\r\n}\r\n</style>\r\n"]}]}