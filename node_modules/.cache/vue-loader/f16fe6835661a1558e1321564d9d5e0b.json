{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\temporadas\\components\\Pedidos\\Pagos\\components\\Verificacion\\ScreenRellenarPagos.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\temporadas\\components\\Pedidos\\Pagos\\components\\Verificacion\\ScreenRellenarPagos.vue","mtime":1712682816586},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport exportLiquidacionVue from '../../../../exportLiquidacion.vue'\r\nexport default{\r\n  components:{\r\n    exportLiquidacionVue,\r\n  },\r\n  data() {\r\n    return{\r\n      sumaTotalVALOR:0,\r\n      DetalleVerificacion:[],\r\n      //REGALADOS\r\n      totalRegalados:0,\r\n      totalCobroVenta:0,\r\n      arregloRegalados:[],\r\n      //VENTA REAL\r\n      arregloValoresVentaReal:[],\r\n      sumaVentaReal:0,\r\n      calcularPagoLiquidacion:false,\r\n    }\r\n  },\r\n  props:{\r\n    VerificacionSelect:{\r\n      type:Object,\r\n      default:function(){\r\n        return {}\r\n      }\r\n    },\r\n    sendPedido:{\r\n      type:Object,\r\n      default:function(){\r\n        return {}\r\n      }\r\n    },\r\n    cantidadVerificaciones:{\r\n      type:Number,\r\n      default:0,\r\n    },\r\n    datosInstitucion:{\r\n      type:Object,\r\n      default:function(){\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  mounted(){\r\n    let me = this;\r\n    me.limpiar()\r\n    me.getDetallesVerificacion()\r\n    me.getRegalados()\r\n  },\r\n  methods:{\r\n    changeHandleUpdatePayments(e){\r\n      let me = this\r\n      me.changeHandleUpdatePayments       = false\r\n      me.limpiar()\r\n      me.$emit('changeHandleUpdatePayments',true)\r\n    },\r\n    getDetallesVerificacion(){\r\n      let me                                            = this;\r\n      me.sumaTotalVALOR                                 = 0\r\n      me.DetalleVerificacion                            = []\r\n      const { id_institucion ,id_periodo }              = me.sendPedido\r\n      const { id, num_verificacion, contrato }          = me.VerificacionSelect\r\n      this.$http.get(this.$server_url+'n_verificacion?contrato='+contrato+'&detalles=yes&IdVerificacion='+id+'&verificacion_id='+num_verificacion+'&institucion_id='+id_institucion+'&periodo_id='+id_periodo)\r\n      .then(function (res) {\r\n        me.DetalleVerificacion = res.data\r\n        me.sumarTotalVenta()\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error + ' error');\r\n      })\r\n    },\r\n    sumarTotalVenta(){\r\n      let me = this;\r\n      if(me.DetalleVerificacion.length >0){\r\n        let datos = me.DetalleVerificacion.filter(p => p.valor)\r\n        let total = datos.reduce((a, b) => a + (b[\"valor\"] || 0), 0);\r\n        me.sumaTotalVALOR = total\r\n      }\r\n    },\r\n    //REGALADOS\r\n    getRegalados(){\r\n      let me = this\r\n      me.totalRegalados   = 0\r\n      me.totalCobroVenta  = 0\r\n      me.arregloRegalados = []\r\n      const { id_institucion ,id_periodo, descuento }                      = me.sendPedido\r\n      const { id, num_verificacion,tipoPago,permiso_cobro_venta_directa }  = me.VerificacionSelect\r\n      this.$http.get(this.$server_url+'getRegalados/'+id_institucion+'/'+id_periodo+'/'+num_verificacion+'/'+id)\r\n        .then(function (res) {\r\n          me.arregloRegalados = res.data\r\n          if(me.arregloRegalados.length > 0){\r\n            let datos           = me.arregloRegalados.filter(p => p.valor)\r\n            let total           = datos.reduce((a, b) => a + (b[\"valor\"] || 0), 0);\r\n            me.totalRegalados   = total\r\n            if(me.totalRegalados > 0){\r\n              //COBRO VENTA DIRECTA=>0 = NADA; 1 = 100%; 2 =porcentaje de la escuela;\r\n              //tipoPago => 0 =  NADA; 1 = Cancelar Total; 2 = Descontar; 3 = Regalado = 4 personalizado\r\n              if(tipoPago == 1 || tipoPago == 3) { me.totalCobroVenta = 0 }\r\n              if(tipoPago == 2 || me.setPersonalizado == 1) {\r\n                //si el cobro de venta directa esta activado\r\n                if(permiso_cobro_venta_directa == 1){\r\n                  me.totalCobroVenta  = ( me.totalRegalados - ( me.totalRegalados * descuento ) / 100)\r\n                }else{\r\n                  me.totalCobroVenta = 0\r\n                }\r\n              }\r\n            }\r\n          }\r\n          me.getVentaRealXVerificacion()\r\n        })\r\n        .catch(function (error) {\r\n            console.log(error + ' error');\r\n        })\r\n    },\r\n    getVentaRealXVerificacion(){\r\n      let me = this;\r\n      me.sumaVentaReal =0\r\n      me.arregloValoresVentaReal = []\r\n      const { id_institucion ,id_periodo }            = me.sendPedido\r\n      const { id, num_verificacion, contrato }        = me.VerificacionSelect\r\n      this.$http.get(this.$server_url+'n_verificacion?contrato='+contrato+'&getVentaRealXVerificacion=yes&IdVerificacion='+id+'&verificacion_id='+num_verificacion+'&institucion_id='+id_institucion+'&periodo_id='+id_periodo)\r\n      .then(function (res) {\r\n        me.arregloValoresVentaReal = res.data\r\n        me.sumarTotalVentaReal()\r\n      })\r\n      .catch(function (error) {\r\n          console.log(error + ' error');\r\n          me.$vs.loading.close()\r\n      })\r\n    },\r\n    sumarTotalVentaReal(){\r\n      let me = this;\r\n      if(me.arregloValoresVentaReal.length > 0){\r\n        let datos = me.arregloValoresVentaReal.filter(p => p.valor)\r\n        let total = datos.reduce((a, b) => a + (b[\"valor\"] || 0), 0);\r\n        me.sumaVentaReal = total\r\n      }\r\n      me.updateValorLiquidacion()\r\n    },\r\n    updateValorLiquidacion(){\r\n      let me = this;\r\n      let formData = new FormData();\r\n      formData.append('verificacion_id',    me.VerificacionSelect.id);\r\n      formData.append('venta_real',         me.sumaVentaReal + me.totalRegalados);\r\n      formData.append('venta_real_regalados',me.totalRegalados)\r\n      this.$http.post(this.$server_url+'updateVentaReal', formData)\r\n      .then(res => {\r\n      //Calcular los valores\r\n      me.calcularPagoLiquidacion = true\r\n      })\r\n    },\r\n    limpiar(){\r\n      let me = this\r\n      me.sumaTotalVALOR           = 0\r\n      me.DetalleVerificacion      = []\r\n      //REGALADOS\r\n      me.totalRegalados           = 0\r\n      me.totalCobroVenta          = 0\r\n      me.arregloRegalados         = []\r\n      //VENTA REAL\r\n      me.arregloValoresVentaReal  = []\r\n      me.sumaVentaReal            = 0\r\n      me.calcularPagoLiquidacion  = false\r\n      //CONVENIO\r\n      me.arregloHijosConvenio     = []\r\n      me.NumeroConvenio           = 0\r\n      me.ObjectConvenio           = {}\r\n      me.SaldoConvenio            = 0\r\n      me.totalAnticipos           = 0\r\n    },\r\n  }\r\n}\r\n",{"version":3,"sources":["ScreenRellenarPagos.vue"],"names":[],"mappings":";AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ScreenRellenarPagos.vue","sourceRoot":"src/views/temporadas/components/Pedidos/Pagos/components/Verificacion","sourcesContent":["<template>\r\n  <div>\r\n    <div>\r\n      <div v-if=\"calcularPagoLiquidacion\">\r\n        <exportLiquidacionVue\r\n        :VerificacionSelect=\"VerificacionSelect\"\r\n        :sumaTotalVALOR=\"sumaTotalVALOR\"\r\n        :sumaTotalValorRegalados=\"totalRegalados\"\r\n        :DetalleVerificacion=\"DetalleVerificacion\"\r\n        :totalCobroVenta=\"totalCobroVenta\"\r\n        :sendPedido=\"sendPedido\"\r\n        :cantidadVerificaciones=\"cantidadVerificaciones\"\r\n        :datosInstitucion=\"datosInstitucion\"\r\n        :desdeConfiguracion=\"2\"\r\n        @changeHandleUpdatePayments=\"changeHandleUpdatePayments\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport exportLiquidacionVue from '../../../../exportLiquidacion.vue'\r\nexport default{\r\n  components:{\r\n    exportLiquidacionVue,\r\n  },\r\n  data() {\r\n    return{\r\n      sumaTotalVALOR:0,\r\n      DetalleVerificacion:[],\r\n      //REGALADOS\r\n      totalRegalados:0,\r\n      totalCobroVenta:0,\r\n      arregloRegalados:[],\r\n      //VENTA REAL\r\n      arregloValoresVentaReal:[],\r\n      sumaVentaReal:0,\r\n      calcularPagoLiquidacion:false,\r\n    }\r\n  },\r\n  props:{\r\n    VerificacionSelect:{\r\n      type:Object,\r\n      default:function(){\r\n        return {}\r\n      }\r\n    },\r\n    sendPedido:{\r\n      type:Object,\r\n      default:function(){\r\n        return {}\r\n      }\r\n    },\r\n    cantidadVerificaciones:{\r\n      type:Number,\r\n      default:0,\r\n    },\r\n    datosInstitucion:{\r\n      type:Object,\r\n      default:function(){\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  mounted(){\r\n    let me = this;\r\n    me.limpiar()\r\n    me.getDetallesVerificacion()\r\n    me.getRegalados()\r\n  },\r\n  methods:{\r\n    changeHandleUpdatePayments(e){\r\n      let me = this\r\n      me.changeHandleUpdatePayments       = false\r\n      me.limpiar()\r\n      me.$emit('changeHandleUpdatePayments',true)\r\n    },\r\n    getDetallesVerificacion(){\r\n      let me                                            = this;\r\n      me.sumaTotalVALOR                                 = 0\r\n      me.DetalleVerificacion                            = []\r\n      const { id_institucion ,id_periodo }              = me.sendPedido\r\n      const { id, num_verificacion, contrato }          = me.VerificacionSelect\r\n      this.$http.get(this.$server_url+'n_verificacion?contrato='+contrato+'&detalles=yes&IdVerificacion='+id+'&verificacion_id='+num_verificacion+'&institucion_id='+id_institucion+'&periodo_id='+id_periodo)\r\n      .then(function (res) {\r\n        me.DetalleVerificacion = res.data\r\n        me.sumarTotalVenta()\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error + ' error');\r\n      })\r\n    },\r\n    sumarTotalVenta(){\r\n      let me = this;\r\n      if(me.DetalleVerificacion.length >0){\r\n        let datos = me.DetalleVerificacion.filter(p => p.valor)\r\n        let total = datos.reduce((a, b) => a + (b[\"valor\"] || 0), 0);\r\n        me.sumaTotalVALOR = total\r\n      }\r\n    },\r\n    //REGALADOS\r\n    getRegalados(){\r\n      let me = this\r\n      me.totalRegalados   = 0\r\n      me.totalCobroVenta  = 0\r\n      me.arregloRegalados = []\r\n      const { id_institucion ,id_periodo, descuento }                      = me.sendPedido\r\n      const { id, num_verificacion,tipoPago,permiso_cobro_venta_directa }  = me.VerificacionSelect\r\n      this.$http.get(this.$server_url+'getRegalados/'+id_institucion+'/'+id_periodo+'/'+num_verificacion+'/'+id)\r\n        .then(function (res) {\r\n          me.arregloRegalados = res.data\r\n          if(me.arregloRegalados.length > 0){\r\n            let datos           = me.arregloRegalados.filter(p => p.valor)\r\n            let total           = datos.reduce((a, b) => a + (b[\"valor\"] || 0), 0);\r\n            me.totalRegalados   = total\r\n            if(me.totalRegalados > 0){\r\n              //COBRO VENTA DIRECTA=>0 = NADA; 1 = 100%; 2 =porcentaje de la escuela;\r\n              //tipoPago => 0 =  NADA; 1 = Cancelar Total; 2 = Descontar; 3 = Regalado = 4 personalizado\r\n              if(tipoPago == 1 || tipoPago == 3) { me.totalCobroVenta = 0 }\r\n              if(tipoPago == 2 || me.setPersonalizado == 1) {\r\n                //si el cobro de venta directa esta activado\r\n                if(permiso_cobro_venta_directa == 1){\r\n                  me.totalCobroVenta  = ( me.totalRegalados - ( me.totalRegalados * descuento ) / 100)\r\n                }else{\r\n                  me.totalCobroVenta = 0\r\n                }\r\n              }\r\n            }\r\n          }\r\n          me.getVentaRealXVerificacion()\r\n        })\r\n        .catch(function (error) {\r\n            console.log(error + ' error');\r\n        })\r\n    },\r\n    getVentaRealXVerificacion(){\r\n      let me = this;\r\n      me.sumaVentaReal =0\r\n      me.arregloValoresVentaReal = []\r\n      const { id_institucion ,id_periodo }            = me.sendPedido\r\n      const { id, num_verificacion, contrato }        = me.VerificacionSelect\r\n      this.$http.get(this.$server_url+'n_verificacion?contrato='+contrato+'&getVentaRealXVerificacion=yes&IdVerificacion='+id+'&verificacion_id='+num_verificacion+'&institucion_id='+id_institucion+'&periodo_id='+id_periodo)\r\n      .then(function (res) {\r\n        me.arregloValoresVentaReal = res.data\r\n        me.sumarTotalVentaReal()\r\n      })\r\n      .catch(function (error) {\r\n          console.log(error + ' error');\r\n          me.$vs.loading.close()\r\n      })\r\n    },\r\n    sumarTotalVentaReal(){\r\n      let me = this;\r\n      if(me.arregloValoresVentaReal.length > 0){\r\n        let datos = me.arregloValoresVentaReal.filter(p => p.valor)\r\n        let total = datos.reduce((a, b) => a + (b[\"valor\"] || 0), 0);\r\n        me.sumaVentaReal = total\r\n      }\r\n      me.updateValorLiquidacion()\r\n    },\r\n    updateValorLiquidacion(){\r\n      let me = this;\r\n      let formData = new FormData();\r\n      formData.append('verificacion_id',    me.VerificacionSelect.id);\r\n      formData.append('venta_real',         me.sumaVentaReal + me.totalRegalados);\r\n      formData.append('venta_real_regalados',me.totalRegalados)\r\n      this.$http.post(this.$server_url+'updateVentaReal', formData)\r\n      .then(res => {\r\n      //Calcular los valores\r\n      me.calcularPagoLiquidacion = true\r\n      })\r\n    },\r\n    limpiar(){\r\n      let me = this\r\n      me.sumaTotalVALOR           = 0\r\n      me.DetalleVerificacion      = []\r\n      //REGALADOS\r\n      me.totalRegalados           = 0\r\n      me.totalCobroVenta          = 0\r\n      me.arregloRegalados         = []\r\n      //VENTA REAL\r\n      me.arregloValoresVentaReal  = []\r\n      me.sumaVentaReal            = 0\r\n      me.calcularPagoLiquidacion  = false\r\n      //CONVENIO\r\n      me.arregloHijosConvenio     = []\r\n      me.NumeroConvenio           = 0\r\n      me.ObjectConvenio           = {}\r\n      me.SaldoConvenio            = 0\r\n      me.totalAnticipos           = 0\r\n    },\r\n  }\r\n}\r\n</script>\r\n"]}]}