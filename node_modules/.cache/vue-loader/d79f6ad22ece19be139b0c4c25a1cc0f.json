{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\director\\visitasUsers.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\director\\visitasUsers.vue","mtime":1712682815738},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport moment from 'moment'\r\nexport default{\r\n    data(){\r\n        return{\r\n            institucion:{},\r\n            arregloVisitas:[],\r\n            anios:[],\r\n            anioSelect:'',\r\n            anioseleccionado:'',\r\n            yactual:null,\r\n            menosUno:null,\r\n            fromDate:null,\r\n            toDate:null,\r\n            mesDescripcion:'',\r\n            //variables para el export a excel\r\n            fileName: null,\r\n            formats: ['xls', 'xlsx', 'csv', 'txt'],\r\n            cellAutoWidth: true,\r\n            selectedFormat: 'xls',\r\n            //fin variables de exportar excel\r\n        }\r\n    },\r\n    created(){\r\n        moment.locale('es');\r\n        let me = this;\r\n        me.institucion = JSON.parse(localStorage.getItem(\"institucion\"))\r\n    },\r\n    mounted(){\r\n        let me = this\r\n        // me.getVisitas()\r\n        me.yactual = moment().format('YYYY');\r\n        me.mactual = moment().format('M');\r\n        me.mesDescripcion = moment().format('MMMM');\r\n        //restar Anios\r\n        me.menosUno = me.yactual - 1;\r\n        me.anios.push({anio:me.yactual});\r\n        me.anios.push({anio:me.menosUno}); \r\n        me.anioSelect = this.anios[0].anio\r\n        me.getMonthStartEnd(me.yactual,me.mactual)\r\n    },\r\n    methods:{\r\n        getMonthStartEnd(year, month) {\r\n            let me = this\r\n            const startDate = new Date(year, parseInt(month-1), 1);\r\n            const endDate = new Date(year, parseInt(month-1) + 1, 0);\r\n            me.fromDate       = moment(startDate).format('YYYY-MM-DD')\r\n            me.toDate         = moment(endDate).format('YYYY-MM-DD')\r\n            me.getVisitas()\r\n        // return { start: startDate, end: endDate };\r\n        },\r\n        // const { start, end } = getMonthStartEnd(2023, 11);\r\n        getVisitas(){\r\n            let me = this;\r\n            me.arregloVisitas = []\r\n            me.anioseleccionado = me.anioSelect\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'usuarioVisitasAll?institucion_id=' + me.institucion.institucion_id+'&fromDate='+me.fromDate+'&toDate='+me.toDate)\r\n                .then(function (response) {\r\n                    me.$vs.loading.close()\r\n                    let datos = response.data\r\n                    datos.forEach((element,index) => {\r\n                            var cal = new Object();\r\n                            cal.idusuario = element.idusuario\r\n                            cal.usuario = element.usuario\r\n                            cal.cedula = element.cedula\r\n                            cal.email = element.email\r\n                            let getRecursos = element.visitas\r\n                            // cal.recursos = new Object();\r\n                            let contador1   = getRecursos.filter(p => p.recurso == 1)           //:libro,\r\n                            let contador2   = getRecursos.filter(p => p.recurso == 2)           //:unidades,\r\n                            let contador3   = getRecursos.filter(p => p.recurso == 3)           //:cuadernos,\r\n                            let contador4   = getRecursos.filter(p => p.recurso == 4)           //:teletarea,\r\n                            let contador5   = getRecursos.filter(p => p.recurso == 5)           //:proyectos, \r\n                            let contador6   = getRecursos.filter(p => p.recurso == 6)           //:adaptaciones,\r\n                            let contador7   = getRecursos.filter(p => p.recurso == 7)           //:propuestas,\r\n                            let contador8   = getRecursos.filter(p => p.recurso == 8)           //:juegos,\r\n                            let contador9   = getRecursos.filter(p => p.recurso == 9)           //:material,\r\n                            let contador10  = getRecursos.filter(p => p.recurso == 10)          //:articulos,\r\n                            let contador11  = getRecursos.filter(p => p.recurso == 11)          //:tareas,\r\n                            let contador12  = getRecursos.filter(p => p.recurso == 12)          //:pdf guia,\r\n                            let contador13  = getRecursos.filter(p => p.recurso == 13)          //:pdf sin guia,\r\n                            let contador14  = getRecursos.filter(p => p.recurso == 14)          //:guia didactica,\r\n                            let contador15  = getRecursos.filter(p => p.recurso == 15)          //:Ingreso al sistema,\r\n                            let contador16  = getRecursos.filter(p => p.recurso == 16)         //:Planificacion,\r\n                            let contador17  = getRecursos.filter(p => p.recurso == 17)         //:Documentos Minesterial,\r\n                            let contador18  = getRecursos.filter(p => p.recurso == 18)         //:videos tema,\r\n                            let contador19  = getRecursos.filter(p => p.recurso == 19)         //:actividades,\r\n                            let contador20  = getRecursos.filter(p => p.recurso == 20)         //:animaciones\r\n                            for (let index = 1; index <= 20; index++) {\r\n                                try {\r\n                                    eval(\"cal.contador\" + index + \"=\" + \"contador\"+index+\".length\");\r\n                                } catch (error) {\r\n                                    eval(\"cal.contador\" + index + \"=\" + 0);\r\n                                }\r\n                                \r\n                            }\r\n                        me.arregloVisitas.push(cal)\r\n                    });\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n          //METODOS PARA EXCEL\r\n        //para limipiar los campos del excel\r\n        clearFields() {\r\n            this.fileName = ''\r\n            this.cellAutoWidth = true\r\n            this.selectedFormat = 'xls'\r\n        },\r\n        //metodo par descargar el excel\r\n        exportToExcel() {\r\n            let me = this;\r\n            let headerTitle = [\r\n                'Nombres',\r\n                'Cédula',\r\n                'Ingreso al sistema',\r\n                'libro',\r\n                'unidades',\r\n                'cuadernos',\r\n                'teletarea',\r\n                'proyectos',\r\n                'adaptaciones curriculares',\r\n                'propuestas metodológicas',\r\n                'juegos',\r\n                'material',\r\n                'articulos',\r\n                'tareas',\r\n                'pdf guia',\r\n                'pdf sin guia',\r\n                'guia didactica',\r\n                'Planificación',\r\n                'Documentos Minesteriales',\r\n                'videos',\r\n                'actividades',\r\n                'animaciones'\r\n            ];\r\n            let headerVal = [\r\n                'usuario',\r\n                'cedula',\r\n                'contador15',\r\n                'contador1',\r\n                'contador2',\r\n                'contador3',\r\n                'contador4',\r\n                'contador5',\r\n                'contador6',\r\n                'contador7',\r\n                'contador8',\r\n                'contador9',\r\n                'contador10',\r\n                'contador11',\r\n                'contador12',\r\n                'contador13',\r\n                'contador14',\r\n                'contador16',\r\n                'contador17',\r\n                'contador18',\r\n                'contador19',\r\n                'contador20',\r\n            ];  \r\n            let codigoSelectedMayus = this.arregloVisitas\r\n            for (var i = 0; i < codigoSelectedMayus.length; i++) {\r\n                for (var key in codigoSelectedMayus[i]) {\r\n                    if (typeof codigoSelectedMayus[i][key] == \"string\") {\r\n                        codigoSelectedMayus[i][key] = codigoSelectedMayus[i][key].toUpperCase();\r\n                    }\r\n                }\r\n            }\r\n            let reporte = 'Reporte visitas '+me.mesDescripcion+'-'+me.anioseleccionado+'-'+me.institucion.nombreInstitucion\r\n            import('@/vendor/Export2Excel').then(excel => {\r\n                const list = codigoSelectedMayus\r\n                const data = this.formatJson(headerVal, list)\r\n                excel.export_json_to_excel({\r\n                    header: headerTitle,\r\n                    data,\r\n                    filename: reporte,\r\n                    autoWidth: this.cellAutoWidth,\r\n                    bookType: this.selectedFormat\r\n                })\r\n                this.clearFields()\r\n            })\r\n        },\r\n        formatJson(filterVal, jsonData) {\r\n            return jsonData.map(v => filterVal.map(j => {\r\n                return v[j]\r\n            }))\r\n        },\r\n    }\r\n}\r\n",{"version":3,"sources":["visitasUsers.vue"],"names":[],"mappings":";AA+GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"visitasUsers.vue","sourceRoot":"src/views/director","sourcesContent":["<template>\r\n    <div class=\"mt-2\">\r\n        <vs-list-header color=\"success\" icon=\"groups\" title=\"Filtro de visitas de docentes\"></vs-list-header>\r\n        <div class=\"flex\" style=\"position: relative;top:15px\">\r\n            <ul class=\"leftx\">\r\n                <li v-for=\"(tr,index) in anios\" :key=\"index\">\r\n                    <vs-radio v-model=\"anioSelect\" @input=\"getEstastica()\" vs-name=\"radios1\" :vs-value=\"tr.anio\">{{ tr.anio }}</vs-radio>\r\n                </li>\r\n            </ul>\r\n            <vs-dropdown vs-custom-content vs-trigger-click  class=\"ml-5\">\r\n                <vs-button type=\"relief\" icon=\"event\" color=\"warning\"  class=\"a-icon\" >\r\n                    Seleccione el mes a filtrar\r\n                    <vs-icon style=\"position: relative;top: 2px;\" icon=\"expand_more\"></vs-icon>\r\n                </vs-button>\r\n                <vs-dropdown-menu class=\"loginx\">\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='enero';getMonthStartEnd(anioSelect,1)\" >\r\n                        <span class=\"feather icon icon-calendar\" ></span> Enero\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='febrero';getMonthStartEnd(anioSelect,2)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Febrero\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='marzo';getMonthStartEnd(anioSelect,3)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Marzo\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='abril';getMonthStartEnd(anioSelect,4)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Abril\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='mayo';getMonthStartEnd(anioSelect,5)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Mayo\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='junio';getMonthStartEnd(anioSelect,6)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Junio\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='julio';getMonthStartEnd(anioSelect,7)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Julio\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='agosto';getMonthStartEnd(anioSelect,8)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Agosto\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='septiembre';getMonthStartEnd(anioSelect,9)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Septiembre\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='octubre';getMonthStartEnd(anioSelect,10)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Octubre\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='noviembre';getMonthStartEnd(anioSelect,11)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Noviembre\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='diciembre';getMonthStartEnd(anioSelect,12)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Diciembre\r\n                    </vs-dropdown-item>\r\n                </vs-dropdown-menu>\r\n            </vs-dropdown>\r\n        </div>\r\n        <!--Tabla-->\r\n        <br>\r\n        <vs-divider color=\"success\" class=\"mt-5\">VISITAS DEL MES {{ mesDescripcion.toUpperCase() }} DEL AÑO {{ anioseleccionado }}</vs-divider>\r\n        <vs-table max-items=\"10\" stripe search pagination :data=\"arregloVisitas\">\r\n            <template slot=\"header\">\r\n                <vs-chip  color=\"primary\">Cantidad: <b> {{ arregloVisitas.length }}</b></vs-chip>\r\n                <span @click=\"exportToExcel()\" class=\"cursor-pointer\">\r\n                    <vs-chip transparent class=\"py-3 ml-2\" style=\"font-weight: bold;\" color=\"warning\"><i class=\"fa-solid fa-download\"></i><span class=\"ml-2\">Exportar</span> </vs-chip>\r\n                </span>\r\n            </template>\r\n            <template slot=\"thead\">\r\n                <vs-th>Datos</vs-th>\r\n                <vs-th>Visitas</vs-th>\r\n            </template>\r\n            <template slot-scope=\"{data}\">\r\n                <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                    <vs-td>\r\n                        Nombres:\r\n                        <br>        \r\n                        <span style=\"font-weight:600;  \" >\r\n                        {{ tr.usuario }} {{ tr.apellidos }}<br>\r\n                        </span>\r\n                        Cédula:\r\n                        <br>  \r\n                        <span style=\"font-weight:600;  \" >\r\n                        {{ tr.cedula }}<br>\r\n                        </span>\r\n                        \r\n                    </vs-td>\r\n                    <vs-td>\r\n                       <p>Ingreso al sistema:       <span class=\"font-bold\">{{ tr.contador15 }}</span></p>\r\n                       <p>Libros:                   <span class=\"font-bold\">{{ tr.contador1 }}</span></p>\r\n                       <p>Unidades:                 <span class=\"font-bold\">{{ tr.contador2 }}</span></p>\r\n                       <p>Cuadernos:                <span class=\"font-bold\">{{ tr.contador3 }}</span></p>\r\n                       <p>Teletarea:                <span class=\"font-bold\">{{ tr.contador4 }}</span></p>\r\n                       <p>Proyectos:                <span class=\"font-bold\">{{ tr.contador5 }}</span></p>\r\n                       <p>Adaptaciones curriculares:<span class=\"font-bold\">{{ tr.contador6 }}</span></p>\r\n                       <p>Propuestas metodólogicas: <span class=\"font-bold\">{{ tr.contador7 }}</span></p>\r\n                       <p>Juegos:                   <span class=\"font-bold\">{{ tr.contador8 }}</span></p>\r\n                       <p>Material:                 <span class=\"font-bold\">{{ tr.contador9 }}</span></p>\r\n                       <p>Artículos:                <span class=\"font-bold\">{{ tr.contador10 }}</span></p>\r\n                       <p>Tareas:                   <span class=\"font-bold\">{{ tr.contador11 }}</span></p>\r\n                       <p>Pdf guia:                 <span class=\"font-bold\">{{ tr.contador12 }}</span></p>\r\n                       <p>Pdf sin guia:             <span class=\"font-bold\">{{ tr.contador13 }}</span></p>\r\n                       <p>Guia didáctica:           <span class=\"font-bold\">{{ tr.contador14 }}</span></p>\r\n                       <p>Planificación:            <span class=\"font-bold\">{{ tr.contador16 }}</span></p>\r\n                       <p>Documentos Minesterial:   <span class=\"font-bold\">{{ tr.contador17 }}</span></p>\r\n                       <p>Videos:                   <span class=\"font-bold\">{{ tr.contador18 }}</span></p>\r\n                       <p>Actividades:              <span class=\"font-bold\">{{ tr.contador19 }}</span></p>\r\n                       <p>Animaciones:              <span class=\"font-bold\">{{ tr.contador20 }}</span></p>\r\n                    </vs-td>\r\n                </vs-tr>\r\n            </template>\r\n        </vs-table> \r\n    </div>\r\n</template>\r\n<script>\r\nimport moment from 'moment'\r\nexport default{\r\n    data(){\r\n        return{\r\n            institucion:{},\r\n            arregloVisitas:[],\r\n            anios:[],\r\n            anioSelect:'',\r\n            anioseleccionado:'',\r\n            yactual:null,\r\n            menosUno:null,\r\n            fromDate:null,\r\n            toDate:null,\r\n            mesDescripcion:'',\r\n            //variables para el export a excel\r\n            fileName: null,\r\n            formats: ['xls', 'xlsx', 'csv', 'txt'],\r\n            cellAutoWidth: true,\r\n            selectedFormat: 'xls',\r\n            //fin variables de exportar excel\r\n        }\r\n    },\r\n    created(){\r\n        moment.locale('es');\r\n        let me = this;\r\n        me.institucion = JSON.parse(localStorage.getItem(\"institucion\"))\r\n    },\r\n    mounted(){\r\n        let me = this\r\n        // me.getVisitas()\r\n        me.yactual = moment().format('YYYY');\r\n        me.mactual = moment().format('M');\r\n        me.mesDescripcion = moment().format('MMMM');\r\n        //restar Anios\r\n        me.menosUno = me.yactual - 1;\r\n        me.anios.push({anio:me.yactual});\r\n        me.anios.push({anio:me.menosUno}); \r\n        me.anioSelect = this.anios[0].anio\r\n        me.getMonthStartEnd(me.yactual,me.mactual)\r\n    },\r\n    methods:{\r\n        getMonthStartEnd(year, month) {\r\n            let me = this\r\n            const startDate = new Date(year, parseInt(month-1), 1);\r\n            const endDate = new Date(year, parseInt(month-1) + 1, 0);\r\n            me.fromDate       = moment(startDate).format('YYYY-MM-DD')\r\n            me.toDate         = moment(endDate).format('YYYY-MM-DD')\r\n            me.getVisitas()\r\n        // return { start: startDate, end: endDate };\r\n        },\r\n        // const { start, end } = getMonthStartEnd(2023, 11);\r\n        getVisitas(){\r\n            let me = this;\r\n            me.arregloVisitas = []\r\n            me.anioseleccionado = me.anioSelect\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'usuarioVisitasAll?institucion_id=' + me.institucion.institucion_id+'&fromDate='+me.fromDate+'&toDate='+me.toDate)\r\n                .then(function (response) {\r\n                    me.$vs.loading.close()\r\n                    let datos = response.data\r\n                    datos.forEach((element,index) => {\r\n                            var cal = new Object();\r\n                            cal.idusuario = element.idusuario\r\n                            cal.usuario = element.usuario\r\n                            cal.cedula = element.cedula\r\n                            cal.email = element.email\r\n                            let getRecursos = element.visitas\r\n                            // cal.recursos = new Object();\r\n                            let contador1   = getRecursos.filter(p => p.recurso == 1)           //:libro,\r\n                            let contador2   = getRecursos.filter(p => p.recurso == 2)           //:unidades,\r\n                            let contador3   = getRecursos.filter(p => p.recurso == 3)           //:cuadernos,\r\n                            let contador4   = getRecursos.filter(p => p.recurso == 4)           //:teletarea,\r\n                            let contador5   = getRecursos.filter(p => p.recurso == 5)           //:proyectos, \r\n                            let contador6   = getRecursos.filter(p => p.recurso == 6)           //:adaptaciones,\r\n                            let contador7   = getRecursos.filter(p => p.recurso == 7)           //:propuestas,\r\n                            let contador8   = getRecursos.filter(p => p.recurso == 8)           //:juegos,\r\n                            let contador9   = getRecursos.filter(p => p.recurso == 9)           //:material,\r\n                            let contador10  = getRecursos.filter(p => p.recurso == 10)          //:articulos,\r\n                            let contador11  = getRecursos.filter(p => p.recurso == 11)          //:tareas,\r\n                            let contador12  = getRecursos.filter(p => p.recurso == 12)          //:pdf guia,\r\n                            let contador13  = getRecursos.filter(p => p.recurso == 13)          //:pdf sin guia,\r\n                            let contador14  = getRecursos.filter(p => p.recurso == 14)          //:guia didactica,\r\n                            let contador15  = getRecursos.filter(p => p.recurso == 15)          //:Ingreso al sistema,\r\n                            let contador16  = getRecursos.filter(p => p.recurso == 16)         //:Planificacion,\r\n                            let contador17  = getRecursos.filter(p => p.recurso == 17)         //:Documentos Minesterial,\r\n                            let contador18  = getRecursos.filter(p => p.recurso == 18)         //:videos tema,\r\n                            let contador19  = getRecursos.filter(p => p.recurso == 19)         //:actividades,\r\n                            let contador20  = getRecursos.filter(p => p.recurso == 20)         //:animaciones\r\n                            for (let index = 1; index <= 20; index++) {\r\n                                try {\r\n                                    eval(\"cal.contador\" + index + \"=\" + \"contador\"+index+\".length\");\r\n                                } catch (error) {\r\n                                    eval(\"cal.contador\" + index + \"=\" + 0);\r\n                                }\r\n                                \r\n                            }\r\n                        me.arregloVisitas.push(cal)\r\n                    });\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n          //METODOS PARA EXCEL\r\n        //para limipiar los campos del excel\r\n        clearFields() {\r\n            this.fileName = ''\r\n            this.cellAutoWidth = true\r\n            this.selectedFormat = 'xls'\r\n        },\r\n        //metodo par descargar el excel\r\n        exportToExcel() {\r\n            let me = this;\r\n            let headerTitle = [\r\n                'Nombres',\r\n                'Cédula',\r\n                'Ingreso al sistema',\r\n                'libro',\r\n                'unidades',\r\n                'cuadernos',\r\n                'teletarea',\r\n                'proyectos',\r\n                'adaptaciones curriculares',\r\n                'propuestas metodológicas',\r\n                'juegos',\r\n                'material',\r\n                'articulos',\r\n                'tareas',\r\n                'pdf guia',\r\n                'pdf sin guia',\r\n                'guia didactica',\r\n                'Planificación',\r\n                'Documentos Minesteriales',\r\n                'videos',\r\n                'actividades',\r\n                'animaciones'\r\n            ];\r\n            let headerVal = [\r\n                'usuario',\r\n                'cedula',\r\n                'contador15',\r\n                'contador1',\r\n                'contador2',\r\n                'contador3',\r\n                'contador4',\r\n                'contador5',\r\n                'contador6',\r\n                'contador7',\r\n                'contador8',\r\n                'contador9',\r\n                'contador10',\r\n                'contador11',\r\n                'contador12',\r\n                'contador13',\r\n                'contador14',\r\n                'contador16',\r\n                'contador17',\r\n                'contador18',\r\n                'contador19',\r\n                'contador20',\r\n            ];  \r\n            let codigoSelectedMayus = this.arregloVisitas\r\n            for (var i = 0; i < codigoSelectedMayus.length; i++) {\r\n                for (var key in codigoSelectedMayus[i]) {\r\n                    if (typeof codigoSelectedMayus[i][key] == \"string\") {\r\n                        codigoSelectedMayus[i][key] = codigoSelectedMayus[i][key].toUpperCase();\r\n                    }\r\n                }\r\n            }\r\n            let reporte = 'Reporte visitas '+me.mesDescripcion+'-'+me.anioseleccionado+'-'+me.institucion.nombreInstitucion\r\n            import('@/vendor/Export2Excel').then(excel => {\r\n                const list = codigoSelectedMayus\r\n                const data = this.formatJson(headerVal, list)\r\n                excel.export_json_to_excel({\r\n                    header: headerTitle,\r\n                    data,\r\n                    filename: reporte,\r\n                    autoWidth: this.cellAutoWidth,\r\n                    bookType: this.selectedFormat\r\n                })\r\n                this.clearFields()\r\n            })\r\n        },\r\n        formatJson(filterVal, jsonData) {\r\n            return jsonData.map(v => filterVal.map(j => {\r\n                return v[j]\r\n            }))\r\n        },\r\n    }\r\n}\r\n</script>\r\n<style scoped>\r\n\r\n</style>"]}]}