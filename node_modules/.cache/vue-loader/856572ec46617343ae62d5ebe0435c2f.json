{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\temporadas\\components\\exportActaGuiasEntregaEscuela.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\temporadas\\components\\exportActaGuiasEntregaEscuela.vue","mtime":1712682816604},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport moment from \"moment\";\r\nimport html2pdf from \"html2pdf.js\"\r\nexport default{\r\n    data(){\r\n        return{\r\n            arregloContrato:[],\r\n            arregloLibros:[],\r\n            day:'',\r\n            mes:'',\r\n            mesd:'',\r\n            year:'',\r\n            anio:'',\r\n            fecha:'',\r\n            telefono:'',\r\n            nombrearchivo:'',\r\n        }\r\n    },\r\n    props:{\r\n        pedido:{\r\n            type:Array,\r\n            default:{},\r\n        },\r\n        tipo:{\r\n            type:Number,\r\n            default:0,\r\n        }\r\n    },\r\n    created(){\r\n        let me = this;\r\n        moment.lang(\"es\")\r\n        me.day = moment().format('DD'); \r\n        me.mes = moment().format('MMMM');\r\n        me.mesd = moment().format('dddd');  \r\n        me.year = moment().format('YYYY')\r\n        me.fecha = me.day+'-'+me.mes.substring(0,3)+'-'+me.year\r\n        me.nombrearchivo = \"Guias_Entrega_\"+me.pedido.nombreInstitucion+\".pdf\"\r\n        // me.contrato = me.$route.params.id\r\n    },\r\n    mounted(){\r\n        let me = this\r\n        me.getLibros()\r\n    },\r\n    methods:{\r\n        //funcion para obtener el dia de 365\r\n        getDay(){\r\n            const hoy = new Date(); // Crear una instancia del objeto Date\r\n            const año = hoy.getFullYear(); // Obtener el año actual\r\n            const diaDelAño = Math.ceil((hoy - new Date(año, 0, 1)) / 86400000); // Obtener el número del día del año actual (86400000 = número de milisegundos en un día)\r\n            return diaDelAño;\r\n            //console.log(\"Hoy es el día número \" + diaDelAño + \" del año \" + año); // Mostrar el número del día del año actual en la consola\r\n        },\r\n        getLibros(){\r\n            let me = this\r\n            me.$vs.loading()\r\n            //cargar documento\r\n            let formData = new FormData()\r\n            this.$http.post(this.$server_url+'upload/file', formData)\r\n            .then(res => {\r\n                me.$vs.loading.close()\r\n                me.$vs.notify({\r\n                text: \"Espere mientras se va generando el archivo...\",\r\n                color: 'primary',\r\n                iconPack: 'feather',\r\n                icon: 'icon-file',\r\n                time:3000\r\n                })\r\n                if(me.tipo == 1){\r\n                    setTimeout(function() {me.imprimirEval()}, 1000);\r\n                }else{\r\n                    setTimeout(function() {me.ExportToDoc()}, 1000);\r\n                }\r\n            })\r\n            .catch((e) => {\r\n                me.$vs.loading.close()\r\n            })\r\n        },\r\n        imprimirEval(){\r\n            let me = this\r\n            var element = document.getElementById('seccionImprimirActaEntrega');\r\n            var opt = {\r\n                margin:       0.5,\r\n                // margin:         [1.5, 0.5, 1, 1],\r\n                filename:     me.nombrearchivo,\r\n                image:        { type: 'jpeg', quality: 0.98 },\r\n                html2canvas:    {scale: 2},\r\n                pagebreak: { mode: 'avoid-all', inside: \"avoid\", before: '#page2el' }  ,\r\n                // jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }\r\n                jsPDF: {unit: 'in', format: 'letter', orientation: 'portrait'} \r\n                //jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }  \r\n            };\r\n            html2pdf().from(element).set(opt).save();\r\n            me.arregloContrato = []\r\n            me.arregloLibros   = []\r\n            me.$vs.notify({\r\n                text: \"Archivo descargado correctamente\",\r\n                color: 'success',\r\n                iconPack: 'feather',\r\n                icon: 'icon-file',\r\n                time:2000\r\n            })\r\n            me.$emit('change',true)\r\n        },\r\n        ExportToDoc(){\r\n            let me = this\r\n            var filename = me.nombrearchivo\r\n            var HtmlHead = \"<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>\";\r\n            var EndHtml = \"</body></html>\";\r\n            //complete html\r\n            var html = HtmlHead +document.getElementById(\"seccionImprimirActaEntrega\").innerHTML+EndHtml;\r\n            //specify the type\r\n            var blob = new Blob(['\\ufeff', html], {\r\n                type: 'application/msword'\r\n            });\r\n            // Specify link url\r\n            var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);\r\n            // Specify file name\r\n            filename = filename?filename+'.doc':'document.doc';\r\n            // Create download link element\r\n            var downloadLink = document.createElement(\"a\");\r\n            document.body.appendChild(downloadLink);\r\n            if(navigator.msSaveOrOpenBlob ){\r\n                navigator.msSaveOrOpenBlob(blob, filename);\r\n            }else{\r\n                // Create a link to the file\r\n                downloadLink.href = url;\r\n                // Setting the file name\r\n                downloadLink.download = filename;\r\n                //triggering the function\r\n                downloadLink.click();\r\n            }\r\n            document.body.removeChild(downloadLink);\r\n            me.$vs.notify({\r\n                text: \"Archivo descargado correctamente\",\r\n                color: 'success',\r\n                iconPack: 'feather',\r\n                icon: 'icon-file',\r\n                time:2000\r\n            })\r\n            me.$emit('change',true)\r\n        },\r\n    }\r\n}\r\n",{"version":3,"sources":["exportActaGuiasEntregaEscuela.vue"],"names":[],"mappings":";AAoIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"exportActaGuiasEntregaEscuela.vue","sourceRoot":"src/views/temporadas/components","sourcesContent":["<template>\r\n    <div>\r\n        <vx-card id=\"seccionImprimirActaEntrega\">\r\n            <h5 class=\"text-center font-bold\">PROMOCIÓN DE VENTAS</h5>\r\n            <h5 class=\"text-center font-bold mt-2\">ACTA DE ENTREGA</h5>\r\n            <div class=\"flex sp55\" style=\"width: 100%;\">\r\n                <div style=\"width: 50%;\">\r\n                    <p class=\"letra2\">Quito, {{ mesd }}, {{ day }} de {{ mes }} del {{ year }}</p>\r\n                </div>\r\n                <div style=\"width: 33%;\" class=\"flex justify-end\">\r\n                    <p class=\"letra2 font-bold\">Ref:</p>\r\n                </div>\r\n            </div>\r\n            <br>\r\n            <div clas=\"flex\">\r\n                <div style=\"width: 100%;\" class=\"flex letra2\">\r\n                    <div style=\"width: 30%;\">\r\n                        <b>RESPONSABLE:</b>\r\n                    </div>\r\n                    <div style=\"width: 50%;\">\r\n                        <p>{{ pedido.responsable.toUpperCase() }}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div clas=\"flex\">\r\n                <div style=\"width: 100%;\" class=\"flex letra2\">\r\n                    <div style=\"width: 30%;\">\r\n                        <b>CI:</b>\r\n                    </div>\r\n                    <div style=\"width: 40%;\">\r\n                        <p>{{ pedido.cedula }}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <p></p>\r\n            <p class=\"sp25 letra2\">\r\n                Con esta fecha, se procede a la suscripción de la presente Acta de Entrega - Recepción de los productos que se\r\n                otorgan en calidad de <b>OBSEQUIOS SIN COSTO,</b> como parte de la PROMOCIÓN DE VENTAS.\r\n            </p>\r\n            <br>\r\n            <table class=\"tabla2\"  border=\"1\">\r\n                <thead>\r\n                    <tr>\r\n                        <td colspan=\"1\"><b>LIBRO</b></td>\r\n                        <td colspan=\"1\"><b>CANTIDAD</b></td>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(tr,key) in pedido.entregas\" :key=\"key\">\r\n                        <td>{{ tr.nombrelibro.toUpperCase() }}  </td>\r\n                        <td>{{ tr.cantidad_entregada - tr.devolucion }}</td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n            <br>\r\n            <div v-if=\"tipo == 1\">\r\n                <!--PDF-->\r\n                <div class=\"flex letra2\" style=\"justify-content: space-between;margin-top: 30px;width: 100%!important;\">\r\n                    <div style=\"width: 50%;\">\r\n                        <p class=\"font-bold\">ENTREGUÉ CONFORME</p>\r\n                    </div>\r\n                    <div style=\"width: 50%;\">\r\n                        <p class=\"font-bold\">RECIBÍ CONFORME</p>\r\n                    </div>\r\n                </div>\r\n                <div class=\"flex letra2\" style=\"justify-content: space-between;margin-top: 110px;width: 100%!important;\">\r\n                    <div style=\"width: 50%;\">\r\n                        <p>{{ pedido.responsable.toUpperCase() }}</p>\r\n                        <p class=\"font-bold\">VENDEDOR</p>\r\n                    </div>\r\n                    <div style=\"width: 50%;\">\r\n                        <p>{{ pedido.nombreInstitucion }} ({{ pedido.ciudad }})</p>\r\n                        <p class=\"font-bold\">COMPRADOR</p>\r\n                    </div>\r\n                </div>  \r\n            </div>\r\n            <!--WORD-->\r\n            <div v-else style=\"display: flex;\">\r\n                <table>\r\n                    <tr>\r\n                        <td colspan=\"5\">ENTREGE CONFORME</td>\r\n                        <td colspan=\"7\">RECIBÍ CONFORME</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"5\" rowspan=\"8\"></td>\r\n                        <td colspan=\"7\" rowspan=\"8\"></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"5\"></td>\r\n                        <td colspan=\"7\"></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"5\"></td>\r\n                        <td colspan=\"7\"></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"5\"></td>\r\n                        <td colspan=\"7\"></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"5\"></td>\r\n                        <td colspan=\"7\"></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"5\"></td>\r\n                        <td colspan=\"7\"></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"5\"></td>\r\n                        <td colspan=\"7\"></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"5\"></td>\r\n                        <td colspan=\"7\"></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"5\">{{ pedido.responsable.toUpperCase() }}</td>\r\n                        <td colspan=\"7\">{{ pedido.nombreInstitucion }} ({{ pedido.ciudad }})</td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan=\"5\">VENDEDOR</td>\r\n                        <td colspan=\"7\">COMPRADOR</td>\r\n                    </tr>\r\n                </table>\r\n            </div>\r\n        </vx-card>\r\n        <div class=\"w-full p-2 bg-gray-400 text-center\">\r\n            <vs-button color=\"primary\" @click=\"imprimirEval()\" type=\"border\">Imprimir</vs-button>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport moment from \"moment\";\r\nimport html2pdf from \"html2pdf.js\"\r\nexport default{\r\n    data(){\r\n        return{\r\n            arregloContrato:[],\r\n            arregloLibros:[],\r\n            day:'',\r\n            mes:'',\r\n            mesd:'',\r\n            year:'',\r\n            anio:'',\r\n            fecha:'',\r\n            telefono:'',\r\n            nombrearchivo:'',\r\n        }\r\n    },\r\n    props:{\r\n        pedido:{\r\n            type:Array,\r\n            default:{},\r\n        },\r\n        tipo:{\r\n            type:Number,\r\n            default:0,\r\n        }\r\n    },\r\n    created(){\r\n        let me = this;\r\n        moment.lang(\"es\")\r\n        me.day = moment().format('DD'); \r\n        me.mes = moment().format('MMMM');\r\n        me.mesd = moment().format('dddd');  \r\n        me.year = moment().format('YYYY')\r\n        me.fecha = me.day+'-'+me.mes.substring(0,3)+'-'+me.year\r\n        me.nombrearchivo = \"Guias_Entrega_\"+me.pedido.nombreInstitucion+\".pdf\"\r\n        // me.contrato = me.$route.params.id\r\n    },\r\n    mounted(){\r\n        let me = this\r\n        me.getLibros()\r\n    },\r\n    methods:{\r\n        //funcion para obtener el dia de 365\r\n        getDay(){\r\n            const hoy = new Date(); // Crear una instancia del objeto Date\r\n            const año = hoy.getFullYear(); // Obtener el año actual\r\n            const diaDelAño = Math.ceil((hoy - new Date(año, 0, 1)) / 86400000); // Obtener el número del día del año actual (86400000 = número de milisegundos en un día)\r\n            return diaDelAño;\r\n            //console.log(\"Hoy es el día número \" + diaDelAño + \" del año \" + año); // Mostrar el número del día del año actual en la consola\r\n        },\r\n        getLibros(){\r\n            let me = this\r\n            me.$vs.loading()\r\n            //cargar documento\r\n            let formData = new FormData()\r\n            this.$http.post(this.$server_url+'upload/file', formData)\r\n            .then(res => {\r\n                me.$vs.loading.close()\r\n                me.$vs.notify({\r\n                text: \"Espere mientras se va generando el archivo...\",\r\n                color: 'primary',\r\n                iconPack: 'feather',\r\n                icon: 'icon-file',\r\n                time:3000\r\n                })\r\n                if(me.tipo == 1){\r\n                    setTimeout(function() {me.imprimirEval()}, 1000);\r\n                }else{\r\n                    setTimeout(function() {me.ExportToDoc()}, 1000);\r\n                }\r\n            })\r\n            .catch((e) => {\r\n                me.$vs.loading.close()\r\n            })\r\n        },\r\n        imprimirEval(){\r\n            let me = this\r\n            var element = document.getElementById('seccionImprimirActaEntrega');\r\n            var opt = {\r\n                margin:       0.5,\r\n                // margin:         [1.5, 0.5, 1, 1],\r\n                filename:     me.nombrearchivo,\r\n                image:        { type: 'jpeg', quality: 0.98 },\r\n                html2canvas:    {scale: 2},\r\n                pagebreak: { mode: 'avoid-all', inside: \"avoid\", before: '#page2el' }  ,\r\n                // jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }\r\n                jsPDF: {unit: 'in', format: 'letter', orientation: 'portrait'} \r\n                //jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }  \r\n            };\r\n            html2pdf().from(element).set(opt).save();\r\n            me.arregloContrato = []\r\n            me.arregloLibros   = []\r\n            me.$vs.notify({\r\n                text: \"Archivo descargado correctamente\",\r\n                color: 'success',\r\n                iconPack: 'feather',\r\n                icon: 'icon-file',\r\n                time:2000\r\n            })\r\n            me.$emit('change',true)\r\n        },\r\n        ExportToDoc(){\r\n            let me = this\r\n            var filename = me.nombrearchivo\r\n            var HtmlHead = \"<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>\";\r\n            var EndHtml = \"</body></html>\";\r\n            //complete html\r\n            var html = HtmlHead +document.getElementById(\"seccionImprimirActaEntrega\").innerHTML+EndHtml;\r\n            //specify the type\r\n            var blob = new Blob(['\\ufeff', html], {\r\n                type: 'application/msword'\r\n            });\r\n            // Specify link url\r\n            var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);\r\n            // Specify file name\r\n            filename = filename?filename+'.doc':'document.doc';\r\n            // Create download link element\r\n            var downloadLink = document.createElement(\"a\");\r\n            document.body.appendChild(downloadLink);\r\n            if(navigator.msSaveOrOpenBlob ){\r\n                navigator.msSaveOrOpenBlob(blob, filename);\r\n            }else{\r\n                // Create a link to the file\r\n                downloadLink.href = url;\r\n                // Setting the file name\r\n                downloadLink.download = filename;\r\n                //triggering the function\r\n                downloadLink.click();\r\n            }\r\n            document.body.removeChild(downloadLink);\r\n            me.$vs.notify({\r\n                text: \"Archivo descargado correctamente\",\r\n                color: 'success',\r\n                iconPack: 'feather',\r\n                icon: 'icon-file',\r\n                time:2000\r\n            })\r\n            me.$emit('change',true)\r\n        },\r\n    }\r\n}\r\n</script>\r\n<style scoped>\r\n.html2canvas-container { width: 3000px !important; height: 3000px !important; }\r\n*{\r\n    font-family: Arial;\r\n}\r\n#ultimo-elemento {\r\n    margin-top: 300px;\r\n}\r\n.letra{\r\n    padding:0px 60px 0px 0px;\r\n    font-size: 11px;\r\n    margin-left: 35px;\r\n}\r\n.letra2{\r\n    font-size: 12px;\r\n}\r\n.letra3{\r\n    display: flex;\r\n    font-size: 11px;\r\n    margin-left: 35px;\r\n}\r\n.letra4{\r\n    margin-top: 15px;\r\n    margin-left: 55px;\r\n    font-size: 11px;\r\n}\r\n.letra5{\r\n    display: flex;\r\n    justify-content: space-evenly;\r\n    width: 90%;\r\n    margin-left: 35px;\r\n    font-size: 11px;\r\n    margin-top: 105px;\r\n}\r\n.tabla1 {\r\n  table-layout: fixed;\r\n  width: 95%;\r\n  border-collapse: collapse;\r\n  border: none;\r\n  margin-left: 15px;\r\n}\r\n.tabla2{\r\n    table-layout: fixed;\r\n    width: 90%;\r\n    border-collapse: collapse;\r\n    border: none;\r\n    font-size: 11px;\r\n    margin-top: 15px;\r\n    \r\n}\r\n.sp25{\r\n    margin-top: 25px;\r\n}\r\n.sp55{\r\n    margin-top: 55px;\r\n}\r\n.-mt20{\r\n    margin-top: -20px;\r\n}\r\n@media print {\r\n    td {page-break-before: always;}\r\n    p  {page-break-before: always;}\r\n}\r\n.encabezado ,td,th {\r\n    border: 1px solid rgb(227, 227, 227);\r\n    text-align: center;\r\n    border-spacing: 0;\r\n}\r\n.rotar{\r\n    font-size: 8px;\r\n    /* writing-mode: vertical-lr;\r\n     transform: rotate(180deg); */\r\n}\r\n.font1{\r\n    font-size: 8px;\r\n}\r\n</style>"]}]}