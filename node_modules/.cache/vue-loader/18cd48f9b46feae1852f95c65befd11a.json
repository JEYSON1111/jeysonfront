{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\pedidos\\pedidoSecuencia.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\pedidos\\pedidoSecuencia.vue","mtime":1712682816366},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport vSelect from 'vue-select';\r\nexport default {\r\n    components: {\r\n        'v-select': vSelect,\r\n    },\r\n    data() {\r\n        return {\r\n            listaSecuencia: [],\r\n            listaPeriodos: [],\r\n            listaAsesores: [],\r\n            asesorSelect: '',\r\n            periodoSelect: '',\r\n            modalAddSecuencia: false,\r\n            txt_titulo_modal: '',\r\n            txt_boton: '',\r\n            datos: {},\r\n            usuario: '',\r\n            noroot: '',\r\n            datoEliminar:'',\r\n        }\r\n    },\r\n    mounted() {\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n        me.getUserRoot(me.usuario);\r\n    },\r\n    methods: {\r\n        getUserRoot(dato) {\r\n            let me = this;\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'permisos/' + dato.idusuario)\r\n                .then((result) => {\r\n                    console.log(result.data)\r\n                    if (result.data.length > 0) {\r\n                        me.getPeriodos();\r\n                        me.getAsesores();\r\n                    } else {\r\n                        me.noroot = 'No tiene permisos para acceder a esta seccion'\r\n                        me.f_notificaciones(me.noroot, 'danger', 'icon-alert-triangle')\r\n                    }\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err)\r\n                })\r\n        },\r\n        getPeriodos() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'periodoActivo')\r\n                .then((result) => {\r\n                    // console.log(result.data)\r\n                    me.listaPeriodos = result.data\r\n                }).catch((err) => {\r\n                    console.log(err)\r\n                });\r\n        },\r\n        f_pedidos(idperiodo) {\r\n            let me = this;\r\n            console.log(idperiodo)\r\n            if (idperiodo == null) {\r\n                return\r\n            }\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'getPedidoSecuencia/' +idperiodo)\r\n                .then((result) => {\r\n                    // console.log(result.data)\r\n                    me.listaSecuencia = result.data\r\n                    me.$vs.loading.close()\r\n                }).catch((err) => {\r\n                    console.log(err)\r\n                    me.$vs.loading.close()\r\n                });\r\n        },\r\n        getAsesores() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'listaAsesores')\r\n                .then((result) => {\r\n                    // console.log(result.data)\r\n                    me.listaAsesores = result.data\r\n                }).catch((err) => {\r\n                    console.log(err)\r\n                });\r\n        },\r\n        f_modal_datos(item) {\r\n            let me = this;\r\n            console.log(item)\r\n            me.txt_titulo_modal = 'Agregar registro de secuencia'\r\n            me.txt_boton = 'Guardar';\r\n            me.datos = {\r\n                'id': '',\r\n                'sec_ven_nombre':           me.periodoSelect.codigo_contrato,\r\n                'id_periodo':               me.periodoSelect.idperiodoescolar,\r\n                'ven_d_codigo':             '',\r\n                'sec_ven_valor':            '',\r\n                'institucion_facturacion':  '',\r\n                'cli_ins_codigo':           '',\r\n            }\r\n            me.asesorSelect = {\r\n                'idusuario': '',\r\n                'nombres': ''\r\n            };\r\n            if (item != null) {\r\n                me.txt_titulo_modal = 'Editar registro'\r\n                me.txt_boton = 'Editar';\r\n                me.datos = {\r\n                    'id': item.id,\r\n                    'sec_ven_nombre':           item.sec_ven_nombre,\r\n                    'id_periodo':               item.id_periodo,\r\n                    'ven_d_codigo':             item.ven_d_codigo,\r\n                    'sec_ven_valor':            item.sec_ven_valor,\r\n                    'institucion_facturacion':  item.institucion_facturacion,\r\n                    'cli_ins_codigo':           item.cli_ins_codigo\r\n                }\r\n                me.asesorSelect = {\r\n                    'idusuario': item.asesor_id,\r\n                    'nombres': item.nombres + ' ' + item.apellidos\r\n                }\r\n            }\r\n            me.modalAddSecuencia = true;\r\n        },\r\n        f_guardar() {\r\n            let me = this;\r\n            let msj = \"\";\r\n            if (me.asesorSelect == null || me.asesorSelect.idusuario == '') {\r\n                msj = 'Seleccione un asesor'\r\n                me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                return;\r\n            }\r\n            //validar que el asesor ya no este ingresado en el periodo\r\n            if(me.datos.id == \"\"){\r\n                let datos = me.listaSecuencia\r\n                let search = datos.filter(p => p.asesor_id == me.asesorSelect.idusuario)\r\n                if(search.length > 0){\r\n                    msj = 'El asesor ya se encuentra asignado en el período'\r\n                    me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                    return\r\n                }\r\n            }\r\n            if (me.datos.ven_d_codigo == '') {\r\n                msj = 'Ingrese las iniciales del asesor'\r\n                me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                return;\r\n            }\r\n            if (me.datos.sec_ven_valor == '') {\r\n                msj = 'Ingrese la secuencia para los pedidos'\r\n                me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                return;\r\n            }\r\n            me.datos.asesor_id = me.asesorSelect.idusuario\r\n            console.log(me.datos)\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'storePedidoSecuencia', me.datos)\r\n                .then((result) => {\r\n                    console.log(result.data)\r\n                    me.f_pedidos(me.datos.id_periodo)\r\n                    console.log(me.datos.id_periodo)\r\n                    me.modalAddSecuencia = false;\r\n                    me.$vs.loading.close()\r\n                }).catch((err) => {\r\n                    me.$vs.loading.close()\r\n                });\r\n        },\r\n        f_confirma_delete(item) {\r\n            let me = this;\r\n            console.log(item)\r\n            me.datoEliminar = item\r\n            me.$vs.dialog({\r\n                type: 'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: '¿Está seguro en eliminar este item?',\r\n                acceptText: 'Aceptar',\r\n                cancelText: 'Cancelar',\r\n                accept: me.eliminarItem\r\n            })\r\n        },\r\n        eliminarItem() {\r\n            let me = this;\r\n            let msj;\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'deletePedidoSecuencia/' + me.datoEliminar.id)\r\n                .then((result) => {\r\n                    msj = 'Item eliminado correctamente.';\r\n                    me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                    me.f_pedidos(result.data.id_periodo)\r\n                    me.$vs.loading.close()\r\n                }).catch((err) => {\r\n                  msj = 'No se pudo eliminar el item solicitado.';\r\n                    me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                    me.$vs.loading.close()\r\n                });\r\n        },\r\n        f_notificaciones(msj, color, icono) {\r\n            let me = this;\r\n            me.$vs.notify({\r\n                text: msj,\r\n                color: color,\r\n                iconPack: 'feather',\r\n                icon: icono\r\n            })\r\n            return;\r\n        }\r\n    },\r\n}\r\n",{"version":3,"sources":["pedidoSecuencia.vue"],"names":[],"mappings":";AAgFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"pedidoSecuencia.vue","sourceRoot":"src/views/pedidos","sourcesContent":["<template>\r\n    <div>\r\n        <vs-popup :title=\"txt_titulo_modal\" :active.sync=\"modalAddSecuencia\">\r\n            <div class=\"vx-row w-full mb-6\">\r\n                <div class=\"vx-col w-1/2 mb-3\" v-if=\"periodoSelect != null\">\r\n                    <vs-input label=\"Periodo\" readonly=\"true\" v-model=\"periodoSelect.descripcion\" class=\"w-full\" />\r\n                </div>\r\n                <div class=\"vx-col w-full mb-3\">\r\n                    <small>Asesores: </small><br />\r\n                    <v-select :options=\"listaAsesores\" :reduce=\"listaAsesores => listaAsesores\" label=\"nombres\" class=\"w-full\" v-model=\"asesorSelect\" />\r\n                    <!-- {{ asesorSelect }} -->\r\n                </div>\r\n                <div class=\"vx-col w-1/2 mb-3\">\r\n                    <vs-input label=\"Iniciales del asesor\" v-model=\"datos.ven_d_codigo\" class=\"w-full\" />\r\n                </div>\r\n                <div class=\"vx-col w-1/2 mb-3\">\r\n                    <vs-input type=\"number\" label=\"Secuencia\" v-model=\"datos.sec_ven_valor\" class=\"w-full\" />\r\n                </div>\r\n                <div class=\"vx-col w-1/2 mb-3\">\r\n                    <vs-input label=\"Institución facturación\" disabled v-model=\"datos.institucion_facturacion\" class=\"w-full\" />\r\n                </div>\r\n                <div class=\"vx-col w-1/2 mb-3\">\r\n                    <vs-input label=\"Id de la tabla cliente_institucion\" v-model=\"datos.cli_ins_codigo\" class=\"w-full\" />\r\n                </div>\r\n                <div class=\"vx-col w-1/2 mb-3\">\r\n                    <vs-button color=\"success\" type=\"gradient\" class=\"m-1\" @click=\"f_guardar()\">{{ txt_boton }}</vs-button>\r\n                </div>\r\n            </div>\r\n        </vs-popup>\r\n        <vs-alert v-if=\"noroot != '' \" title=\"Alerta\" active=\"true\" color=\"danger\" class=\"m-3\">\r\n            <h4> {{ noroot }} </h4>\r\n        </vs-alert>\r\n        <div class=\"m-2 mb-4\">\r\n            <small>Seleccione un periodo: </small>\r\n            <v-select :options=\"listaPeriodos\" :reduce=\"listaPeriodos => listaPeriodos\" label=\"descripcion\" class=\"w-full\" v-model=\"periodoSelect\" @input=\"f_pedidos(periodoSelect.idperiodoescolar)\" />\r\n        </div>\r\n        <div class=\"m-2\">\r\n            <vs-button v-if=\"periodoSelect\" color=\"primary\" type=\"gradient\" class=\"m-1\" @click=\"f_modal_datos()\">Agregar</vs-button>\r\n        </div>\r\n        <div v-if=\"periodoSelect == null\">\r\n            <br /><br /><br /><br /><br /><br /><br /><br />\r\n        </div>\r\n        <vs-table v-else class=\"mt-4\" max-items=\"10\" pagination search stripe :data=\"listaSecuencia\" v>\r\n            <template slot=\"header\">\r\n                <vs-chip color=\"primary\">Cantidad: {{ listaSecuencia.length }}</vs-chip>\r\n            </template>\r\n            <template slot=\"thead\">\r\n                <vs-th> Iniciales </vs-th>\r\n                <vs-th> Secuencia </vs-th>\r\n                <vs-th> Codigo asesor </vs-th>\r\n                <vs-th> Asesor </vs-th>\r\n                <vs-th> Acciones </vs-th>\r\n            </template>\r\n            <template slot-scope=\"{data}\">\r\n                <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                    <vs-td :data=\"data[indextr].sec_ven_nombre\">\r\n                        {{data[indextr].sec_ven_nombre}}\r\n                    </vs-td>\r\n                    <vs-td :data=\"data[indextr].sec_ven_valor\">\r\n                        {{data[indextr].sec_ven_valor}}\r\n                    </vs-td>\r\n                    <vs-td :data=\"data[indextr].ven_d_codigo\">\r\n                        {{data[indextr].ven_d_codigo}}\r\n                    </vs-td>\r\n                    <vs-td :data=\"data[indextr].nombres\">\r\n                        {{data[indextr].nombres}}\r\n                        {{data[indextr].apellidos}}\r\n                        <p class=\"mt-1\"><b>Código Institución:</b> {{ tr.institucion_facturacion }} </p>\r\n                        <p class=\"mt-1\"><b>Id Cliente Institución:</b> {{ tr.cli_ins_codigo }} </p>\r\n                    </vs-td>\r\n                    <vs-td>\r\n                        <vs-button color=\"warning\" round icon=\"edit\" class=\"m-1\" @click=\"f_modal_datos(data[indextr])\"></vs-button>\r\n                        <vs-button color=\"danger\" round icon=\"delete\" class=\"m-1\" @click=\"f_confirma_delete(data[indextr])\"></vs-button>\r\n                    </vs-td>\r\n                </vs-tr>\r\n            </template>\r\n        </vs-table>\r\n    </div>\r\n</template>\r\n<script>\r\nimport vSelect from 'vue-select';\r\nexport default {\r\n    components: {\r\n        'v-select': vSelect,\r\n    },\r\n    data() {\r\n        return {\r\n            listaSecuencia: [],\r\n            listaPeriodos: [],\r\n            listaAsesores: [],\r\n            asesorSelect: '',\r\n            periodoSelect: '',\r\n            modalAddSecuencia: false,\r\n            txt_titulo_modal: '',\r\n            txt_boton: '',\r\n            datos: {},\r\n            usuario: '',\r\n            noroot: '',\r\n            datoEliminar:'',\r\n        }\r\n    },\r\n    mounted() {\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n        me.getUserRoot(me.usuario);\r\n    },\r\n    methods: {\r\n        getUserRoot(dato) {\r\n            let me = this;\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'permisos/' + dato.idusuario)\r\n                .then((result) => {\r\n                    console.log(result.data)\r\n                    if (result.data.length > 0) {\r\n                        me.getPeriodos();\r\n                        me.getAsesores();\r\n                    } else {\r\n                        me.noroot = 'No tiene permisos para acceder a esta seccion'\r\n                        me.f_notificaciones(me.noroot, 'danger', 'icon-alert-triangle')\r\n                    }\r\n                    me.$vs.loading.close()\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err)\r\n                })\r\n        },\r\n        getPeriodos() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'periodoActivo')\r\n                .then((result) => {\r\n                    // console.log(result.data)\r\n                    me.listaPeriodos = result.data\r\n                }).catch((err) => {\r\n                    console.log(err)\r\n                });\r\n        },\r\n        f_pedidos(idperiodo) {\r\n            let me = this;\r\n            console.log(idperiodo)\r\n            if (idperiodo == null) {\r\n                return\r\n            }\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'getPedidoSecuencia/' +idperiodo)\r\n                .then((result) => {\r\n                    // console.log(result.data)\r\n                    me.listaSecuencia = result.data\r\n                    me.$vs.loading.close()\r\n                }).catch((err) => {\r\n                    console.log(err)\r\n                    me.$vs.loading.close()\r\n                });\r\n        },\r\n        getAsesores() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'listaAsesores')\r\n                .then((result) => {\r\n                    // console.log(result.data)\r\n                    me.listaAsesores = result.data\r\n                }).catch((err) => {\r\n                    console.log(err)\r\n                });\r\n        },\r\n        f_modal_datos(item) {\r\n            let me = this;\r\n            console.log(item)\r\n            me.txt_titulo_modal = 'Agregar registro de secuencia'\r\n            me.txt_boton = 'Guardar';\r\n            me.datos = {\r\n                'id': '',\r\n                'sec_ven_nombre':           me.periodoSelect.codigo_contrato,\r\n                'id_periodo':               me.periodoSelect.idperiodoescolar,\r\n                'ven_d_codigo':             '',\r\n                'sec_ven_valor':            '',\r\n                'institucion_facturacion':  '',\r\n                'cli_ins_codigo':           '',\r\n            }\r\n            me.asesorSelect = {\r\n                'idusuario': '',\r\n                'nombres': ''\r\n            };\r\n            if (item != null) {\r\n                me.txt_titulo_modal = 'Editar registro'\r\n                me.txt_boton = 'Editar';\r\n                me.datos = {\r\n                    'id': item.id,\r\n                    'sec_ven_nombre':           item.sec_ven_nombre,\r\n                    'id_periodo':               item.id_periodo,\r\n                    'ven_d_codigo':             item.ven_d_codigo,\r\n                    'sec_ven_valor':            item.sec_ven_valor,\r\n                    'institucion_facturacion':  item.institucion_facturacion,\r\n                    'cli_ins_codigo':           item.cli_ins_codigo\r\n                }\r\n                me.asesorSelect = {\r\n                    'idusuario': item.asesor_id,\r\n                    'nombres': item.nombres + ' ' + item.apellidos\r\n                }\r\n            }\r\n            me.modalAddSecuencia = true;\r\n        },\r\n        f_guardar() {\r\n            let me = this;\r\n            let msj = \"\";\r\n            if (me.asesorSelect == null || me.asesorSelect.idusuario == '') {\r\n                msj = 'Seleccione un asesor'\r\n                me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                return;\r\n            }\r\n            //validar que el asesor ya no este ingresado en el periodo\r\n            if(me.datos.id == \"\"){\r\n                let datos = me.listaSecuencia\r\n                let search = datos.filter(p => p.asesor_id == me.asesorSelect.idusuario)\r\n                if(search.length > 0){\r\n                    msj = 'El asesor ya se encuentra asignado en el período'\r\n                    me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                    return\r\n                }\r\n            }\r\n            if (me.datos.ven_d_codigo == '') {\r\n                msj = 'Ingrese las iniciales del asesor'\r\n                me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                return;\r\n            }\r\n            if (me.datos.sec_ven_valor == '') {\r\n                msj = 'Ingrese la secuencia para los pedidos'\r\n                me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                return;\r\n            }\r\n            me.datos.asesor_id = me.asesorSelect.idusuario\r\n            console.log(me.datos)\r\n            me.$vs.loading()\r\n            this.$http.post(this.$server_url + 'storePedidoSecuencia', me.datos)\r\n                .then((result) => {\r\n                    console.log(result.data)\r\n                    me.f_pedidos(me.datos.id_periodo)\r\n                    console.log(me.datos.id_periodo)\r\n                    me.modalAddSecuencia = false;\r\n                    me.$vs.loading.close()\r\n                }).catch((err) => {\r\n                    me.$vs.loading.close()\r\n                });\r\n        },\r\n        f_confirma_delete(item) {\r\n            let me = this;\r\n            console.log(item)\r\n            me.datoEliminar = item\r\n            me.$vs.dialog({\r\n                type: 'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: '¿Está seguro en eliminar este item?',\r\n                acceptText: 'Aceptar',\r\n                cancelText: 'Cancelar',\r\n                accept: me.eliminarItem\r\n            })\r\n        },\r\n        eliminarItem() {\r\n            let me = this;\r\n            let msj;\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'deletePedidoSecuencia/' + me.datoEliminar.id)\r\n                .then((result) => {\r\n                    msj = 'Item eliminado correctamente.';\r\n                    me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                    me.f_pedidos(result.data.id_periodo)\r\n                    me.$vs.loading.close()\r\n                }).catch((err) => {\r\n                  msj = 'No se pudo eliminar el item solicitado.';\r\n                    me.f_notificaciones(msj, 'warning', 'icon-alert-triangle')\r\n                    me.$vs.loading.close()\r\n                });\r\n        },\r\n        f_notificaciones(msj, color, icono) {\r\n            let me = this;\r\n            me.$vs.notify({\r\n                text: msj,\r\n                color: color,\r\n                iconPack: 'feather',\r\n                icon: icono\r\n            })\r\n            return;\r\n        }\r\n    },\r\n}\r\n</script>\r\n"]}]}