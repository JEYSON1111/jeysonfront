{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\articulos\\listaArticulos.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\articulos\\listaArticulos.vue","mtime":1712682815506},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nimport vSelect from 'vue-select'\r\nimport moment from \"moment\";\r\nVue.filter('fecha', function (value) {\r\n    if (value) {\r\n        return moment(String(value)).format('YYYY-MM-DD HH:mm')\r\n    }\r\n});\r\nexport default {\r\n    components: {\r\n        'v-select': vSelect,\r\n    },\r\n    data() {\r\n        return {\r\n            publicaciones: '',\r\n            elimita_contenido_articulo: '',\r\n            usuario: [],\r\n            grupo_usuario: '',\r\n            titleModal: '',\r\n            mod_articulos: false,\r\n            asignaturas: [{\r\n                    'id': '1',\r\n                    'nombre': 'Lengua'\r\n                },\r\n                {\r\n                    'id': '2',\r\n                    'nombre': 'Matemática'\r\n                },\r\n                {\r\n                    'id': '3',\r\n                    'nombre': 'Ciencias Naturales'\r\n                },\r\n                {\r\n                    'id': '4',\r\n                    'nombre': 'Ciencias Sociales'\r\n                },\r\n                {\r\n                    'id': '5',\r\n                    'nombre': 'Enseñanza educación'\r\n                }\r\n            ],\r\n            asignaturaSelect: {\r\n                'id': '',\r\n                'nombre': ''\r\n            },\r\n            archivo: '',\r\n            portada: '',\r\n            porcentaje: 0,\r\n            id_pub: '',\r\n            nombre: '',\r\n            descripcion: '',\r\n            estado: true,\r\n            edita: '',\r\n            datosEditar: '',\r\n            porcentajep: 0,\r\n            limiteMegas: 10, //permitir maximo de megas\r\n            limitePortada: 0.7, //permitir maximo de megas en la portada\r\n            bytes: 1048576, //para calculo de megas\r\n            pesoArchivo: 0,\r\n            muyPesado: false,\r\n            pesoArchivop: 0,\r\n            muyPesadop: false,\r\n            idusuario: '',\r\n            file: '',\r\n            filep: '',\r\n            id_eliminar: '',\r\n            tipo: '',\r\n            btn_color: '',\r\n            btn_texto: '',\r\n            datos_imagen: '',\r\n            modal_imagen: false,\r\n            replace_archivo: '',\r\n            replace_portada: '',\r\n            msj_articulo: '',\r\n        }\r\n    },\r\n    mounted() {\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n        me.grupo_usuario = me.usuario.id_group;\r\n        me.getPublicaciones();\r\n    },\r\n    methods: {\r\n        getPublicaciones() {\r\n            let me = this;\r\n            me.mod_articulos = false;\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + 'articulos')\r\n                .then(function (res) {\r\n                    me.publicaciones = res.data;\r\n                    me.$vs.loading.close();\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        crearPublicacion() {\r\n            let me = this;\r\n            me.edita = false;\r\n            me.btn_color = 'success'\r\n            me.btn_texto = 'Guardar'\r\n            me.titleModal = \"Agregar artículo\";\r\n            me.msj_articulo = 'Articulo agregado correctamente';\r\n            me.id = '';\r\n            me.nombre = '';\r\n            me.descripcion = '';\r\n            me.asignaturaSelect = {\r\n                'id': '',\r\n                'nombre': ''\r\n            };\r\n            me.file = \"\";\r\n            me.filep = \"\";\r\n            me.portada = '';\r\n            me.archivo = '';\r\n            me.mod_articulos = true;\r\n\r\n        },\r\n        handleFileUpload() {\r\n            let me = this;\r\n            me.porcentaje = 0;\r\n            me.pesoArchivo = 0;\r\n            me.muyPesado = false;\r\n            me.file = me.$refs.file.files[0];\r\n            // verificar tamaño de archivo\r\n            // console.log(me.file)\r\n            me.pesoArchivo = (me.file.size / me.bytes).toFixed(2);\r\n            if (me.pesoArchivo > me.limiteMegas) {\r\n                me.muyPesado = true;\r\n            }\r\n        },\r\n        portadaUpload() {\r\n            let me = this;\r\n            me.porcentajep = 0;\r\n            me.pesoArchivop = 0;\r\n            me.muyPesadop = false;\r\n            me.filep = me.$refs.filep.files[0];\r\n            // verificar tamaño de archivo\r\n            // console.log(me.filep)\r\n            me.pesoArchivop = (me.filep.size / me.bytes).toFixed(2);\r\n            if (me.pesoArchivop > me.limitePortada) {\r\n                me.muyPesadop = true;\r\n            }\r\n        },\r\n        subirArchivo() {\r\n            let me = this;\r\n            if (me.nombre == \"\") {\r\n                me.$vs.notify({\r\n                    text: 'Ingrese el nombre del artículo',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            if (me.descripcion == \"\") {\r\n                me.$vs.notify({\r\n                    text: 'Ingrese la descripción del artículo',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            if (me.asignaturaSelect.nombre == \"\") {\r\n                me.$vs.notify({\r\n                    text: 'Seleccione el área',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            if (me.muyPesado) {\r\n                me.$vs.notify({\r\n                    text: 'El archivo a subir excede el peso permitido, verifique antes de continuar',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            if (me.muyPesadop) {\r\n                me.$vs.notify({\r\n                    text: 'La portada a subir excede el peso permitido, verifique antes de continuar',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            if (me.archivo == \"\" && me.file == \"\") {\r\n                me.$vs.notify({\r\n                    text: 'Seleccione el archivo ',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n\r\n            if (me.portada == \"\" && me.filep === \"\") {\r\n                me.$vs.notify({\r\n                    text: 'Seleccione una portada',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            let estado1 = me.estado ? 1 : 0;\r\n            let dataA = new FormData();\r\n            if (me.file != '') {\r\n                dataA.append('archivo', me.file);\r\n            }\r\n            if (me.filep != '') {\r\n                dataA.append('portada', me.filep);\r\n            }\r\n            dataA.append('id', me.id);\r\n            dataA.append('nombre', me.nombre);\r\n            dataA.append('descripcion', me.descripcion);\r\n            dataA.append('idusuario', me.usuario.idusuario);\r\n            dataA.append('idarea', me.asignaturaSelect.id);\r\n            dataA.append('area', me.asignaturaSelect.nombre);\r\n            dataA.append('estado', estado1);\r\n            dataA.append('replace_archivo', me.replace_archivo);\r\n            dataA.append('replace_portada', me.replace_portada);\r\n            const config = {\r\n                headers: {\r\n                    'Content-Type': 'multipart/form-data'\r\n                }\r\n            };\r\n\r\n            axios.post(this.$data_url + 'api/save_posts', dataA, config)\r\n                .then(res => {\r\n                    // console.log(res.data)\r\n                    me.getPublicaciones();\r\n                    me.$vs.notify({\r\n                        text: me.msj_articulo,\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        f_zoom_img(item) {\r\n            let me = this;\r\n            me.datos_imagen = item;\r\n            // console.log(item)\r\n            me.modal_imagen = true;\r\n        },\r\n        editaArticulo(item) {\r\n            let me = this;\r\n            console.log(item)\r\n            me.edita = true;\r\n            me.btn_color = 'warning'\r\n            me.btn_texto = 'Editar'\r\n            me.titleModal = \"Editar artículo\";\r\n            me.msj_articulo = 'Articulo editado correctamente';\r\n            me.id = item.id;\r\n            me.nombre = item.nombre;\r\n            me.descripcion = item.descripcion;\r\n            me.asignaturaSelect.id = item.idarea;\r\n            me.asignaturaSelect.nombre = item.area;\r\n            me.file = '';\r\n            me.filep = '';\r\n            me.portada = item.nombre_portada;\r\n            me.archivo = item.nombre_archivo;\r\n            me.estado = item.estado == 1 ? true : false;\r\n            me.mod_articulos = true;\r\n        },\r\n        quitarArchivo(item, data) {\r\n            let me = this;\r\n            // console.log(item, data)\r\n            if (item == 1) {\r\n                me.archivo = \"\";\r\n                me.file = \"\";\r\n                me.replace_archivo = data;\r\n            }\r\n            if (item == 2) {\r\n                me.portada = \"\";\r\n                me.filep = \"\";\r\n                me.replace_portada = data;\r\n            }\r\n        },\r\n        verArticulo(web) {\r\n            let a1 = web.nombre_archivo.indexOf(\".\");\r\n            let b1 = web.nombre_archivo.substr(a1 + 1)\r\n            if (b1 == \"doc\" || b1 == \"docx\" || b1 == \"xls\" || b1 == \"xlsx\") {\r\n                window.open('https://view.officeapps.live.com/op/embed.aspx?src=' + this.$data_url + web.ruta_archivo + '/' + web.nombre_archivo, '_blank');\r\n                return\r\n            }\r\n            if (b1 == \"pdf\") {\r\n                window.open('https://docs.google.com/viewer?url=' + this.$data_url + web.ruta_archivo + '/' + web.nombre_archivo, '_blank');\r\n                return\r\n            }\r\n            me.$vs.notify({\r\n                text: 'No es posible mostrar una vista previa del archivo solicitado, por favor descarguelo',\r\n                color: 'success',\r\n                iconPack: 'feather',\r\n                icon: 'icon-alert-triangle'\r\n            })\r\n        },\r\n        openConfirmEliminar(item) {\r\n            let me = this;\r\n            me.elimita_contenido_articulo = item\r\n            console.log(item)\r\n            me.$vs.dialog({\r\n                type: 'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: '¿Está seguro en eliminar este artículo?',\r\n                acceptText: 'Aceptar',\r\n                cancelText: 'Cancelar',\r\n                accept: me.eliminarArticulos\r\n            })\r\n        },\r\n        eliminarArticulos() {\r\n            let me = this;\r\n            //eliminar archivo\r\n            let dataA = new FormData();\r\n            dataA.append('id', me.elimita_contenido_articulo.id);\r\n            dataA.append('archivo', me.elimita_contenido_articulo.nombre_archivo);\r\n            dataA.append('portada', me.elimita_contenido_articulo.nombre_portada);\r\n            const config = {\r\n                headers: {\r\n                    'Content-Type': 'multipart/form-data'\r\n                }\r\n            };\r\n            axios.post(this.$data_url + 'api/delete_posts', dataA, config)\r\n                .then(res => {\r\n                    // console.log(res.data)\r\n                    me.$vs.notify({\r\n                        text: res.data,\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    me.getPublicaciones();\r\n                })\r\n                .catch(error => {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        verArticulos() {\r\n            let me = this\r\n            if (me.grupo_usuario == 6) {\r\n                me.$router.push('/vpublicaciones');\r\n            }\r\n            if (me.grupo_usuario == 1) {\r\n                me.$router.push('/verArticulosAdmin');\r\n            }\r\n        },\r\n    }\r\n}\r\n",{"version":3,"sources":["listaArticulos.vue"],"names":[],"mappings":";AAuIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"listaArticulos.vue","sourceRoot":"src/views/articulos","sourcesContent":["<template>\r\n<div class=\"vx-col md:w-full w-full mb-base\">\r\n    <vs-popup classContent=\"popup-example\" v-if=\"datos_imagen != ''\" title=\"Portada\" :active.sync=\"modal_imagen\">\r\n        <div class=\"text-center\">\r\n            <img style=\"height:300px\" :src=\"$data_url+datos_imagen.ruta_portada+'/'+datos_imagen.nombre_portada\" alt=\"\">\r\n        </div>\r\n    </vs-popup>\r\n    <vs-popup classContent=\"popup-example\" :title=\"titleModal\" :active.sync=\"mod_articulos\">\r\n        <div class=\"vx-row p-1\">\r\n            <div class=\"vx-col w-full\" align=\"left\">\r\n                <div style=\"font-size: 12px; \">Nombre: </div>\r\n                <vs-input type=\"text\" class=\"inputx w-full\" v-model=\"nombre\" maxlength=\"100\"></vs-input>\r\n            </div>\r\n            <div class=\"vx-col w-full mt-2\" align=\"left\">\r\n                <div style=\"font-size: 12px; \">Descripción: </div>\r\n                <vs-textarea type=\"text\" class=\"inputx w-full\" v-model=\"descripcion\"></vs-textarea>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 lg:w-1/2 w-full mt-2\" align=\"left\">\r\n                <div style=\"font-size: 12px; \">Área: </div>\r\n                <v-select class=\"mb-4 w-full\" v-model=\"asignaturaSelect\" :options=\"asignaturas\" label=\"nombre\" :reduce=\"asignaturas => asignaturas\" />\r\n                <!-- {{asignaturaSelect}} -->\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 lg:w-1/2 w-full mt-2\" align=\"center\">\r\n                <div style=\"font-size: 12px; \">Estado: </div>\r\n                <vs-switch class=\"\" vs-icon-on=\"check\" color=\"success\" v-model=\"estado\" style=\"width: 100px;\">\r\n                    <span slot=\"on\">Publicada</span>\r\n                    <span slot=\"off\">Inactivo</span>\r\n                </vs-switch>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 lg:w-1/2 w-full\" align=\"left\">\r\n                <div class=\"borde-unidad\">\r\n                    <div v-if=\"archivo\">\r\n                        <p><b>Archivo actual:</b></p>\r\n                        <p>{{archivo}}</p>\r\n                        <p>\r\n                            <vx-tooltip text=\"Descargar\" position=\"bottom\" style=\"display: inline-block\" color=\"success\">\r\n                                <vs-button style=\"display: inline\" class=\"m-1\" @click=\"descargaArchivo(archivo)\" size=\"small\" icon-pack=\"feather\" icon=\"icon-arrow-down\" color=\"success\" type=\"border\"></vs-button>\r\n                            </vx-tooltip>\r\n                            <vx-tooltip text=\"Eliminar\" position=\"bottom\" style=\"display: inline-block\" color=\"danger\">\r\n                                <vs-button style=\"display: inline\" class=\"m-1\" size=\"small\" icon-pack=\"feather\" icon=\"icon-x\" color=\"danger\" type=\"border\" @click=\"quitarArchivo(1,archivo)\"></vs-button>\r\n                            </vx-tooltip>\r\n                        </p>\r\n                    </div>\r\n                    <div v-else>\r\n                        <div style=\"font-size: 12px;\">Archivo: </div>\r\n                        <input v-if=\"porcentaje == 0\" type=\"file\" id=\"file\" ref=\"file\" v-on:change=\"handleFileUpload()\" />\r\n                        <div class=\"v-row text-left\" v-if=\"porcentaje>0\">\r\n                            <vs-progress style=\"height:25px\" :percent=\"porcentaje\" color=\"success\"> {{porcentaje}}% </vs-progress>\r\n                        </div><br>\r\n                        <small>Tamaño máximo: {{limiteMegas}} mb.</small>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"vx-col sm:w-1/2 lg:w-1/2 w-full\" align=\"left\">\r\n                <div class=\"borde-unidad\">\r\n                    <div v-if=\"portada != ''\">\r\n                        <p><b>Portada actual:</b></p>\r\n                        <p> {{portada}}</p>\r\n                        <p>\r\n                            <vx-tooltip text=\"Descargar\" position=\"bottom\" style=\"display: inline-block\" color=\"success\">\r\n                                <vs-button style=\"display: inline\" class=\"m-1\" @click=\"descargaArchivo(portada)\" size=\"small\" icon-pack=\"feather\" icon=\"icon-arrow-down\" color=\"success\" type=\"border\"></vs-button>\r\n                            </vx-tooltip>\r\n                            <vx-tooltip text=\"Eliminar\" position=\"bottom\" style=\"display: inline-block\" color=\"danger\">\r\n                                <vs-button style=\"display: inline\" class=\"m-1\" size=\"small\" icon-pack=\"feather\" icon=\"icon-x\" color=\"danger\" type=\"border\" @click=\"quitarArchivo(2,portada)\"></vs-button>\r\n                            </vx-tooltip>\r\n                        </p>\r\n                    </div>\r\n                    <div v-else>\r\n                        <div style=\"font-size: 12px;\">Portada: </div>\r\n                        <input v-if=\"porcentajep == 0\" type=\"file\" id=\"filep\" ref=\"filep\" accept=\"image/x-png,image/gif,image/jpeg\" v-on:change=\"portadaUpload()\" />\r\n                        <div class=\"v-row text-left\" v-if=\"porcentajep>0\">\r\n                            <vs-progress style=\"height:25px\" :percent=\"porcentajep\" color=\"success\"> {{porcentajep}}% </vs-progress>\r\n                        </div><br>\r\n                        <small>Tamaño máximo: {{limitePortada}} mb.</small>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"vx-col w-full m-1\">\r\n                <vs-button style=\"display: inline\" class=\"m-1\" @click=\"subirArchivo()\" size=\"medium\" icon-pack=\"feather\" icon=\"icon-save\" :color=\"btn_color\" type=\"gradient\">{{btn_texto}} </vs-button>\r\n            </div>\r\n        </div>\r\n    </vs-popup>\r\n    <vx-card>\r\n        <vs-button class=\"m-1\" @click=\"crearPublicacion()\" color=\"success\">Agregar</vs-button>\r\n        <vs-button class=\"m-1\" @click=\"verArticulos()\" color=\"warning\">Ver artículos</vs-button>\r\n        <vs-table max-items=\"10\" search pagination :data=\"publicaciones\" class=\"stripe\">\r\n            <template slot=\"header\">\r\n                <p>Total de articulos registrados: <b>{{publicaciones.length}}</b> </p>\r\n            </template>\r\n            <template slot=\"thead\">\r\n                <vs-th width=\"40%\">Nombre</vs-th>\r\n                <vs-th width=\"35%\">Archivo</vs-th>\r\n                <vs-th width=\"15%\">Estado</vs-th>\r\n                <vs-th width=\"10%\">Acciones</vs-th>\r\n            </template>\r\n            <template slot-scope=\"{data}\">\r\n                <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                    <vs-td>\r\n                        {{data[indextr].nombre}} <br>\r\n                        <small>{{data[indextr].descripcion}}</small> <br>\r\n                        <small>\r\n                            <b>Área</b> {{data[indextr].area}}\r\n                        </small>\r\n                    </vs-td>\r\n                    <vs-td>\r\n                        <span v-if=\"data[indextr].nombre_archivo != null\">\r\n                            <i class=\"text-primary cursor-pointer\" @click=\"verArticulo(data[indextr])\"><u>{{data[indextr].nombre_archivo}}</u></i>\r\n                        </span>\r\n                        <span v-else class=\"text-danger\"><i> Sin archivo</i></span> <br>\r\n                        <span v-if=\"data[indextr].nombre_portada == null\" class=\"text-danger\" style=\"font-size:10px\"><i> Sin portada</i></span>\r\n                        <span v-else>\r\n                            <vs-avatar size=\"large\" :src=\"$data_url+data[indextr].ruta_portada+'/'+data[indextr].nombre_portada\" @click=\"f_zoom_img(data[indextr])\" />\r\n                        </span>\r\n                    </vs-td>\r\n                    <vs-td>\r\n                        <small v-if=\"data[indextr].estado == 1\" class=\"text-success\"> Publicado</small>\r\n                        <small v-else class=\"text-danger\">Inactivo</small><br>\r\n                        <small> {{data[indextr].updated_at | fecha}} </small>\r\n                    </vs-td>\r\n                    <vs-td>\r\n                        <vx-tooltip style=\"display: inline-block;\" text=\"editar publicación\" position=\"top\" color=\"success\">\r\n                            <vs-button @click=\"editaArticulo(data[indextr])\" size=\"small\" radius icon-pack=\"feather\" icon=\"icon-edit\" color=\"success\" type=\"gradient\"></vs-button>\r\n                        </vx-tooltip>\r\n                        <vx-tooltip style=\"display: inline-block;\" text=\"eliminar publicaciòn\" position=\"top\" color=\"danger\">\r\n                            <vs-button @click=\"openConfirmEliminar(data[indextr])\" size=\"small\" radius icon-pack=\"feather\" icon=\"icon-trash\" color=\"danger\" type=\"gradient\"></vs-button>\r\n                        </vx-tooltip>\r\n                    </vs-td>\r\n                </vs-tr>\r\n            </template>\r\n        </vs-table>\r\n    </vx-card>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nimport vSelect from 'vue-select'\r\nimport moment from \"moment\";\r\nVue.filter('fecha', function (value) {\r\n    if (value) {\r\n        return moment(String(value)).format('YYYY-MM-DD HH:mm')\r\n    }\r\n});\r\nexport default {\r\n    components: {\r\n        'v-select': vSelect,\r\n    },\r\n    data() {\r\n        return {\r\n            publicaciones: '',\r\n            elimita_contenido_articulo: '',\r\n            usuario: [],\r\n            grupo_usuario: '',\r\n            titleModal: '',\r\n            mod_articulos: false,\r\n            asignaturas: [{\r\n                    'id': '1',\r\n                    'nombre': 'Lengua'\r\n                },\r\n                {\r\n                    'id': '2',\r\n                    'nombre': 'Matemática'\r\n                },\r\n                {\r\n                    'id': '3',\r\n                    'nombre': 'Ciencias Naturales'\r\n                },\r\n                {\r\n                    'id': '4',\r\n                    'nombre': 'Ciencias Sociales'\r\n                },\r\n                {\r\n                    'id': '5',\r\n                    'nombre': 'Enseñanza educación'\r\n                }\r\n            ],\r\n            asignaturaSelect: {\r\n                'id': '',\r\n                'nombre': ''\r\n            },\r\n            archivo: '',\r\n            portada: '',\r\n            porcentaje: 0,\r\n            id_pub: '',\r\n            nombre: '',\r\n            descripcion: '',\r\n            estado: true,\r\n            edita: '',\r\n            datosEditar: '',\r\n            porcentajep: 0,\r\n            limiteMegas: 10, //permitir maximo de megas\r\n            limitePortada: 0.7, //permitir maximo de megas en la portada\r\n            bytes: 1048576, //para calculo de megas\r\n            pesoArchivo: 0,\r\n            muyPesado: false,\r\n            pesoArchivop: 0,\r\n            muyPesadop: false,\r\n            idusuario: '',\r\n            file: '',\r\n            filep: '',\r\n            id_eliminar: '',\r\n            tipo: '',\r\n            btn_color: '',\r\n            btn_texto: '',\r\n            datos_imagen: '',\r\n            modal_imagen: false,\r\n            replace_archivo: '',\r\n            replace_portada: '',\r\n            msj_articulo: '',\r\n        }\r\n    },\r\n    mounted() {\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n        me.grupo_usuario = me.usuario.id_group;\r\n        me.getPublicaciones();\r\n    },\r\n    methods: {\r\n        getPublicaciones() {\r\n            let me = this;\r\n            me.mod_articulos = false;\r\n            me.$vs.loading();\r\n            this.$http.get(this.$server_url + 'articulos')\r\n                .then(function (res) {\r\n                    me.publicaciones = res.data;\r\n                    me.$vs.loading.close();\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        crearPublicacion() {\r\n            let me = this;\r\n            me.edita = false;\r\n            me.btn_color = 'success'\r\n            me.btn_texto = 'Guardar'\r\n            me.titleModal = \"Agregar artículo\";\r\n            me.msj_articulo = 'Articulo agregado correctamente';\r\n            me.id = '';\r\n            me.nombre = '';\r\n            me.descripcion = '';\r\n            me.asignaturaSelect = {\r\n                'id': '',\r\n                'nombre': ''\r\n            };\r\n            me.file = \"\";\r\n            me.filep = \"\";\r\n            me.portada = '';\r\n            me.archivo = '';\r\n            me.mod_articulos = true;\r\n\r\n        },\r\n        handleFileUpload() {\r\n            let me = this;\r\n            me.porcentaje = 0;\r\n            me.pesoArchivo = 0;\r\n            me.muyPesado = false;\r\n            me.file = me.$refs.file.files[0];\r\n            // verificar tamaño de archivo\r\n            // console.log(me.file)\r\n            me.pesoArchivo = (me.file.size / me.bytes).toFixed(2);\r\n            if (me.pesoArchivo > me.limiteMegas) {\r\n                me.muyPesado = true;\r\n            }\r\n        },\r\n        portadaUpload() {\r\n            let me = this;\r\n            me.porcentajep = 0;\r\n            me.pesoArchivop = 0;\r\n            me.muyPesadop = false;\r\n            me.filep = me.$refs.filep.files[0];\r\n            // verificar tamaño de archivo\r\n            // console.log(me.filep)\r\n            me.pesoArchivop = (me.filep.size / me.bytes).toFixed(2);\r\n            if (me.pesoArchivop > me.limitePortada) {\r\n                me.muyPesadop = true;\r\n            }\r\n        },\r\n        subirArchivo() {\r\n            let me = this;\r\n            if (me.nombre == \"\") {\r\n                me.$vs.notify({\r\n                    text: 'Ingrese el nombre del artículo',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            if (me.descripcion == \"\") {\r\n                me.$vs.notify({\r\n                    text: 'Ingrese la descripción del artículo',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            if (me.asignaturaSelect.nombre == \"\") {\r\n                me.$vs.notify({\r\n                    text: 'Seleccione el área',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            if (me.muyPesado) {\r\n                me.$vs.notify({\r\n                    text: 'El archivo a subir excede el peso permitido, verifique antes de continuar',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            if (me.muyPesadop) {\r\n                me.$vs.notify({\r\n                    text: 'La portada a subir excede el peso permitido, verifique antes de continuar',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            if (me.archivo == \"\" && me.file == \"\") {\r\n                me.$vs.notify({\r\n                    text: 'Seleccione el archivo ',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n\r\n            if (me.portada == \"\" && me.filep === \"\") {\r\n                me.$vs.notify({\r\n                    text: 'Seleccione una portada',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    icon: 'icon-alert-triangle'\r\n                })\r\n                return\r\n            }\r\n            let estado1 = me.estado ? 1 : 0;\r\n            let dataA = new FormData();\r\n            if (me.file != '') {\r\n                dataA.append('archivo', me.file);\r\n            }\r\n            if (me.filep != '') {\r\n                dataA.append('portada', me.filep);\r\n            }\r\n            dataA.append('id', me.id);\r\n            dataA.append('nombre', me.nombre);\r\n            dataA.append('descripcion', me.descripcion);\r\n            dataA.append('idusuario', me.usuario.idusuario);\r\n            dataA.append('idarea', me.asignaturaSelect.id);\r\n            dataA.append('area', me.asignaturaSelect.nombre);\r\n            dataA.append('estado', estado1);\r\n            dataA.append('replace_archivo', me.replace_archivo);\r\n            dataA.append('replace_portada', me.replace_portada);\r\n            const config = {\r\n                headers: {\r\n                    'Content-Type': 'multipart/form-data'\r\n                }\r\n            };\r\n\r\n            axios.post(this.$data_url + 'api/save_posts', dataA, config)\r\n                .then(res => {\r\n                    // console.log(res.data)\r\n                    me.getPublicaciones();\r\n                    me.$vs.notify({\r\n                        text: me.msj_articulo,\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        f_zoom_img(item) {\r\n            let me = this;\r\n            me.datos_imagen = item;\r\n            // console.log(item)\r\n            me.modal_imagen = true;\r\n        },\r\n        editaArticulo(item) {\r\n            let me = this;\r\n            console.log(item)\r\n            me.edita = true;\r\n            me.btn_color = 'warning'\r\n            me.btn_texto = 'Editar'\r\n            me.titleModal = \"Editar artículo\";\r\n            me.msj_articulo = 'Articulo editado correctamente';\r\n            me.id = item.id;\r\n            me.nombre = item.nombre;\r\n            me.descripcion = item.descripcion;\r\n            me.asignaturaSelect.id = item.idarea;\r\n            me.asignaturaSelect.nombre = item.area;\r\n            me.file = '';\r\n            me.filep = '';\r\n            me.portada = item.nombre_portada;\r\n            me.archivo = item.nombre_archivo;\r\n            me.estado = item.estado == 1 ? true : false;\r\n            me.mod_articulos = true;\r\n        },\r\n        quitarArchivo(item, data) {\r\n            let me = this;\r\n            // console.log(item, data)\r\n            if (item == 1) {\r\n                me.archivo = \"\";\r\n                me.file = \"\";\r\n                me.replace_archivo = data;\r\n            }\r\n            if (item == 2) {\r\n                me.portada = \"\";\r\n                me.filep = \"\";\r\n                me.replace_portada = data;\r\n            }\r\n        },\r\n        verArticulo(web) {\r\n            let a1 = web.nombre_archivo.indexOf(\".\");\r\n            let b1 = web.nombre_archivo.substr(a1 + 1)\r\n            if (b1 == \"doc\" || b1 == \"docx\" || b1 == \"xls\" || b1 == \"xlsx\") {\r\n                window.open('https://view.officeapps.live.com/op/embed.aspx?src=' + this.$data_url + web.ruta_archivo + '/' + web.nombre_archivo, '_blank');\r\n                return\r\n            }\r\n            if (b1 == \"pdf\") {\r\n                window.open('https://docs.google.com/viewer?url=' + this.$data_url + web.ruta_archivo + '/' + web.nombre_archivo, '_blank');\r\n                return\r\n            }\r\n            me.$vs.notify({\r\n                text: 'No es posible mostrar una vista previa del archivo solicitado, por favor descarguelo',\r\n                color: 'success',\r\n                iconPack: 'feather',\r\n                icon: 'icon-alert-triangle'\r\n            })\r\n        },\r\n        openConfirmEliminar(item) {\r\n            let me = this;\r\n            me.elimita_contenido_articulo = item\r\n            console.log(item)\r\n            me.$vs.dialog({\r\n                type: 'confirm',\r\n                color: 'danger',\r\n                title: `Confirmar`,\r\n                text: '¿Está seguro en eliminar este artículo?',\r\n                acceptText: 'Aceptar',\r\n                cancelText: 'Cancelar',\r\n                accept: me.eliminarArticulos\r\n            })\r\n        },\r\n        eliminarArticulos() {\r\n            let me = this;\r\n            //eliminar archivo\r\n            let dataA = new FormData();\r\n            dataA.append('id', me.elimita_contenido_articulo.id);\r\n            dataA.append('archivo', me.elimita_contenido_articulo.nombre_archivo);\r\n            dataA.append('portada', me.elimita_contenido_articulo.nombre_portada);\r\n            const config = {\r\n                headers: {\r\n                    'Content-Type': 'multipart/form-data'\r\n                }\r\n            };\r\n            axios.post(this.$data_url + 'api/delete_posts', dataA, config)\r\n                .then(res => {\r\n                    // console.log(res.data)\r\n                    me.$vs.notify({\r\n                        text: res.data,\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-alert-triangle'\r\n                    })\r\n                    me.getPublicaciones();\r\n                })\r\n                .catch(error => {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        verArticulos() {\r\n            let me = this\r\n            if (me.grupo_usuario == 6) {\r\n                me.$router.push('/vpublicaciones');\r\n            }\r\n            if (me.grupo_usuario == 1) {\r\n                me.$router.push('/verArticulosAdmin');\r\n            }\r\n        },\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"css\">\r\n.borde-unidad {\r\n    border: 1px dashed #ccc;\r\n    /* display: inline-block; */\r\n    padding: 6px;\r\n    cursor: pointer;\r\n}\r\n</style>\r\n"]}]}