{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\pedidos2\\pedidos\\anticipos\\pagos2\\Pagos2Listado.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\pedidos2\\pedidos\\anticipos\\pagos2\\Pagos2Listado.vue","mtime":1712682816396},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport axios from 'axios'\r\nconst AprobarAnticipoAprobadoVue = () => import('./components/AprobarAnticipoAprobado.vue')\r\nexport default {\r\n  components:{\r\n    AprobarAnticipoAprobadoVue,\r\n  },\r\n  data() {\r\n    return{\r\n      ObjectSelect:'',\r\n      popupConfirmAnticipoAprobado:false,\r\n\r\n    }\r\n  },\r\n  // inject: ['getSendPedido'],\r\n  // computed: {\r\n  //   sendPedido(){ return this.getSendPedido(); }\r\n  // },\r\n  props:{\r\n    arregloPagos:{\r\n      type:Array,\r\n      default:function(){\r\n        return []\r\n      }\r\n    },\r\n    sendPedido:{\r\n      type:Object,\r\n      default:function(){\r\n        return {}\r\n      }\r\n    },\r\n    usuario:{\r\n      type:Object,\r\n      default:function(){\r\n        return{}\r\n      }\r\n    },\r\n    userRoot:{\r\n      type:Boolean,\r\n      default:false,\r\n    },\r\n    groupFacturador:{\r\n      type:Boolean,\r\n      default:false,\r\n    }\r\n  },\r\n  watch:{\r\n    arregloPagos(results){\r\n      this.arregloPagos = results\r\n    },\r\n    sendPedido(results){\r\n      this.sendPedido = results\r\n    }\r\n  },\r\n  mounted(){\r\n    let me  = this\r\n  },\r\n  methods:{\r\n    rechargePedido(e){\r\n      let me = this\r\n      me.$emit('rechargePedido',e)\r\n    },\r\n    changeHandle(e){\r\n      let me = this\r\n      if(e == 0) { me.popupConfirmAnticipoAprobado = false; }\r\n      if(e == 1) { me.popupConfirmAnticipoAprobado = false; me.rechargePedido();   me.$emit('rechargeValores',true) }\r\n    },\r\n    openDocument(tr){\r\n      let me = this;\r\n      let ruta = me.$data_url+'archivos/pedidos/pagos/'+tr.url\r\n      window.open(ruta,'_blank')\r\n    },\r\n    openConfirmAprobarPago(tr){\r\n      let me = this;\r\n      //si es anticipo del pedido verificar que este aprobado por el facturador\r\n      if(tr.ifAntAprobado == 1){\r\n        if(me.sendPedido.ifagregado_anticipo_aprobado == 0){\r\n          me.$vs.notify({\r\n            text: 'El anticipo del pedido no esta aprobado por el facturador No puede cerrar el pago',\r\n            color: 'warning',\r\n            iconPack: 'feather',\r\n            icon: 'icon-alert-triangle',\r\n            time:6000,\r\n          })\r\n          return\r\n        }\r\n      }\r\n      this.$vs.dialog({\r\n        type:'confirm',\r\n        color: 'danger',\r\n        title: `Confirmar`,\r\n        acceptText:'Si, deseo aprobar el pago',\r\n        cancelText:'Cancelar',\r\n        text: 'Estás seguro de aprobar el pago?',\r\n        accept:this.aprobarPago\r\n      })\r\n    },\r\n    aprobarPago(){\r\n      let me = this;\r\n      let formData = new FormData();\r\n      formData.append('aprobarPagoVerificacion',  'yes')\r\n      formData.append('doc_codigo',               me.ObjectSelect.doc_codigo);\r\n      formData.append('contrato',                 me.sendPedido.contrato_generado)\r\n      formData.append('user_created',             me.usuario.idusuario);\r\n      formData.append('periodo_id',               me.sendPedido.id_periodo)\r\n      formData.append('institucion_id',           me.sendPedido.id_institucion)\r\n      formData.append('id_pedido',                me.sendPedido.id_pedido)\r\n      formData.append('valor',                    me.ObjectSelect.doc_valor)\r\n      formData.append('tipo_pago_id',             me.ObjectSelect.tipo_pago_id)\r\n      formData.append('doc_observacion',          me.ObjectSelect.doc_observacion)\r\n      me.$vs.loading()\r\n      this.$http.post(this.$server_url+'pedigo_Pagos', formData)\r\n      .then(function (res) {\r\n        me.$vs.loading.close()\r\n        if(res.data.status == 0){\r\n          me.$vs.notify({\r\n            text: res.data.message,\r\n            color: 'warning',\r\n            iconPack: 'feather',\r\n            icon: 'icon-alert-triangle',\r\n            time:5000,\r\n          })\r\n          return\r\n        }\r\n        me.$vs.notify({\r\n          text: res.data.message,\r\n          color: 'success',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle'\r\n        })\r\n        me.$emit('rechargeValores',true)\r\n      })\r\n      .catch(function (error) {\r\n        me.$vs.loading.close()\r\n      })\r\n    },\r\n    openConfirmEliminarPago(){\r\n        let me = this;\r\n        if(me.ObjectSelect.ifAntAprobado == 1){\r\n          this.$vs.dialog({\r\n            type:'confirm',\r\n            color: 'danger',\r\n            title: `Confirmar`,\r\n            acceptText:'Si, deseo eliminar el registro del pago',\r\n            cancelText:'Cancelar',\r\n            text: 'Estás seguro de eliminar el registro del pago?',\r\n            accept:this.eliminarPagoAnticipo\r\n          })\r\n          return\r\n        }\r\n        const { doc_observacion ,tipo_pago_id } = me.ObjectSelect\r\n        if(tipo_pago_id == 1 && doc_observacion &&  doc_observacion.toLowerCase().includes(\"deuda\")){\r\n          this.$vs.dialog({\r\n            type:'confirm',\r\n            color: 'danger',\r\n            title: `Confirmar`,\r\n            acceptText:'Si, deseo eliminar el registro del pago',\r\n            cancelText:'Cancelar',\r\n            text: 'Estás seguro de eliminar el registro del pago?',\r\n            accept:this.eliminarValorPagoDeuda\r\n          })\r\n          return\r\n        }\r\n        else{\r\n          this.$vs.dialog({\r\n            type:'confirm',\r\n            color: 'danger',\r\n            title: `Confirmar`,\r\n            acceptText:'Si, deseo eliminar el registro del pago',\r\n            cancelText:'Cancelar',\r\n            text: 'Estás seguro de eliminar el registro del pago?',\r\n            accept:this.eliminarValorPago\r\n          })\r\n        }\r\n      },\r\n      eliminarValorPago(){\r\n        let me = this;\r\n        let formData = new FormData()\r\n        formData.append('eliminarRegistroPago',         \"yes\")\r\n        formData.append('doc_codigo',                   me.ObjectSelect.doc_codigo)\r\n        formData.append('id_pedido',                    me.sendPedido.id_pedido)\r\n        formData.append('user_created',                 me.usuario.idusuario)\r\n        me.$vs.loading()\r\n        axios.post(this.$data_url + 'api/guardarDatosPedido', formData)\r\n        .then(function (res) {\r\n          me.$vs.loading.close()\r\n          if(res.data.status == 0){\r\n            me.$vs.notify({\r\n            text:res.data.message,\r\n            color:'warning',\r\n            iconPack: 'feather',\r\n            icon:'icon-check',\r\n            time:5000\r\n            })\r\n            return\r\n          }\r\n          me.$vs.notify({\r\n          text:\"Se elimino correctamente\",\r\n          color:'success',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          me.setHistoricoPagoEliminado()\r\n          // me.$emit('rechargeValores',true)\r\n        })\r\n        .catch(function (error) {\r\n            me.$vs.loading.close()\r\n        })\r\n      },\r\n      setHistoricoPagoEliminado(){\r\n        let me = this\r\n        let formData = new FormData()\r\n        formData.append('eliminarPagoNormal',       \"yes\")\r\n        formData.append('doc_codigo',                me.ObjectSelect.doc_codigo)\r\n        formData.append('id_pedido',                 me.sendPedido.id_pedido)\r\n        formData.append('user_created',              me.usuario.idusuario)\r\n        formData.append('old_values',                JSON.stringify(me.ObjectSelect))\r\n        formData.append('ven_codigo',                me.ObjectSelect.ven_codigo)\r\n        formData.append('periodo_id',                me.ObjectSelect.periodo_id)\r\n        formData.append('institucion_id',            me.ObjectSelect.institucion_id)\r\n        formData.append('id_pedido',                 me.ObjectSelect.id_pedido)\r\n        formData.append('tipo_pago_id',              me.ObjectSelect.tipo_pago_id)\r\n        formData.append('forma_pago_id',             me.ObjectSelect.forma_pago_id)\r\n        formData.append('doc_observacion',           me.ObjectSelect.doc_observacion)\r\n        this.$http.post(this.$server_url+'eliminarPagos', formData)\r\n        .then(function (res) {\r\n          me.$emit('rechargeValores',true)\r\n        })\r\n        .catch(function (error) {})\r\n      },\r\n      eliminarPagoAnticipo(){\r\n        let me = this\r\n        let formData = new FormData()\r\n        formData.append('eliminarPagoAnticipo',      \"yes\")\r\n        formData.append('doc_codigo',                me.ObjectSelect.doc_codigo)\r\n        formData.append('id_pedido',                 me.sendPedido.id_pedido)\r\n        formData.append('user_created',              me.usuario.idusuario)\r\n        me.$vs.loading()\r\n        this.$http.post(this.$server_url+'eliminarPagos', formData)\r\n        .then(function (res) {\r\n          me.$vs.loading.close()\r\n          me.$vs.notify({\r\n          text:\"Se elimino correctamente\",\r\n          color:'success',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          me.$emit('rechargeValores',true)\r\n        })\r\n        .catch(function (error) {})\r\n      },\r\n      eliminarValorPagoDeuda(){\r\n        let me = this\r\n        let formData = new FormData()\r\n        formData.append('eliminarPagoDeuda',         \"yes\")\r\n        formData.append('doc_codigo',                me.ObjectSelect.doc_codigo)\r\n        formData.append('id_pedido',                 me.sendPedido.id_pedido)\r\n        formData.append('doc_valor',                 me.ObjectSelect.doc_valor)\r\n        formData.append('user_created',              me.usuario.idusuario)\r\n        me.$vs.loading()\r\n        this.$http.post(this.$server_url+'eliminarPagos', formData)\r\n        .then(function (res) {\r\n          me.$vs.loading.close()\r\n          me.$vs.notify({\r\n          text:\"Se elimino correctamente\",\r\n          color:'success',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          me.$emit('rechargeValores',true)\r\n        })\r\n        .catch(function (error) {})\r\n      },\r\n      confirmReAbriPago(){\r\n        let me = this\r\n        this.$vs.dialog({\r\n          type:'confirm',\r\n          color: 'danger',\r\n          title: `Confirmar`,\r\n          acceptText:'Si, deseo reabrir el pago',\r\n          cancelText:'Cancelar',\r\n          text: 'Estás seguro de reabrir el pago?',\r\n          accept:this.reAbriPago\r\n        })\r\n      },\r\n      reAbriPago(){\r\n        let me = this\r\n        let formData = new FormData()\r\n        formData.append('reabrirPagos',        \"yes\")\r\n        formData.append('id_pedido',           me.sendPedido.id_pedido)\r\n        formData.append('doc_codigo',          me.ObjectSelect.doc_codigo)\r\n        formData.append('user_created',        me.usuario.idusuario)\r\n        formData.append('tipo_pago_id',        me.ObjectSelect.tipo_pago_id)\r\n        formData.append('forma_pago_id',       me.ObjectSelect.forma_pago_id)\r\n        formData.append('doc_observacion',     me.ObjectSelect.doc_observacion)\r\n        me.$vs.loading()\r\n        this.$http.post(this.$server_url+'pedigo_Pagos', formData)\r\n        .then(function (res) {\r\n          me.$vs.loading.close()\r\n          if(res.data.status == 0){\r\n            me.$vs.notify({\r\n            text:res.data.message,\r\n            color:'warning',\r\n            iconPack: 'feather',\r\n            icon:'icon-check',\r\n            time:5000\r\n            })\r\n            return\r\n          }\r\n          me.$vs.notify({\r\n          text:\"Se reabrio correctamente\",\r\n          color:'success',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          me.$emit('rechargeValores',true)\r\n        })\r\n        .catch(function (error) {})\r\n      }\r\n  }\r\n}\r\n",{"version":3,"sources":["Pagos2Listado.vue"],"names":[],"mappings":";AA8KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Pagos2Listado.vue","sourceRoot":"src/views/pedidos2/pedidos/anticipos/pagos2","sourcesContent":["<template>\r\n  <div>\r\n    <div>\r\n      <vs-table stripe :data=\"arregloPagos\" class=\"mt-3\" max-items=\"5\" search pagination>\r\n        <template slot=\"header\">\r\n          <div class=\"flex\">\r\n              <vs-chip>Cantidad: {{ arregloPagos.length }}</vs-chip>\r\n          </div>\r\n          <br>\r\n        </template>\r\n        <template slot=\"thead\">\r\n            <vs-th width=\"10%\">#</vs-th>\r\n            <vs-th width=\"20%\">Documento</vs-th>\r\n            <vs-th width=\"30%\">Contrato</vs-th>\r\n            <vs-th width=\"10%\">Observación</vs-th>\r\n            <vs-th width=\"30%\">Acción</vs-th>\r\n        </template>\r\n        <template slot-scope=\"{data}\">\r\n        <vs-tr :data=\"tr\" :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n            <vs-td>{{ tr.doc_codigo }}</vs-td>\r\n            <vs-td>\r\n              <div class=\"flex\" v-if=\"tr.ifAntAprobado == 0\">\r\n                <p class=\"\"><vs-chip v-if=\"tr.estado == 0\" color=\"warning\">Pendiente</vs-chip></p>\r\n                <p class=\"\"><vs-chip v-if=\"tr.estado == 1\" color=\"success\">Aprobado</vs-chip></p>\r\n                <p class=\"\"><vs-chip v-if=\"tr.estado == 2\" color=\"danger\">Anulado</vs-chip></p>\r\n              </div>\r\n              <div :class=\"sendPedido.ifagregado_anticipo_aprobado == 0 || sendPedido.ifagregado_anticipo_aprobado == 2  ?  'mt-2 bg-warning' :  'mt-2 bg-success'\" v-if=\"tr.ifAntAprobado == 1\"  style=\"color:white;padding:5px;border-radius: 10px;\">\r\n                <p class=\"font-bold mt-2\">Anticipo Pedido:</p>\r\n                <small v-if=\"sendPedido.ifagregado_anticipo_aprobado == 0\">Sin aprobar</small>\r\n                <small v-if=\"sendPedido.ifagregado_anticipo_aprobado == 1 && sendPedido.anticipo_aprobado > 0\">Anticipo aprobado por admin facturador</small>\r\n                <small v-if=\"sendPedido.ifagregado_anticipo_aprobado == 2\" class=\"font-bold\">!Anticipo solicitado a gerencia ${{ sendPedido.anticipo_solicitud_for_gerencia }}</small>\r\n                <small v-if=\"sendPedido.ifagregado_anticipo_aprobado == 3\"><b>ANTICIPO APROBADO POR GERENCIA <span class=\"text-success\">$ {{ sendPedido.anticipo_aprobado_gerencia }}</span></b></small>\r\n                <small v-if=\"sendPedido.ifagregado_anticipo_aprobado == 4\" class=\"text-danger\">Anticipo solicitado: rechazado</small>\r\n                <small v-if=\"sendPedido.ifagregado_anticipo_aprobado == 5\" class=\"text-success\">Gerencia aprueba anticipo sugerido</small>\r\n              </div>\r\n              <p  class=\"mt-3\" style=\"font-weight:bold;\">Doc valor:  <span  class=\"text-success font-bold\">{{ data[indextr].doc_valor | filtrarDecimal }}</span></p>\r\n              <p style=\"font-weight:bold;\">Tipo de pago:</p>\r\n              <span>{{ tr.tipo_pagos.nombre }}</span>\r\n              <p style=\"font-weight:bold;\">Forma de pago:</p>\r\n              <p>{{ tr.forma_pagos.tip_pag_nombre }}</p>\r\n              <div v-if=\"tr.unicoEvidencia == 0\">\r\n                <p style=\"font-weight:bold;\" >Doc. Número:</p>\r\n                <span>{{ data[indextr].doc_numero }}</span>\r\n              </div>\r\n              <p style=\"font-weight:bold;\">Doc. Nombre:</p>\r\n              <span>{{ data[indextr].doc_nombre }}</span>\r\n              <p style=\"font-weight:bold;\">Doc. Apellidos:</p>\r\n              <span>{{ data[indextr].doc_apellidos }}</span>\r\n              <!-- <p style=\"font-weight:bold;\">Doc. Ci:</p>\r\n              <span>{{ data[indextr].doc_ci }}</span> -->\r\n              <p style=\"font-weight:bold;\">Doc. Institución:</p>\r\n              <span>{{ data[indextr].doc_institucion }}</span>\r\n              <p style=\"font-weight:bold;\">Doc. Tipo:</p>\r\n              <span>{{ data[indextr].doc_tipo }}</span>\r\n              <p style=\"font-weight:bold;\">Doc. Fecha:</p>\r\n              <span>{{ data[indextr].doc_fecha }}</span>\r\n              <div v-if=\"tr.unicoEvidencia == 0\">\r\n                <p v-if=\"!tr.archivo\">\r\n                  <b class=\"text-danger\"> Solicitud de evidencias: No subida </b>\r\n                  </p>\r\n                  <p v-else class=\"imagen\" @click=\"openDocument(tr)\">\r\n                      <b> Evidencia:\r\n                          <!--PDF-->\r\n                          <ion-icon v-if=\"tr.archivo.substr(-3) == 'pdf'\" style=\"font-size:20px;color:green;position:relative;top:5px;\" name=\"document-outline\"></ion-icon>\r\n                          <!--IMAGE-->\r\n                          <ion-icon v-else style=\"font-size:20px;color:green;position:relative;top:5px;\" name=\"camera-outline\"></ion-icon>\r\n                      </b>\r\n                  </p>\r\n              </div>\r\n          </vs-td>\r\n          <vs-td>\r\n            {{ tr.ven_codigo }}\r\n            <div v-if=\"tr.pedido_pagos_hijo.length > 0\">\r\n              <vs-collapse accordion >\r\n                <vs-collapse-item  style=\"position:relative;left:-50px;\">\r\n                  <div slot=\"header\">\r\n                    <p class=\"font-bold\"> Ver varias Evidencias </p>\r\n                  </div>\r\n                  <vs-row>\r\n                    <vs-col vs-type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\" vs-sm = \"12\" vs-xs=\"12\" >\r\n                      <vs-card>\r\n                        <div class=\"header\">\r\n                          <p style=\"font-weight: bold;\">Varias Documentos </p>\r\n                          <table class=\"tabla\">\r\n                              <tr>\r\n                                <th class=\"th1\">Valor</th>\r\n                                <th class=\"th1\">Num. Documento</th>\r\n                                <th class=\"th1\">Evidencia</th>\r\n                              </tr>\r\n                              <tr v-for=\"(item,key) in tr.pedido_pagos_hijo\" :key=\"key\">\r\n                                <td class=\"td1\">{{  item.valor }}</td>\r\n                                <td class=\"td1\">{{ item.codigo }}</td>\r\n                                <td class=\"td1\">\r\n                                  <p v-if=\"!item.archivo\">\r\n                                    <b class=\"text-danger\"> Solicitud de evidencias: No subida </b>\r\n                                    </p>\r\n                                    <p v-else class=\"imagen\" @click=\"openDocument(item)\">\r\n                                        <b> Evidencia:\r\n                                            <!--PDF-->\r\n                                            <ion-icon v-if=\"item.archivo.substr(-3) == 'pdf'\" style=\"font-size:20px;color:green;position:relative;top:5px;\" name=\"document-outline\"></ion-icon>\r\n                                            <!--IMAGE-->\r\n                                            <ion-icon v-else style=\"font-size:20px;color:green;position:relative;top:5px;\" name=\"camera-outline\"></ion-icon>\r\n                                        </b>\r\n                                    </p>\r\n                                </td>\r\n                              </tr>\r\n                          </table>\r\n                        </div>\r\n                      </vs-card>\r\n                    </vs-col>\r\n                  </vs-row>\r\n                </vs-collapse-item>\r\n                </vs-collapse>\r\n            </div>\r\n          </vs-td>\r\n            <vs-td height=\"30%\" width=\"30%\">\r\n              <div class=\"overflow-y-auto h-24\">\r\n                {{ tr.doc_observacion }}\r\n              </div>\r\n            </vs-td>\r\n            <vs-td align=\"center\">\r\n              <div v-if=\"tr.estado == 0\">\r\n                <!--facturador-->\r\n                <div v-if=\"usuario.id_group == 22\">\r\n                  <!--anticipo del pedido-->\r\n                  <div v-if=\"tr.ifAntAprobado == 1\">\r\n                    <vs-button v-if=\"tr.estado == 0 && sendPedido.ifagregado_anticipo_aprobado == 0\" size=\"small\" class=\"m-2\" @click=\"id=tr.doc_codigo;ObjectSelect=tr;openConfirmAprobarPago(tr);\"  icon-pack=\"feather\" icon=\"icon-check\" color=\"success\" type=\"gradient\">Cerrar Pago </vs-button>\r\n                    <vs-button v-if=\"tr.estado == 0 && sendPedido.ifagregado_anticipo_aprobado > 0\" size=\"small\" class=\"m-2\" @click=\"id=tr.doc_codigo;ObjectSelect=tr;openConfirmAprobarPago(tr);\"  icon-pack=\"feather\" icon=\"icon-check\" color=\"success\" type=\"gradient\">Cerrar Pago </vs-button>\r\n                  </div>\r\n                  <!--otros pagos-->\r\n                  <div v-if=\"tr.ifAntAprobado == 0\">\r\n                    <vs-button v-if=\"tr.estado == 0\" size=\"small\" class=\"m-2\" @click=\"id=tr.doc_codigo;ObjectSelect=tr;openConfirmAprobarPago(tr);\" icon-pack=\"feather\" icon=\"icon-check\" color=\"success\" type=\"gradient\">Cerrar Pago </vs-button>\r\n                  </div>\r\n                </div>\r\n                <!--facturador admin y root-->\r\n                <div v-if=\"usuario.id_group == 23 || userRoot\">\r\n                  <!--anticipo del pedido-->\r\n                  <div v-if=\"tr.ifAntAprobado == 1\">\r\n                    <vs-button size=\"small\" class=\"m-2\" @click=\"id=tr.doc_codigo;ObjectSelect=tr;popupConfirmAnticipoAprobado=true;\"  icon-pack=\"feather\" icon=\"icon-check\" color=\"primary\" type=\"gradient\">{{ sendPedido.ifagregado_anticipo_aprobado == 0 ? 'Aprobar Anticipo solicitado' : 'Cambiar Anticipo solicitado' }}  </vs-button>\r\n                    <vs-button size=\"small\" class=\"m-2 mt-3\" @click=\"id=tr.doc_codigo;ObjectSelect=tr;openConfirmAprobarPago(tr);\"  icon-pack=\"feather\" icon=\"icon-check\" color=\"success\" type=\"gradient\">Cerrar Pago </vs-button>\r\n                  </div>\r\n                  <!--otros pagos-->\r\n                  <div v-if=\"tr.ifAntAprobado == 0\">\r\n                    <vs-button v-if=\"tr.estado == 0\" size=\"small\" class=\"m-2\" @click=\"id=tr.doc_codigo;ObjectSelect=tr;openConfirmAprobarPago(tr);\" icon-pack=\"feather\" icon=\"icon-check\" color=\"success\" type=\"gradient\">Cerrar Pago </vs-button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div v-else>\r\n                <vx-tooltip style=\"display: inline-block;\" text=\"Vuelva nuevamente a habilitar el Pago\" position=\"top\" color=\"primary\">\r\n                  <vs-button size=\"small\"  v-if=\"usuario.id_group == 23 || userRoot\" icon-pack=\"feather\" icon=\"icon-settings\" class=\"m-3\" @click=\"ObjectSelect=tr;confirmReAbriPago(tr)\" color=\"primary\" type=\"gradient\">Reabrir pago</vs-button>\r\n                </vx-tooltip>\r\n              </div>\r\n              <vx-tooltip text=\"Editar pago\" position=\"top\" color=\"warning\" style=\"display: inline-block; z-index: 3;\">\r\n                <vs-button  size=\"small\"  icon-pack=\"feather\" icon=\"icon-edit\" class=\"m-3\" @click=\"id=tr.doc_codigo;ObjectSelect=tr;$emit('showCreate',1,tr);\" color=\"warning\" type=\"gradient\">Editar</vs-button>\r\n              </vx-tooltip>\r\n              <vx-tooltip text=\"Eliminar pago\" position=\"top\" color=\"danger\" style=\"display: inline-block; z-index: 3;\">\r\n                <vs-button v-if=\"userRoot\" size=\"small\"  icon-pack=\"feather\" class=\"m-3\" icon=\"icon-x\" @click=\"ObjectSelect=tr;openConfirmEliminarPago(tr)\" color=\"danger\" type=\"gradient\">Eliminar</vs-button>\r\n              </vx-tooltip>\r\n              <vx-tooltip text=\"Eliminar pago\" position=\"top\" color=\"danger\" style=\"display: inline-block; z-index: 3;\">\r\n                <vs-button v-if=\"tr.estado == 0 && (usuario.id_group == 22 || usuario.id_group == 23)\" class=\"m-2\" size=\"small\" icon-pack=\"feather\" icon=\"icon-x\" @click=\"ObjectSelect=tr;openConfirmEliminarPago(tr)\" color=\"danger\" type=\"gradient\">Eliminar</vs-button>\r\n              </vx-tooltip>\r\n            </vs-td>\r\n        </vs-tr>\r\n        </template>\r\n      </vs-table>\r\n    </div>\r\n    <!---MODALES-->\r\n    <!--MODAL PARA APROBAR EL ANTICIPO APROBADO-->\r\n    <vs-popup classContent=\"popup-example\" title=\"Aprobar Anticipo del pedido\" :active.sync=\"popupConfirmAnticipoAprobado\">\r\n      <AprobarAnticipoAprobadoVue v-if=\"popupConfirmAnticipoAprobado\" :sendPedido=\"sendPedido\" :usuario=\"usuario\" :userRoot=\"Boolean(userRoot)\" @changeHandle=\"changeHandle\"/>\r\n    </vs-popup>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from 'axios'\r\nconst AprobarAnticipoAprobadoVue = () => import('./components/AprobarAnticipoAprobado.vue')\r\nexport default {\r\n  components:{\r\n    AprobarAnticipoAprobadoVue,\r\n  },\r\n  data() {\r\n    return{\r\n      ObjectSelect:'',\r\n      popupConfirmAnticipoAprobado:false,\r\n\r\n    }\r\n  },\r\n  // inject: ['getSendPedido'],\r\n  // computed: {\r\n  //   sendPedido(){ return this.getSendPedido(); }\r\n  // },\r\n  props:{\r\n    arregloPagos:{\r\n      type:Array,\r\n      default:function(){\r\n        return []\r\n      }\r\n    },\r\n    sendPedido:{\r\n      type:Object,\r\n      default:function(){\r\n        return {}\r\n      }\r\n    },\r\n    usuario:{\r\n      type:Object,\r\n      default:function(){\r\n        return{}\r\n      }\r\n    },\r\n    userRoot:{\r\n      type:Boolean,\r\n      default:false,\r\n    },\r\n    groupFacturador:{\r\n      type:Boolean,\r\n      default:false,\r\n    }\r\n  },\r\n  watch:{\r\n    arregloPagos(results){\r\n      this.arregloPagos = results\r\n    },\r\n    sendPedido(results){\r\n      this.sendPedido = results\r\n    }\r\n  },\r\n  mounted(){\r\n    let me  = this\r\n  },\r\n  methods:{\r\n    rechargePedido(e){\r\n      let me = this\r\n      me.$emit('rechargePedido',e)\r\n    },\r\n    changeHandle(e){\r\n      let me = this\r\n      if(e == 0) { me.popupConfirmAnticipoAprobado = false; }\r\n      if(e == 1) { me.popupConfirmAnticipoAprobado = false; me.rechargePedido();   me.$emit('rechargeValores',true) }\r\n    },\r\n    openDocument(tr){\r\n      let me = this;\r\n      let ruta = me.$data_url+'archivos/pedidos/pagos/'+tr.url\r\n      window.open(ruta,'_blank')\r\n    },\r\n    openConfirmAprobarPago(tr){\r\n      let me = this;\r\n      //si es anticipo del pedido verificar que este aprobado por el facturador\r\n      if(tr.ifAntAprobado == 1){\r\n        if(me.sendPedido.ifagregado_anticipo_aprobado == 0){\r\n          me.$vs.notify({\r\n            text: 'El anticipo del pedido no esta aprobado por el facturador No puede cerrar el pago',\r\n            color: 'warning',\r\n            iconPack: 'feather',\r\n            icon: 'icon-alert-triangle',\r\n            time:6000,\r\n          })\r\n          return\r\n        }\r\n      }\r\n      this.$vs.dialog({\r\n        type:'confirm',\r\n        color: 'danger',\r\n        title: `Confirmar`,\r\n        acceptText:'Si, deseo aprobar el pago',\r\n        cancelText:'Cancelar',\r\n        text: 'Estás seguro de aprobar el pago?',\r\n        accept:this.aprobarPago\r\n      })\r\n    },\r\n    aprobarPago(){\r\n      let me = this;\r\n      let formData = new FormData();\r\n      formData.append('aprobarPagoVerificacion',  'yes')\r\n      formData.append('doc_codigo',               me.ObjectSelect.doc_codigo);\r\n      formData.append('contrato',                 me.sendPedido.contrato_generado)\r\n      formData.append('user_created',             me.usuario.idusuario);\r\n      formData.append('periodo_id',               me.sendPedido.id_periodo)\r\n      formData.append('institucion_id',           me.sendPedido.id_institucion)\r\n      formData.append('id_pedido',                me.sendPedido.id_pedido)\r\n      formData.append('valor',                    me.ObjectSelect.doc_valor)\r\n      formData.append('tipo_pago_id',             me.ObjectSelect.tipo_pago_id)\r\n      formData.append('doc_observacion',          me.ObjectSelect.doc_observacion)\r\n      me.$vs.loading()\r\n      this.$http.post(this.$server_url+'pedigo_Pagos', formData)\r\n      .then(function (res) {\r\n        me.$vs.loading.close()\r\n        if(res.data.status == 0){\r\n          me.$vs.notify({\r\n            text: res.data.message,\r\n            color: 'warning',\r\n            iconPack: 'feather',\r\n            icon: 'icon-alert-triangle',\r\n            time:5000,\r\n          })\r\n          return\r\n        }\r\n        me.$vs.notify({\r\n          text: res.data.message,\r\n          color: 'success',\r\n          iconPack: 'feather',\r\n          icon: 'icon-alert-triangle'\r\n        })\r\n        me.$emit('rechargeValores',true)\r\n      })\r\n      .catch(function (error) {\r\n        me.$vs.loading.close()\r\n      })\r\n    },\r\n    openConfirmEliminarPago(){\r\n        let me = this;\r\n        if(me.ObjectSelect.ifAntAprobado == 1){\r\n          this.$vs.dialog({\r\n            type:'confirm',\r\n            color: 'danger',\r\n            title: `Confirmar`,\r\n            acceptText:'Si, deseo eliminar el registro del pago',\r\n            cancelText:'Cancelar',\r\n            text: 'Estás seguro de eliminar el registro del pago?',\r\n            accept:this.eliminarPagoAnticipo\r\n          })\r\n          return\r\n        }\r\n        const { doc_observacion ,tipo_pago_id } = me.ObjectSelect\r\n        if(tipo_pago_id == 1 && doc_observacion &&  doc_observacion.toLowerCase().includes(\"deuda\")){\r\n          this.$vs.dialog({\r\n            type:'confirm',\r\n            color: 'danger',\r\n            title: `Confirmar`,\r\n            acceptText:'Si, deseo eliminar el registro del pago',\r\n            cancelText:'Cancelar',\r\n            text: 'Estás seguro de eliminar el registro del pago?',\r\n            accept:this.eliminarValorPagoDeuda\r\n          })\r\n          return\r\n        }\r\n        else{\r\n          this.$vs.dialog({\r\n            type:'confirm',\r\n            color: 'danger',\r\n            title: `Confirmar`,\r\n            acceptText:'Si, deseo eliminar el registro del pago',\r\n            cancelText:'Cancelar',\r\n            text: 'Estás seguro de eliminar el registro del pago?',\r\n            accept:this.eliminarValorPago\r\n          })\r\n        }\r\n      },\r\n      eliminarValorPago(){\r\n        let me = this;\r\n        let formData = new FormData()\r\n        formData.append('eliminarRegistroPago',         \"yes\")\r\n        formData.append('doc_codigo',                   me.ObjectSelect.doc_codigo)\r\n        formData.append('id_pedido',                    me.sendPedido.id_pedido)\r\n        formData.append('user_created',                 me.usuario.idusuario)\r\n        me.$vs.loading()\r\n        axios.post(this.$data_url + 'api/guardarDatosPedido', formData)\r\n        .then(function (res) {\r\n          me.$vs.loading.close()\r\n          if(res.data.status == 0){\r\n            me.$vs.notify({\r\n            text:res.data.message,\r\n            color:'warning',\r\n            iconPack: 'feather',\r\n            icon:'icon-check',\r\n            time:5000\r\n            })\r\n            return\r\n          }\r\n          me.$vs.notify({\r\n          text:\"Se elimino correctamente\",\r\n          color:'success',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          me.setHistoricoPagoEliminado()\r\n          // me.$emit('rechargeValores',true)\r\n        })\r\n        .catch(function (error) {\r\n            me.$vs.loading.close()\r\n        })\r\n      },\r\n      setHistoricoPagoEliminado(){\r\n        let me = this\r\n        let formData = new FormData()\r\n        formData.append('eliminarPagoNormal',       \"yes\")\r\n        formData.append('doc_codigo',                me.ObjectSelect.doc_codigo)\r\n        formData.append('id_pedido',                 me.sendPedido.id_pedido)\r\n        formData.append('user_created',              me.usuario.idusuario)\r\n        formData.append('old_values',                JSON.stringify(me.ObjectSelect))\r\n        formData.append('ven_codigo',                me.ObjectSelect.ven_codigo)\r\n        formData.append('periodo_id',                me.ObjectSelect.periodo_id)\r\n        formData.append('institucion_id',            me.ObjectSelect.institucion_id)\r\n        formData.append('id_pedido',                 me.ObjectSelect.id_pedido)\r\n        formData.append('tipo_pago_id',              me.ObjectSelect.tipo_pago_id)\r\n        formData.append('forma_pago_id',             me.ObjectSelect.forma_pago_id)\r\n        formData.append('doc_observacion',           me.ObjectSelect.doc_observacion)\r\n        this.$http.post(this.$server_url+'eliminarPagos', formData)\r\n        .then(function (res) {\r\n          me.$emit('rechargeValores',true)\r\n        })\r\n        .catch(function (error) {})\r\n      },\r\n      eliminarPagoAnticipo(){\r\n        let me = this\r\n        let formData = new FormData()\r\n        formData.append('eliminarPagoAnticipo',      \"yes\")\r\n        formData.append('doc_codigo',                me.ObjectSelect.doc_codigo)\r\n        formData.append('id_pedido',                 me.sendPedido.id_pedido)\r\n        formData.append('user_created',              me.usuario.idusuario)\r\n        me.$vs.loading()\r\n        this.$http.post(this.$server_url+'eliminarPagos', formData)\r\n        .then(function (res) {\r\n          me.$vs.loading.close()\r\n          me.$vs.notify({\r\n          text:\"Se elimino correctamente\",\r\n          color:'success',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          me.$emit('rechargeValores',true)\r\n        })\r\n        .catch(function (error) {})\r\n      },\r\n      eliminarValorPagoDeuda(){\r\n        let me = this\r\n        let formData = new FormData()\r\n        formData.append('eliminarPagoDeuda',         \"yes\")\r\n        formData.append('doc_codigo',                me.ObjectSelect.doc_codigo)\r\n        formData.append('id_pedido',                 me.sendPedido.id_pedido)\r\n        formData.append('doc_valor',                 me.ObjectSelect.doc_valor)\r\n        formData.append('user_created',              me.usuario.idusuario)\r\n        me.$vs.loading()\r\n        this.$http.post(this.$server_url+'eliminarPagos', formData)\r\n        .then(function (res) {\r\n          me.$vs.loading.close()\r\n          me.$vs.notify({\r\n          text:\"Se elimino correctamente\",\r\n          color:'success',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          me.$emit('rechargeValores',true)\r\n        })\r\n        .catch(function (error) {})\r\n      },\r\n      confirmReAbriPago(){\r\n        let me = this\r\n        this.$vs.dialog({\r\n          type:'confirm',\r\n          color: 'danger',\r\n          title: `Confirmar`,\r\n          acceptText:'Si, deseo reabrir el pago',\r\n          cancelText:'Cancelar',\r\n          text: 'Estás seguro de reabrir el pago?',\r\n          accept:this.reAbriPago\r\n        })\r\n      },\r\n      reAbriPago(){\r\n        let me = this\r\n        let formData = new FormData()\r\n        formData.append('reabrirPagos',        \"yes\")\r\n        formData.append('id_pedido',           me.sendPedido.id_pedido)\r\n        formData.append('doc_codigo',          me.ObjectSelect.doc_codigo)\r\n        formData.append('user_created',        me.usuario.idusuario)\r\n        formData.append('tipo_pago_id',        me.ObjectSelect.tipo_pago_id)\r\n        formData.append('forma_pago_id',       me.ObjectSelect.forma_pago_id)\r\n        formData.append('doc_observacion',     me.ObjectSelect.doc_observacion)\r\n        me.$vs.loading()\r\n        this.$http.post(this.$server_url+'pedigo_Pagos', formData)\r\n        .then(function (res) {\r\n          me.$vs.loading.close()\r\n          if(res.data.status == 0){\r\n            me.$vs.notify({\r\n            text:res.data.message,\r\n            color:'warning',\r\n            iconPack: 'feather',\r\n            icon:'icon-check',\r\n            time:5000\r\n            })\r\n            return\r\n          }\r\n          me.$vs.notify({\r\n          text:\"Se reabrio correctamente\",\r\n          color:'success',\r\n          iconPack: 'feather',\r\n          icon:'icon-check'})\r\n          me.$emit('rechargeValores',true)\r\n        })\r\n        .catch(function (error) {})\r\n      }\r\n  }\r\n}\r\n</script>\r\n"]}]}