{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\usuarios\\tipos\\components\\editarUsuario.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\usuarios\\tipos\\components\\editarUsuario.vue","mtime":1712682816666},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport vSelect from 'vue-select'\r\nexport default {\r\n    data() {\r\n        return {\r\n            usuario: [],\r\n            estado: [{\r\n                    id: 1,\r\n                    label: \"Activo\"\r\n                },\r\n                {\r\n                    id: 2,\r\n                    label: \"Bloqueado\"\r\n                },\r\n                {\r\n                    id: 4,\r\n                    label: \"Eliminado\"\r\n                }\r\n            ],\r\n            cargos: [],\r\n            grupo: [],\r\n            configdateTimePicker: {\r\n                enableTime: true,\r\n                dateFormat: 'Y-m-d'\r\n            },\r\n            desabilitar_boton: false,\r\n            userRoot: false,\r\n        }\r\n    },\r\n    components: {\r\n        flatPickr,\r\n        vSelect,\r\n    },\r\n    props: {\r\n        usuarios: {\r\n            type: Object,\r\n            default: {},\r\n        },\r\n        instituciones: {\r\n            type: Array,\r\n            default: [],\r\n        },\r\n    },\r\n    created() {\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n        me.getCargos()\r\n        me.getPerfiles()\r\n    },\r\n    mounted() {\r\n        let me = this\r\n        me.getUserRoot(me.usuario)\r\n    },\r\n    methods: {\r\n        getUserRoot(dato) {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'permisos/' + dato.idusuario)\r\n                .then((result) => {\r\n                    if (result.data.length > 0) {\r\n                        me.userRoot = true;\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err)\r\n                })\r\n        },\r\n        getPerfiles() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'obtenerPerfiles?id_group=' + me.usuario.id_group)\r\n                .then(function (response) {\r\n                    me.grupo = response.data;\r\n                })\r\n                .catch(function (error) {})\r\n        },\r\n        getCargos() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'traerCargos')\r\n                .then(function (response) {\r\n                    me.cargos = response.data;\r\n                })\r\n                .catch(function (error) {})\r\n        },\r\n        async guardar() {\r\n            let me = this\r\n            me.btn = false;\r\n            me.$vs.loading({\r\n                color: '#046AE7'\r\n            })\r\n            let formData = new FormData();\r\n            formData.append('idusuario', this.usuarios.idusuario);\r\n            formData.append('cedula', this.usuarios.cedula);\r\n            formData.append('nombres', this.usuarios.nombres);\r\n            formData.append('apellidos', this.usuarios.apellidos);\r\n            formData.append('email', this.usuarios.email);\r\n            if (me.userRoot) {\r\n              formData.append('name_usuario', this.usuarios.name_usuario);\r\n            } else {\r\n              formData.append('name_usuario', this.usuarios.email);\r\n            }\r\n            formData.append('estado_idEstado', this.usuarios.estado_idEstado);\r\n            formData.append('institucion_idInstitucion', this.usuarios.institucion_idInstitucion);\r\n            formData.append('id_group', this.usuarios.id_group);\r\n            formData.append('capacitador', this.usuarios.capacitador);\r\n            formData.append('cli_ins_codigo',this.usuarios.cli_ins_codigo)\r\n            if (me.usuarios.telefono == \"\" || me.usuarios.telefono == null || me.usuarios.telefono == undefined) {\r\n                formData.append('telefono', \"\");\r\n            } else {\r\n                formData.append('telefono', me.usuarios.telefono);\r\n            }\r\n            if (this.usuarios.iniciales == null || this.usuarios.iniciales == \"null\") {\r\n                formData.append('iniciales', \"\");\r\n            } else {\r\n                formData.append('iniciales', this.usuarios.iniciales);\r\n            }\r\n            if (me.usuarios.cargo_id == \"\" || me.usuarios.cargo_id == null || me.usuarios.cargo_id == undefined) {\r\n                formData.append('cargo_id', \"\");\r\n            } else {\r\n                formData.append('cargo_id', me.usuarios.cargo_id);\r\n            }\r\n            if (me.usuarios.fecha_nacimiento == \"\" || me.usuarios.fecha_nacimiento == null || me.usuarios.fecha_nacimiento == undefined) {\r\n                formData.append('fecha_nacimiento', \"\");\r\n            } else {\r\n                formData.append('fecha_nacimiento', me.usuarios.fecha_nacimiento);\r\n            }\r\n            this.$http.post(this.$server_url + 'usr', formData)\r\n                .then(function (response) {\r\n                  // console.log(response.data)\r\n                    me.$vs.loading.close();\r\n                    me.$vs.notify({\r\n                        text: 'Usuario guardado',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-user'\r\n                    })\r\n                    me.$emit('saveChange', true)\r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        generarPassword() {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            this.$vs.loading({\r\n                background: this.backgroundLoading,\r\n                color: this.colorLoading,\r\n                container: \"#button-with-loading\",\r\n                scale: 0.45\r\n            })\r\n            formData.append('email', this.usuarios.email);\r\n            this.$http.post(this.$server_url + 'restaurarPassword', formData)\r\n                .then(function (response) {\r\n                    me.$vs.notify({\r\n                        text: 'Use el número de cédula para acceder al perfil del usuario.',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-lock'\r\n                    })\r\n                    me.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.notify({\r\n                        text: 'Error en el proceso',\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-lock'\r\n                    })\r\n                    me.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n                })\r\n        },\r\n    }\r\n}\r\n",{"version":3,"sources":["editarUsuario.vue"],"names":[],"mappings":";AAoGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"editarUsuario.vue","sourceRoot":"src/views/usuarios/tipos/components","sourcesContent":["<template>\r\n<div>\r\n    <vs-row vs-justify=\"center\">\r\n        <vs-col type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"5\" style=\"margin:10px;\">\r\n            <vs-card>\r\n                <div class=\"vx-col sm:w-full md:w-1/2\">\r\n                    <vs-avatar class=\"text-center\" size=\"100px\" :src=\"$data_url+'archivos/'+'perfil/'+usuarios.foto_user\" />\r\n                </div>\r\n            </vs-card>\r\n        </vs-col>\r\n        <vs-col type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"5\" style=\"margin:10px;\">\r\n            <vs-card>\r\n                <div class=\"vx-col w-full mt-5\">\r\n                    <vs-button ref=\"loadableButton\" id=\"button-with-loading\" class=\"vs-con-loading__container\" @click=\"generarPassword(usuarios.email)\" type=\"relief\">\r\n                        Resetear contraseña\r\n                    </vs-button>\r\n                </div>\r\n            </vs-card>\r\n        </vs-col>\r\n    </vs-row>\r\n    <div class=\"vx-row mb-4\">\r\n        <div class=\"vx-col w-full sm:w-1/2\">\r\n            <vs-input class=\"w-full\" icon-pack=\"feather\" icon=\"icon-user\" icon-no-border label=\"Nombres\" v-model=\"usuarios.nombres\" />\r\n        </div>\r\n        <div class=\"vx-col w-full sm:w-1/2\">\r\n            <vs-input class=\"w-full\" icon-pack=\"feather\" icon=\"icon-user\" icon-no-border label=\"Apellidos\" v-model=\"usuarios.apellidos\" />\r\n        </div>\r\n    </div>\r\n    <div class=\"vx-row mb-4\">\r\n        <div class=\"vx-col w-full sm:w-1/2\">\r\n            <vs-input class=\"w-full\" icon-pack=\"feather\" icon=\"icon-smartphone\" icon-no-border label=\"Cédula\" v-model=\"usuarios.cedula\" />\r\n        </div>\r\n        <div class=\"vx-col w-full sm:w-1/2\" v-if=\"userRoot\">\r\n            <vs-input class=\"w-full\" icon-pack=\"feather\" icon=\"icon-smartphone\" icon-no-border label=\"Usuario\" v-model=\"usuarios.name_usuario\" />\r\n        </div>\r\n    </div>\r\n    <div class=\"vx-row mb-4\">\r\n        <div class=\"vx-col w-full sm:w-1/2\">\r\n            <vs-input type=\"email\" class=\"w-full\" icon-pack=\"feather\" icon=\"icon-mail\" icon-no-border label=\"Correo\" v-model=\"usuarios.email\" />\r\n        </div>\r\n        <div class=\"vx-col w-full sm:w-1/2\">\r\n            <vs-input class=\"w-full\" type=\"tel\" icon-pack=\"feather\" icon=\"icon-smartphone\" icon-no-border label=\"Teléfono\" v-model=\"usuarios.telefono\" />\r\n        </div>\r\n    </div>\r\n    <vs-row vs-justify=\"center\">\r\n        <vs-col type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"12\">\r\n            <vs-card>\r\n                <div class=\"vx-col w-full mt-5\">\r\n                    Perfil\r\n                    <v-select :options=\"grupo\" :reduce=\"grupo => grupo.id\" label=\"deskripsi\" v-model=\"usuarios.id_group\"></v-select>\r\n                </div>\r\n                <div class=\"vx-col w-full mt-5\" v-if=\"usuarios.id_group  == 1\">\r\n                    <div class=\"vx-col sm:w-2/3 w-full\">\r\n                      Capacitador:\r\n                        <vs-radio class=\"m-2\" color=\"success\" v-model=\"usuarios.capacitador\" vs-name=\"capacitador\" vs-value=\"1\">Si</vs-radio>\r\n                        <vs-radio class=\"m-2\" v-model=\"usuarios.capacitador\" vs-name=\"capacitador\" vs-value=\"0\">No</vs-radio>\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col w-full mt-5\">\r\n                    <v-select :options=\"estado\" :reduce=\"estado => estado.id\" label=\"label\" v-model=\"usuarios.estado_idEstado\"></v-select>\r\n                </div>\r\n                <div class=\"vx-col w-full mt-5\">\r\n                    <v-select :disabled=\"desabilitar_boton\" :options=\"instituciones\" :reduce=\"instituciones => instituciones.id\" label=\"label\" v-model=\"usuarios.institucion_idInstitucion\"></v-select>\r\n                </div>\r\n                <div v-if=\"usuarios.id_group == 11 && userRoot\">\r\n                  <vs-alert color=\"primary\">\r\n                    <p>* El campo de <b>iniciales</b> se usa para realizar pedidos </p>\r\n                    <p>* El campo de <b>cli_ins_codigo</b> es el id de la tabla cliente_institucion de facturación donde se relaciona con la institución llamada prolipa Plataforma y el asesor </p>\r\n                  </vs-alert>\r\n                </div>\r\n                <div class=\"vx-row mb-6\" v-if=\"usuarios.id_group == 11 && userRoot\">\r\n                    <div class=\"vx-col sm:w-1/3 w-full\">\r\n                        <span>Iniciales</span>\r\n                    </div>\r\n                    <div class=\"vx-col sm:w-2/3 w-full\">\r\n                        <vs-input class=\"w-full\" type=\"tel\" icon-pack=\"feather\" icon=\"icon-check\" icon-no-border label=\"Iniciales\" v-model=\"usuarios.iniciales\" />\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-row mb-6\" v-if=\"usuarios.id_group == 11 && userRoot\">\r\n                  <div class=\"vx-col sm:w-1/3 w-full\">\r\n                      <span>Cliente ins_codigo</span>\r\n                  </div>\r\n                  <div class=\"vx-col sm:w-2/3 w-full\">\r\n                      <vs-input class=\"w-full\" type=\"tel\" icon-pack=\"feather\" icon=\"icon-check\" icon-no-border label=\"Cliente Facturación id\" v-model=\"usuarios.cli_ins_codigo\" />\r\n                  </div>\r\n                </div>\r\n            </vs-card>\r\n        </vs-col>\r\n        <vs-col type=\"flex\" vs-justify=\"center\" vs-align=\"center\" vs-w=\"10\" style=\"margin:10px;\">\r\n            <vs-card>\r\n                <div class=\"vx-col w-full mt-5\">\r\n                    <vs-button color=\"success\" @click=\"guardar\" style=\"width:100%;\" type=\"filled\">Guardar</vs-button>\r\n                </div>\r\n            </vs-card>\r\n        </vs-col>\r\n    </vs-row>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport flatPickr from 'vue-flatpickr-component';\r\nimport 'flatpickr/dist/flatpickr.css';\r\nimport vSelect from 'vue-select'\r\nexport default {\r\n    data() {\r\n        return {\r\n            usuario: [],\r\n            estado: [{\r\n                    id: 1,\r\n                    label: \"Activo\"\r\n                },\r\n                {\r\n                    id: 2,\r\n                    label: \"Bloqueado\"\r\n                },\r\n                {\r\n                    id: 4,\r\n                    label: \"Eliminado\"\r\n                }\r\n            ],\r\n            cargos: [],\r\n            grupo: [],\r\n            configdateTimePicker: {\r\n                enableTime: true,\r\n                dateFormat: 'Y-m-d'\r\n            },\r\n            desabilitar_boton: false,\r\n            userRoot: false,\r\n        }\r\n    },\r\n    components: {\r\n        flatPickr,\r\n        vSelect,\r\n    },\r\n    props: {\r\n        usuarios: {\r\n            type: Object,\r\n            default: {},\r\n        },\r\n        instituciones: {\r\n            type: Array,\r\n            default: [],\r\n        },\r\n    },\r\n    created() {\r\n        let me = this;\r\n        me.usuario = JSON.parse(localStorage.getItem(\"usuario\"))\r\n        me.getCargos()\r\n        me.getPerfiles()\r\n    },\r\n    mounted() {\r\n        let me = this\r\n        me.getUserRoot(me.usuario)\r\n    },\r\n    methods: {\r\n        getUserRoot(dato) {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'permisos/' + dato.idusuario)\r\n                .then((result) => {\r\n                    if (result.data.length > 0) {\r\n                        me.userRoot = true;\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err)\r\n                })\r\n        },\r\n        getPerfiles() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'obtenerPerfiles?id_group=' + me.usuario.id_group)\r\n                .then(function (response) {\r\n                    me.grupo = response.data;\r\n                })\r\n                .catch(function (error) {})\r\n        },\r\n        getCargos() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'traerCargos')\r\n                .then(function (response) {\r\n                    me.cargos = response.data;\r\n                })\r\n                .catch(function (error) {})\r\n        },\r\n        async guardar() {\r\n            let me = this\r\n            me.btn = false;\r\n            me.$vs.loading({\r\n                color: '#046AE7'\r\n            })\r\n            let formData = new FormData();\r\n            formData.append('idusuario', this.usuarios.idusuario);\r\n            formData.append('cedula', this.usuarios.cedula);\r\n            formData.append('nombres', this.usuarios.nombres);\r\n            formData.append('apellidos', this.usuarios.apellidos);\r\n            formData.append('email', this.usuarios.email);\r\n            if (me.userRoot) {\r\n              formData.append('name_usuario', this.usuarios.name_usuario);\r\n            } else {\r\n              formData.append('name_usuario', this.usuarios.email);\r\n            }\r\n            formData.append('estado_idEstado', this.usuarios.estado_idEstado);\r\n            formData.append('institucion_idInstitucion', this.usuarios.institucion_idInstitucion);\r\n            formData.append('id_group', this.usuarios.id_group);\r\n            formData.append('capacitador', this.usuarios.capacitador);\r\n            formData.append('cli_ins_codigo',this.usuarios.cli_ins_codigo)\r\n            if (me.usuarios.telefono == \"\" || me.usuarios.telefono == null || me.usuarios.telefono == undefined) {\r\n                formData.append('telefono', \"\");\r\n            } else {\r\n                formData.append('telefono', me.usuarios.telefono);\r\n            }\r\n            if (this.usuarios.iniciales == null || this.usuarios.iniciales == \"null\") {\r\n                formData.append('iniciales', \"\");\r\n            } else {\r\n                formData.append('iniciales', this.usuarios.iniciales);\r\n            }\r\n            if (me.usuarios.cargo_id == \"\" || me.usuarios.cargo_id == null || me.usuarios.cargo_id == undefined) {\r\n                formData.append('cargo_id', \"\");\r\n            } else {\r\n                formData.append('cargo_id', me.usuarios.cargo_id);\r\n            }\r\n            if (me.usuarios.fecha_nacimiento == \"\" || me.usuarios.fecha_nacimiento == null || me.usuarios.fecha_nacimiento == undefined) {\r\n                formData.append('fecha_nacimiento', \"\");\r\n            } else {\r\n                formData.append('fecha_nacimiento', me.usuarios.fecha_nacimiento);\r\n            }\r\n            this.$http.post(this.$server_url + 'usr', formData)\r\n                .then(function (response) {\r\n                  // console.log(response.data)\r\n                    me.$vs.loading.close();\r\n                    me.$vs.notify({\r\n                        text: 'Usuario guardado',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-user'\r\n                    })\r\n                    me.$emit('saveChange', true)\r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n        generarPassword() {\r\n            let me = this;\r\n            let formData = new FormData();\r\n            this.$vs.loading({\r\n                background: this.backgroundLoading,\r\n                color: this.colorLoading,\r\n                container: \"#button-with-loading\",\r\n                scale: 0.45\r\n            })\r\n            formData.append('email', this.usuarios.email);\r\n            this.$http.post(this.$server_url + 'restaurarPassword', formData)\r\n                .then(function (response) {\r\n                    me.$vs.notify({\r\n                        text: 'Use el número de cédula para acceder al perfil del usuario.',\r\n                        color: 'success',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-lock'\r\n                    })\r\n                    me.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n                })\r\n                .catch(function (error) {\r\n                    me.$vs.notify({\r\n                        text: 'Error en el proceso',\r\n                        color: 'danger',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-lock'\r\n                    })\r\n                    me.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n                })\r\n        },\r\n    }\r\n}\r\n</script>\r\n"]}]}