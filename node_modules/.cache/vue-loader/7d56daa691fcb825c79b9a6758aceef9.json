{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\redactores\\redactor\\control_cumplimientos.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\redactores\\redactor\\control_cumplimientos.vue","mtime":1712682816490},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport vSelect from 'vue-select'\r\nimport flatPickr from 'vue-flatpickr-component'\r\nimport 'flatpickr/dist/flatpickr.css'\r\nimport moment from 'moment'\r\nimport gestionCumplimiento from '../admin/control_cumplimientos.vue'\r\n\r\nexport default {\r\n    components:{\r\n      vSelect,\r\n      flatPickr,\r\n      gestionCumplimiento\r\n    },\r\n    data: () => ({\r\n      usuario: [],\r\n      actividad_selected: [],\r\n      actividades: [],\r\n      area_selected: [],\r\n      serie_selected: [],\r\n      libro_selected: [],\r\n      periodo_selected: [],\r\n      serie_filtro: [],\r\n      areas: [],\r\n      format: \"yyyy-MM-dd\",\r\n      fecha_registro: '',\r\n      observacion: '',\r\n      areas_activa: false,\r\n      libro_activo: false,\r\n      unidad_activo: false,\r\n      periodo_activo: false,\r\n      cantidad: 0,\r\n      configdateTimePicker: {\r\n          enableTime: false,\r\n          dateFormat: 'Y-m-d'\r\n      },\r\n      fecha_inicio: '',\r\n      fecha_fin: '',\r\n      estadisticas: [],\r\n      estadisticas_edicion: [],\r\n      series: [],\r\n      libros: [],\r\n      periodos: [],\r\n      unidad_selected: '',\r\n      popupActividades: false,\r\n      actividad_filtro: [],\r\n      serie_filtro: [],\r\n      libro_filtro: [],\r\n      unidad_filtro: '',\r\n    }),\r\n    mounted() {\r\n        let date = new Date()\r\n        this.fecha_inicio = moment(date, 'DD/MM/YYYY HH:mm:ss').format('YYYY-MM-DD')\r\n        this.fecha_fin = moment(date, 'DD/MM/YYYY HH:mm:ss').add(7, 'days').format('YYYY-MM-DD')\r\n\r\n        this.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n        // this.get_cumplimiento_redactor_normal()\r\n        // this.get_cumplimiento_redactor_edicion()\r\n        this.get_actividades()\r\n        this.get_series_cumplimiento()\r\n        this.get_periodos_cumplimiento()\r\n    },\r\n    methods: {\r\n      get_actividades(){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_actividades_cumplimiento')\r\n        .then(res => {\r\n            me.actividades = res.data\r\n        })\r\n      },\r\n      get_areas(){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_areas_cumplimiento/' + me.actividad_selected.id_actividades)\r\n        .then(res => { me.areas = res.data })\r\n      },\r\n      get_series_cumplimiento(){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_series_cumplimiento')\r\n        .then(res => { me.series = res.data })\r\n      },\r\n      get_libros_cumplimiento(id_serie){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_libros_cumplimiento/' + id_serie)\r\n        .then(res => { me.libros = res.data })\r\n      },\r\n      get_periodos_cumplimiento(){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_periodos_cumplimiento')\r\n        .then(res => { me.periodos = res.data })\r\n      },\r\n      guardar_cumplimiento(){\r\n        let me = this\r\n        \r\n        let area = 0\r\n        if( me.actividad_selected ){\r\n          if( me.fecha_registro == '' || me.cantidad == ''){\r\n            me.$vs.notify({ text: 'Complete los campos obligatorios', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n            return\r\n          }\r\n          if( me.actividad_selected.categoria != 'edicion' ){\r\n            if( !me.actividad_selected ){\r\n              me.$vs.notify({ text: 'Seleccione una área', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n              return\r\n            }else{\r\n              area = me.area_selected.idarea\r\n            }\r\n          }\r\n          if( me.serie_selected.id_serie === undefined ){\r\n            me.$vs.notify({ text: 'Seleccione una serie', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n              return\r\n          }\r\n        }else{\r\n          me.$vs.notify({ text: 'Seleccione una actividad', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n          return\r\n        }\r\n\r\n        let observacion = me.observacion == '' ? 'Sin comentarios' : me.observacion\r\n        \r\n        let id_libro = me.libro_selected.idLibro\r\n        if( me.libro_selected.idLibro === undefined ){\r\n          id_libro = 0\r\n        }\r\n        let id_periodo = me.periodo_selected.idperiodoescolar\r\n        if( me.periodo_selected.idperiodoescolar === undefined ){\r\n          id_periodo = 0\r\n        }\r\n        let unidad = me.unidad_selected\r\n        if( me.unidad_selected == '' ){\r\n          unidad = 0\r\n        }\r\n\r\n        let formData = new FormData();\r\n        formData.append('id_actividad', me.actividad_selected.id_actividades)\r\n        formData.append('id_area',      area)\r\n        formData.append('id_serie',     me.serie_selected.id_serie)\r\n        formData.append('id_libro',     id_libro)\r\n        formData.append('unidad',       unidad)\r\n        formData.append('id_periodo',   id_periodo)\r\n        formData.append('fecha',        me.fecha_registro)\r\n        formData.append('cantidad',     me.cantidad)\r\n        formData.append('observacion',  observacion)\r\n        formData.append('id_usuario',   me.usuario.idusuario)\r\n\r\n        me.$vs.loading();\r\n\r\n        this.$http.post(this.$server_url + 'cumplimientos', formData)\r\n        .then(res => {\r\n            me.popupActividades = false\r\n            // me.get_cumplimiento_redactor_normal()\r\n            // me.get_cumplimiento_redactor_edicion()\r\n            me.actividad_selected = ''; me.area_selected = ''; me.fecha_registro = ''; me.cantidad = ''; me.observacion = '';\r\n            me.$vs.loading.close();\r\n            me.$vs.notify({ text: 'Guardado exitosamente', color: 'success', iconPack: 'feather', icon: 'icon-check' })\r\n        })\r\n        .catch(err => { \r\n          me.$vs.notify({ text: 'Complete los campos obligatorios', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n          me.$vs.loading.close()\r\n        })\r\n\r\n      },\r\n      get_cumplimiento_redactor_normal(){\r\n        let me = this\r\n        if( me.serie_filtro.id_serie === undefined ){\r\n          me.$vs.notify({ text: 'Seleccione una serie', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n          return\r\n        }\r\n        \r\n        let id_libro = me.libro_filtro == null || me.libro_filtro == '' ? 0 : me.libro_filtro.idLibro\r\n        let unidad = me.unidad_filtro === null || me.unidad_filtro == '' ? 0 : me.unidad_filtro\r\n        \r\n        me.$vs.loading();\r\n        this.$http.get(this.$server_url+'get_cumplimiento_redactor_normal/'+me.fecha_inicio +'/'+ me.fecha_fin +'/'+ me.usuario.idusuario+'/'+me.serie_filtro.id_serie+'/'+me.actividad_filtro.id_actividades+'/'+id_libro+'/'+unidad)\r\n        .then(res => {\r\n            me.estadisticas = res.data\r\n            me.$vs.loading.close();\r\n        })\r\n      },\r\n      get_cumplimiento_redactor_edicion(){\r\n        let me = this\r\n\r\n        if( me.serie_filtro.id_serie === undefined ){\r\n          me.$vs.notify({ text: 'Seleccione una serie', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n          return\r\n        }\r\n\r\n        let id_libro = me.libro_filtro == null || me.libro_filtro == '' ? 0 : me.libro_filtro.idLibro\r\n        let unidad = me.unidad_filtro === null || me.unidad_filtro == '' ? 0 : me.unidad_filtro\r\n        \r\n        me.$vs.loading();\r\n        this.$http.get(this.$server_url+'get_cumplimiento_redactor_edicion/'+me.fecha_inicio +'/'+ me.fecha_fin +'/'+ me.usuario.idusuario+'/'+me.serie_filtro.id_serie+'/'+me.actividad_filtro.id_actividades+'/'+id_libro+'/'+unidad)\r\n        .then(res => {\r\n            me.estadisticas_edicion = res.data\r\n            me.$vs.loading.close();\r\n        })\r\n      },\r\n\r\n    },\r\n}\r\n",{"version":3,"sources":["control_cumplimientos.vue"],"names":[],"mappings":";AAuJA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"control_cumplimientos.vue","sourceRoot":"src/views/redactores/redactor","sourcesContent":["<template>\r\n<div>\r\n\r\n<vs-popup title=\"Registro de actividades\" :active.sync=\"popupActividades\">\r\n  <div class=\"p-3 vx-row\">\r\n    <div class=\"vx-col sm:w-1/2 w-full sm:mb-2\">\r\n      Actividades\r\n      <v-select :options=\"actividades\" :reduce=\"actividades => actividades\" label=\"nombre\" v-model=\"actividad_selected\" \r\n      @input=\"\r\n      areas_activa = actividad_selected.area_activa == 1 ? false : true; \r\n      libro_activo = actividad_selected.libro_activo == 1 ? false : true; \r\n      unidad_activo = actividad_selected.unidad_activo == 1 ? false : true; \r\n      periodo_activo = actividad_selected.periodo_activo == 1 ? false : true; \r\n      get_areas()\"/>\r\n    </div>\r\n    <div class=\"vx-col sm:w-1/2 w-full sm:mb-2\">\r\n      Serie\r\n      <v-select :options=\"series\" :reduce=\"series => series\" label=\"nombre_serie\" v-model=\"serie_selected\" @input=\"get_libros_cumplimiento(serie_selected.id_serie)\" />\r\n    </div>\r\n    <div class=\"vx-col sm:w-1/2 w-full sm:mb-2\">\r\n      Áreas\r\n      <v-select :options=\"areas\" :reduce=\"areas => areas\" label=\"nombrearea\" v-model=\"area_selected\" :disabled=\"areas_activa\" />\r\n    </div>\r\n    <div class=\"vx-col sm:w-1/2 w-full sm:mb-2\">\r\n      Libro\r\n      <v-select :options=\"libros\" :reduce=\"libros => libros\" label=\"nombrelibro\" v-model=\"libro_selected\" :disabled=\"libro_activo\" />\r\n    </div>\r\n    <div class=\"vx-col sm:w-1/2 w-full sm:mb-2\">\r\n      Unidad\r\n      <v-select :options=\"[1,2,3,4,5,6,7,8,9,10]\" v-model=\"unidad_selected\" :disabled=\"unidad_activo\" class=\"w-full\" :dir=\"$vs.rtl ? 'rtl' : 'ltr'\" />\r\n    </div>\r\n    <div class=\"vx-col sm:w-1/2 w-full sm:mb-2\">\r\n      Periodo\r\n      <v-select :options=\"periodos\" :reduce=\"periodos => periodos\" label=\"descripcion\" v-model=\"periodo_selected\" :disabled=\"periodo_activo\" />\r\n    </div>\r\n    <div class=\"vx-col sm:w-1/2 w-full sm:mb-2\">\r\n      Fecha\r\n      <flat-pickr class=\"w-full\" :config=\"configdateTimePicker\" v-model=\"fecha_registro\" />\r\n    </div>\r\n    <div class=\"vx-col sm:w-1/2 w-full sm:mb-2\">\r\n      Cantidad\r\n      <vs-input v-model=\"cantidad\" type=\"number\" class=\"w-full\" />\r\n    </div>\r\n    <div class=\"vx-col w-full sm:mb-2\">\r\n      Detalle actividades realizadas\r\n      <vs-textarea type=\"text\" class=\"w-full\" v-model=\"observacion\"></vs-textarea>\r\n    </div>\r\n    <div class=\"vx-col w-full pt-3\" align=\"center\">\r\n      <vs-button class=\"w-full\" type=\"gradient\" @click=\"guardar_cumplimiento\">Guardar</vs-button>\r\n    </div>\r\n  </div>\r\n</vs-popup>\r\n\r\n<vs-tabs alignment=\"fixed\">\r\n\r\n  <vs-tab label=\"Control\" v-if=\"usuario.idusuario != 64960\" class=\"pt-6\">\r\n\r\n    <vx-card style=\"min-height: 600px;\">\r\n      <div class=\"w-full text-center flex flex-wrap gap-8 items-center justify-center text-lg mb-5\">\r\n        <vs-button @click=\" actividad_selected=[]; serie_selected=[]; area_selected=[]; libro_selected=[]; periodo_selected=[]; unidad_selected=''; fecha_registro=''; cantidad=0; observacion=''; popupActividades=true\" class=\"py-2 px-3\" color=\"dark\" type=\"gradient\">Registrar actividades</vs-button>\r\n        <p class=\"text-left\">Estadísticas de cumplimiento del</p>\r\n        <flat-pickr :config=\"configdateTimePicker\" v-model=\"fecha_inicio\" />\r\n        <p>al</p>\r\n        <flat-pickr :config=\"configdateTimePicker\" v-model=\"fecha_fin\" />\r\n      </div>\r\n\r\n\r\n      <div class=\"w-full vx-row\">\r\n        <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n          Actividad\r\n          <v-select class=\"flex-1\" :options=\"actividades\" :reduce=\"actividades => actividades\" label=\"nombre\" v-model=\"actividad_filtro\" @input=\"\r\n          serie_filtro=[]; libro_filtro=[]; unidad_filtro=''; \r\n          libro_activo = actividad_filtro.libro_activo == 1 ? false : true; \r\n          unidad_activo = actividad_filtro.unidad_activo == 1 ? false : true;\" />\r\n        </div>\r\n        <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n          Serie\r\n          <v-select class=\"flex-1\" :options=\"series\" :reduce=\"series => series\" label=\"nombre_serie\" v-model=\"serie_filtro\" @input=\"get_libros_cumplimiento(serie_filtro.id_serie)\" />\r\n        </div>\r\n        <div class=\"vx-col sm:w-1/2 w-full mb-2\">\r\n          Libro\r\n          <v-select class=\"flex-1\" :options=\"libros\" :reduce=\"libros => libros\" label=\"nombrelibro\" v-model=\"libro_filtro\" :disabled=\"libro_activo\"/>\r\n        </div>\r\n        <div class=\"vx-col sm:w-1/4 w-full mb-2\">\r\n          Unidad\r\n          <v-select class=\"flex-1\" :options=\"[1,2,3,4,5,6,7,8,9,10]\" v-model=\"unidad_filtro\" :dir=\"$vs.rtl ? 'rtl' : 'ltr'\" :disabled=\"unidad_activo\"/>\r\n        </div>\r\n        <div class=\"vx-col sm:w-1/4 w-full mb-2 flex flex-wrap gap-4 items-end justify-center\">\r\n          <vx-tooltip text=\"Buscar con los filtros seleccionados\" position=\"top\">\r\n            <vs-button radius icon=\"icon-search\" icon-pack=\"feather\" @click=\"get_cumplimiento_redactor_normal(); get_cumplimiento_redactor_edicion();\"/>\r\n          </vx-tooltip>\r\n          <vx-tooltip text=\"Borrar filtros\" position=\"top\">\r\n            <vs-button radius icon=\"icon-trash\" icon-pack=\"feather\" type=\"border\" @click=\"actividad_filtro=''; serie_filtro=''; libro_filtro=''; unidad_filtro='';\"/>\r\n          </vx-tooltip>\r\n        </div>\r\n      </div>\r\n\r\n\r\n      <div :key=\"index\" v-for=\"(item, index) in estadisticas\">\r\n        <vs-divider class=\"mb-0\" color=\"#7443FF\" position=\"left\">{{item.actividad}}</vs-divider>\r\n        <div :key=\"index_ar\" v-for=\"(item_ar, index_ar) in item.areas\" class=\"px-5 flex flex-wrap gap-8 items-center justify-center\">\r\n          <vs-divider class=\"mb-0\" border-style=\"dashed\" position=\"center\">{{item_ar.nombre_area}}</vs-divider>\r\n\r\n          <div :key=\"index_av\" v-for=\"(item_av, index_av) in item_ar.avances\" class=\"flex-1 mb-4\">\r\n              <vx-tooltip :text=\"item_av.observacion_redactor\" color=\"dark\" position=\"bottom\">\r\n                <p> {{item_av.fecha}} - {{item_av.cant_avance}} / {{item_av.cant_diaria}}</p>\r\n                <span v-if=\"item_av.nombrelibro\">{{item_av.nombrelibro}}</span> <span v-if=\"item_av.periodoescolar\"> - {{item_av.periodoescolar}}</span>\r\n                <p v-if=\"item_av.unidad\"> Unidad {{item_av.unidad}}</p>\r\n                <vs-progress v-if=\"((item_av.cant_avance*100)/item_av.cant_diaria) >= 75\" height=\"7\" :percent=\"(item_av.cant_avance*100)/item_av.cant_diaria\" color=\"success\"></vs-progress>\r\n                <vs-progress v-if=\"((item_av.cant_avance*100)/item_av.cant_diaria) >= 50 && ((item_av.cant_avance*100)/item_av.cant_diaria) < 75\" height=\"7\" :percent=\"(item_av.cant_avance*100)/item_av.cant_diaria\" color=\"primary\"></vs-progress>\r\n                <vs-progress v-if=\"((item_av.cant_avance*100)/item_av.cant_diaria) >= 25 && ((item_av.cant_avance*100)/item_av.cant_diaria) < 50\" height=\"7\" :percent=\"(item_av.cant_avance*100)/item_av.cant_diaria\" color=\"warning\"></vs-progress>\r\n                <vs-progress v-if=\"((item_av.cant_avance*100)/item_av.cant_diaria) < 25\" height=\"7\" :percent=\"(item_av.cant_avance*100)/item_av.cant_diaria\" color=\"danger\"></vs-progress>\r\n              </vx-tooltip>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <div :key=\"index\" v-for=\"(item, index) in estadisticas_edicion\">\r\n          <vs-divider color=\"#7443FF\" position=\"left\">{{item.actividad}}</vs-divider>\r\n            <div class=\"px-5 flex flex-wrap gap-8 items-center justify-center mb-base\">\r\n              <div :key=\"index_av\" v-for=\"(item_av, index_av) in item.avances\" class=\"flex-1\">\r\n                <vx-tooltip :text=\"item_av.observacion_redactor\" color=\"dark\" position=\"bottom\">\r\n                <p> {{item_av.fecha}} - {{item_av.cant_avance}} / {{item_av.cant_diaria}}</p>\r\n                <span v-if=\"item_av.nombrelibro\">{{item_av.nombrelibro}}</span> <span v-if=\"item_av.periodoescolar\"> - {{item_av.periodoescolar}}</span>\r\n                <p v-if=\"item_av.unidad\"> Unidad {{item_av.unidad}}</p>\r\n                <vs-progress v-if=\"((item_av.cant_avance*100)/item_av.cant_diaria) >= 75\" height=\"7\" :percent=\"(item_av.cant_avance*100)/item_av.cant_diaria\" color=\"success\"></vs-progress>\r\n                <vs-progress v-if=\"((item_av.cant_avance*100)/item_av.cant_diaria) >= 50 && ((item_av.cant_avance*100)/item_av.cant_diaria) < 75\" height=\"7\" :percent=\"(item_av.cant_avance*100)/item_av.cant_diaria\" color=\"primary\"></vs-progress>\r\n                <vs-progress v-if=\"((item_av.cant_avance*100)/item_av.cant_diaria) >= 25 && ((item_av.cant_avance*100)/item_av.cant_diaria) < 50\" height=\"7\" :percent=\"(item_av.cant_avance*100)/item_av.cant_diaria\" color=\"warning\"></vs-progress>\r\n                <vs-progress v-if=\"((item_av.cant_avance*100)/item_av.cant_diaria) < 25\" height=\"7\" :percent=\"(item_av.cant_avance*100)/item_av.cant_diaria\" color=\"danger\"></vs-progress>\r\n                </vx-tooltip>\r\n              </div>\r\n            </div>\r\n        </div>\r\n      </div>\r\n    </vx-card>\r\n  </vs-tab>\r\n\r\n\r\n  <vs-tab label=\"Reporte\" v-if=\"usuario.idusuario == 14818 || usuario.idusuario == 3762 || usuario.idusuario == 64960\" class=\"pt-6\">\r\n      <gestion-cumplimiento></gestion-cumplimiento>\r\n  </vs-tab>\r\n\r\n</vs-tabs>\r\n\r\n\r\n\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport vSelect from 'vue-select'\r\nimport flatPickr from 'vue-flatpickr-component'\r\nimport 'flatpickr/dist/flatpickr.css'\r\nimport moment from 'moment'\r\nimport gestionCumplimiento from '../admin/control_cumplimientos.vue'\r\n\r\nexport default {\r\n    components:{\r\n      vSelect,\r\n      flatPickr,\r\n      gestionCumplimiento\r\n    },\r\n    data: () => ({\r\n      usuario: [],\r\n      actividad_selected: [],\r\n      actividades: [],\r\n      area_selected: [],\r\n      serie_selected: [],\r\n      libro_selected: [],\r\n      periodo_selected: [],\r\n      serie_filtro: [],\r\n      areas: [],\r\n      format: \"yyyy-MM-dd\",\r\n      fecha_registro: '',\r\n      observacion: '',\r\n      areas_activa: false,\r\n      libro_activo: false,\r\n      unidad_activo: false,\r\n      periodo_activo: false,\r\n      cantidad: 0,\r\n      configdateTimePicker: {\r\n          enableTime: false,\r\n          dateFormat: 'Y-m-d'\r\n      },\r\n      fecha_inicio: '',\r\n      fecha_fin: '',\r\n      estadisticas: [],\r\n      estadisticas_edicion: [],\r\n      series: [],\r\n      libros: [],\r\n      periodos: [],\r\n      unidad_selected: '',\r\n      popupActividades: false,\r\n      actividad_filtro: [],\r\n      serie_filtro: [],\r\n      libro_filtro: [],\r\n      unidad_filtro: '',\r\n    }),\r\n    mounted() {\r\n        let date = new Date()\r\n        this.fecha_inicio = moment(date, 'DD/MM/YYYY HH:mm:ss').format('YYYY-MM-DD')\r\n        this.fecha_fin = moment(date, 'DD/MM/YYYY HH:mm:ss').add(7, 'days').format('YYYY-MM-DD')\r\n\r\n        this.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n        // this.get_cumplimiento_redactor_normal()\r\n        // this.get_cumplimiento_redactor_edicion()\r\n        this.get_actividades()\r\n        this.get_series_cumplimiento()\r\n        this.get_periodos_cumplimiento()\r\n    },\r\n    methods: {\r\n      get_actividades(){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_actividades_cumplimiento')\r\n        .then(res => {\r\n            me.actividades = res.data\r\n        })\r\n      },\r\n      get_areas(){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_areas_cumplimiento/' + me.actividad_selected.id_actividades)\r\n        .then(res => { me.areas = res.data })\r\n      },\r\n      get_series_cumplimiento(){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_series_cumplimiento')\r\n        .then(res => { me.series = res.data })\r\n      },\r\n      get_libros_cumplimiento(id_serie){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_libros_cumplimiento/' + id_serie)\r\n        .then(res => { me.libros = res.data })\r\n      },\r\n      get_periodos_cumplimiento(){\r\n        let me = this\r\n        this.$http.get(this.$server_url+'get_periodos_cumplimiento')\r\n        .then(res => { me.periodos = res.data })\r\n      },\r\n      guardar_cumplimiento(){\r\n        let me = this\r\n        \r\n        let area = 0\r\n        if( me.actividad_selected ){\r\n          if( me.fecha_registro == '' || me.cantidad == ''){\r\n            me.$vs.notify({ text: 'Complete los campos obligatorios', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n            return\r\n          }\r\n          if( me.actividad_selected.categoria != 'edicion' ){\r\n            if( !me.actividad_selected ){\r\n              me.$vs.notify({ text: 'Seleccione una área', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n              return\r\n            }else{\r\n              area = me.area_selected.idarea\r\n            }\r\n          }\r\n          if( me.serie_selected.id_serie === undefined ){\r\n            me.$vs.notify({ text: 'Seleccione una serie', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n              return\r\n          }\r\n        }else{\r\n          me.$vs.notify({ text: 'Seleccione una actividad', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n          return\r\n        }\r\n\r\n        let observacion = me.observacion == '' ? 'Sin comentarios' : me.observacion\r\n        \r\n        let id_libro = me.libro_selected.idLibro\r\n        if( me.libro_selected.idLibro === undefined ){\r\n          id_libro = 0\r\n        }\r\n        let id_periodo = me.periodo_selected.idperiodoescolar\r\n        if( me.periodo_selected.idperiodoescolar === undefined ){\r\n          id_periodo = 0\r\n        }\r\n        let unidad = me.unidad_selected\r\n        if( me.unidad_selected == '' ){\r\n          unidad = 0\r\n        }\r\n\r\n        let formData = new FormData();\r\n        formData.append('id_actividad', me.actividad_selected.id_actividades)\r\n        formData.append('id_area',      area)\r\n        formData.append('id_serie',     me.serie_selected.id_serie)\r\n        formData.append('id_libro',     id_libro)\r\n        formData.append('unidad',       unidad)\r\n        formData.append('id_periodo',   id_periodo)\r\n        formData.append('fecha',        me.fecha_registro)\r\n        formData.append('cantidad',     me.cantidad)\r\n        formData.append('observacion',  observacion)\r\n        formData.append('id_usuario',   me.usuario.idusuario)\r\n\r\n        me.$vs.loading();\r\n\r\n        this.$http.post(this.$server_url + 'cumplimientos', formData)\r\n        .then(res => {\r\n            me.popupActividades = false\r\n            // me.get_cumplimiento_redactor_normal()\r\n            // me.get_cumplimiento_redactor_edicion()\r\n            me.actividad_selected = ''; me.area_selected = ''; me.fecha_registro = ''; me.cantidad = ''; me.observacion = '';\r\n            me.$vs.loading.close();\r\n            me.$vs.notify({ text: 'Guardado exitosamente', color: 'success', iconPack: 'feather', icon: 'icon-check' })\r\n        })\r\n        .catch(err => { \r\n          me.$vs.notify({ text: 'Complete los campos obligatorios', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n          me.$vs.loading.close()\r\n        })\r\n\r\n      },\r\n      get_cumplimiento_redactor_normal(){\r\n        let me = this\r\n        if( me.serie_filtro.id_serie === undefined ){\r\n          me.$vs.notify({ text: 'Seleccione una serie', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n          return\r\n        }\r\n        \r\n        let id_libro = me.libro_filtro == null || me.libro_filtro == '' ? 0 : me.libro_filtro.idLibro\r\n        let unidad = me.unidad_filtro === null || me.unidad_filtro == '' ? 0 : me.unidad_filtro\r\n        \r\n        me.$vs.loading();\r\n        this.$http.get(this.$server_url+'get_cumplimiento_redactor_normal/'+me.fecha_inicio +'/'+ me.fecha_fin +'/'+ me.usuario.idusuario+'/'+me.serie_filtro.id_serie+'/'+me.actividad_filtro.id_actividades+'/'+id_libro+'/'+unidad)\r\n        .then(res => {\r\n            me.estadisticas = res.data\r\n            me.$vs.loading.close();\r\n        })\r\n      },\r\n      get_cumplimiento_redactor_edicion(){\r\n        let me = this\r\n\r\n        if( me.serie_filtro.id_serie === undefined ){\r\n          me.$vs.notify({ text: 'Seleccione una serie', color: 'warning', iconPack: 'feather', icon: 'icon-alert-triangle' })\r\n          return\r\n        }\r\n\r\n        let id_libro = me.libro_filtro == null || me.libro_filtro == '' ? 0 : me.libro_filtro.idLibro\r\n        let unidad = me.unidad_filtro === null || me.unidad_filtro == '' ? 0 : me.unidad_filtro\r\n        \r\n        me.$vs.loading();\r\n        this.$http.get(this.$server_url+'get_cumplimiento_redactor_edicion/'+me.fecha_inicio +'/'+ me.fecha_fin +'/'+ me.usuario.idusuario+'/'+me.serie_filtro.id_serie+'/'+me.actividad_filtro.id_actividades+'/'+id_libro+'/'+unidad)\r\n        .then(res => {\r\n            me.estadisticas_edicion = res.data\r\n            me.$vs.loading.close();\r\n        })\r\n      },\r\n\r\n    },\r\n}\r\n</script>"]}]}