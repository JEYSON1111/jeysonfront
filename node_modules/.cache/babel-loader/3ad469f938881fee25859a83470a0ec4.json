{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\institucion\\institucionesXCiudad.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\institucion\\institucionesXCiudad.vue","mtime":1712682816032},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\babel.config.js","mtime":1712682813877},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\.babelrc","mtime":1712682813750},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import vSelect from 'vue-select';\nimport AddInstitucion from \"./addInstitucion.vue\";\nimport RevisionVentaVue from \"../codigos/components/utils/RevisionVenta.vue\";\nexport default {\n  components: {\n    \"v-select\": vSelect,\n    AddInstitucion: AddInstitucion,\n    RevisionVentaVue: RevisionVentaVue\n  },\n  data: function data() {\n    return {\n      arregloCiudad: [],\n      ciudadSelect: {},\n      instituciones: [],\n      permisoRoot: false,\n      usuario: [],\n      popupTipoVenta: false,\n      informacion: [],\n      tmpinformacion: [],\n      nombreInstitucion: '',\n      institucion_id: '',\n      titulo: '',\n      modalEditarInstitucion: false,\n      modalOk: false,\n      institucionSend: 0,\n      pedido: {}\n    };\n  },\n  mounted: function mounted() {\n    var me = this;\n    me.usuario = JSON.parse(localStorage.getItem('usuario'));\n    me.getUserRoot();\n  },\n  methods: {\n    listaCiudades: function listaCiudades() {\n      var me = this;\n      this.$http.get(this.$server_url + 'ciudad').then(function (res) {\n        me.arregloCiudad = res.data;\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    getUserRoot: function getUserRoot() {\n      var me = this;\n      this.$http.get(this.$server_url + 'permisos?permiso=yes&usuario_id=' + me.usuario.idusuario).then(function (res) {\n        // console.log(res.data,me.usuario.idusuario)\n        if (res.data.status == '1') {\n          me.permisoRoot = true;\n          me.listaCiudades();\n        } else {\n          me.permisoRoot = false;\n          me.listaCiudades();\n        }\n      }).catch(function (error) {\n        console.log(error + ' error');\n      });\n    },\n    filtrarInstituciones: function filtrarInstituciones() {\n      var me = this;\n      if (me.ciudadSelect == null) return;\n      me.instituciones = [];\n      me.$vs.loading();\n      this.$http.get(this.$server_url + 'institucionesX_Ciudad?ciudad_id=' + me.ciudadSelect.idciudad).then(function (res) {\n        console.log(res.data);\n        me.instituciones = res.data;\n        me.$vs.loading.close();\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    getTipoVenta: function getTipoVenta(tr) {\n      var me = this;\n      if (tr.periodo.length == 0) {\n        me.$vs.notify({\n          text: 'No hay período asignado',\n          color: 'success',\n          iconPack: 'feather',\n          icon: 'icon-check'\n        });\n        return;\n      }\n      me.pedido.nombreInstitucion = tr.institucion.nombreInstitucion;\n      me.pedido.idInstitucion = tr.institucion.idInstitucion;\n      me.pedido.periodo = tr.periodo[0].periodo;\n      me.pedido.periodo_id = tr.periodo[0].periodo_id;\n      me.titulo = 'Detalle de venta de ' + me.pedido.nombreInstitucion;\n      me.popupTipoVenta = true;\n    },\n    getEditar: function getEditar(item) {\n      var me = this;\n      localStorage.setItem('dato_Institucion', item);\n      me.modalOk = true;\n      me.modalEditarInstitucion = true;\n    },\n    f_closeModal: function f_closeModal() {\n      var me = this;\n      me.modalEditarInstitucion = false;\n      me.modalOk = false;\n    },\n    f_update_institucion: function f_update_institucion() {\n      var me = this;\n      console.log(me.ciudadSelect);\n      me.filtrarInstituciones();\n      me.f_closeModal();\n    }\n  }\n};",{"version":3,"names":["vSelect","AddInstitucion","RevisionVentaVue","components","data","arregloCiudad","ciudadSelect","instituciones","permisoRoot","usuario","popupTipoVenta","informacion","tmpinformacion","nombreInstitucion","institucion_id","titulo","modalEditarInstitucion","modalOk","institucionSend","pedido","mounted","me","JSON","parse","localStorage","getItem","getUserRoot","methods","listaCiudades","$http","get","$server_url","then","res","catch","error","console","log","idusuario","status","filtrarInstituciones","$vs","loading","idciudad","close","getTipoVenta","tr","periodo","length","notify","text","color","iconPack","icon","institucion","idInstitucion","periodo_id","getEditar","item","setItem","f_closeModal","f_update_institucion"],"sources":["src/views/institucion/institucionesXCiudad.vue"],"sourcesContent":["<template>\r\n<div>\r\n    <div class=\"vx-row mb-4 mt-4\">\r\n        <div class=\"vx-col sm:w-1/3 w-full\">\r\n            <span>Ciudad</span>\r\n        </div>\r\n        <div class=\"vx-col sm:w-2/3 w-full\">\r\n          <div>\r\n            <v-select @input=\"filtrarInstituciones()\" :options=\"arregloCiudad\" :reduce=\"arregloCiudad => arregloCiudad\" label=\"nombre\" class=\"w-full\" v-model=\"ciudadSelect\" />\r\n            </div>\r\n            <div v-if=\"ciudadSelect == null || ciudadSelect.idciudad == null \">\r\n                <br />\r\n                <br />\r\n                <br />\r\n                <br />\r\n                <br />\r\n                <br />\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"vx-row mb-4\">\r\n        <vs-table stripe max-items=\"50\" v-if=\"instituciones.length > 0\" style=\"width: 100%;\" search pagination :data=\"instituciones\">\r\n            <template slot=\"header\">\r\n                <div class=\"vx-row\">\r\n                    <div class=\"vx-col w-full m-3\">\r\n                        Cantidad: {{instituciones.length}}\r\n                    </div>\r\n                </div>\r\n            </template>\r\n            <template slot=\"thead\">\r\n                <vs-th sort-key=\"idInstitucion\">#</vs-th>\r\n                <vs-th sort-key=\"nombreInstitucion\">Institución (asesor)</vs-th>\r\n                <vs-th sort-key=\"codigo_institucion_milton\">id Facturación</vs-th>\r\n                <vs-th sort-key=\"region\">Region</vs-th>\r\n                <vs-th sort-key=\"nombre\">Accion</vs-th>\r\n            </template>\r\n            <template slot-scope=\"{data}\">\r\n                <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                    <vs-td :data=\"data[indextr].institucion.idInstitucion \">\r\n                        {{data[indextr].institucion.idInstitucion }}\r\n                    </vs-td>\r\n                    <vs-td :data=\"data[indextr].institucion.nombreInstitucion\">\r\n                        {{data[indextr].institucion.nombreInstitucion}}<br>\r\n                        <div v-if=\"data[indextr].institucion.nombre_asesor == null &&  data[indextr].institucion.apellido_asesor == null\">\r\n                            <small> <i style=\"color:red;\">No existe asesor </i></small><br>\r\n                        </div>\r\n                        <div v-else>\r\n                            <small> <i>{{data[indextr].institucion.nombre_asesor}} {{data[indextr].institucion.apellido_asesor}} </i></small><br>\r\n                        </div>\r\n                        <small>{{data[indextr].institucion.fecha_registro}} </small>\r\n                    </vs-td>\r\n                    <vs-td :data=\"data[indextr].institucion.codigo_institucion_milton\">\r\n                        <span :class=\"tr.institucion.codigo_institucion_milton == '22507' ? 'texto-grande-1':'' \">{{data[indextr].institucion.codigo_institucion_milton}} </span><br />\r\n                        <small class=\"text-danger\" v-if=\"tr.institucion.codigo_institucion_milton == 22507\">Hay que cambiar</small>\r\n                    </vs-td>\r\n                    <vs-td :data=\"data[indextr].institucion.nombreregion\">\r\n                        {{data[indextr].institucion.nombreregion}} <br>\r\n                        <small>{{data[indextr].institucion.ciudad}}</small>\r\n                        <div v-if=\"tr.periodo.length > 0\">\r\n                          <br>\r\n                          <span>{{ tr.periodo[0].periodo }}</span>\r\n                        </div>\r\n                        <div v-else>\r\n                          <p><vs-chip color=\"danger\">Sin período</vs-chip></p>\r\n                        </div>\r\n                    </vs-td>\r\n                    <vs-td>\r\n                        <div class=\"flex\">\r\n                            <vs-button icon=\"code\" size=\"small\" color=\"dark\" @click=\"getTipoVenta(tr);\" class=\"ml-4\">Ver revisión venta</vs-button>\r\n                            <vs-button icon=\"edit\" size=\"small\" color=\"warning\" @click=\"institucionSend = tr.institucion.idInstitucion;getEditar(tr.institucion.idInstitucion)\" class=\"ml-4\"></vs-button>\r\n                        </div>\r\n                    </vs-td>\r\n                </vs-tr>\r\n            </template>\r\n        </vs-table>\r\n    </div>\r\n    <vs-popup fullscreen title=\"titulo\" :active.sync=\"modalEditarInstitucion\" @close=\"f_closeModal()\" v-if=\"modalOk\">\r\n        <AddInstitucion :id=\"institucionSend\" @update_institucion_x_ciudad=\"f_update_institucion()\" xciudad=\"ok\" />\r\n    </vs-popup>\r\n    <vs-popup class=\"holamundo\" fullscreen :title=\"titulo\" :active.sync=\"popupTipoVenta\">\r\n        <RevisionVentaVue v-if=\"popupTipoVenta\" :pedido=\"pedido\"/>\r\n    </vs-popup>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport vSelect from 'vue-select'\r\nimport AddInstitucion from './addInstitucion.vue';\r\nimport RevisionVentaVue from '../codigos/components/utils/RevisionVenta.vue';\r\nexport default {\r\n    components: {\r\n        \"v-select\": vSelect,\r\n        AddInstitucion,\r\n        RevisionVentaVue,\r\n    },\r\n    data() {\r\n        return {\r\n            arregloCiudad: [],\r\n            ciudadSelect: {},\r\n            instituciones: [],\r\n            permisoRoot: false,\r\n            usuario: [],\r\n            popupTipoVenta: false,\r\n            informacion: [],\r\n            tmpinformacion: [],\r\n            nombreInstitucion: '',\r\n            institucion_id: '',\r\n            titulo: '',\r\n            modalEditarInstitucion: false,\r\n            modalOk: false,\r\n            institucionSend:0,\r\n            pedido:{},\r\n        }\r\n    },\r\n    mounted() {\r\n        let me = this\r\n        me.usuario = JSON.parse(localStorage.getItem('usuario'));\r\n        me.getUserRoot()\r\n    },\r\n    methods: {\r\n        listaCiudades() {\r\n            let me = this\r\n            this.$http.get(this.$server_url + 'ciudad')\r\n                .then(res => {\r\n                    me.arregloCiudad = res.data;\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                })\r\n        },\r\n        getUserRoot() {\r\n            let me = this;\r\n            this.$http.get(this.$server_url + 'permisos?permiso=yes&usuario_id=' + me.usuario.idusuario)\r\n                .then(function (res) {\r\n                    // console.log(res.data,me.usuario.idusuario)\r\n                    if (res.data.status == '1') {\r\n                        me.permisoRoot = true\r\n                        me.listaCiudades();\r\n                    } else {\r\n                        me.permisoRoot = false\r\n                        me.listaCiudades();\r\n                    }\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error + ' error');\r\n                })\r\n        },\r\n        filtrarInstituciones() {\r\n          let me = this;\r\n          if (me.ciudadSelect == null) return\r\n          me.instituciones = []\r\n          me.$vs.loading()\r\n          this.$http.get(this.$server_url + 'institucionesX_Ciudad?ciudad_id='+me.ciudadSelect.idciudad)\r\n            .then(res => {\r\n                console.log(res.data)\r\n                me.instituciones = res.data;\r\n                me.$vs.loading.close()\r\n            })\r\n            .catch(function (error) {\r\n                console.log(error);\r\n            })\r\n        },\r\n        getTipoVenta(tr) {\r\n            let me = this;\r\n            if(tr.periodo.length == 0){\r\n                me.$vs.notify({\r\n                text:'No hay período asignado',\r\n                color:'success',\r\n                iconPack: 'feather',\r\n                icon:'icon-check'})\r\n                return\r\n            }\r\n            me.pedido.nombreInstitucion = tr.institucion.nombreInstitucion\r\n            me.pedido.idInstitucion     = tr.institucion.idInstitucion\r\n            me.pedido.periodo           = tr.periodo[0].periodo\r\n            me.pedido.periodo_id        = tr.periodo[0].periodo_id\r\n            me.titulo               = 'Detalle de venta de ' + me.pedido.nombreInstitucion\r\n            me.popupTipoVenta       = true;\r\n        },\r\n        getEditar(item) {\r\n            let me = this;\r\n            localStorage.setItem('dato_Institucion', item);\r\n            me.modalOk = true;\r\n            me.modalEditarInstitucion = true;\r\n        },\r\n        f_closeModal() {\r\n            let me = this;\r\n            me.modalEditarInstitucion = false;\r\n            me.modalOk = false;\r\n        },\r\n        f_update_institucion() {\r\n            let me = this;\r\n            console.log(me.ciudadSelect)\r\n            me.filtrarInstituciones();\r\n            me.f_closeModal();\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.texto-grande-1 {\r\n    font-size: medium;\r\n    color: red;\r\n    font-weight: 800;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]}]}