{"remainingRequest":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\director\\visitasUsers.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\src\\views\\director\\visitasUsers.vue","mtime":1712682815738},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\babel.config.js","mtime":1712682813877},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\.babelrc","mtime":1712682813750},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\laragon\\www\\PRY_NEW_JEYSON\\LOCAL\\plataformaprolipa_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport moment from 'moment';\nexport default {\n  data: function data() {\n    return {\n      institucion: {},\n      arregloVisitas: [],\n      anios: [],\n      anioSelect: '',\n      anioseleccionado: '',\n      yactual: null,\n      menosUno: null,\n      fromDate: null,\n      toDate: null,\n      mesDescripcion: '',\n      //variables para el export a excel\n      fileName: null,\n      formats: ['xls', 'xlsx', 'csv', 'txt'],\n      cellAutoWidth: true,\n      selectedFormat: 'xls'\n      //fin variables de exportar excel\n    };\n  },\n  created: function created() {\n    moment.locale('es');\n    var me = this;\n    me.institucion = JSON.parse(localStorage.getItem(\"institucion\"));\n  },\n  mounted: function mounted() {\n    var me = this;\n    // me.getVisitas()\n    me.yactual = moment().format('YYYY');\n    me.mactual = moment().format('M');\n    me.mesDescripcion = moment().format('MMMM');\n    //restar Anios\n    me.menosUno = me.yactual - 1;\n    me.anios.push({\n      anio: me.yactual\n    });\n    me.anios.push({\n      anio: me.menosUno\n    });\n    me.anioSelect = this.anios[0].anio;\n    me.getMonthStartEnd(me.yactual, me.mactual);\n  },\n  methods: {\n    getMonthStartEnd: function getMonthStartEnd(year, month) {\n      var me = this;\n      var startDate = new Date(year, parseInt(month - 1), 1);\n      var endDate = new Date(year, parseInt(month - 1) + 1, 0);\n      me.fromDate = moment(startDate).format('YYYY-MM-DD');\n      me.toDate = moment(endDate).format('YYYY-MM-DD');\n      me.getVisitas();\n      // return { start: startDate, end: endDate };\n    },\n    // const { start, end } = getMonthStartEnd(2023, 11);\n    getVisitas: function getVisitas() {\n      var me = this;\n      me.arregloVisitas = [];\n      me.anioseleccionado = me.anioSelect;\n      me.$vs.loading();\n      this.$http.get(this.$server_url + 'usuarioVisitasAll?institucion_id=' + me.institucion.institucion_id + '&fromDate=' + me.fromDate + '&toDate=' + me.toDate).then(function (response) {\n        me.$vs.loading.close();\n        var datos = response.data;\n        datos.forEach(function (element, index) {\n          var cal = new Object();\n          cal.idusuario = element.idusuario;\n          cal.usuario = element.usuario;\n          cal.cedula = element.cedula;\n          cal.email = element.email;\n          var getRecursos = element.visitas;\n          // cal.recursos = new Object();\n          var contador1 = getRecursos.filter(function (p) {\n            return p.recurso == 1;\n          }); //:libro,\n          var contador2 = getRecursos.filter(function (p) {\n            return p.recurso == 2;\n          }); //:unidades,\n          var contador3 = getRecursos.filter(function (p) {\n            return p.recurso == 3;\n          }); //:cuadernos,\n          var contador4 = getRecursos.filter(function (p) {\n            return p.recurso == 4;\n          }); //:teletarea,\n          var contador5 = getRecursos.filter(function (p) {\n            return p.recurso == 5;\n          }); //:proyectos, \n          var contador6 = getRecursos.filter(function (p) {\n            return p.recurso == 6;\n          }); //:adaptaciones,\n          var contador7 = getRecursos.filter(function (p) {\n            return p.recurso == 7;\n          }); //:propuestas,\n          var contador8 = getRecursos.filter(function (p) {\n            return p.recurso == 8;\n          }); //:juegos,\n          var contador9 = getRecursos.filter(function (p) {\n            return p.recurso == 9;\n          }); //:material,\n          var contador10 = getRecursos.filter(function (p) {\n            return p.recurso == 10;\n          }); //:articulos,\n          var contador11 = getRecursos.filter(function (p) {\n            return p.recurso == 11;\n          }); //:tareas,\n          var contador12 = getRecursos.filter(function (p) {\n            return p.recurso == 12;\n          }); //:pdf guia,\n          var contador13 = getRecursos.filter(function (p) {\n            return p.recurso == 13;\n          }); //:pdf sin guia,\n          var contador14 = getRecursos.filter(function (p) {\n            return p.recurso == 14;\n          }); //:guia didactica,\n          var contador15 = getRecursos.filter(function (p) {\n            return p.recurso == 15;\n          }); //:Ingreso al sistema,\n          var contador16 = getRecursos.filter(function (p) {\n            return p.recurso == 16;\n          }); //:Planificacion,\n          var contador17 = getRecursos.filter(function (p) {\n            return p.recurso == 17;\n          }); //:Documentos Minesterial,\n          var contador18 = getRecursos.filter(function (p) {\n            return p.recurso == 18;\n          }); //:videos tema,\n          var contador19 = getRecursos.filter(function (p) {\n            return p.recurso == 19;\n          }); //:actividades,\n          var contador20 = getRecursos.filter(function (p) {\n            return p.recurso == 20;\n          }); //:animaciones\n          for (var _index = 1; _index <= 20; _index++) {\n            try {\n              eval(\"cal.contador\" + _index + \"=\" + \"contador\" + _index + \".length\");\n            } catch (error) {\n              eval(\"cal.contador\" + _index + \"=\" + 0);\n            }\n          }\n          me.arregloVisitas.push(cal);\n        });\n      }).catch(function (error) {\n        console.log(error);\n        me.$vs.loading.close();\n      });\n    },\n    //METODOS PARA EXCEL\n    //para limipiar los campos del excel\n    clearFields: function clearFields() {\n      this.fileName = '';\n      this.cellAutoWidth = true;\n      this.selectedFormat = 'xls';\n    },\n    //metodo par descargar el excel\n    exportToExcel: function exportToExcel() {\n      var _this = this;\n      var me = this;\n      var headerTitle = ['Nombres', 'Cédula', 'Ingreso al sistema', 'libro', 'unidades', 'cuadernos', 'teletarea', 'proyectos', 'adaptaciones curriculares', 'propuestas metodológicas', 'juegos', 'material', 'articulos', 'tareas', 'pdf guia', 'pdf sin guia', 'guia didactica', 'Planificación', 'Documentos Minesteriales', 'videos', 'actividades', 'animaciones'];\n      var headerVal = ['usuario', 'cedula', 'contador15', 'contador1', 'contador2', 'contador3', 'contador4', 'contador5', 'contador6', 'contador7', 'contador8', 'contador9', 'contador10', 'contador11', 'contador12', 'contador13', 'contador14', 'contador16', 'contador17', 'contador18', 'contador19', 'contador20'];\n      var codigoSelectedMayus = this.arregloVisitas;\n      for (var i = 0; i < codigoSelectedMayus.length; i++) {\n        for (var key in codigoSelectedMayus[i]) {\n          if (typeof codigoSelectedMayus[i][key] == \"string\") {\n            codigoSelectedMayus[i][key] = codigoSelectedMayus[i][key].toUpperCase();\n          }\n        }\n      }\n      var reporte = 'Reporte visitas ' + me.mesDescripcion + '-' + me.anioseleccionado + '-' + me.institucion.nombreInstitucion;\n      import('@/vendor/Export2Excel').then(function (excel) {\n        var list = codigoSelectedMayus;\n        var data = _this.formatJson(headerVal, list);\n        excel.export_json_to_excel({\n          header: headerTitle,\n          data: data,\n          filename: reporte,\n          autoWidth: _this.cellAutoWidth,\n          bookType: _this.selectedFormat\n        });\n        _this.clearFields();\n      });\n    },\n    formatJson: function formatJson(filterVal, jsonData) {\n      return jsonData.map(function (v) {\n        return filterVal.map(function (j) {\n          return v[j];\n        });\n      });\n    }\n  }\n};",{"version":3,"names":["moment","data","institucion","arregloVisitas","anios","anioSelect","anioseleccionado","yactual","menosUno","fromDate","toDate","mesDescripcion","fileName","formats","cellAutoWidth","selectedFormat","created","locale","me","JSON","parse","localStorage","getItem","mounted","format","mactual","push","anio","getMonthStartEnd","methods","year","month","startDate","Date","parseInt","endDate","getVisitas","$vs","loading","$http","get","$server_url","institucion_id","then","response","close","datos","forEach","element","index","cal","Object","idusuario","usuario","cedula","email","getRecursos","visitas","contador1","filter","p","recurso","contador2","contador3","contador4","contador5","contador6","contador7","contador8","contador9","contador10","contador11","contador12","contador13","contador14","contador15","contador16","contador17","contador18","contador19","contador20","eval","error","catch","console","log","clearFields","exportToExcel","_this","headerTitle","headerVal","codigoSelectedMayus","i","length","key","toUpperCase","reporte","nombreInstitucion","excel","list","formatJson","export_json_to_excel","header","filename","autoWidth","bookType","filterVal","jsonData","map","v","j"],"sources":["src/views/director/visitasUsers.vue"],"sourcesContent":["<template>\r\n    <div class=\"mt-2\">\r\n        <vs-list-header color=\"success\" icon=\"groups\" title=\"Filtro de visitas de docentes\"></vs-list-header>\r\n        <div class=\"flex\" style=\"position: relative;top:15px\">\r\n            <ul class=\"leftx\">\r\n                <li v-for=\"(tr,index) in anios\" :key=\"index\">\r\n                    <vs-radio v-model=\"anioSelect\" @input=\"getEstastica()\" vs-name=\"radios1\" :vs-value=\"tr.anio\">{{ tr.anio }}</vs-radio>\r\n                </li>\r\n            </ul>\r\n            <vs-dropdown vs-custom-content vs-trigger-click  class=\"ml-5\">\r\n                <vs-button type=\"relief\" icon=\"event\" color=\"warning\"  class=\"a-icon\" >\r\n                    Seleccione el mes a filtrar\r\n                    <vs-icon style=\"position: relative;top: 2px;\" icon=\"expand_more\"></vs-icon>\r\n                </vs-button>\r\n                <vs-dropdown-menu class=\"loginx\">\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='enero';getMonthStartEnd(anioSelect,1)\" >\r\n                        <span class=\"feather icon icon-calendar\" ></span> Enero\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='febrero';getMonthStartEnd(anioSelect,2)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Febrero\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='marzo';getMonthStartEnd(anioSelect,3)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Marzo\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='abril';getMonthStartEnd(anioSelect,4)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Abril\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='mayo';getMonthStartEnd(anioSelect,5)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Mayo\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='junio';getMonthStartEnd(anioSelect,6)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Junio\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='julio';getMonthStartEnd(anioSelect,7)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Julio\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='agosto';getMonthStartEnd(anioSelect,8)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Agosto\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='septiembre';getMonthStartEnd(anioSelect,9)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Septiembre\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='octubre';getMonthStartEnd(anioSelect,10)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Octubre\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='noviembre';getMonthStartEnd(anioSelect,11)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Noviembre\r\n                    </vs-dropdown-item>\r\n                    <vs-dropdown-item  style=\"width:200px\" @click=\"mesDescripcion='diciembre';getMonthStartEnd(anioSelect,12)\">\r\n                        <span class=\"feather icon icon-calendar\" ></span> Diciembre\r\n                    </vs-dropdown-item>\r\n                </vs-dropdown-menu>\r\n            </vs-dropdown>\r\n        </div>\r\n        <!--Tabla-->\r\n        <br>\r\n        <vs-divider color=\"success\" class=\"mt-5\">VISITAS DEL MES {{ mesDescripcion.toUpperCase() }} DEL AÑO {{ anioseleccionado }}</vs-divider>\r\n        <vs-table max-items=\"10\" stripe search pagination :data=\"arregloVisitas\">\r\n            <template slot=\"header\">\r\n                <vs-chip  color=\"primary\">Cantidad: <b> {{ arregloVisitas.length }}</b></vs-chip>\r\n                <span @click=\"exportToExcel()\" class=\"cursor-pointer\">\r\n                    <vs-chip transparent class=\"py-3 ml-2\" style=\"font-weight: bold;\" color=\"warning\"><i class=\"fa-solid fa-download\"></i><span class=\"ml-2\">Exportar</span> </vs-chip>\r\n                </span>\r\n            </template>\r\n            <template slot=\"thead\">\r\n                <vs-th>Datos</vs-th>\r\n                <vs-th>Visitas</vs-th>\r\n            </template>\r\n            <template slot-scope=\"{data}\">\r\n                <vs-tr :key=\"indextr\" v-for=\"(tr, indextr) in data\">\r\n                    <vs-td>\r\n                        Nombres:\r\n                        <br>        \r\n                        <span style=\"font-weight:600;  \" >\r\n                        {{ tr.usuario }} {{ tr.apellidos }}<br>\r\n                        </span>\r\n                        Cédula:\r\n                        <br>  \r\n                        <span style=\"font-weight:600;  \" >\r\n                        {{ tr.cedula }}<br>\r\n                        </span>\r\n                        \r\n                    </vs-td>\r\n                    <vs-td>\r\n                       <p>Ingreso al sistema:       <span class=\"font-bold\">{{ tr.contador15 }}</span></p>\r\n                       <p>Libros:                   <span class=\"font-bold\">{{ tr.contador1 }}</span></p>\r\n                       <p>Unidades:                 <span class=\"font-bold\">{{ tr.contador2 }}</span></p>\r\n                       <p>Cuadernos:                <span class=\"font-bold\">{{ tr.contador3 }}</span></p>\r\n                       <p>Teletarea:                <span class=\"font-bold\">{{ tr.contador4 }}</span></p>\r\n                       <p>Proyectos:                <span class=\"font-bold\">{{ tr.contador5 }}</span></p>\r\n                       <p>Adaptaciones curriculares:<span class=\"font-bold\">{{ tr.contador6 }}</span></p>\r\n                       <p>Propuestas metodólogicas: <span class=\"font-bold\">{{ tr.contador7 }}</span></p>\r\n                       <p>Juegos:                   <span class=\"font-bold\">{{ tr.contador8 }}</span></p>\r\n                       <p>Material:                 <span class=\"font-bold\">{{ tr.contador9 }}</span></p>\r\n                       <p>Artículos:                <span class=\"font-bold\">{{ tr.contador10 }}</span></p>\r\n                       <p>Tareas:                   <span class=\"font-bold\">{{ tr.contador11 }}</span></p>\r\n                       <p>Pdf guia:                 <span class=\"font-bold\">{{ tr.contador12 }}</span></p>\r\n                       <p>Pdf sin guia:             <span class=\"font-bold\">{{ tr.contador13 }}</span></p>\r\n                       <p>Guia didáctica:           <span class=\"font-bold\">{{ tr.contador14 }}</span></p>\r\n                       <p>Planificación:            <span class=\"font-bold\">{{ tr.contador16 }}</span></p>\r\n                       <p>Documentos Minesterial:   <span class=\"font-bold\">{{ tr.contador17 }}</span></p>\r\n                       <p>Videos:                   <span class=\"font-bold\">{{ tr.contador18 }}</span></p>\r\n                       <p>Actividades:              <span class=\"font-bold\">{{ tr.contador19 }}</span></p>\r\n                       <p>Animaciones:              <span class=\"font-bold\">{{ tr.contador20 }}</span></p>\r\n                    </vs-td>\r\n                </vs-tr>\r\n            </template>\r\n        </vs-table> \r\n    </div>\r\n</template>\r\n<script>\r\nimport moment from 'moment'\r\nexport default{\r\n    data(){\r\n        return{\r\n            institucion:{},\r\n            arregloVisitas:[],\r\n            anios:[],\r\n            anioSelect:'',\r\n            anioseleccionado:'',\r\n            yactual:null,\r\n            menosUno:null,\r\n            fromDate:null,\r\n            toDate:null,\r\n            mesDescripcion:'',\r\n            //variables para el export a excel\r\n            fileName: null,\r\n            formats: ['xls', 'xlsx', 'csv', 'txt'],\r\n            cellAutoWidth: true,\r\n            selectedFormat: 'xls',\r\n            //fin variables de exportar excel\r\n        }\r\n    },\r\n    created(){\r\n        moment.locale('es');\r\n        let me = this;\r\n        me.institucion = JSON.parse(localStorage.getItem(\"institucion\"))\r\n    },\r\n    mounted(){\r\n        let me = this\r\n        // me.getVisitas()\r\n        me.yactual = moment().format('YYYY');\r\n        me.mactual = moment().format('M');\r\n        me.mesDescripcion = moment().format('MMMM');\r\n        //restar Anios\r\n        me.menosUno = me.yactual - 1;\r\n        me.anios.push({anio:me.yactual});\r\n        me.anios.push({anio:me.menosUno}); \r\n        me.anioSelect = this.anios[0].anio\r\n        me.getMonthStartEnd(me.yactual,me.mactual)\r\n    },\r\n    methods:{\r\n        getMonthStartEnd(year, month) {\r\n            let me = this\r\n            const startDate = new Date(year, parseInt(month-1), 1);\r\n            const endDate = new Date(year, parseInt(month-1) + 1, 0);\r\n            me.fromDate       = moment(startDate).format('YYYY-MM-DD')\r\n            me.toDate         = moment(endDate).format('YYYY-MM-DD')\r\n            me.getVisitas()\r\n        // return { start: startDate, end: endDate };\r\n        },\r\n        // const { start, end } = getMonthStartEnd(2023, 11);\r\n        getVisitas(){\r\n            let me = this;\r\n            me.arregloVisitas = []\r\n            me.anioseleccionado = me.anioSelect\r\n            me.$vs.loading()\r\n            this.$http.get(this.$server_url + 'usuarioVisitasAll?institucion_id=' + me.institucion.institucion_id+'&fromDate='+me.fromDate+'&toDate='+me.toDate)\r\n                .then(function (response) {\r\n                    me.$vs.loading.close()\r\n                    let datos = response.data\r\n                    datos.forEach((element,index) => {\r\n                            var cal = new Object();\r\n                            cal.idusuario = element.idusuario\r\n                            cal.usuario = element.usuario\r\n                            cal.cedula = element.cedula\r\n                            cal.email = element.email\r\n                            let getRecursos = element.visitas\r\n                            // cal.recursos = new Object();\r\n                            let contador1   = getRecursos.filter(p => p.recurso == 1)           //:libro,\r\n                            let contador2   = getRecursos.filter(p => p.recurso == 2)           //:unidades,\r\n                            let contador3   = getRecursos.filter(p => p.recurso == 3)           //:cuadernos,\r\n                            let contador4   = getRecursos.filter(p => p.recurso == 4)           //:teletarea,\r\n                            let contador5   = getRecursos.filter(p => p.recurso == 5)           //:proyectos, \r\n                            let contador6   = getRecursos.filter(p => p.recurso == 6)           //:adaptaciones,\r\n                            let contador7   = getRecursos.filter(p => p.recurso == 7)           //:propuestas,\r\n                            let contador8   = getRecursos.filter(p => p.recurso == 8)           //:juegos,\r\n                            let contador9   = getRecursos.filter(p => p.recurso == 9)           //:material,\r\n                            let contador10  = getRecursos.filter(p => p.recurso == 10)          //:articulos,\r\n                            let contador11  = getRecursos.filter(p => p.recurso == 11)          //:tareas,\r\n                            let contador12  = getRecursos.filter(p => p.recurso == 12)          //:pdf guia,\r\n                            let contador13  = getRecursos.filter(p => p.recurso == 13)          //:pdf sin guia,\r\n                            let contador14  = getRecursos.filter(p => p.recurso == 14)          //:guia didactica,\r\n                            let contador15  = getRecursos.filter(p => p.recurso == 15)          //:Ingreso al sistema,\r\n                            let contador16  = getRecursos.filter(p => p.recurso == 16)         //:Planificacion,\r\n                            let contador17  = getRecursos.filter(p => p.recurso == 17)         //:Documentos Minesterial,\r\n                            let contador18  = getRecursos.filter(p => p.recurso == 18)         //:videos tema,\r\n                            let contador19  = getRecursos.filter(p => p.recurso == 19)         //:actividades,\r\n                            let contador20  = getRecursos.filter(p => p.recurso == 20)         //:animaciones\r\n                            for (let index = 1; index <= 20; index++) {\r\n                                try {\r\n                                    eval(\"cal.contador\" + index + \"=\" + \"contador\"+index+\".length\");\r\n                                } catch (error) {\r\n                                    eval(\"cal.contador\" + index + \"=\" + 0);\r\n                                }\r\n                                \r\n                            }\r\n                        me.arregloVisitas.push(cal)\r\n                    });\r\n                })\r\n                .catch(function (error) {\r\n                    console.log(error)\r\n                    me.$vs.loading.close()\r\n                })\r\n        },\r\n          //METODOS PARA EXCEL\r\n        //para limipiar los campos del excel\r\n        clearFields() {\r\n            this.fileName = ''\r\n            this.cellAutoWidth = true\r\n            this.selectedFormat = 'xls'\r\n        },\r\n        //metodo par descargar el excel\r\n        exportToExcel() {\r\n            let me = this;\r\n            let headerTitle = [\r\n                'Nombres',\r\n                'Cédula',\r\n                'Ingreso al sistema',\r\n                'libro',\r\n                'unidades',\r\n                'cuadernos',\r\n                'teletarea',\r\n                'proyectos',\r\n                'adaptaciones curriculares',\r\n                'propuestas metodológicas',\r\n                'juegos',\r\n                'material',\r\n                'articulos',\r\n                'tareas',\r\n                'pdf guia',\r\n                'pdf sin guia',\r\n                'guia didactica',\r\n                'Planificación',\r\n                'Documentos Minesteriales',\r\n                'videos',\r\n                'actividades',\r\n                'animaciones'\r\n            ];\r\n            let headerVal = [\r\n                'usuario',\r\n                'cedula',\r\n                'contador15',\r\n                'contador1',\r\n                'contador2',\r\n                'contador3',\r\n                'contador4',\r\n                'contador5',\r\n                'contador6',\r\n                'contador7',\r\n                'contador8',\r\n                'contador9',\r\n                'contador10',\r\n                'contador11',\r\n                'contador12',\r\n                'contador13',\r\n                'contador14',\r\n                'contador16',\r\n                'contador17',\r\n                'contador18',\r\n                'contador19',\r\n                'contador20',\r\n            ];  \r\n            let codigoSelectedMayus = this.arregloVisitas\r\n            for (var i = 0; i < codigoSelectedMayus.length; i++) {\r\n                for (var key in codigoSelectedMayus[i]) {\r\n                    if (typeof codigoSelectedMayus[i][key] == \"string\") {\r\n                        codigoSelectedMayus[i][key] = codigoSelectedMayus[i][key].toUpperCase();\r\n                    }\r\n                }\r\n            }\r\n            let reporte = 'Reporte visitas '+me.mesDescripcion+'-'+me.anioseleccionado+'-'+me.institucion.nombreInstitucion\r\n            import('@/vendor/Export2Excel').then(excel => {\r\n                const list = codigoSelectedMayus\r\n                const data = this.formatJson(headerVal, list)\r\n                excel.export_json_to_excel({\r\n                    header: headerTitle,\r\n                    data,\r\n                    filename: reporte,\r\n                    autoWidth: this.cellAutoWidth,\r\n                    bookType: this.selectedFormat\r\n                })\r\n                this.clearFields()\r\n            })\r\n        },\r\n        formatJson(filterVal, jsonData) {\r\n            return jsonData.map(v => filterVal.map(j => {\r\n                return v[j]\r\n            }))\r\n        },\r\n    }\r\n}\r\n</script>\r\n<style scoped>\r\n\r\n</style>"],"mappings":";AA+GA,OAAAA,MAAA;AACA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,WAAA;MACAC,cAAA;MACAC,KAAA;MACAC,UAAA;MACAC,gBAAA;MACAC,OAAA;MACAC,QAAA;MACAC,QAAA;MACAC,MAAA;MACAC,cAAA;MACA;MACAC,QAAA;MACAC,OAAA;MACAC,aAAA;MACAC,cAAA;MACA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACAhB,MAAA,CAAAiB,MAAA;IACA,IAAAC,EAAA;IACAA,EAAA,CAAAhB,WAAA,GAAAiB,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,IAAAL,EAAA;IACA;IACAA,EAAA,CAAAX,OAAA,GAAAP,MAAA,GAAAwB,MAAA;IACAN,EAAA,CAAAO,OAAA,GAAAzB,MAAA,GAAAwB,MAAA;IACAN,EAAA,CAAAP,cAAA,GAAAX,MAAA,GAAAwB,MAAA;IACA;IACAN,EAAA,CAAAV,QAAA,GAAAU,EAAA,CAAAX,OAAA;IACAW,EAAA,CAAAd,KAAA,CAAAsB,IAAA;MAAAC,IAAA,EAAAT,EAAA,CAAAX;IAAA;IACAW,EAAA,CAAAd,KAAA,CAAAsB,IAAA;MAAAC,IAAA,EAAAT,EAAA,CAAAV;IAAA;IACAU,EAAA,CAAAb,UAAA,QAAAD,KAAA,IAAAuB,IAAA;IACAT,EAAA,CAAAU,gBAAA,CAAAV,EAAA,CAAAX,OAAA,EAAAW,EAAA,CAAAO,OAAA;EACA;EACAI,OAAA;IACAD,gBAAA,WAAAA,iBAAAE,IAAA,EAAAC,KAAA;MACA,IAAAb,EAAA;MACA,IAAAc,SAAA,OAAAC,IAAA,CAAAH,IAAA,EAAAI,QAAA,CAAAH,KAAA;MACA,IAAAI,OAAA,OAAAF,IAAA,CAAAH,IAAA,EAAAI,QAAA,CAAAH,KAAA;MACAb,EAAA,CAAAT,QAAA,GAAAT,MAAA,CAAAgC,SAAA,EAAAR,MAAA;MACAN,EAAA,CAAAR,MAAA,GAAAV,MAAA,CAAAmC,OAAA,EAAAX,MAAA;MACAN,EAAA,CAAAkB,UAAA;MACA;IACA;IACA;IACAA,UAAA,WAAAA,WAAA;MACA,IAAAlB,EAAA;MACAA,EAAA,CAAAf,cAAA;MACAe,EAAA,CAAAZ,gBAAA,GAAAY,EAAA,CAAAb,UAAA;MACAa,EAAA,CAAAmB,GAAA,CAAAC,OAAA;MACA,KAAAC,KAAA,CAAAC,GAAA,MAAAC,WAAA,yCAAAvB,EAAA,CAAAhB,WAAA,CAAAwC,cAAA,kBAAAxB,EAAA,CAAAT,QAAA,gBAAAS,EAAA,CAAAR,MAAA,EACAiC,IAAA,WAAAC,QAAA;QACA1B,EAAA,CAAAmB,GAAA,CAAAC,OAAA,CAAAO,KAAA;QACA,IAAAC,KAAA,GAAAF,QAAA,CAAA3C,IAAA;QACA6C,KAAA,CAAAC,OAAA,WAAAC,OAAA,EAAAC,KAAA;UACA,IAAAC,GAAA,OAAAC,MAAA;UACAD,GAAA,CAAAE,SAAA,GAAAJ,OAAA,CAAAI,SAAA;UACAF,GAAA,CAAAG,OAAA,GAAAL,OAAA,CAAAK,OAAA;UACAH,GAAA,CAAAI,MAAA,GAAAN,OAAA,CAAAM,MAAA;UACAJ,GAAA,CAAAK,KAAA,GAAAP,OAAA,CAAAO,KAAA;UACA,IAAAC,WAAA,GAAAR,OAAA,CAAAS,OAAA;UACA;UACA,IAAAC,SAAA,GAAAF,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAC,SAAA,GAAAN,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAE,SAAA,GAAAP,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAG,SAAA,GAAAR,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAI,SAAA,GAAAT,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAK,SAAA,GAAAV,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAM,SAAA,GAAAX,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAO,SAAA,GAAAZ,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAQ,SAAA,GAAAb,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAS,UAAA,GAAAd,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAU,UAAA,GAAAf,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAW,UAAA,GAAAhB,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAY,UAAA,GAAAjB,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAa,UAAA,GAAAlB,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAc,UAAA,GAAAnB,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAe,UAAA,GAAApB,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAgB,UAAA,GAAArB,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAiB,UAAA,GAAAtB,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAkB,UAAA,GAAAvB,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,IAAAmB,UAAA,GAAAxB,WAAA,CAAAG,MAAA,WAAAC,CAAA;YAAA,OAAAA,CAAA,CAAAC,OAAA;UAAA;UACA,SAAAZ,MAAA,MAAAA,MAAA,QAAAA,MAAA;YACA;cACAgC,IAAA,kBAAAhC,MAAA,sBAAAA,MAAA;YACA,SAAAiC,KAAA;cACAD,IAAA,kBAAAhC,MAAA;YACA;UAEA;UACA/B,EAAA,CAAAf,cAAA,CAAAuB,IAAA,CAAAwB,GAAA;QACA;MACA,GACAiC,KAAA,WAAAD,KAAA;QACAE,OAAA,CAAAC,GAAA,CAAAH,KAAA;QACAhE,EAAA,CAAAmB,GAAA,CAAAC,OAAA,CAAAO,KAAA;MACA;IACA;IACA;IACA;IACAyC,WAAA,WAAAA,YAAA;MACA,KAAA1E,QAAA;MACA,KAAAE,aAAA;MACA,KAAAC,cAAA;IACA;IACA;IACAwE,aAAA,WAAAA,cAAA;MAAA,IAAAC,KAAA;MACA,IAAAtE,EAAA;MACA,IAAAuE,WAAA,IACA,WACA,UACA,sBACA,SACA,YACA,aACA,aACA,aACA,6BACA,4BACA,UACA,YACA,aACA,UACA,YACA,gBACA,kBACA,iBACA,4BACA,UACA,eACA,cACA;MACA,IAAAC,SAAA,IACA,WACA,UACA,cACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,cACA,cACA,cACA,cACA,cACA,cACA,cACA,cACA,cACA,aACA;MACA,IAAAC,mBAAA,QAAAxF,cAAA;MACA,SAAAyF,CAAA,MAAAA,CAAA,GAAAD,mBAAA,CAAAE,MAAA,EAAAD,CAAA;QACA,SAAAE,GAAA,IAAAH,mBAAA,CAAAC,CAAA;UACA,WAAAD,mBAAA,CAAAC,CAAA,EAAAE,GAAA;YACAH,mBAAA,CAAAC,CAAA,EAAAE,GAAA,IAAAH,mBAAA,CAAAC,CAAA,EAAAE,GAAA,EAAAC,WAAA;UACA;QACA;MACA;MACA,IAAAC,OAAA,wBAAA9E,EAAA,CAAAP,cAAA,SAAAO,EAAA,CAAAZ,gBAAA,SAAAY,EAAA,CAAAhB,WAAA,CAAA+F,iBAAA;MACA,gCAAAtD,IAAA,WAAAuD,KAAA;QACA,IAAAC,IAAA,GAAAR,mBAAA;QACA,IAAA1F,IAAA,GAAAuF,KAAA,CAAAY,UAAA,CAAAV,SAAA,EAAAS,IAAA;QACAD,KAAA,CAAAG,oBAAA;UACAC,MAAA,EAAAb,WAAA;UACAxF,IAAA,EAAAA,IAAA;UACAsG,QAAA,EAAAP,OAAA;UACAQ,SAAA,EAAAhB,KAAA,CAAA1E,aAAA;UACA2F,QAAA,EAAAjB,KAAA,CAAAzE;QACA;QACAyE,KAAA,CAAAF,WAAA;MACA;IACA;IACAc,UAAA,WAAAA,WAAAM,SAAA,EAAAC,QAAA;MACA,OAAAA,QAAA,CAAAC,GAAA,WAAAC,CAAA;QAAA,OAAAH,SAAA,CAAAE,GAAA,WAAAE,CAAA;UACA,OAAAD,CAAA,CAAAC,CAAA;QACA;MAAA;IACA;EACA;AACA","ignoreList":[]}]}